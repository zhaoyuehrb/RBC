%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Thu Sep 10 09:48:15 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
ACAUUGUCGUUAGUUUACCAGAUCCGUGAUGCCACUUACCUGUGUGUUUGGUAACAACAAACCAACAUCAUGGAGGUCCCUGGAUUGAAAAAGGAGCCUCUCCCACUCCUCCUACCACCGAAGUGGUUAGGACUCUAUAUAAAUAAAAACAAGGCUUUUGGAAAAUAAUUGCA\
) } def
/len { sequence length } bind def

/coor [
[86.92358398 423.29293823]
[72.03133392 429.25955200]
[58.15299988 421.21148682]
[55.93484879 405.32250977]
[67.07845306 393.78131104]
[68.16082001 378.82040405]
[69.24318695 363.85949707]
[62.44442749 350.60711670]
[71.15734863 337.40121460]
[72.23971558 322.44030762]
[73.32208252 307.47940063]
[74.40444946 292.51852417]
[67.60569000 279.26611328]
[76.31861115 266.06021118]
[77.40097809 251.09931946]
[78.48334503 236.13842773]
[75.82059479 229.21614075]
[79.72270203 220.91796875]
[81.07499695 205.97904968]
[82.42729187 191.04014587]
[83.77959442 176.10122681]
[85.13188934 161.16230774]
[76.90822601 145.67611694]
[87.59571838 130.70046997]
[88.67808533 115.73957062]
[79.49304199 103.88060760]
[64.73686981 101.18702698]
[49.98069382 98.49344635]
[35.22452164 95.79986572]
[20.46834946 93.10628510]
[5.71217632 90.41271210]
[5.06542301 110.66369629]
[-14.21935844 128.68815613]
[-28.97553062 131.38172913]
[-43.73170471 134.07531738]
[-52.51129532 147.21662903]
[-68.02780914 150.21885681]
[-81.07556915 141.30081177]
[-83.91358185 125.75343323]
[-74.85809326 112.80068207]
[-59.28156662 110.12721252]
[-46.42528152 119.31913757]
[-31.66910934 116.62555695]
[-16.91293716 113.93198395]
[-15.83339214 106.51007843]
[-27.60914612 97.21859741]
[-13.67430305 91.66628265]
[-12.59475803 84.24438477]
[-25.97212982 77.45867157]
[-39.34949875 70.67295074]
[-52.72687149 63.88723755]
[-66.10424042 57.10152435]
[-79.85544586 64.29068756]
[-95.20113373 61.99079514]
[-106.24057770 51.08619690]
[-108.72888184 35.76993179]
[-101.70925140 21.93141937]
[-87.88087463 14.89184952]
[-72.56104279 17.35807991]
[-61.64053726 28.38179588]
[-59.31852722 43.72415161]
[-45.94115448 50.50986862]
[-32.56378555 57.29558182]
[-19.18641281 64.08129883]
[-5.80904198 70.86701202]
[8.40575504 75.65653992]
[23.16192818 78.35011292]
[37.91810226 81.04369354]
[52.67427444 83.73727417]
[67.43044281 86.43085480]
[82.18661499 89.12443542]
[93.61904907 79.41363525]
[93.34823608 64.41608429]
[93.07742310 49.41852951]
[92.80661011 34.42097092]
[92.53579712 19.42341805]
[92.26499176 4.42586231]
[84.27980042 -9.23237038]
[91.78605652 -22.09725761]
[91.51524353 -37.09481430]
[91.24443054 -52.09236908]
[77.76808929 -59.46011734]
[69.79482269 -72.58728790]
[69.46939850 -87.94273376]
[76.87934875 -101.39591217]
[90.03144836 -109.32799530]
[105.38784027 -109.60528564]
[118.81772614 -102.15319824]
[126.70854950 -88.97630310]
[126.93769836 -73.61912537]
[119.44355011 -60.21265793]
[106.24198914 -52.36318207]
[106.51280212 -37.36562729]
[106.78361511 -22.36807060]
[114.74943542 -9.78256321]
[107.26254272 4.15505028]
[107.53335571 19.15260506]
[107.80416870 34.15016174]
[108.07498169 49.14771652]
[108.34579468 64.14527130]
[108.61660767 79.14282227]
[114.78602600 83.40760040]
[121.73857117 70.11617279]
[124.34214783 55.34384918]
[138.18267822 49.56113815]
[150.52182007 58.09024048]
[150.00305176 73.08126831]
[137.10272217 80.73703003]
[127.12486267 91.93714142]
[133.29428101 96.20191193]
[147.42028809 91.15653229]
[161.54629517 86.11115265]
[175.67231750 81.06577301]
[189.79832458 76.02039337]
[203.87820435 70.84770203]
[217.91082764 65.54811096]
[231.94343567 60.24852371]
[245.97605896 54.94893265]
[255.94094849 41.92461014]
[272.16564941 44.31032181]
[277.95956421 59.65185165]
[267.36242676 72.16715240]
[251.27565002 68.98155212]
[237.24302673 74.28114319]
[223.21041870 79.58072662]
[209.17779541 84.88031769]
[204.01336670 90.20355225]
[194.84370422 90.14640808]
[180.71768188 95.19178772]
[166.59167480 100.23715973]
[152.46566772 105.28253937]
[138.33966064 110.32791901]
[153.15528870 112.67255402]
[167.97090149 115.01718903]
[182.78652954 117.36182404]
[196.59600830 123.21829224]
[207.98655701 132.97817993]
[215.89060974 145.72674561]
[219.56738281 160.26913452]
[218.67225647 175.24240112]
[213.28912354 189.24319458]
[203.92253113 200.95928955]
[191.45033264 209.29261780]
[177.04148865 213.46214294]
[162.04643250 213.07708740]
[147.87055969 208.17355347]
[135.84249878 199.21109009]
[127.08954620 187.02970886]
[122.43208313 172.77110291]
[122.30729675 157.76695251]
[116.08452606 144.11860657]
[109.86175537 130.47027588]
[103.63898468 116.82192993]
[102.55661774 131.78283691]
[110.39945221 142.05105591]
[109.16896057 154.50991821]
[100.07080841 162.51460266]
[98.71850586 177.45352173]
[97.36621094 192.39244080]
[96.01391602 207.33135986]
[94.66162109 222.27027893]
[93.44423676 237.22079468]
[92.36187744 252.18168640]
[91.27951050 267.14257812]
[98.00084686 281.46508789]
[89.36534882 293.60089111]
[88.28298187 308.56176758]
[87.20061493 323.52267456]
[86.11824799 338.48358154]
[92.83959198 352.80609131]
[84.20408630 364.94186401]
[83.12171936 379.90277100]
[82.03935242 394.86367798]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[5 173]
[6 172]
[7 171]
[9 169]
[10 168]
[11 167]
[12 166]
[14 164]
[15 163]
[16 162]
[18 161]
[19 160]
[20 159]
[21 158]
[22 157]
[24 154]
[25 153]
[26 71]
[27 70]
[28 69]
[29 68]
[30 67]
[31 66]
[33 44]
[34 43]
[35 42]
[48 65]
[49 64]
[50 63]
[51 62]
[52 61]
[72 101]
[73 100]
[74 99]
[75 98]
[76 97]
[77 96]
[79 94]
[80 93]
[81 92]
[110 132]
[111 131]
[112 130]
[113 129]
[114 128]
[115 126]
[116 125]
[117 124]
[118 123]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
