%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Thu Sep 10 09:39:51 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
UUAUCCAUUCCUUUUGGCCCUGCAGCAUGUCAUGCUCCCAGAAUUUCAGCUUCAGCUUAACUGACAGACGUUAAAGCUUUCUGGUUAGAUUGUUUUCACUUGGUGAUCAUGUCUUUUCCAUGUGUACCUGUAAUAUUUUUCCAUCAUAUCUCAAAGUAAAGUCAUUAACAUCAA\
) } def
/len { sequence length } bind def

/coor [
[152.81819153 374.07070923]
[137.76342773 374.74212646]
[122.95974731 371.92294312]
[109.20549011 365.76525879]
[97.24240875 356.60113525]
[87.71565247 344.92477417]
[81.13899231 331.36584473]
[77.86709595 316.65560913]
[78.07641602 301.58731079]
[81.75566864 286.97363281]
[88.70642090 273.60263062]
[98.55384827 262.19540405]
[110.76686859 253.36711121]
[124.68686676 247.59385681]
[139.56315613 245.18699646]
[140.63934326 230.22564697]
[141.71553040 215.26431274]
[142.79173279 200.30296326]
[132.87863159 189.24555969]
[133.75691223 174.05729675]
[145.42214966 163.73451233]
[146.49833679 148.77316284]
[147.57453918 133.81181335]
[134.98226929 125.66106415]
[121.77333832 132.76908875]
[108.56439972 139.87712097]
[95.35546875 146.98515320]
[82.14653778 154.09318542]
[71.06383514 166.92323303]
[55.66719818 159.82536316]
[58.22546768 143.06553650]
[75.03850555 140.88424683]
[88.24743652 133.77621460]
[101.45637512 126.66819000]
[114.66530609 119.56015778]
[127.87423706 112.45213318]
[89.38189697 126.69304657]
[74.58947754 91.09522247]
[62.37556839 82.38771820]
[50.16166687 73.68022156]
[37.94776154 64.97272491]
[25.73385811 56.26522064]
[13.51995277 47.55772400]
[9.10929012 47.29835892]
[5.39650393 45.78380585]
[2.69388914 43.39360428]
[1.15595353 40.57020950]
[0.77262604 37.76119614]
[-10.78507233 28.19983673]
[-22.34277153 18.63847733]
[-33.90047073 9.07711792]
[-45.45816803 -0.48424208]
[-61.02332306 -3.31911063]
[-65.89791870 -17.39347076]
[-77.45561218 -26.95483208]
[-89.01331329 -36.51618958]
[-102.63521576 -29.70710564]
[-117.84923553 -29.03371048]
[-132.01945496 -34.61267471]
[-142.69079590 -45.47740936]
[-148.01437378 -59.74553299]
[-147.06787109 -74.94500732]
[-140.01524353 -88.44242859]
[-128.07843018 -97.89929199]
[-113.32553864 -101.67713928]
[-98.31259918 -99.12142944]
[-85.64070129 -90.67495728]
[-77.50532532 -77.80112457]
[-75.31596375 -62.73040771]
[-79.45195007 -48.07389069]
[-67.89425659 -38.51253128]
[-56.33655548 -28.95116997]
[-41.59808350 -26.80019379]
[-35.89680862 -12.04194069]
[-24.33910942 -2.48058081]
[-12.78141117 7.08077908]
[-1.22371280 16.64213943]
[10.33398628 26.20349884]
[22.22745323 35.34381866]
[34.44135666 44.05131912]
[46.65526199 52.75881577]
[58.86916351 61.46631622]
[71.08306885 70.17381287]
[83.29697418 78.88131714]
[93.12799072 73.03538513]
[104.86280823 71.68717194]
[116.47730255 75.37617493]
[125.84268188 83.74624634]
[128.52104187 68.98730469]
[119.31584930 56.14051056]
[121.97325134 40.56123734]
[134.91664124 31.49238777]
[150.46694946 34.31435394]
[159.39845276 47.35290909]
[156.41223145 62.87251282]
[143.27998352 71.66565704]
[140.60162354 86.42459869]
[146.86093140 90.55632782]
[155.12457275 78.03785706]
[167.64291382 86.30169678]
[159.37951660 98.81977844]
[165.63882446 102.95150757]
[178.15742493 94.68805695]
[190.67602539 86.42459869]
[203.19462585 78.16114807]
[206.48425293 62.93563843]
[219.29760742 54.73365021]
[233.79252625 57.96364212]
[246.31112671 49.70018768]
[258.82971191 41.43673325]
[271.34832764 33.17327881]
[272.95806885 17.61876869]
[284.22534180 6.77522564]
[299.83010864 5.76264000]
[312.40426636 15.05912304]
[316.01068115 30.27515984]
[308.94650269 44.22620392]
[294.54724121 50.32499695]
[279.61178589 45.69187546]
[267.09317017 53.95532990]
[254.57458496 62.21878815]
[242.05598450 70.48223877]
[239.32917786 85.08019257]
[226.75125122 93.63883972]
[211.45806885 90.67974091]
[198.93946838 98.94319916]
[186.42088318 107.20664978]
[173.90228271 115.47010803]
[188.85009766 114.21997833]
[203.79791260 112.96984863]
[217.04917908 105.94106293]
[231.53479004 102.04657745]
[246.52418518 101.48281860]
[261.26141357 104.27822113]
[275.00320435 110.29179382]
[287.05651855 119.22025299]
[296.81347656 130.61331177]
[303.78201294 143.89637756]
[307.61062622 158.39953613]
[308.10629272 173.39134216]
[305.24395752 188.11570740]
[299.16802979 201.83004761]
[290.18490601 213.84268188]
[278.74761963 223.54777527]
[265.43304443 230.45587158]
[250.91264343 234.21858215]
[235.91873169 234.64611816]
[221.20751953 231.71691895]
[207.52093506 225.57873535]
[195.54922485 216.54112244]
[185.89619446 205.05989075]
[179.04866028 191.71405029]
[175.35195923 177.17671204]
[174.99269104 162.17955017]
[168.76428223 148.53378296]
[162.53587341 134.88801575]
[161.45968628 149.84934998]
[160.38349915 164.81069946]
[170.45121765 176.69677734]
[169.14666748 191.85437012]
[157.75306702 201.37915039]
[156.67687988 216.34049988]
[155.60069275 231.30184937]
[154.52449036 246.26318359]
[168.90315247 250.77439880]
[181.85356140 258.48046875]
[192.67732239 268.96585083]
[200.79072571 281.66503906]
[205.75624084 295.89318848]
[207.30606079 310.88299561]
[205.35661316 325.82611084]
[200.01304626 339.91662598]
[191.56350708 352.39468384]
[180.46366882 362.58737183]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[15 164]
[16 163]
[17 162]
[18 161]
[21 158]
[22 157]
[23 156]
[24 36]
[25 35]
[26 34]
[27 33]
[28 32]
[38 84]
[39 83]
[40 82]
[41 81]
[42 80]
[43 79]
[48 78]
[49 77]
[50 76]
[51 75]
[52 74]
[54 72]
[55 71]
[56 70]
[88 97]
[89 96]
[102 128]
[103 127]
[104 126]
[105 125]
[108 122]
[109 121]
[110 120]
[111 119]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
