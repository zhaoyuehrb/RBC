%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Fri Sep 11 09:35:10 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
ACAGCUUUUUGCAUGGGAUAGGAGCAUGUCUAUUCUAACACAUCAGCUUAUUCAAAAGCAAGAAUUUUAAAAAUAAGAUAAAUGUAAAGUUGUUUUAUAAACGAUCCUGUUAAUUAAACCACAGACACCAUAUAUCCUUCUGCAUCCUUUGGCCAAUAAAAGUUGCUGGAGAACCAA\
) } def
/len { sequence length } bind def

/coor [
[269.87606812 129.78814697]
[254.93443298 128.46615601]
[239.99279785 127.14417267]
[225.05117798 125.82218170]
[210.10954285 124.50019073]
[195.16790771 123.17820740]
[180.22627258 121.85621643]
[176.03431702 124.20127869]
[170.32034302 123.91687012]
[164.78381348 120.21477509]
[149.89814758 118.36630249]
[135.01248169 116.51782990]
[120.12680817 114.66934967]
[105.24114227 112.82087708]
[90.79893494 116.87336731]
[79.04792023 126.19611359]
[67.29690552 135.51885986]
[55.54589081 144.84161377]
[43.79487610 154.16436768]
[32.04385757 163.48710632]
[20.29284286 172.80986023]
[8.54182816 182.13259888]
[6.98193026 197.85972595]
[-5.29462337 207.81269836]
[-21.00437164 206.08662415]
[-30.82699776 193.70552063]
[-28.93491364 178.01489258]
[-16.45065880 168.32371521]
[-0.78092033 170.38159180]
[10.97009468 161.05883789]
[22.72111130 151.73609924]
[34.47212601 142.41334534]
[46.22314072 133.09059143]
[57.97415543 123.76785278]
[69.72517395 114.44509888]
[81.47618866 105.12235260]
[80.02924347 97.76325226]
[65.31104279 100.65714264]
[50.59284210 103.55103302]
[37.48925400 110.85144043]
[26.49693871 100.64511871]
[32.80693817 87.03688812]
[47.69895172 88.83283234]
[62.41715240 85.93894196]
[77.13535309 83.04505157]
[75.68840790 75.68595123]
[61.28252411 71.50617218]
[46.87664413 67.32639313]
[32.47076035 63.14660645]
[18.74660683 70.98390198]
[3.52258062 66.74072266]
[-4.16917419 52.93447495]
[0.23472437 37.75616074]
[14.12152195 30.21080589]
[29.25242615 34.77493286]
[36.65054321 48.74072647]
[51.05642319 52.92050934]
[65.46230316 57.10028839]
[79.86818695 61.28007126]
[84.21207428 55.16610336]
[71.98426819 46.47813416]
[80.67243195 34.25046539]
[92.89985657 42.93816376]
[97.24374390 36.82419205]
[88.55596924 24.59625435]
[79.86818695 12.36831474]
[71.18040466 0.14037573]
[62.49263000 -12.08756351]
[53.80485153 -24.31550217]
[38.67777252 -30.64824104]
[36.86722565 -46.94713593]
[50.23574448 -56.44528198]
[65.03094482 -49.37179947]
[66.03279114 -33.00328064]
[74.72056580 -20.77534294]
[83.40834808 -8.54740334]
[92.09612274 3.68053603]
[100.78390503 15.90847492]
[109.47168732 28.13641548]
[125.07932281 55.83981705]
[122.81776428 81.96512604]
[107.08961487 97.93520355]
[121.97528839 99.78368378]
[136.86096191 101.63215637]
[151.74662781 103.48063660]
[166.63229370 105.32910919]
[181.54826355 106.91458893]
[196.48989868 108.23657227]
[211.43153381 109.55856323]
[226.37315369 110.88054657]
[241.31478882 112.20253754]
[256.25640869 113.52452850]
[271.19805908 114.84651184]
[274.42379761 103.06591797]
[279.46957397 91.94716644]
[286.20730591 81.76933289]
[294.46646118 72.78764343]
[304.03836060 65.22709656]
[314.68145752 59.27679443]
[326.12750244 55.08522797]
[338.08816528 52.75658417]
[350.26239014 52.34813690]
[362.34399414 53.86884689]
[374.02932739 57.27916718]
[385.02484131 62.49208069]
[395.05462646 69.37530518]
[403.86715698 77.75466156]
[415.93984985 68.85243225]
[428.01257324 59.95019913]
[440.08526611 51.04796982]
[438.29232788 35.79408646]
[444.38125610 21.69371796]
[456.71420288 12.53978825]
[471.97360229 10.79466057]
[486.05484009 16.92776489]
[495.17004395 29.28932762]
[496.86734009 44.55414963]
[490.69012451 58.61606979]
[478.30004883 67.69250488]
[463.02999878 69.34193420]
[448.98751831 63.12067795]
[436.91479492 72.02291107]
[424.84207153 80.92514038]
[412.76937866 89.82736969]
[416.01251221 95.86879730]
[418.70291138 102.17581940]
[420.81906128 108.69799805]
[422.34399414 115.38315582]
[423.26553345 122.17782593]
[423.57632446 129.02764893]
[423.27389526 135.87785339]
[422.36059570 142.67364502]
[420.84381104 149.36065674]
[418.73562622 155.88540649]
[416.05291748 162.19570923]
[412.81713867 168.24107361]
[409.05416870 173.97315979]
[420.29531860 183.90475464]
[431.53646851 193.83633423]
[442.77761841 203.76792908]
[458.24252319 207.10668945]
[462.65756226 221.33190918]
[473.89871216 231.26348877]
[485.13986206 241.19508362]
[498.05773926 241.18325806]
[507.21899414 249.71194458]
[508.07223511 261.79730225]
[519.13635254 271.92575073]
[530.20050049 282.05416870]
[541.26464844 292.18258667]
[556.44116211 288.94970703]
[570.60583496 295.28555298]
[578.31195068 308.75384521]
[576.59637451 324.17581177]
[566.11877441 335.62133789]
[550.90802002 338.68939209]
[536.81298828 332.20028687]
[529.25341797 318.64913940]
[531.13616943 303.24673462]
[520.07208252 293.11828613]
[509.00793457 282.98986816]
[497.94381714 272.86141968]
[480.63998413 270.01647949]
[475.20828247 252.43623352]
[463.96713257 242.50463867]
[452.72598267 232.57305908]
[438.06512451 229.94467163]
[432.84603882 215.00907898]
[421.60488892 205.07749939]
[410.36373901 195.14590454]
[399.12255859 185.21432495]
[380.98892212 197.80265808]
[360.00830078 204.70841980]
[337.91659546 205.35234070]
[316.54388428 199.67355347]
[297.66290283 188.13529968]
[282.84179688 171.68714905]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[1 93]
[2 92]
[3 91]
[4 90]
[5 89]
[6 88]
[7 87]
[10 86]
[11 85]
[12 84]
[13 83]
[14 82]
[15 36]
[16 35]
[17 34]
[18 33]
[19 32]
[20 31]
[21 30]
[22 29]
[46 59]
[47 58]
[48 57]
[49 56]
[64 79]
[65 78]
[66 77]
[67 76]
[68 75]
[69 74]
[107 124]
[108 123]
[109 122]
[110 121]
[137 171]
[138 170]
[139 169]
[140 168]
[142 166]
[143 165]
[144 164]
[147 162]
[148 161]
[149 160]
[150 159]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
