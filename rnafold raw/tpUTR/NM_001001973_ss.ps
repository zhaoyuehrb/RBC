%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Thu Sep 10 23:32:00 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
UGAAAAUCAAGUUCCAUCCUCAGACAAGAGGUAAAGAAGGAAAAUUCAGCCAGUUGAUUUUGUUUUUAGCUUACUGCUGCCUUUGUCCGAAGAAACUGUUCCUCCAUUAUUUGAAUUACUGAAGACAGCAAGAUAUUUGUAAAUUAUCUUAAAAUAAACAACUUAAAAUAA\
) } def
/len { sequence length } bind def

/coor [
[97.53746033 296.75665283]
[83.39144897 291.30999756]
[71.96343994 281.35125732]
[64.63343811 268.08297729]
[62.28656769 253.10740662]
[65.20623016 238.23289490]
[73.03985596 225.25559998]
[84.84149933 215.74259949]
[99.18605804 210.84265137]
[99.46001434 195.84515381]
[99.73397827 180.84765625]
[100.00793457 165.85015869]
[100.28189850 150.85266113]
[93.15968323 148.76916504]
[86.64035034 145.72802734]
[80.84642792 141.85868835]
[75.87586212 137.30519104]
[71.80054474 132.22183228]
[60.09751511 141.60475159]
[48.39448547 150.98767090]
[36.69145584 160.37059021]
[35.21226883 176.10549927]
[22.98694229 186.12133789]
[7.26854610 184.47587585]
[-2.61747479 172.14533997]
[-0.80591851 156.44520569]
[11.62845039 146.69010925]
[27.30854225 148.66755676]
[39.01156998 139.28463745]
[50.71459961 129.90171814]
[62.41762924 120.51880646]
[57.30541611 111.75572968]
[54.28434753 101.72110748]
[53.66782379 90.92468262]
[55.64279938 79.95232391]
[60.25162506 69.43424225]
[67.38198090 60.00896835]
[76.76580811 52.28524017]
[87.98761749 46.80387497]
[77.00071716 36.59172440]
[66.01381683 26.37957382]
[54.93411636 16.26818466]
[43.76253510 6.25840330]
[32.59095001 -3.75137877]
[17.02916908 -3.06676245]
[5.84218884 -13.37724876]
[5.28541374 -28.21724892]
[-5.88616896 -38.22703171]
[-17.05775261 -48.23681259]
[-28.22933388 -58.24659348]
[-49.41534805 -61.30284119]
[-55.13464737 -81.11298370]
[-66.83767700 -90.49590302]
[-78.54071045 -99.87881470]
[-90.24373627 -109.26173401]
[-101.94676208 -118.64464569]
[-113.64979553 -128.02755737]
[-128.58235168 -123.80873871]
[-143.13113403 -129.20436096]
[-151.70182800 -142.13967896]
[-150.99884033 -157.64082336]
[-141.29248047 -169.74728394]
[-126.31504059 -173.80386353]
[-111.82565308 -168.25073242]
[-103.39577484 -155.22319031]
[-104.26687622 -139.73059082]
[-92.56385040 -130.34767151]
[-80.86082458 -120.96475983]
[-69.15779114 -111.58184814]
[-57.45476151 -102.19892883]
[-45.75173187 -92.81601715]
[-37.13933563 -95.22481537]
[-28.25388527 -93.35112762]
[-21.13431358 -87.49468994]
[-17.47412300 -78.88355255]
[-18.21955299 -69.41817474]
[-7.04796982 -59.40839386]
[4.12361288 -49.39861298]
[15.29519558 -39.38883209]
[30.10706520 -40.45846558]
[41.57923126 -30.46626472]
[42.60073471 -14.92296124]
[53.77231598 -4.91317940]
[64.94390106 5.09660292]
[72.05014801 7.22617531]
[76.22596741 15.39267349]
[87.21286774 25.60482407]
[98.19976807 35.81697464]
[112.84091187 32.55552292]
[118.45436096 18.64548492]
[116.44372559 2.95255971]
[128.38172913 -5.95436382]
[133.99519348 -19.86440086]
[139.60864258 -33.77443695]
[136.78518677 -49.92869949]
[149.53535461 -60.24204254]
[164.74287415 -54.10498810]
[166.76354980 -37.83080673]
[153.51867676 -28.16098595]
[147.90522766 -14.25094795]
[142.29177856 -0.34091052]
[144.70391846 14.35707664]
[132.36439514 24.25893974]
[126.75094604 38.16897583]
[131.54849243 43.93383026]
[143.07820129 34.33873367]
[154.60791016 24.74363899]
[166.13761902 15.14854431]
[177.66732788 5.55344868]
[189.19703674 -4.04164648]
[200.72689819 -13.63655090]
[210.32160950 -2.10652518]
[198.79212952 7.48806047]
[187.26242065 17.08315659]
[175.73271179 26.67825127]
[164.20300293 36.27334595]
[152.67329407 45.86844254]
[141.14358521 55.46353531]
[145.94113159 61.22838974]
[160.63940430 58.23488998]
[175.33766174 55.24138641]
[187.25239563 43.97323227]
[202.88883972 48.91627884]
[206.16156006 64.98554230]
[193.70387268 75.65034485]
[178.33116150 69.93965149]
[163.63290405 72.93315125]
[148.93464661 75.92665100]
[152.68794250 99.16888428]
[146.31602478 120.99758148]
[160.12121582 126.86415100]
[173.92640686 132.73072815]
[187.73159790 138.59729004]
[201.53680420 144.46386719]
[215.34199524 150.33042908]
[228.03601074 141.56315613]
[243.45559692 141.07339478]
[256.68041992 149.01744080]
[263.49047852 162.86036682]
[261.71270752 178.18495178]
[251.91438293 190.10118103]
[237.22212219 194.80662537]
[222.32417297 190.79978943]
[211.97441101 179.35925293]
[209.47541809 164.13563538]
[195.67022705 158.26905823]
[181.86503601 152.40248108]
[168.05984497 146.53591919]
[154.25465393 140.66934204]
[140.44946289 134.80278015]
[134.15693665 138.88374329]
[143.45954895 150.65069580]
[152.76216125 162.41766357]
[162.74714661 173.61141968]
[156.61912537 187.30256653]
[141.61912537 187.31330872]
[135.47143555 173.63143921]
[128.52166748 160.33854675]
[121.57191467 147.04565430]
[115.27939606 151.12661743]
[115.00543213 166.12411499]
[114.73147583 181.12161255]
[114.45751190 196.11912537]
[114.18355560 211.11662292]
[128.33958435 216.53718567]
[139.78591919 226.47485352]
[147.14036560 239.72958374]
[149.51483154 254.70082092]
[146.62258911 269.58068848]
[138.81288147 282.57238770]
[127.02879333 292.10711670]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[9 164]
[10 163]
[11 162]
[12 161]
[13 160]
[18 31]
[19 30]
[20 29]
[21 28]
[39 88]
[40 87]
[41 86]
[42 84]
[43 83]
[44 82]
[47 79]
[48 78]
[49 77]
[50 76]
[52 71]
[53 70]
[54 69]
[55 68]
[56 67]
[57 66]
[89 104]
[90 103]
[92 101]
[93 100]
[94 99]
[119 128]
[120 127]
[121 126]
[130 150]
[131 149]
[132 148]
[133 147]
[134 146]
[135 145]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
