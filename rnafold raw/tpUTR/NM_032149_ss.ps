%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Fri Sep 11 12:56:55 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AAGUUCUAGACUGGGUGAAUUCUUUCAUGAAUAUGAGCUUCACAUUUACAUCAUCAAAUUAUUUUUCAAAUGAAUAUUUUUGGUAUUGAGGAAUCAAGUGGUCCUCUUUAUGGUGGCACAUGUAAAUCUAAAAAUACCUGUAUGUAAUGCUACAAAUAAAUAUUACUGGAAAUGAUAUUUCCAUUUGUAGUUAA\
) } def
/len { sequence length } bind def

/coor [
[88.77214050 126.67489624]
[79.56899261 138.51980591]
[70.36583710 150.36473083]
[61.16268921 162.20964050]
[51.95953751 174.05455017]
[42.75638962 185.89947510]
[50.05521393 197.20272827]
[53.50647354 210.18397522]
[52.78730011 223.57406616]
[47.98185349 236.06840515]
[39.57171249 246.45401001]
[28.38769341 253.72726440]
[15.52775383 257.19088745]
[2.24923229 256.52084351]
[-10.15409470 251.79643250]
[-19.73406219 263.33871460]
[-29.31402969 274.88098145]
[-38.89399719 286.42327881]
[-48.47396469 297.96554565]
[-50.70001221 314.21292114]
[-65.98382568 320.15740967]
[-78.60272980 309.68386841]
[-75.57547760 293.56652832]
[-60.01624680 288.38558960]
[-50.43627930 276.84329224]
[-40.85630798 265.30102539]
[-31.27634239 253.75874329]
[-21.69637489 242.21646118]
[-29.80667686 227.68721008]
[-31.72421074 211.12147522]
[-27.12730217 195.05303955]
[-16.69284630 181.95043945]
[-1.99678695 173.83787537]
[14.72385120 171.98245239]
[30.91147232 176.69631958]
[40.11462402 164.85140991]
[49.31777573 153.00648499]
[58.52092361 141.16157532]
[67.72407532 129.31666565]
[76.92722321 117.47174072]
[72.59539795 109.30603790]
[71.05905914 100.19104767]
[72.47492981 91.05656433]
[76.69857788 82.83438110]
[83.29916382 76.36323547]
[91.60336304 72.30322266]
[91.12012482 57.31101227]
[90.63688660 42.31879807]
[90.15364838 27.32658386]
[89.67041016 12.33437061]
[89.18717194 -2.65784383]
[88.58318329 -17.64567947]
[87.85848236 -32.62816238]
[73.47700500 -28.01413536]
[61.18522263 -35.12919235]
[58.40821838 -48.13794708]
[46.20233536 -56.85668564]
[33.99645233 -65.57542419]
[18.26959991 -67.30072784]
[12.41039371 -80.99448395]
[0.20451079 -89.71322632]
[-12.00137234 -98.43196106]
[-24.20725441 -107.15070343]
[-36.41313934 -115.86944580]
[-51.50905609 -111.78932953]
[-65.67401886 -118.41411591]
[-72.21977234 -132.61578369]
[-68.05560303 -147.68872070]
[-55.14770889 -156.51597595]
[-39.59080124 -154.92956543]
[-28.73037910 -143.67855835]
[-27.69439697 -128.07533264]
[-15.48851490 -119.35659027]
[-3.28263211 -110.63784790]
[8.92325020 -101.91910553]
[21.12913322 -93.20037079]
[35.98294067 -92.09868622]
[42.71519089 -77.78131104]
[54.92107391 -69.06256866]
[67.12696075 -60.34383011]
[80.08313751 -62.62684631]
[91.68565369 -53.99743271]
[97.56515503 -67.79711914]
[103.44464874 -81.59681702]
[109.32415009 -95.39650726]
[115.20365143 -109.19619751]
[121.08315277 -122.99588776]
[114.25474548 -139.09461975]
[121.04233551 -154.84362793]
[136.80140686 -160.69924927]
[142.45782471 -174.59187317]
[148.11424255 -188.48449707]
[137.96223450 -199.82899475]
[133.75961304 -214.39694214]
[136.28851318 -229.28401184]
[144.99452209 -241.54641724]
[158.10716248 -248.78298950]
[172.99975586 -249.60527039]
[178.65618896 -263.49789429]
[184.31260681 -277.39050293]
[178.42059326 -291.80999756]
[184.35491943 -305.81851196]
[198.13801575 -311.34680176]
[203.79443359 -325.23941040]
[201.83232117 -340.93847656]
[213.79779053 -349.80844116]
[219.45422363 -363.70108032]
[216.68070984 -379.86398315]
[229.46270752 -390.13787842]
[244.65118408 -383.95382690]
[246.62153625 -367.67349243]
[233.34683228 -358.04464722]
[227.69041443 -344.15203857]
[230.05711365 -329.44665527]
[217.68705750 -319.58297729]
[212.03062439 -305.69036865]
[218.03224182 -292.10668945]
[212.49372864 -277.93701172]
[198.20523071 -271.73406982]
[192.54879761 -257.84146118]
[186.89237976 -243.94883728]
[196.97512817 -232.95777893]
[201.30371094 -218.61996460]
[198.96829224 -203.76374817]
[190.37916565 -191.34411621]
[177.19590759 -183.85488892]
[162.00686646 -182.82806396]
[156.35044861 -168.93545532]
[150.69403076 -155.04283142]
[157.31140137 -143.97758484]
[156.32852173 -130.92687988]
[147.88098145 -120.67702484]
[134.88284302 -117.11639404]
[129.00334167 -103.31669617]
[123.12384033 -89.51700592]
[117.24434662 -75.71731567]
[111.36484528 -61.91762543]
[105.48534393 -48.11793137]
[102.84096527 -33.35286331]
[103.56566620 -18.37038040]
[107.03363800 -11.83250523]
[104.17938995 -3.14108205]
[104.66262817 11.85113144]
[105.14586639 26.84334564]
[105.62910461 41.83555984]
[106.11234283 56.82777405]
[106.59558105 71.81998444]
[126.43944550 88.22840118]
[125.35513306 113.95463562]
[136.17317200 124.34550476]
[146.99121094 134.73637390]
[157.80924988 145.12722778]
[168.62727356 155.51809692]
[179.44531250 165.90896606]
[190.26335144 176.29983521]
[201.08139038 186.69068909]
[211.89942932 197.08155823]
[222.88345337 207.29679871]
[234.03062439 217.33375549]
[245.17779541 227.37071228]
[256.32498169 237.40766907]
[267.47213745 247.44464111]
[278.61932373 257.48159790]
[289.76647949 267.51855469]
[300.91366577 277.55551147]
[316.37283325 275.20016479]
[329.70230103 283.37692261]
[334.60827637 298.22500610]
[328.77429199 312.73358154]
[314.95501709 320.05215454]
[299.67547607 316.72509766]
[290.15017700 304.32339478]
[290.87670898 288.70269775]
[279.72952271 278.66571045]
[268.58236694 268.62875366]
[257.43518066 258.59179688]
[246.28800964 248.55485535]
[235.14083862 238.51788330]
[223.99366760 228.48092651]
[212.84649658 218.44396973]
[208.10246277 217.79656982]
[203.71878052 214.15354919]
[201.50856018 207.89959717]
[190.69052124 197.50872803]
[179.87248230 187.11785889]
[169.05445862 176.72700500]
[158.23641968 166.33613586]
[147.41838074 155.94526672]
[136.60034180 145.55439758]
[125.78230286 135.16354370]
[114.96427155 124.77267456]
[110.06091309 127.13655853]
[104.80165100 128.54048157]
[99.37252808 128.93476868]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[1 40]
[2 39]
[3 38]
[4 37]
[5 36]
[6 35]
[15 28]
[16 27]
[17 26]
[18 25]
[19 24]
[46 147]
[47 146]
[48 145]
[49 144]
[50 143]
[51 142]
[52 140]
[53 139]
[56 80]
[57 79]
[58 78]
[60 76]
[61 75]
[62 74]
[63 73]
[64 72]
[82 138]
[83 137]
[84 136]
[85 135]
[86 134]
[87 133]
[90 129]
[91 128]
[92 127]
[98 121]
[99 120]
[100 119]
[103 116]
[104 115]
[106 113]
[107 112]
[149 191]
[150 190]
[151 189]
[152 188]
[153 187]
[154 186]
[155 185]
[156 184]
[157 183]
[158 180]
[159 179]
[160 178]
[161 177]
[162 176]
[163 175]
[164 174]
[165 173]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
