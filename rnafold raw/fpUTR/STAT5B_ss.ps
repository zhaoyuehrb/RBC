%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Sun Sep 13 19:45:29 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
GGCGGGAGGAGAGUCGGCGGCCGGAGCCGUCACCCCGGGCGGGGACCCAGCGCAGGCAACUCCGCGCGGCGGCCCGGCCGAGGGAGGGAGCGAGCGGGCGGGCGGGCAAGCCAGACAGCUGGGCCGGAGCAGCCGCGGGCGCCCGAGGGGCCGAGCGAGAUUGUAAACC\
) } def
/len { sequence length } bind def

/coor [
[106.45285034 144.13034058]
[101.81759644 129.86448669]
[97.18233490 115.59864044]
[89.68746185 115.32150269]
[74.69770813 114.76723480]
[67.20282745 114.49009705]
[61.52666092 128.37466431]
[67.87243652 142.84901428]
[62.04691696 157.54046631]
[47.50628662 163.73284912]
[32.87724304 157.75233459]
[26.83893585 143.14704895]
[32.97378540 128.58204651]
[47.64209747 122.69849396]
[53.31826019 108.81392670]
[41.18300629 99.99714661]
[29.73203278 109.68607330]
[18.28105927 119.37499237]
[6.83008432 129.06391907]
[-4.62089014 138.75283813]
[-16.07186508 148.44175720]
[-21.10514259 164.04939270]
[-37.19304276 167.22924805]
[-47.78571320 154.71015930]
[-41.98632050 139.37069702]
[-25.76078606 136.99078369]
[-14.30981064 127.30185699]
[-2.85883665 117.61293793]
[8.59213734 107.92401886]
[20.04311180 98.23509979]
[31.49408531 88.54617310]
[68.47032166 77.26763916]
[96.12275696 92.68019867]
[99.42195129 78.04751587]
[102.72114563 63.41483688]
[105.88499451 48.75229645]
[108.91323090 34.06114960]
[111.94146729 19.37000465]
[114.96970367 4.67885733]
[117.99794006 -10.01228905]
[121.02617645 -24.70343590]
[119.47515106 -28.85465813]
[119.36192322 -32.87410736]
[120.46363068 -36.31943130]
[122.43495941 -38.86851501]
[124.85897064 -40.34936142]
[128.96391296 -54.77674484]
[133.06886292 -69.20413208]
[132.40861511 -78.35494232]
[137.38525391 -83.85887146]
[141.75610352 -98.20793915]
[140.55314636 -103.36800385]
[141.39135742 -107.99969482]
[143.71914673 -111.40709686]
[146.78721619 -113.21873474]
[151.94644165 -127.30355835]
[157.10568237 -141.38838196]
[150.70504761 -155.58943176]
[156.13787842 -169.79994202]
[169.71585083 -175.81445312]
[174.87509155 -189.89927673]
[180.03431702 -203.98411560]
[185.19355774 -218.06893921]
[190.35279846 -232.15376282]
[190.37016296 -241.32833862]
[195.73968506 -246.44970703]
[201.15830994 -260.43679810]
[180.41589355 -298.61383057]
[173.98492432 -313.06906128]
[182.86354065 -325.02813721]
[176.43257141 -339.48333740]
[185.31118774 -351.44241333]
[186.69520569 -366.37841797]
[188.07923889 -381.31442261]
[189.46325684 -396.25045776]
[190.84729004 -411.18646240]
[184.41630554 -425.64166260]
[193.29493713 -437.60073853]
[194.67895508 -452.53674316]
[196.06298828 -467.47277832]
[184.57608032 -477.73712158]
[181.37318420 -492.62319946]
[187.47767639 -506.37817383]
[200.35694885 -513.81201172]
[190.06887817 -525.80914307]
[191.36065674 -541.56054688]
[203.46588135 -551.72125244]
[219.20275879 -550.26300049]
[229.23486328 -538.05102539]
[227.61032104 -522.33044434]
[215.29295349 -512.42797852]
[226.58695984 -502.75415039]
[230.06005859 -488.11169434]
[224.17637634 -474.06762695]
[210.99899292 -466.08874512]
[209.61497498 -451.15274048]
[208.23094177 -436.21670532]
[214.76091003 -422.82983398]
[205.78329468 -409.80242920]
[204.39927673 -394.86642456]
[203.01524353 -379.93041992]
[201.63122559 -364.99438477]
[200.24719238 -350.05838013]
[206.77716064 -336.67147827]
[197.79956055 -323.64410400]
[204.32952881 -310.25720215]
[195.35191345 -297.22982788]
[201.41954041 -292.82141113]
[215.12271118 -298.92251587]
[213.55479431 -284.00463867]
[219.62242126 -279.59625244]
[233.39971924 -285.52801514]
[247.17703247 -291.45977783]
[260.95434570 -297.39157104]
[270.31710815 -310.85525513]
[286.63342285 -309.20925903]
[293.11849976 -294.14685059]
[283.10101318 -281.16293335]
[266.88610840 -283.61425781]
[253.10879517 -277.68249512]
[239.33149719 -271.75073242]
[225.55418396 -265.81893921]
[215.14540100 -255.01815796]
[209.72677612 -241.03108215]
[204.43762207 -226.99452209]
[199.27838135 -212.90969849]
[194.11915588 -198.82487488]
[188.95991516 -184.74005127]
[183.80067444 -170.65522766]
[190.28114319 -157.29336548]
[185.24958801 -142.93585205]
[171.19050598 -136.22915649]
[166.03126526 -122.14432526]
[160.87203979 -108.05950165]
[156.10516357 -93.83708954]
[151.73431396 -79.48802185]
[147.49624634 -65.09918213]
[143.39129639 -50.67179871]
[139.28634644 -36.24441528]
[135.71733093 -21.67519951]
[132.68908691 -6.98405313]
[129.66085815 7.70709372]
[126.63261414 22.39823914]
[123.60437775 37.08938599]
[120.57614136 51.78053284]
[122.31234741 58.99480820]
[117.35382843 66.71403503]
[114.05462646 81.34671021]
[110.75543213 95.97939301]
[111.44818878 110.96338654]
[116.08344269 125.22923279]
[120.71869659 139.49508667]
[135.84664917 139.47683716]
[150.23919678 144.13619995]
[162.48631287 153.01670837]
[171.38813782 165.24833679]
[176.07257080 179.63273621]
[176.08068848 194.76069641]
[171.41166687 209.15013123]
[162.52296448 221.39128113]
[150.28536987 230.28491211]
[135.89782715 234.95971680]
[120.76986694 234.95768738]
[106.38357544 230.27903748]
[94.14837646 221.38212585]
[85.26294708 209.13858032]
[80.59779358 194.74790955]
[80.60995483 179.61994934]
[85.29824829 165.23680115]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[1 152]
[2 151]
[3 150]
[6 15]
[7 14]
[16 31]
[17 30]
[18 29]
[19 28]
[20 27]
[21 26]
[33 149]
[34 148]
[35 147]
[36 145]
[37 144]
[38 143]
[39 142]
[40 141]
[41 140]
[46 139]
[47 138]
[48 137]
[50 136]
[51 135]
[55 134]
[56 133]
[57 132]
[60 129]
[61 128]
[62 127]
[63 126]
[64 125]
[66 124]
[67 123]
[68 107]
[70 105]
[72 103]
[73 102]
[74 101]
[75 100]
[76 99]
[78 97]
[79 96]
[80 95]
[84 91]
[111 122]
[112 121]
[113 120]
[114 119]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
