%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Sun Sep 13 19:41:18 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AGGUCUAGGGUUGCACCGCGCUGACUUCACACUCAGCAGCAUGUGCAGCUGAGGCCUCCGGGCAGUCGUCUCCUGCGAGGCGGGCAGCGAGGUCAGCUUGGCAGCCGCUGCCUCUCCAGCCUGGAUCUGGCCGCAGGCAGCGGUUCCCUAGGACCCGAGAAAAGG\
) } def
/len { sequence length } bind def

/coor [
[115.30361176 256.27359009]
[127.76350403 247.45805359]
[125.22093201 232.67510986]
[122.67835236 217.89218140]
[120.13578033 203.10923767]
[117.45343781 188.35101318]
[114.63156128 173.61883545]
[111.80969238 158.88665771]
[108.98781586 144.15447998]
[106.16594696 129.42230225]
[95.89538574 128.64527893]
[86.87990570 124.52542114]
[80.12281036 117.81259918]
[76.27363586 109.52546692]
[75.56974030 100.80342865]
[77.83496857 92.75239563]
[65.83458710 83.75290680]
[53.83420563 74.75341034]
[38.15159988 72.66381073]
[32.61157608 58.83784485]
[20.61119461 49.83835220]
[8.61081314 40.83886337]
[-3.38956809 31.83937073]
[-15.38994980 22.83987999]
[-27.39033127 13.84038830]
[-39.39071274 4.84089613]
[-51.39109421 -4.15859509]
[-63.39147568 -13.15808678]
[-79.07408142 -15.24768543]
[-84.61410522 -29.07365417]
[-110.63895416 -22.81587982]
[-131.81036377 -43.90921402]
[-146.79962158 -44.47683716]
[-161.78887939 -45.04445648]
[-176.77813721 -45.61207962]
[-191.76739502 -46.17970276]
[-206.75665283 -46.74732590]
[-220.83973694 -39.53778458]
[-233.26509094 -47.75116348]
[-248.25434875 -48.31878281]
[-262.49603271 -40.18818283]
[-276.51983643 -48.68908310]
[-275.89926147 -65.07648468]
[-261.27270508 -72.49243164]
[-247.68673706 -63.30804062]
[-232.69747925 -62.74041748]
[-219.68652344 -69.99055481]
[-206.18902588 -61.73657990]
[-191.19976807 -61.16896057]
[-176.21051025 -60.60133743]
[-161.22126770 -60.03371429]
[-146.23200989 -59.46609116]
[-131.24275208 -58.89847183]
[-123.90724182 -71.98244476]
[-132.21125793 -84.47416687]
[-140.51528931 -96.96588898]
[-148.81932068 -109.45761108]
[-157.12333679 -121.94933319]
[-165.54519653 -134.36192322]
[-174.08413696 -146.69425964]
[-182.62306213 -159.02659607]
[-191.16200256 -171.35894775]
[-198.65425110 -176.66281128]
[-199.74324036 -184.00643921]
[-208.04725647 -196.49816895]
[-222.97047424 -203.29740906]
[-224.27421570 -219.64465332]
[-210.61730957 -228.72325134]
[-196.04881287 -221.19390869]
[-195.55554199 -204.80218506]
[-187.25151062 -192.31047058]
[-178.82965088 -179.89787292]
[-170.29072571 -167.56553650]
[-161.75178528 -155.23320007]
[-153.21286011 -142.90086365]
[-146.79144287 -139.17524719]
[-144.63162231 -130.25335693]
[-136.32759094 -117.76163483]
[-128.02355957 -105.26991272]
[-119.71954346 -92.77819061]
[-111.41551208 -80.28646851]
[-99.36248779 -81.28813171]
[-88.19863892 -77.82928467]
[-79.45602417 -70.70101166]
[-74.21503448 -61.17407227]
[-72.97418976 -50.78129959]
[-75.61461639 -41.07403564]
[-60.79035568 -39.62813950]
[-54.39198303 -25.15846825]
[-42.39160156 -16.15897560]
[-30.39122009 -7.15948486]
[-18.39083862 1.84000647]
[-6.39045811 10.83949757]
[5.60992336 19.83898926]
[17.61030388 28.83848190]
[29.61068535 37.83797073]
[41.61106873 46.83746338]
[56.43532562 48.28335953]
[62.83369827 62.75303268]
[74.83407593 71.75252533]
[86.83445740 80.75201416]
[112.43505096 76.38303375]
[130.06141663 99.95188904]
[145.05873108 99.66802979]
[160.05604553 99.38417053]
[175.05335999 99.10030365]
[190.05067444 98.81644440]
[205.04798889 98.53257751]
[220.04530334 98.24871826]
[235.04261780 97.96485901]
[250.03993225 97.68099213]
[265.03723145 97.39713287]
[280.03454590 97.11327362]
[287.15292358 88.81578064]
[297.45800781 85.89002991]
[307.45489502 89.07577515]
[313.89102173 97.08157349]
[327.83514404 89.60681152]
[340.41369629 97.58358002]
[355.41101074 97.86743927]
[370.40832520 98.15130615]
[380.54782104 86.24646759]
[395.97589111 83.69535828]
[409.40792847 91.70252228]
[414.50170898 106.48722076]
[408.85208130 121.06858063]
[395.12667847 128.56172180]
[379.80618286 125.42861938]
[370.12448120 113.14862061]
[355.12716675 112.86475372]
[340.12985229 112.58089447]
[327.25842285 120.07595825]
[313.60714722 112.07888794]
[297.45800781 122.66667938]
[280.31842041 112.11058807]
[265.32110596 112.39444733]
[250.32379150 112.67830658]
[235.32647705 112.96217346]
[220.32916260 113.24603271]
[205.33184814 113.52989197]
[190.33453369 113.81375885]
[175.33721924 114.09761810]
[160.33990479 114.38147736]
[145.34259033 114.66534424]
[130.34527588 114.94920349]
[120.89812469 126.60043335]
[123.71999359 141.33261108]
[126.54187012 156.06478882]
[129.36373901 170.79696655]
[132.18560791 185.52914429]
[136.89274597 193.40998840]
[134.91871643 200.56666565]
[137.46128845 215.34960938]
[140.00387573 230.13253784]
[142.54644775 244.91548157]
[157.23565674 249.06155396]
[168.66557312 259.17687988]
[174.56678772 273.25302124]
[173.76760864 288.49520874]
[166.42669678 301.87707520]
[154.00161743 310.74160767]
[138.95936584 313.32876587]
[124.28659821 309.12490845]
[112.89659882 298.96466064]
[107.05086517 284.86535645]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[2 155]
[3 154]
[4 153]
[5 152]
[6 150]
[7 149]
[8 148]
[9 147]
[10 146]
[16 101]
[17 100]
[18 99]
[20 97]
[21 96]
[22 95]
[23 94]
[24 93]
[25 92]
[26 91]
[27 90]
[28 89]
[30 87]
[32 53]
[33 52]
[34 51]
[35 50]
[36 49]
[37 48]
[39 46]
[40 45]
[54 81]
[55 80]
[56 79]
[57 78]
[58 77]
[59 75]
[60 74]
[61 73]
[62 72]
[64 71]
[65 70]
[103 145]
[104 144]
[105 143]
[106 142]
[107 141]
[108 140]
[109 139]
[110 138]
[111 137]
[112 136]
[113 135]
[117 133]
[119 131]
[120 130]
[121 129]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
