fileName = paste(motif_folder,"/",name,".txt",sep="")
file = system.file(fileName, package = "DiffLogo")
motifs_dna2[[name]] = getPwmFromAlignmentFile(file)
}
for (name in motif_names_dna2) {
fileName = paste(motif_folder,"/",name,".txt",sep="")
file = system.file(fileName, package = "DiffLogo")
motifs_dna2[[name]] = getPwmFromAlignmentFile(file)
}
> ## plot custom sequence logo
par(mfrow=c(2,1), pin=c(3, 1), mar = c(2, 4, 1, 1))
DiffLogo::seqLogo(pwm = pwm1)
DiffLogo::seqLogo(pwm = pwm2, stackHeight = sumProbabilities)
par(mfrow=c(1,1), pin=c(1, 1), mar=c(5.1, 4.1, 4.1, 2.1))
> ## plot DiffLogo
diffLogoFromPwm(pwm1 = pwm1, pwm2 = pwm2)
> ## diffLogoFromPwm is a convenience function for
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
diffLogo(diffLogoObj)
> ## mark symbol stacks with significant changes
diffLogoObj = enrichDiffLogoObjectWithPvalues(diffLogoObj, n1, n2)
diffLogo(diffLogoObj)
> ## plot DiffLogo for PWMs of different length
diffLogoFromPwm(pwm1 = pwm_long, pwm2 = pwm_short, align_pwms=TRUE)
DiffLogo::seqLogo(pwm = pwm1)
DiffLogo::seqLogo(pwm = pwm2, stackHeight = sumProbabilities)
pwm2 = list$"Hsapiens-jolma2013-CTCF"
> ## plot DiffLogo
diffLogoFromPwm(pwm1 = pwm1, pwm2 = pwm2)
> ## diffLogoFromPwm is a convenience function for
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
diffLogo(diffLogoObj)
> ## mark symbol stacks with significant changes
diffLogoObj = enrichDiffLogoObjectWithPvalues(diffLogoObj, n1, n2)
View(pwm1)
View(pwm2)
> ## plot DiffLogo
diffLogoFromPwm(pwm1 = pwm1, pwm2 = pwm2)
> ## plot DiffLogo
diffLogoFromPwm(pwm1 = pwm1, pwm2 = pwm2)
> ## plot DiffLogo
diffLogoFromPwm(pwm1 = pwm1, pwm2 = pwm2)
## plot DiffLogo
diffLogoFromPwm(pwm1 = pwm1, pwm2 = pwm2)
View(diffLogoObj)
View(diffLogoObj)
diffLogo(diffLogoObj)
diffLogo(diffLogoObj)
## mark symbol stacks with significant changes
diffLogoObj = enrichDiffLogoObjectWithPvalues(diffLogoObj, n1, n2)
diffLogo(diffLogoObj)
## diffLogoFromPwm is a convenience function for
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
diffLogo(diffLogoObj)
View(diffLogoObj)
library(DiffLogo)
library(seqLogo)
library(MotifDb)
pw1 = read.csv('deseq_wo_replace/pwms/ER_L24_t1/ER_L24_t1_enriched.csv',row.names=1)
setwd('Documents/HGLab_new/RBC/MOTIF/SeqLogo/')
pw1 = read.csv('deseq_wo_replace/pwms/ER_L24_t1/ER_L24_t1_enriched.csv',row.names=1)
pw2 = read.csv('deseq_wo_replace/pwms/ER_L24_t1/ER_L24_t1_depleted.csv',row.names=1)
diffLogoObj = createDiffLogoObject(pwm1 = pw1, pwm2 = pw2)
diffLogo(diffLogoObj)
fileName = "test.png"
png(filename = fileName)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
widthToHeightRatio = 16/10
size = length(pw1) * 2
resolution = 100
width = size * widthToHeightRatio
height = size
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
resolution = 300
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
resolution = 30
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
resolution = 3
width = size * widthToHeightRatio
height = size
fileName = "test.png"
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 10
resolution = 100
width = size * widthToHeightRatio
height = size
fileName = "test.png"
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 20
resolution = 100
width = size * widthToHeightRatio
height = size
fileName = "test.png"
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 5
resolution = 100
width = size * widthToHeightRatio
height = size
fileName = "test.png"
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 5
resolution = 40
width = size * widthToHeightRatio
height = size
fileName = "test.png"
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 4
resolution = 200
width = size * widthToHeightRatio
height = size
fileName = "test.png"
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
pw1 = read.csv(paste(dir,batch,'/',batch,'_enriched.csv'),row.names=1)
dir <- 'deseq_wo_replace/pwms/'
batch <- 'ER_L24_t1'
pw1 = read.csv(paste(dir,batch,'/',batch,'_enriched.csv'),row.names=1)
pw1 = read.csv(paste(dir,batch,'/',batch,'_enriched.csv',''),row.names=1)
pw1 = read.csv(paste(dir,batch,'/',batch,'_enriched.csv',sep=''),row.names=1)
pw_de = read.csv(paste(dir,batch,'/',batch,'_depleted.csv',sep=''),row.names=1)
pw_bg = read.csv(paste(dir,batch,'/',batch,'bg.csv',sep=''),row.names=1)
pw_bg = read.csv(paste(dir,batch,'/bg.csv',sep=''),row.names=1)
createPlot <- function(pwm1,pwm2,compare) {
diffLogoObj = createDiffLogoObject(pwm1 = pw1, pwm2 = pw2)
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 4
resolution = 200
width = size * widthToHeightRatio
height = size
fileName = "test.png"
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
}
createPlot <- function(pwm1,pwm2,compare) {
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 4
resolution = 200
width = size * widthToHeightRatio
height = size
fileName = paste(dir,batch,'/',compare,'.png',sep='')
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
}
createPlot(pwm1 = pwm_en,pwm2 = pwm_de,compare = 'enrich vs deplete')
pwm_en = read.csv(paste(dir,batch,'/',batch,'_enriched.csv',sep=''),row.names=1)
pwm_de = read.csv(paste(dir,batch,'/',batch,'_depleted.csv',sep=''),row.names=1)
pwm_bg = read.csv(paste(dir,batch,'/bg.csv',sep=''),row.names=1)
pwm_left = read.csv(paste(dir,batch,'/',batch,'_leftstd_comb50',sep=''),row.names=1)
pwm_mid = read.csv(paste(dir,batch,'/',batch,'_median_comb50',sep=''),row.names=1)
pwm_left = read.csv(paste(dir,batch,'/',batch,'_leftstd_comb50.csv',sep=''),row.names=1)
pwm_mid = read.csv(paste(dir,batch,'/',batch,'_median_comb50.csv',sep=''),row.names=1)
pwm_right = read.csv(paste(dir,batch,'/',batch,'_rightstd_comb50.csv',sep=''),row.names=1)
createPlot <- function(pwm1,pwm2,compare) {
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 4
resolution = 200
width = size * widthToHeightRatio
height = size
fileName = paste(dir,batch,'/',compare,'.png',sep='')
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
}
createPlot(pwm1 = pwm_en,pwm2 = pwm_de,compare = 'enrich vs deplete')
createPlot(pwm1 = pwm_en,pwm2 = pwm_bg,compare = 'enrich vs background')
createPlot(pwm1 = pwm_en,pwm2 = pwm_left,compare = 'enrich vs left')
createPlot(pwm1 = pwm_en,pwm2 = pwm_mid,compare = 'enrich vs mode')
createPlot(pwm1 = pwm_en,pwm2 = pwm_right,compare = 'enrich vs right')
dir.create(file.path('difflogo/ER_L24_t1'), showWarnings = FALSE)
dir.create(file.path(getwd(),'difflogo/ER_L24_t1'), showWarnings = FALSE)
dir.create(file.path(getwd(),'difflogo/ER_L24_t1'))
dir.create(file.path(getwd(),'difflogo/ER_L24_t1'))
dir.create(file.path(getwd(),'difflogo/','ER_L24_t1'), showWarnings = FALSE)
dir.create(file.path(getwd(),'difflogo/','ER_L24_t1'), showWarnings = FALSE)
dir.create(file.path(getwd(),'difflogo/','ER_L24_t1'), showWarnings = FALSE)
dir.create(file.path(getwd(),'difflogo/',batch), showWarnings = FALSE)
pwm_en = read.csv(paste(dir,batch,'/',batch,'_enriched.csv',sep=''),row.names=1)
pwm_de = read.csv(paste(dir,batch,'/',batch,'_depleted.csv',sep=''),row.names=1)
pwm_bg = read.csv(paste(dir,batch,'/bg.csv',sep=''),row.names=1)
pwm_left = read.csv(paste(dir,batch,'/',batch,'_leftstd_comb50.csv',sep=''),row.names=1)
pwm_mid = read.csv(paste(dir,batch,'/',batch,'_median_comb50.csv',sep=''),row.names=1)
pwm_right = read.csv(paste(dir,batch,'/',batch,'_rightstd_comb50.csv',sep=''),row.names=1)
createPlot <- function(pwm1,pwm2,compare) {
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
#diffLogoObj$ylim.negMax=-0.005
#diffLogoObj$ylim.posMax=0.005
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 4
resolution = 200
width = size * widthToHeightRatio
height = size
fileName = paste('difflogo/',batch,'/',compare,'.png',sep='')
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
}
createPlot(pwm1 = pwm_en,pwm2 = pwm_de,compare = 'enrich vs deplete')
createPlot(pwm1 = pwm_en,pwm2 = pwm_bg,compare = 'enrich vs background')
createPlot(pwm1 = pwm_en,pwm2 = pwm_left,compare = 'enrich vs left')
createPlot(pwm1 = pwm_en,pwm2 = pwm_mid,compare = 'enrich vs mode')
createPlot(pwm1 = pwm_en,pwm2 = pwm_right,compare = 'enrich vs right')
batches <- clist <- c("ER_L24_t1", "ER_S15_t0","ER_S15_t1","ER_S15_t2")
for (batch in batches) {
dir.create(file.path(getwd(),'difflogo/',batch), showWarnings = FALSE)
pwm_en = read.csv(paste(dir,batch,'/',batch,'_enriched.csv',sep=''),row.names=1)
pwm_de = read.csv(paste(dir,batch,'/',batch,'_depleted.csv',sep=''),row.names=1)
pwm_bg = read.csv(paste(dir,batch,'/bg.csv',sep=''),row.names=1)
pwm_left = read.csv(paste(dir,batch,'/',batch,'_leftstd_comb50.csv',sep=''),row.names=1)
pwm_mid = read.csv(paste(dir,batch,'/',batch,'_median_comb50.csv',sep=''),row.names=1)
pwm_right = read.csv(paste(dir,batch,'/',batch,'_rightstd_comb50.csv',sep=''),row.names=1)
createPlot <- function(pwm1,pwm2,compare) {
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
#diffLogoObj$ylim.negMax=-0.005
#diffLogoObj$ylim.posMax=0.005
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 4
resolution = 200
width = size * widthToHeightRatio
height = size
fileName = paste('difflogo/',batch,'/',compare,'.png',sep='')
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
}
createPlot(pwm1 = pwm_en,pwm2 = pwm_de,compare = 'enrich vs deplete')
createPlot(pwm1 = pwm_en,pwm2 = pwm_bg,compare = 'enrich vs background')
createPlot(pwm1 = pwm_en,pwm2 = pwm_left,compare = 'enrich vs left')
createPlot(pwm1 = pwm_en,pwm2 = pwm_mid,compare = 'enrich vs mode')
createPlot(pwm1 = pwm_en,pwm2 = pwm_right,compare = 'enrich vs right')
}
for (batch in batches) {
dir.create(file.path(getwd(),'difflogo/',batch), showWarnings = FALSE)
pwm_en = read.csv(paste(dir,batch,'/',batch,'_enriched.csv',sep=''),row.names=1)
pwm_de = read.csv(paste(dir,batch,'/',batch,'_depleted.csv',sep=''),row.names=1)
pwm_bg = read.csv(paste(dir,batch,'/bg.csv',sep=''),row.names=1)
pwm_left = read.csv(paste(dir,batch,'/',batch,'_leftstd_comb50.csv',sep=''),row.names=1)
pwm_mid = read.csv(paste(dir,batch,'/',batch,'_median_comb50.csv',sep=''),row.names=1)
pwm_right = read.csv(paste(dir,batch,'/',batch,'_rightstd_comb50.csv',sep=''),row.names=1)
createPlot <- function(pwm1,pwm2,compare) {
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
#diffLogoObj$ylim.negMax=-0.005
#diffLogoObj$ylim.posMax=0.005
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 4
resolution = 200
width = size * widthToHeightRatio
height = size
fileName = paste('difflogo/',batch,'/',batch,'_',compare,'.png',sep='')
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
}
createPlot(pwm1 = pwm_en,pwm2 = pwm_de,compare = 'enrich vs deplete')
createPlot(pwm1 = pwm_en,pwm2 = pwm_bg,compare = 'enrich vs background')
createPlot(pwm1 = pwm_en,pwm2 = pwm_left,compare = 'enrich vs left')
createPlot(pwm1 = pwm_en,pwm2 = pwm_mid,compare = 'enrich vs mode')
createPlot(pwm1 = pwm_en,pwm2 = pwm_right,compare = 'enrich vs right')
}
library(DiffLogo)
library(seqLogo)
library(MotifDb)
dir <- 'deseq_wo_replace/pwms/'
batches <- clist <- c("ER_L24_t1", "ER_S15_t0","ER_S15_t1","ER_S15_t2")
createPlot <- function(pwm1,pwm2,compare) {
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
#diffLogoObj$ylim.negMax=-0.005
#diffLogoObj$ylim.posMax=0.005
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 4
resolution = 200
width = size * widthToHeightRatio
height = size
fileName = paste('difflogo/',batch,'/',batch,'_',compare,'.png',sep='')
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pw1, pwm2 = pw2)
dev.off()
}
for (batch in batches) {
dir.create(file.path(getwd(),'difflogo/',batch), showWarnings = FALSE)
pwm_en = read.csv(paste(dir,batch,'/',batch,'_enriched.csv',sep=''),row.names=1)
pwm_de = read.csv(paste(dir,batch,'/',batch,'_depleted.csv',sep=''),row.names=1)
pwm_bg = read.csv(paste(dir,batch,'/bg.csv',sep=''),row.names=1)
pwm_left = read.csv(paste(dir,batch,'/',batch,'_leftstd_comb50.csv',sep=''),row.names=1)
pwm_mid = read.csv(paste(dir,batch,'/',batch,'_median_comb50.csv',sep=''),row.names=1)
pwm_right = read.csv(paste(dir,batch,'/',batch,'_rightstd_comb50.csv',sep=''),row.names=1)
createPlot(pwm1 = pwm_en,pwm2 = pwm_de,compare = 'enrich vs deplete')
createPlot(pwm1 = pwm_en,pwm2 = pwm_bg,compare = 'enrich vs background')
createPlot(pwm1 = pwm_en,pwm2 = pwm_left,compare = 'enrich vs left')
createPlot(pwm1 = pwm_en,pwm2 = pwm_mid,compare = 'enrich vs mode')
createPlot(pwm1 = pwm_en,pwm2 = pwm_right,compare = 'enrich vs right')
}
for (batch in batches) {
dir.create(file.path(getwd(),'difflogo/',batch), showWarnings = FALSE)
pwm_en = read.csv(paste(dir,batch,'/',batch,'_enriched.csv',sep=''),row.names=1)
pwm_de = read.csv(paste(dir,batch,'/',batch,'_depleted.csv',sep=''),row.names=1)
pwm_bg = read.csv(paste(dir,batch,'/bg.csv',sep=''),row.names=1)
pwm_left = read.csv(paste(dir,batch,'/',batch,'_leftstd_comb50.csv',sep=''),row.names=1)
pwm_mid = read.csv(paste(dir,batch,'/',batch,'_median_comb50.csv',sep=''),row.names=1)
pwm_right = read.csv(paste(dir,batch,'/',batch,'_rightstd_comb50.csv',sep=''),row.names=1)
createPlot(pwm1 = pwm_en,pwm2 = pwm_de,compare = 'enrich vs deplete')
createPlot(pwm1 = pwm_en,pwm2 = pwm_bg,compare = 'enrich vs background')
createPlot(pwm1 = pwm_en,pwm2 = pwm_left,compare = 'enrich vs left')
createPlot(pwm1 = pwm_en,pwm2 = pwm_mid,compare = 'enrich vs mode')
createPlot(pwm1 = pwm_en,pwm2 = pwm_right,compare = 'enrich vs right')
}
View(pw1)
View(pw2)
createPlot <- function(pwm1,pwm2,compare) {
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
#diffLogoObj$ylim.negMax=-0.005
#diffLogoObj$ylim.posMax=0.005
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 4
resolution = 200
width = size * widthToHeightRatio
height = size
fileName = paste('difflogo/',batch,'/',batch,'_',compare,'.png',sep='')
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
diffLogoFromPwm(pwm1 = pwm1, pwm2 = pwm2)
dev.off()
}
batches <- clist <- c("ER_L24_t1", "ER_S15_t0","ER_S15_t1","ER_S15_t2")
for (batch in batches) {
dir.create(file.path(getwd(),'difflogo/',batch), showWarnings = FALSE)
pwm_en = read.csv(paste(dir,batch,'/',batch,'_enriched.csv',sep=''),row.names=1)
pwm_de = read.csv(paste(dir,batch,'/',batch,'_depleted.csv',sep=''),row.names=1)
pwm_bg = read.csv(paste(dir,batch,'/bg.csv',sep=''),row.names=1)
pwm_left = read.csv(paste(dir,batch,'/',batch,'_leftstd_comb50.csv',sep=''),row.names=1)
pwm_mid = read.csv(paste(dir,batch,'/',batch,'_median_comb50.csv',sep=''),row.names=1)
pwm_right = read.csv(paste(dir,batch,'/',batch,'_rightstd_comb50.csv',sep=''),row.names=1)
createPlot(pwm1 = pwm_en,pwm2 = pwm_de,compare = 'enrich vs deplete')
createPlot(pwm1 = pwm_en,pwm2 = pwm_bg,compare = 'enrich vs background')
createPlot(pwm1 = pwm_en,pwm2 = pwm_left,compare = 'enrich vs left')
createPlot(pwm1 = pwm_en,pwm2 = pwm_mid,compare = 'enrich vs mode')
createPlot(pwm1 = pwm_en,pwm2 = pwm_right,compare = 'enrich vs right')
}
createPlot <- function(pwm1,pwm2,compare) {
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
diffLogoObj$ylim.negMax=-0.005
diffLogoObj$ylim.posMax=0.005
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 4
resolution = 200
width = size * widthToHeightRatio
height = size
fileName = paste('difflogo/',batch,'/',batch,'_',compare,'.png',sep='')
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
#diffLogoFromPwm(pwm1 = pwm1, pwm2 = pwm2)
diffLogo(diffLogoObj)
dev.off()
}
batches <- clist <- c("ER_L24_t1", "ER_S15_t0","ER_S15_t1","ER_S15_t2")
for (batch in batches) {
dir.create(file.path(getwd(),'difflogo/',batch), showWarnings = FALSE)
pwm_en = read.csv(paste(dir,batch,'/',batch,'_enriched.csv',sep=''),row.names=1)
pwm_de = read.csv(paste(dir,batch,'/',batch,'_depleted.csv',sep=''),row.names=1)
pwm_bg = read.csv(paste(dir,batch,'/bg.csv',sep=''),row.names=1)
pwm_left = read.csv(paste(dir,batch,'/',batch,'_leftstd_comb50.csv',sep=''),row.names=1)
pwm_mid = read.csv(paste(dir,batch,'/',batch,'_median_comb50.csv',sep=''),row.names=1)
pwm_right = read.csv(paste(dir,batch,'/',batch,'_rightstd_comb50.csv',sep=''),row.names=1)
createPlot(pwm1 = pwm_en,pwm2 = pwm_de,compare = 'enrich vs deplete')
createPlot(pwm1 = pwm_en,pwm2 = pwm_bg,compare = 'enrich vs background')
createPlot(pwm1 = pwm_en,pwm2 = pwm_left,compare = 'enrich vs left')
createPlot(pwm1 = pwm_en,pwm2 = pwm_mid,compare = 'enrich vs mode')
createPlot(pwm1 = pwm_en,pwm2 = pwm_right,compare = 'enrich vs right')
}
createPlot <- function(pwm1,pwm2,compare) {
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
diffLogoObj$ylim.negMax=-0.05
diffLogoObj$ylim.posMax=0.05
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 4
resolution = 200
width = size * widthToHeightRatio
height = size
fileName = paste('difflogo/',batch,'/',batch,'_',compare,'.png',sep='')
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
#diffLogoFromPwm(pwm1 = pwm1, pwm2 = pwm2)
diffLogo(diffLogoObj)
dev.off()
}
batches <- clist <- c("ER_L24_t1", "ER_S15_t0","ER_S15_t1","ER_S15_t2")
for (batch in batches) {
dir.create(file.path(getwd(),'difflogo/',batch), showWarnings = FALSE)
pwm_en = read.csv(paste(dir,batch,'/',batch,'_enriched.csv',sep=''),row.names=1)
pwm_de = read.csv(paste(dir,batch,'/',batch,'_depleted.csv',sep=''),row.names=1)
pwm_bg = read.csv(paste(dir,batch,'/bg.csv',sep=''),row.names=1)
pwm_left = read.csv(paste(dir,batch,'/',batch,'_leftstd_comb50.csv',sep=''),row.names=1)
pwm_mid = read.csv(paste(dir,batch,'/',batch,'_median_comb50.csv',sep=''),row.names=1)
pwm_right = read.csv(paste(dir,batch,'/',batch,'_rightstd_comb50.csv',sep=''),row.names=1)
createPlot(pwm1 = pwm_en,pwm2 = pwm_de,compare = 'enrich vs deplete')
createPlot(pwm1 = pwm_en,pwm2 = pwm_bg,compare = 'enrich vs background')
createPlot(pwm1 = pwm_en,pwm2 = pwm_left,compare = 'enrich vs left')
createPlot(pwm1 = pwm_en,pwm2 = pwm_mid,compare = 'enrich vs mode')
createPlot(pwm1 = pwm_en,pwm2 = pwm_right,compare = 'enrich vs right')
}
createPlot <- function(pwm1,pwm2,compare) {
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
#diffLogoObj$ylim.negMax=-0.05
#diffLogoObj$ylim.posMax=0.05
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 4
resolution = 200
width = size * widthToHeightRatio
height = size
fileName = paste('difflogo/',batch,'/',batch,'_',compare,'.png',sep='')
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
#diffLogoFromPwm(pwm1 = pwm1, pwm2 = pwm2)
diffLogo(diffLogoObj)
dev.off()
}
batches <- clist <- c("ER_L24_t1", "ER_S15_t0","ER_S15_t1","ER_S15_t2")
for (batch in batches) {
dir.create(file.path(getwd(),'difflogo/',batch), showWarnings = FALSE)
pwm_en = read.csv(paste(dir,batch,'/',batch,'_enriched.csv',sep=''),row.names=1)
pwm_de = read.csv(paste(dir,batch,'/',batch,'_depleted.csv',sep=''),row.names=1)
pwm_bg = read.csv(paste(dir,batch,'/bg.csv',sep=''),row.names=1)
pwm_left = read.csv(paste(dir,batch,'/',batch,'_leftstd_comb50.csv',sep=''),row.names=1)
pwm_mid = read.csv(paste(dir,batch,'/',batch,'_median_comb50.csv',sep=''),row.names=1)
pwm_right = read.csv(paste(dir,batch,'/',batch,'_rightstd_comb50.csv',sep=''),row.names=1)
createPlot(pwm1 = pwm_en,pwm2 = pwm_de,compare = 'enrich vs deplete')
createPlot(pwm1 = pwm_en,pwm2 = pwm_bg,compare = 'enrich vs background')
createPlot(pwm1 = pwm_en,pwm2 = pwm_left,compare = 'enrich vs left')
createPlot(pwm1 = pwm_en,pwm2 = pwm_mid,compare = 'enrich vs mode')
createPlot(pwm1 = pwm_en,pwm2 = pwm_right,compare = 'enrich vs right')
}
library(DiffLogo)
library(seqLogo)
library(MotifDb)
BiocManager::install("DiffLogo")
BiocManager::install("seqLogo")
BiocManager::install("MotifDb")
createPlot <- function(pwm1,pwm2,cluster) {
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
#diffLogoObj$ylim.negMax=-0.05
#diffLogoObj$ylim.posMax=0.05
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 4
resolution = 200
width = size * widthToHeightRatio
height = size
fileName = paste('kmeans_jm/',batch,'/',batch,' vs cluster',cluster,'.png',sep='')
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
#diffLogoFromPwm(pwm1 = pwm1, pwm2 = pwm2)
diffLogo(diffLogoObj)
dev.off()
}
batches <- clist <- c("ER_L24_t1", "ER_S15_t0","ER_S15_t1","ER_S15_t2")
er_dir <- 'deseq_wo_replace/pwms/'
cluster_dir <- 'kmeans_jm/pwm/'
createPlot <- function(pwm1,pwm2,cluster) {
diffLogoObj = createDiffLogoObject(pwm1 = pwm1, pwm2 = pwm2)
#diffLogoObj$ylim.negMax=-0.05
#diffLogoObj$ylim.posMax=0.05
widthToHeightRatio = 16/10
size = length(pw1) * 2 / 4
resolution = 200
width = size * widthToHeightRatio
height = size
fileName = paste('kmeans_jm/',batch,'/',batch,' vs cluster',cluster,'.png',sep='')
png(filename = fileName, res = resolution,width = width * resolution, height = height * resolution)
#diffLogoFromPwm(pwm1 = pwm1, pwm2 = pwm2)
diffLogo(diffLogoObj)
dev.off()
}
batches <- clist <- c("ER_L24_t1", "ER_S15_t0","ER_S15_t1","ER_S15_t2")
for (batch in batches) {
for (cluster in c(1:8)) {
#dir.create(file.path(getwd(),'difflogo/',batch), showWarnings = FALSE)
pwm_en = read.csv(paste(er_dir,batch,'/',batch,'_enriched.csv',sep=''),row.names=1)
pwm_cluster = read.csv(paste(cluster_dir,'cluster',cluster,'_pwm.csv',sep=''),row.names=1)
createPlot(pwm1 = pwm_en,pwm2 = pwm_cluster,cluster = cluster)
}
}
library(DiffLogo)
library(seqLogo)
library(MotifDb)
for (batch in batches) {
for (cluster in c(1:8)) {
#dir.create(file.path(getwd(),'difflogo/',batch), showWarnings = FALSE)
pwm_en = read.csv(paste(er_dir,batch,'/',batch,'_enriched.csv',sep=''),row.names=1)
pwm_cluster = read.csv(paste(cluster_dir,'cluster',cluster,'_pwm.csv',sep=''),row.names=1)
createPlot(pwm1 = pwm_en,pwm2 = pwm_cluster,cluster = cluster)
}
}
