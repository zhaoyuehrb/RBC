%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:22:41 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (HMGCR)
} def

/sequence { (\
CUCUUAUUGGUCGAAGGCUCGUCCAGCUCCGAGCGUGCGUAAGGUGAGGGCUCCUUCCGCUCCGCGACUGCGUUAACUGGAGCCAGGCUGAGCGUCGGCGCCGGGGUUCGGUGGCCUCUAGUGAGAUCUGGAGGAUCCAAGGAUUCUGUAGCUACA\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 125 0.021868047 ubox
1 131 0.004622988 ubox
2 124 0.021719582 ubox
2 126 0.934435764 ubox
3 9 0.004991736 ubox
3 123 0.021257397 ubox
3 125 0.998874329 ubox
4 124 0.999005180 ubox
5 123 0.998803376 ubox
6 122 0.999040620 ubox
7 121 0.998590430 ubox
8 25 0.003501400 ubox
8 120 0.997623152 ubox
9 24 0.004166643 ubox
9 118 0.018440571 ubox
9 119 0.998313793 ubox
10 23 0.004166318 ubox
10 99 0.025919962 ubox
10 117 0.009751973 ubox
10 118 0.991411792 ubox
11 98 0.026074162 ubox
12 21 0.004212198 ubox
12 97 0.026497942 ubox
13 20 0.004253103 ubox
13 96 0.026953449 ubox
13 118 0.116262132 ubox
14 19 0.003979054 ubox
14 95 0.026684823 ubox
14 117 0.102989601 ubox
15 117 0.984169863 ubox
16 116 0.999502774 ubox
16 117 0.006178795 ubox
17 93 0.027295826 ubox
17 115 0.999589091 ubox
17 116 0.005813274 ubox
18 92 0.027302090 ubox
18 114 0.995109311 ubox
19 91 0.027297805 ubox
19 111 0.023898809 ubox
19 113 0.522847626 ubox
19 114 0.093656195 ubox
20 90 0.027287899 ubox
20 110 0.048227596 ubox
20 113 0.840768633 ubox
21 88 0.021316087 ubox
21 89 0.016528099 ubox
21 109 0.048599310 ubox
21 112 0.813320516 ubox
22 87 0.021075464 ubox
22 111 0.303783617 ubox
23 86 0.021033839 ubox
23 87 0.017300071 ubox
23 110 0.318429120 ubox
23 111 0.943212241 ubox
24 86 0.017290133 ubox
24 110 0.943201214 ubox
25 108 0.974898148 ubox
26 83 0.027322511 ubox
26 107 0.998402004 ubox
27 82 0.027343663 ubox
27 106 0.999595560 ubox
28 81 0.027340008 ubox
28 105 0.998912190 ubox
29 80 0.027343854 ubox
29 104 0.999532859 ubox
29 105 0.010968068 ubox
30 79 0.027317005 ubox
30 103 0.999541893 ubox
30 104 0.010880800 ubox
31 78 0.018376797 ubox
31 102 0.998911265 ubox
32 74 0.009208816 ubox
32 78 0.019108932 ubox
33 73 0.009608278 ubox
33 77 0.021977996 ubox
33 99 0.148262310 ubox
33 101 0.988428851 ubox
34 72 0.009649803 ubox
34 97 0.013222272 ubox
34 98 0.147847893 ubox
34 100 0.988515442 ubox
35 71 0.009616216 ubox
35 77 0.003658260 ubox
35 96 0.017915302 ubox
35 99 0.988115108 ubox
36 70 0.009335733 ubox
36 76 0.003489209 ubox
36 94 0.007054664 ubox
36 97 0.259513891 ubox
36 98 0.927660520 ubox
37 60 0.008756330 ubox
37 65 0.005423896 ubox
37 69 0.005728204 ubox
37 73 0.025132000 ubox
37 93 0.017110513 ubox
37 95 0.903409156 ubox
37 96 0.364954367 ubox
38 59 0.008773606 ubox
38 64 0.005451962 ubox
38 66 0.005937556 ubox
38 72 0.025372049 ubox
38 92 0.017117246 ubox
38 94 0.998675214 ubox
38 97 0.011781630 ubox
39 58 0.008771992 ubox
39 63 0.005428210 ubox
39 65 0.005971216 ubox
39 68 0.005111124 ubox
39 71 0.025373325 ubox
39 93 0.999273125 ubox
39 96 0.011087784 ubox
40 64 0.005899692 ubox
40 67 0.004884234 ubox
40 70 0.025238064 ubox
40 90 0.005471413 ubox
40 92 0.995971433 ubox
41 56 0.008469632 ubox
41 69 0.021885657 ubox
41 89 0.003572024 ubox
42 55 0.009188129 ubox
42 69 0.005816904 ubox
42 89 0.056617882 ubox
43 54 0.009209519 ubox
43 58 0.004148130 ubox
43 61 0.006785221 ubox
43 68 0.008042282 ubox
43 88 0.055204120 ubox
43 89 0.996462197 ubox
44 53 0.009198975 ubox
44 57 0.004161357 ubox
44 60 0.006943944 ubox
44 65 0.025452143 ubox
44 88 0.997740966 ubox
44 93 0.003749620 ubox
45 59 0.006913251 ubox
45 64 0.025468787 ubox
45 66 0.003186533 ubox
45 85 0.003914299 ubox
45 87 0.986544897 ubox
45 92 0.003738741 ubox
46 56 0.005668834 ubox
46 57 0.007045925 ubox
46 58 0.005535880 ubox
46 63 0.025404393 ubox
46 65 0.004634445 ubox
47 55 0.006676025 ubox
47 56 0.007952770 ubox
48 54 0.006879330 ubox
48 55 0.007888870 ubox
48 62 0.025431487 ubox
48 63 0.005071020 ubox
48 84 0.195295858 ubox
49 53 0.006769896 ubox
49 54 0.007863938 ubox
49 58 0.003528233 ubox
49 61 0.025441045 ubox
49 62 0.005063362 ubox
49 83 0.138266670 ubox
49 84 0.978868585 ubox
50 57 0.003497461 ubox
50 60 0.025948027 ubox
50 83 0.989922589 ubox
51 59 0.025938732 ubox
51 82 0.999497347 ubox
52 81 0.999314997 ubox
53 80 0.999311806 ubox
54 79 0.998393825 ubox
54 80 0.014124796 ubox
55 67 0.005739080 ubox
55 76 0.153400843 ubox
55 79 0.019581709 ubox
56 66 0.004190138 ubox
56 67 0.014560965 ubox
56 75 0.168178655 ubox
56 79 0.004052047 ubox
56 81 0.011982165 ubox
57 66 0.012853195 ubox
57 79 0.005706383 ubox
57 80 0.015097765 ubox
58 64 0.010932582 ubox
58 66 0.065131619 ubox
58 70 0.003909054 ubox
58 72 0.626182796 ubox
58 79 0.016445082 ubox
59 63 0.011246351 ubox
59 65 0.066706002 ubox
59 69 0.003695593 ubox
59 71 0.630703225 ubox
59 73 0.106865813 ubox
59 78 0.023519279 ubox
59 83 0.008480702 ubox
59 93 0.003522809 ubox
60 64 0.066229793 ubox
60 70 0.630448837 ubox
60 72 0.095040597 ubox
60 82 0.008534928 ubox
60 92 0.003529056 ubox
61 67 0.123484631 ubox
61 81 0.008559662 ubox
61 91 0.003532882 ubox
62 66 0.128536025 ubox
62 80 0.008571325 ubox
62 90 0.003526103 ubox
63 70 0.036953268 ubox
63 72 0.755068303 ubox
63 79 0.008528387 ubox
64 69 0.028244635 ubox
64 71 0.766393665 ubox
64 73 0.068847142 ubox
64 78 0.005581974 ubox
64 88 0.003504868 ubox
65 70 0.765327824 ubox
65 72 0.070538476 ubox
65 87 0.003493837 ubox
65 97 0.007748498 ubox
66 71 0.069338681 ubox
66 74 0.010714109 ubox
66 96 0.008046792 ubox
67 73 0.020306620 ubox
67 95 0.008040932 ubox
68 72 0.020996628 ubox
68 86 0.003747855 ubox
68 94 0.007822332 ubox
69 75 0.006699805 ubox
69 85 0.003781917 ubox
70 74 0.005961100 ubox
70 84 0.003721416 ubox
70 93 0.008023060 ubox
71 92 0.008022089 ubox
72 78 0.003895921 ubox
72 83 0.003545835 ubox
73 82 0.003536190 ubox
73 91 0.003939245 ubox
74 81 0.003231454 ubox
74 90 0.004089175 ubox
75 89 0.003853230 ubox
77 86 0.008407855 ubox
78 85 0.008418476 ubox
79 84 0.008396119 ubox
97 116 0.005786460 ubox
98 115 0.006017598 ubox
98 152 0.004619761 ubox
99 113 0.005301921 ubox
99 114 0.004394462 ubox
99 151 0.004632263 ubox
100 112 0.006904417 ubox
100 152 0.023214670 ubox
101 111 0.007093810 ubox
101 151 0.023145604 ubox
102 110 0.007094566 ubox
102 148 0.024999952 ubox
103 109 0.007069012 ubox
103 118 0.004325523 ubox
103 147 0.025878956 ubox
104 108 0.004579557 ubox
104 117 0.004354291 ubox
104 146 0.025926542 ubox
105 116 0.004366627 ubox
105 145 0.025853188 ubox
106 115 0.004366694 ubox
106 144 0.025893560 ubox
107 114 0.004285914 ubox
107 143 0.025880419 ubox
108 142 0.025819794 ubox
109 141 0.025790836 ubox
110 138 0.003327950 ubox
111 137 0.003324229 ubox
111 155 0.003403654 ubox
112 139 0.023711116 ubox
112 154 0.003408589 ubox
113 137 0.007018776 ubox
113 138 0.024440097 ubox
113 153 0.003411427 ubox
114 136 0.007090105 ubox
114 137 0.024299701 ubox
114 152 0.003411518 ubox
115 134 0.025923260 ubox
115 151 0.003249633 ubox
116 133 0.026088308 ubox
117 132 0.026099773 ubox
118 131 0.026183025 ubox
119 130 0.026171667 ubox
120 129 0.026170391 ubox
121 128 0.026120812 ubox
121 155 0.004326839 ubox
122 154 0.004259245 ubox
124 153 0.007863331 ubox
125 152 0.009366431 ubox
128 141 0.004490019 ubox
128 142 0.003225363 ubox
128 151 0.979525352 ubox
129 139 0.005969040 ubox
129 140 0.003198732 ubox
129 150 0.995099009 ubox
129 154 0.015823483 ubox
130 138 0.007407616 ubox
130 149 0.993337880 ubox
130 153 0.017469348 ubox
131 137 0.007410375 ubox
131 152 0.017634802 ubox
132 136 0.006447111 ubox
132 147 0.998281492 ubox
133 146 0.999532680 ubox
133 147 0.003889615 ubox
134 145 0.998785832 ubox
134 146 0.004589520 ubox
135 144 0.999081160 ubox
135 145 0.003693246 ubox
136 142 0.005362279 ubox
136 143 0.999306408 ubox
137 141 0.009856340 ubox
137 142 0.999056908 ubox
147 156 0.004869738 ubox
148 155 0.016675189 ubox
149 154 0.015620970 ubox
2 126 0.9500000 lbox
3 125 0.9500000 lbox
4 124 0.9500000 lbox
5 123 0.9500000 lbox
6 122 0.9500000 lbox
7 121 0.9500000 lbox
8 120 0.9500000 lbox
9 119 0.9500000 lbox
10 118 0.9500000 lbox
15 117 0.9500000 lbox
16 116 0.9500000 lbox
17 115 0.9500000 lbox
18 114 0.9500000 lbox
20 113 0.9500000 lbox
21 112 0.9500000 lbox
23 111 0.9500000 lbox
24 110 0.9500000 lbox
25 108 0.9500000 lbox
26 107 0.9500000 lbox
27 106 0.9500000 lbox
28 105 0.9500000 lbox
29 104 0.9500000 lbox
30 103 0.9500000 lbox
31 102 0.9500000 lbox
33 101 0.9500000 lbox
34 100 0.9500000 lbox
35 99 0.9500000 lbox
36 98 0.9500000 lbox
37 95 0.9500000 lbox
38 94 0.9500000 lbox
39 93 0.9500000 lbox
40 92 0.9500000 lbox
43 89 0.9500000 lbox
44 88 0.9500000 lbox
45 87 0.9500000 lbox
49 84 0.9500000 lbox
50 83 0.9500000 lbox
51 82 0.9500000 lbox
52 81 0.9500000 lbox
53 80 0.9500000 lbox
54 79 0.9500000 lbox
63 72 0.9500000 lbox
64 71 0.9500000 lbox
65 70 0.9500000 lbox
128 151 0.9500000 lbox
129 150 0.9500000 lbox
130 149 0.9500000 lbox
132 147 0.9500000 lbox
133 146 0.9500000 lbox
134 145 0.9500000 lbox
135 144 0.9500000 lbox
136 143 0.9500000 lbox
137 142 0.9500000 lbox
showpage
end
%%EOF
