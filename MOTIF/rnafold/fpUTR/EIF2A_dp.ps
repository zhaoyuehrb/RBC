%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:20:10 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (EIF2A)
} def

/sequence { (\
AAUUGGCCCCGAGGCUGAUGGCUCCGGAAACACCAAUUCGCUGUCUCCACGCAUGAGGAGACGUGUAGGGGCCGGGUUCGGCCCUGGUGAACUCUCACCCGAGCGGUUUCUCUUUCCGGGACAAC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 38 0.008357557 ubox
2 19 0.906459357 ubox
2 37 0.011286183 ubox
3 12 0.004425688 ubox
3 18 0.964860738 ubox
3 21 0.005859800 ubox
3 36 0.011643273 ubox
3 124 0.067872459 ubox
4 11 0.004777248 ubox
4 17 0.973829060 ubox
4 20 0.006863326 ubox
4 35 0.011812351 ubox
4 123 0.081483342 ubox
5 10 0.004914405 ubox
5 16 0.989760848 ubox
5 23 0.027199833 ubox
5 34 0.011848089 ubox
5 122 0.082952428 ubox
6 15 0.995270512 ubox
6 22 0.034261711 ubox
6 33 0.011831149 ubox
7 14 0.994987652 ubox
7 21 0.034263177 ubox
7 120 0.067327854 ubox
8 13 0.991471971 ubox
8 14 0.023992710 ubox
8 20 0.034156947 ubox
8 119 0.068399567 ubox
8 120 0.056465561 ubox
9 13 0.033647045 ubox
9 27 0.012164538 ubox
9 118 0.068189440 ubox
9 119 0.056688083 ubox
10 17 0.025419756 ubox
10 26 0.012283335 ubox
10 118 0.056801297 ubox
11 16 0.019563798 ubox
11 24 0.005555727 ubox
11 25 0.012676237 ubox
11 112 0.020892020 ubox
11 114 0.039511596 ubox
11 115 0.018167551 ubox
11 116 0.054238095 ubox
11 117 0.049720735 ubox
12 23 0.005645856 ubox
12 111 0.022961433 ubox
12 113 0.052877118 ubox
12 114 0.031080218 ubox
12 115 0.053961434 ubox
13 22 0.005140795 ubox
13 23 0.015954136 ubox
13 83 0.004034962 ubox
13 110 0.023103829 ubox
13 111 0.013278424 ubox
13 112 0.054131238 ubox
13 113 0.037721631 ubox
13 114 0.048174764 ubox
13 115 0.005377329 ubox
13 116 0.012515959 ubox
14 22 0.017690607 ubox
14 82 0.004117329 ubox
14 109 0.020368899 ubox
14 110 0.022498379 ubox
14 111 0.043163105 ubox
14 112 0.040496247 ubox
14 113 0.040748260 ubox
14 114 0.005088068 ubox
14 115 0.011313040 ubox
15 21 0.017865076 ubox
15 81 0.004182260 ubox
16 20 0.016103680 ubox
16 80 0.004178816 ubox
16 123 0.003280165 ubox
17 79 0.004176531 ubox
17 108 0.083369991 ubox
17 109 0.007248936 ubox
17 110 0.020311000 ubox
17 112 0.006690461 ubox
17 122 0.005391200 ubox
18 78 0.004070750 ubox
18 107 0.086197754 ubox
18 108 0.005677314 ubox
18 109 0.018122721 ubox
18 111 0.005755904 ubox
19 74 0.003590705 ubox
19 106 0.087286873 ubox
19 123 0.274435619 ubox
20 73 0.003803512 ubox
20 122 0.494990752 ubox
21 72 0.003805433 ubox
21 104 0.089666768 ubox
22 71 0.003805356 ubox
22 103 0.089681126 ubox
22 119 0.003992163 ubox
22 120 0.356098037 ubox
23 70 0.003797634 ubox
23 102 0.089624755 ubox
23 119 0.044451079 ubox
23 120 0.785891819 ubox
23 121 0.090484424 ubox
24 69 0.003800198 ubox
24 101 0.086482285 ubox
24 118 0.031496248 ubox
24 119 0.991052023 ubox
24 120 0.079804520 ubox
25 40 0.032411485 ubox
25 68 0.003883741 ubox
25 101 0.022944814 ubox
25 118 0.993703120 ubox
25 119 0.056563991 ubox
26 34 0.065836139 ubox
26 39 0.036213313 ubox
26 95 0.004733556 ubox
26 99 0.012954082 ubox
26 100 0.031666618 ubox
26 111 0.003611241 ubox
26 117 0.995829618 ubox
27 33 0.065751193 ubox
27 38 0.036100991 ubox
27 39 0.022254498 ubox
27 94 0.005580174 ubox
27 98 0.012462594 ubox
27 99 0.023133279 ubox
27 110 0.004425495 ubox
27 116 0.995849968 ubox
28 37 0.035560702 ubox
28 38 0.022237429 ubox
28 93 0.006162611 ubox
28 95 0.003526441 ubox
28 109 0.005155110 ubox
28 114 0.013677304 ubox
28 115 0.994277285 ubox
29 37 0.020630199 ubox
29 38 0.004914233 ubox
29 108 0.007798578 ubox
29 109 0.010297907 ubox
29 113 0.017608856 ubox
29 114 0.980376676 ubox
29 115 0.028521435 ubox
30 37 0.005767357 ubox
30 66 0.035740197 ubox
30 107 0.009394277 ubox
30 108 0.014124860 ubox
30 113 0.904596761 ubox
30 114 0.037149912 ubox
31 65 0.039255519 ubox
31 89 0.076093419 ubox
31 106 0.009567325 ubox
32 64 0.039205946 ubox
32 66 0.004406555 ubox
32 88 0.078245734 ubox
32 107 0.120909905 ubox
33 63 0.038130140 ubox
33 65 0.004149216 ubox
33 69 0.013316455 ubox
33 70 0.003539125 ubox
33 87 0.078486441 ubox
33 106 0.124153913 ubox
34 65 0.005228833 ubox
34 68 0.017976497 ubox
34 69 0.004233223 ubox
34 86 0.078450265 ubox
34 105 0.123465511 ubox
35 64 0.005072061 ubox
35 85 0.054741067 ubox
35 108 0.394075451 ubox
35 109 0.556795253 ubox
36 66 0.013333457 ubox
36 107 0.416793168 ubox
36 108 0.591927467 ubox
37 65 0.008592344 ubox
37 68 0.024792250 ubox
37 91 0.006055289 ubox
37 102 0.028496000 ubox
37 103 0.087772704 ubox
37 106 0.297712375 ubox
38 67 0.051036341 ubox
38 68 0.011726108 ubox
38 90 0.007250578 ubox
38 101 0.024443404 ubox
38 102 0.097769390 ubox
38 105 0.059204982 ubox
38 106 0.870806180 ubox
39 63 0.004091018 ubox
39 65 0.170327612 ubox
39 68 0.018554771 ubox
39 89 0.007489838 ubox
39 101 0.098946874 ubox
39 105 0.967505609 ubox
40 64 0.175187937 ubox
40 66 0.108679339 ubox
40 88 0.007493383 ubox
40 100 0.088396071 ubox
40 104 0.970181822 ubox
41 63 0.175940669 ubox
41 65 0.117441292 ubox
41 68 0.006273183 ubox
41 87 0.007493740 ubox
41 103 0.969888019 ubox
42 63 0.285502015 ubox
42 65 0.005882164 ubox
42 67 0.006573726 ubox
42 86 0.006674731 ubox
42 101 0.031689924 ubox
42 102 0.912620614 ubox
43 62 0.998171894 ubox
43 100 0.019873348 ubox
44 61 0.999550629 ubox
45 60 0.999950855 ubox
46 59 0.999816460 ubox
47 57 0.004710602 ubox
47 58 0.999949126 ubox
48 55 0.014707330 ubox
48 57 0.999651520 ubox
48 65 0.003462415 ubox
49 54 0.023815564 ubox
49 64 0.003473737 ubox
50 63 0.003475087 ubox
51 62 0.003426751 ubox
51 66 0.006251959 ubox
52 65 0.006446709 ubox
53 64 0.006447661 ubox
54 63 0.006443764 ubox
55 62 0.006377926 ubox
62 101 0.004909483 ubox
63 85 0.005231331 ubox
63 92 0.007910455 ubox
63 98 0.010012070 ubox
63 100 0.016798328 ubox
64 86 0.003196505 ubox
64 91 0.007863141 ubox
64 97 0.010040321 ubox
64 101 0.019879150 ubox
65 85 0.010421178 ubox
65 96 0.010039782 ubox
65 100 0.025703990 ubox
66 86 0.020510683 ubox
66 87 0.003837404 ubox
67 85 0.108748472 ubox
67 95 0.007324069 ubox
68 84 0.099020066 ubox
68 85 0.914707706 ubox
68 94 0.007368876 ubox
68 100 0.009194052 ubox
69 83 0.080877743 ubox
69 84 0.994550999 ubox
69 85 0.006392233 ubox
69 93 0.007033349 ubox
70 82 0.057209942 ubox
70 83 0.996651407 ubox
70 84 0.005569194 ubox
70 92 0.007020753 ubox
71 82 0.998303703 ubox
71 83 0.003943641 ubox
71 88 0.007538717 ubox
72 81 0.999947099 ubox
72 87 0.007638936 ubox
73 80 0.999908562 ubox
73 86 0.007640056 ubox
74 79 0.986137689 ubox
74 84 0.004562426 ubox
74 85 0.006422083 ubox
75 83 0.004626534 ubox
75 84 0.006390380 ubox
76 82 0.004676769 ubox
76 83 0.006324449 ubox
77 81 0.004422938 ubox
85 101 0.070655737 ubox
85 102 0.007187586 ubox
86 99 0.984317838 ubox
86 100 0.126290522 ubox
86 110 0.003342257 ubox
86 111 0.011797334 ubox
86 112 0.027141708 ubox
86 113 0.011388740 ubox
87 98 0.991976378 ubox
87 99 0.089673654 ubox
87 110 0.013316703 ubox
87 111 0.025819127 ubox
87 112 0.013953852 ubox
88 97 0.995792687 ubox
89 96 0.995788318 ubox
89 109 0.036337465 ubox
89 110 0.016461187 ubox
90 95 0.931556266 ubox
90 108 0.074458391 ubox
90 109 0.014187049 ubox
91 107 0.081246196 ubox
91 108 0.010260886 ubox
92 103 0.016123083 ubox
92 106 0.082609015 ubox
93 102 0.016367762 ubox
93 105 0.081266506 ubox
94 101 0.016551560 ubox
94 103 0.082982500 ubox
95 102 0.083144225 ubox
96 101 0.083055513 ubox
97 107 0.008504145 ubox
98 106 0.009070045 ubox
99 105 0.009056371 ubox
99 106 0.008015727 ubox
100 105 0.012015710 ubox
101 108 0.005717346 ubox
101 109 0.004365141 ubox
101 110 0.042261289 ubox
101 112 0.156362517 ubox
101 114 0.006480144 ubox
102 107 0.005953600 ubox
102 108 0.004773413 ubox
102 109 0.041461998 ubox
102 111 0.156522055 ubox
102 113 0.008434296 ubox
103 107 0.003467127 ubox
103 108 0.030520710 ubox
103 110 0.154408360 ubox
103 112 0.008995852 ubox
105 111 0.007767532 ubox
105 112 0.015519694 ubox
105 113 0.009909083 ubox
106 110 0.008870204 ubox
106 111 0.011529732 ubox
106 112 0.014920124 ubox
106 122 0.011139689 ubox
106 125 0.008295112 ubox
107 121 0.010999963 ubox
107 124 0.008442641 ubox
108 120 0.010862024 ubox
108 123 0.008254106 ubox
109 119 0.010766191 ubox
109 121 0.014266238 ubox
110 118 0.010761366 ubox
110 120 0.015131574 ubox
111 119 0.015080502 ubox
112 118 0.015058832 ubox
2 19 0.9500000 lbox
3 18 0.9500000 lbox
4 17 0.9500000 lbox
5 16 0.9500000 lbox
6 15 0.9500000 lbox
7 14 0.9500000 lbox
8 13 0.9500000 lbox
23 120 0.9500000 lbox
24 119 0.9500000 lbox
25 118 0.9500000 lbox
26 117 0.9500000 lbox
27 116 0.9500000 lbox
28 115 0.9500000 lbox
29 114 0.9500000 lbox
30 113 0.9500000 lbox
38 106 0.9500000 lbox
39 105 0.9500000 lbox
40 104 0.9500000 lbox
41 103 0.9500000 lbox
42 102 0.9500000 lbox
43 62 0.9500000 lbox
44 61 0.9500000 lbox
45 60 0.9500000 lbox
46 59 0.9500000 lbox
47 58 0.9500000 lbox
48 57 0.9500000 lbox
68 85 0.9500000 lbox
69 84 0.9500000 lbox
70 83 0.9500000 lbox
71 82 0.9500000 lbox
72 81 0.9500000 lbox
73 80 0.9500000 lbox
74 79 0.9500000 lbox
86 99 0.9500000 lbox
87 98 0.9500000 lbox
88 97 0.9500000 lbox
89 96 0.9500000 lbox
90 95 0.9500000 lbox
showpage
end
%%EOF
