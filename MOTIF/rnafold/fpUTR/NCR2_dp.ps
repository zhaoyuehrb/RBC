%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:21:21 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (NCR2)
} def

/sequence { (\
AGCAGCAGAAUCAGGCCCAGCUCCCAAUUCCCUCUCCCCAGUCUUCUCCAGGUGUCCCCUCCCAUGAGCGCACAGGAAAAGGACCAC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 22 0.562834084 ubox
1 33 0.028541942 ubox
1 35 0.269802841 ubox
2 16 0.053241376 ubox
2 21 0.646974061 ubox
2 32 0.032635070 ubox
2 34 0.309977135 ubox
2 42 0.010932268 ubox
3 15 0.053316855 ubox
3 20 0.647044098 ubox
3 41 0.011988581 ubox
4 22 0.129642652 ubox
4 33 0.375176388 ubox
4 35 0.182396955 ubox
4 47 0.004093172 ubox
5 16 0.654544157 ubox
5 21 0.138571562 ubox
5 32 0.384204358 ubox
5 34 0.194141789 ubox
5 42 0.005822682 ubox
5 46 0.004877268 ubox
6 15 0.654740391 ubox
6 20 0.138488030 ubox
6 41 0.006421083 ubox
7 22 0.007633456 ubox
7 29 0.014159725 ubox
7 33 0.062607695 ubox
7 35 0.043510911 ubox
7 44 0.005955580 ubox
7 47 0.003375650 ubox
8 21 0.008121779 ubox
8 23 0.016177719 ubox
8 28 0.014513928 ubox
8 29 0.031000989 ubox
8 30 0.690145928 ubox
8 32 0.050331055 ubox
8 34 0.045417752 ubox
8 36 0.045746977 ubox
8 43 0.006226222 ubox
8 46 0.003930424 ubox
9 22 0.014129634 ubox
9 28 0.030446801 ubox
9 29 0.692220822 ubox
9 33 0.042084376 ubox
9 35 0.045433543 ubox
9 42 0.006112373 ubox
9 45 0.003910955 ubox
10 28 0.689679981 ubox
11 27 0.671975705 ubox
11 83 0.004258137 ubox
12 82 0.004640921 ubox
13 22 0.084113460 ubox
13 29 0.008730279 ubox
13 33 0.074868825 ubox
13 35 0.010599366 ubox
13 44 0.004452839 ubox
14 21 0.087675039 ubox
14 22 0.321349431 ubox
14 23 0.120553457 ubox
14 24 0.538084857 ubox
14 25 0.309162328 ubox
14 28 0.005754197 ubox
14 30 0.006983607 ubox
14 31 0.023673098 ubox
14 32 0.079996515 ubox
14 33 0.004237910 ubox
14 34 0.011262468 ubox
14 35 0.003576307 ubox
14 36 0.003995556 ubox
14 37 0.019495936 ubox
14 38 0.026011994 ubox
14 39 0.030576250 ubox
14 43 0.004964532 ubox
14 85 0.014382293 ubox
15 21 0.356728157 ubox
15 22 0.043495352 ubox
15 23 0.531113467 ubox
15 24 0.308596345 ubox
15 29 0.005432703 ubox
15 30 0.023659301 ubox
15 31 0.079424100 ubox
15 32 0.005217618 ubox
15 33 0.008517638 ubox
15 34 0.003839128 ubox
15 35 0.003250913 ubox
15 36 0.019425188 ubox
15 37 0.026018817 ubox
15 38 0.030392492 ubox
15 42 0.005038124 ubox
15 84 0.014102149 ubox
16 20 0.359774533 ubox
16 41 0.005055035 ubox
16 82 0.007716915 ubox
17 81 0.007303036 ubox
17 82 0.010309221 ubox
18 81 0.010074952 ubox
19 29 0.017437580 ubox
19 33 0.026834987 ubox
19 35 0.017470536 ubox
20 28 0.015615003 ubox
20 32 0.027606558 ubox
20 34 0.017806617 ubox
20 42 0.008308173 ubox
20 43 0.003266064 ubox
21 41 0.009379946 ubox
22 40 0.009058992 ubox
22 77 0.005200188 ubox
22 83 0.008782542 ubox
23 76 0.005292515 ubox
23 82 0.010957705 ubox
24 75 0.005264570 ubox
24 81 0.010596579 ubox
24 82 0.013714111 ubox
25 81 0.013675747 ubox
27 42 0.005105115 ubox
28 41 0.005557345 ubox
28 78 0.013847595 ubox
29 40 0.007629091 ubox
29 77 0.014547961 ubox
29 83 0.030541954 ubox
30 76 0.014402868 ubox
30 82 0.032777108 ubox
31 52 0.007545437 ubox
31 75 0.014167769 ubox
31 76 0.003804241 ubox
31 81 0.032039073 ubox
31 82 0.041000207 ubox
32 41 0.046636626 ubox
32 51 0.007973095 ubox
32 75 0.004442512 ubox
32 81 0.041180496 ubox
32 82 0.004260789 ubox
33 40 0.047661623 ubox
33 50 0.007577151 ubox
33 74 0.004821646 ubox
33 80 0.039854158 ubox
33 83 0.009498910 ubox
34 41 0.033891885 ubox
34 51 0.004569081 ubox
34 81 0.003368276 ubox
34 82 0.010120432 ubox
35 40 0.035003039 ubox
35 50 0.004403243 ubox
35 77 0.043863431 ubox
35 81 0.004892525 ubox
35 83 0.027764896 ubox
36 51 0.003204350 ubox
36 52 0.005118446 ubox
36 76 0.044703682 ubox
36 82 0.030095433 ubox
37 51 0.005488376 ubox
37 52 0.007825963 ubox
37 75 0.044609912 ubox
37 76 0.008979638 ubox
37 81 0.027653617 ubox
37 82 0.016391906 ubox
38 51 0.008386313 ubox
38 52 0.007222904 ubox
38 75 0.009072581 ubox
38 76 0.011525952 ubox
38 81 0.015144345 ubox
38 82 0.022279106 ubox
39 51 0.007735155 ubox
39 75 0.011569122 ubox
39 81 0.020463933 ubox
40 47 0.016221779 ubox
41 46 0.018333307 ubox
41 69 0.006570971 ubox
41 71 0.037729217 ubox
41 73 0.022651315 ubox
41 84 0.953965582 ubox
41 87 0.016731720 ubox
42 68 0.003975761 ubox
42 70 0.037561794 ubox
42 72 0.022111340 ubox
42 77 0.011090751 ubox
42 82 0.251822075 ubox
42 83 0.948008610 ubox
42 86 0.014646064 ubox
43 51 0.009701269 ubox
43 68 0.012291272 ubox
43 76 0.011077361 ubox
43 81 0.371542368 ubox
43 82 0.924623047 ubox
44 50 0.009322489 ubox
44 51 0.003226549 ubox
44 67 0.011836939 ubox
44 68 0.025967575 ubox
44 75 0.010860178 ubox
44 77 0.005097619 ubox
44 78 0.009712829 ubox
44 79 0.028625666 ubox
44 80 0.428685998 ubox
44 81 0.890861145 ubox
44 82 0.003522934 ubox
44 83 0.014523568 ubox
45 66 0.010876511 ubox
45 67 0.027833513 ubox
45 74 0.010500073 ubox
45 76 0.006449150 ubox
45 77 0.014594206 ubox
45 78 0.053230504 ubox
45 79 0.432594815 ubox
45 80 0.788813901 ubox
45 81 0.022215259 ubox
45 82 0.016014976 ubox
45 83 0.008935601 ubox
46 51 0.003945275 ubox
46 66 0.028052106 ubox
46 68 0.034077191 ubox
46 75 0.007226875 ubox
46 76 0.014677771 ubox
46 81 0.020168162 ubox
46 82 0.009441678 ubox
47 67 0.034160138 ubox
47 74 0.007217229 ubox
47 75 0.010924046 ubox
47 76 0.010798797 ubox
47 77 0.976496580 ubox
47 80 0.012967365 ubox
47 81 0.005857442 ubox
48 66 0.033671301 ubox
48 75 0.013310451 ubox
48 76 0.996774717 ubox
49 66 0.005644276 ubox
49 75 0.996377942 ubox
50 60 0.022510042 ubox
50 65 0.007489679 ubox
51 58 0.005105156 ubox
51 59 0.023328064 ubox
51 62 0.031871434 ubox
51 63 0.021405524 ubox
51 85 0.006703158 ubox
52 57 0.005208412 ubox
52 58 0.023228353 ubox
52 59 0.003199243 ubox
52 61 0.032082175 ubox
52 62 0.021090320 ubox
52 65 0.007460789 ubox
52 71 0.041934982 ubox
52 73 0.997067981 ubox
52 84 0.006375109 ubox
52 87 0.013676095 ubox
53 64 0.007601612 ubox
53 70 0.041966755 ubox
53 72 0.997259677 ubox
53 74 0.021144385 ubox
53 83 0.005267877 ubox
53 86 0.014164530 ubox
54 63 0.007612570 ubox
54 69 0.041905733 ubox
54 71 0.997446525 ubox
54 73 0.021476625 ubox
54 84 0.021176883 ubox
54 85 0.010384613 ubox
55 67 0.014475353 ubox
55 68 0.029797622 ubox
55 70 0.991123711 ubox
55 72 0.020922938 ubox
55 83 0.023681948 ubox
56 66 0.018062744 ubox
56 82 0.023872657 ubox
57 81 0.023790479 ubox
57 82 0.004280414 ubox
58 81 0.004474138 ubox
59 68 0.994954733 ubox
60 67 0.995650189 ubox
60 77 0.022699203 ubox
61 66 0.990593087 ubox
61 76 0.023293404 ubox
62 75 0.023250846 ubox
62 76 0.007837054 ubox
63 75 0.007917308 ubox
65 72 0.021783246 ubox
65 74 0.009336183 ubox
66 71 0.021923782 ubox
66 73 0.009666593 ubox
1 22 0.9500000 lbox
2 21 0.9500000 lbox
3 20 0.9500000 lbox
5 16 0.9500000 lbox
6 15 0.9500000 lbox
41 84 0.9500000 lbox
42 83 0.9500000 lbox
43 82 0.9500000 lbox
44 81 0.9500000 lbox
45 80 0.9500000 lbox
47 77 0.9500000 lbox
48 76 0.9500000 lbox
49 75 0.9500000 lbox
52 73 0.9500000 lbox
53 72 0.9500000 lbox
54 71 0.9500000 lbox
55 70 0.9500000 lbox
59 68 0.9500000 lbox
60 67 0.9500000 lbox
61 66 0.9500000 lbox
showpage
end
%%EOF
