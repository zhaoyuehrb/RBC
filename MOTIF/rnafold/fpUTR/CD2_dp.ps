%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 04:11:34 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (CD2)
} def

/sequence { (\
AGUCUCACUUCAGUUCCUUUUGCAUGAAGAGCUCAGAAUCAAAAGAGGAAACCAACCCCUAAG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 9 0.180027050 ubox
1 10 0.019945846 ubox
1 15 0.007750025 ubox
1 33 0.184990893 ubox
1 60 0.063308545 ubox
2 8 0.209724577 ubox
2 9 0.021664805 ubox
2 14 0.014333506 ubox
2 32 0.212749084 ubox
2 39 0.024718393 ubox
2 52 0.085097997 ubox
2 56 0.043055667 ubox
2 59 0.066697108 ubox
3 7 0.189125840 ubox
3 13 0.004842869 ubox
3 30 0.027711354 ubox
3 31 0.082065910 ubox
3 37 0.111641693 ubox
3 38 0.020584852 ubox
3 46 0.070677255 ubox
3 48 0.107316047 ubox
3 49 0.032939927 ubox
3 51 0.083380695 ubox
3 55 0.041338821 ubox
4 13 0.092661921 ubox
4 29 0.030326843 ubox
4 31 0.217493005 ubox
4 36 0.120106154 ubox
4 45 0.082696586 ubox
4 47 0.137886469 ubox
4 48 0.033541848 ubox
4 63 0.040253792 ubox
5 12 0.088988609 ubox
5 27 0.020273111 ubox
5 28 0.023894936 ubox
5 30 0.214582345 ubox
5 35 0.116165938 ubox
5 37 0.047035199 ubox
5 44 0.079826005 ubox
5 46 0.138865826 ubox
5 47 0.026463345 ubox
5 48 0.010821555 ubox
5 49 0.071634338 ubox
5 62 0.039708438 ubox
6 26 0.026365492 ubox
6 29 0.178417663 ubox
6 36 0.048889775 ubox
6 45 0.138453143 ubox
6 47 0.017796679 ubox
6 48 0.073296168 ubox
7 14 0.058854847 ubox
7 25 0.025235418 ubox
8 13 0.070140785 ubox
8 29 0.295210653 ubox
8 31 0.012965650 ubox
8 36 0.111772845 ubox
8 45 0.052321010 ubox
8 47 0.052516341 ubox
8 48 0.061890598 ubox
8 63 0.101323819 ubox
9 27 0.007645545 ubox
9 28 0.333760828 ubox
9 30 0.011555790 ubox
9 31 0.004455703 ubox
9 35 0.107303697 ubox
9 36 0.086010444 ubox
9 37 0.036798010 ubox
9 38 0.240997529 ubox
9 42 0.043571406 ubox
9 43 0.041909713 ubox
9 44 0.051789569 ubox
9 45 0.004222435 ubox
9 46 0.050169938 ubox
9 47 0.062617980 ubox
9 49 0.012763172 ubox
9 50 0.049619137 ubox
9 51 0.020509746 ubox
9 55 0.140774872 ubox
9 62 0.102445505 ubox
9 63 0.010432857 ubox
10 26 0.006350223 ubox
10 27 0.347293493 ubox
10 29 0.006737185 ubox
10 30 0.005015042 ubox
10 35 0.101927043 ubox
10 36 0.036935515 ubox
10 37 0.275911906 ubox
10 41 0.037217206 ubox
10 42 0.044124399 ubox
10 43 0.044909825 ubox
10 44 0.004474380 ubox
10 45 0.036599318 ubox
10 46 0.064380934 ubox
10 48 0.013357775 ubox
10 49 0.054548299 ubox
10 50 0.019060188 ubox
10 54 0.155630900 ubox
10 61 0.098368650 ubox
10 62 0.016508273 ubox
11 22 0.030187321 ubox
11 26 0.347700931 ubox
11 29 0.005063483 ubox
11 36 0.278141205 ubox
11 45 0.064945321 ubox
11 47 0.013332673 ubox
11 48 0.054831303 ubox
12 18 0.003394294 ubox
12 20 0.003458470 ubox
12 21 0.030405064 ubox
12 25 0.344932235 ubox
12 33 0.357988357 ubox
12 60 0.095708375 ubox
13 17 0.004149476 ubox
13 19 0.005483087 ubox
13 20 0.029357788 ubox
13 23 0.324408751 ubox
13 25 0.005506840 ubox
13 32 0.380795831 ubox
13 39 0.097858244 ubox
13 52 0.451203333 ubox
13 56 0.061722477 ubox
13 59 0.096938375 ubox
14 22 0.323043601 ubox
14 24 0.008902041 ubox
14 28 0.005171019 ubox
14 31 0.380460873 ubox
14 36 0.005836843 ubox
14 37 0.005318184 ubox
14 38 0.100957720 ubox
14 42 0.010748740 ubox
14 46 0.008899842 ubox
14 47 0.032883795 ubox
14 48 0.016179339 ubox
14 49 0.166387607 ubox
14 50 0.624640385 ubox
14 51 0.369159799 ubox
14 55 0.055869193 ubox
14 62 0.003514502 ubox
15 27 0.005877243 ubox
15 30 0.378659433 ubox
15 35 0.006095448 ubox
15 36 0.004989575 ubox
15 37 0.101646224 ubox
15 41 0.010435076 ubox
15 45 0.003468567 ubox
15 46 0.047262926 ubox
15 47 0.021054122 ubox
15 48 0.180951668 ubox
15 49 0.745488905 ubox
15 50 0.260497175 ubox
15 54 0.024327838 ubox
16 26 0.005909789 ubox
16 29 0.310617043 ubox
16 36 0.101166651 ubox
16 45 0.035455946 ubox
16 47 0.190096128 ubox
16 48 0.796290351 ubox
17 29 0.220693141 ubox
17 31 0.097277661 ubox
17 36 0.011356477 ubox
17 45 0.294368857 ubox
17 47 0.794401781 ubox
17 48 0.019417163 ubox
18 27 0.199905372 ubox
18 28 0.308545785 ubox
18 29 0.008455230 ubox
18 30 0.097632792 ubox
18 31 0.008956130 ubox
18 35 0.013585429 ubox
18 36 0.004386016 ubox
18 37 0.006349553 ubox
18 38 0.013941147 ubox
18 43 0.006816085 ubox
18 44 0.312641434 ubox
18 45 0.040851450 ubox
18 46 0.784553372 ubox
18 47 0.019369115 ubox
19 26 0.199067442 ubox
19 27 0.309826742 ubox
19 28 0.043772037 ubox
19 29 0.097566750 ubox
19 30 0.011680299 ubox
19 31 0.003525907 ubox
19 35 0.011788459 ubox
19 36 0.007225563 ubox
19 37 0.016374613 ubox
19 38 0.006259979 ubox
19 41 0.004524151 ubox
19 42 0.010873563 ubox
19 43 0.360962120 ubox
19 44 0.062814365 ubox
19 45 0.757618516 ubox
19 46 0.025974657 ubox
20 26 0.306483830 ubox
20 27 0.051251683 ubox
20 28 0.100293178 ubox
20 29 0.012590784 ubox
20 30 0.004460973 ubox
20 31 0.005218052 ubox
20 35 0.009082509 ubox
20 36 0.017789418 ubox
20 37 0.009514354 ubox
20 38 0.008165688 ubox
20 41 0.014295852 ubox
20 42 0.440235442 ubox
20 43 0.078006777 ubox
20 44 0.703572555 ubox
20 45 0.031011285 ubox
20 46 0.004052742 ubox
21 26 0.049187094 ubox
21 27 0.099953352 ubox
21 28 0.017276245 ubox
21 29 0.004620077 ubox
21 30 0.006482164 ubox
21 35 0.017486531 ubox
21 36 0.010230403 ubox
21 37 0.009569633 ubox
21 41 0.493834691 ubox
21 42 0.086637429 ubox
21 43 0.663949800 ubox
21 44 0.034074659 ubox
21 45 0.006516599 ubox
22 32 0.147986373 ubox
22 34 0.014704772 ubox
22 40 0.508821688 ubox
23 31 0.148152467 ubox
24 39 0.164516213 ubox
25 35 0.692846641 ubox
25 38 0.150208059 ubox
25 41 0.330242895 ubox
26 34 0.699377457 ubox
26 40 0.348647334 ubox
27 33 0.678248340 ubox
27 39 0.331826989 ubox
29 40 0.096687716 ubox
30 39 0.097840388 ubox
30 60 0.006052879 ubox
31 59 0.006212324 ubox
32 45 0.014726772 ubox
32 47 0.102795602 ubox
32 48 0.006858401 ubox
32 63 0.007173180 ubox
33 44 0.014292351 ubox
33 46 0.104665314 ubox
33 47 0.005169037 ubox
33 48 0.004654452 ubox
33 49 0.008111334 ubox
33 62 0.007229949 ubox
34 45 0.105506025 ubox
34 47 0.006690187 ubox
34 48 0.008831325 ubox
35 60 0.010745713 ubox
36 59 0.011164495 ubox
39 46 0.064079052 ubox
39 48 0.011948948 ubox
39 49 0.021065657 ubox
40 45 0.074545452 ubox
40 47 0.019133143 ubox
40 48 0.022434934 ubox
44 60 0.350568564 ubox
45 59 0.363226466 ubox
46 60 0.295594289 ubox
47 53 0.082606938 ubox
47 57 0.196801972 ubox
47 58 0.358497876 ubox
47 59 0.305099258 ubox
47 60 0.018668261 ubox
48 52 0.081456793 ubox
48 56 0.196799379 ubox
48 57 0.359831023 ubox
48 58 0.303324671 ubox
48 59 0.020030323 ubox
14 50 0.9500000 lbox
15 49 0.9500000 lbox
16 48 0.9500000 lbox
17 47 0.9500000 lbox
18 46 0.9500000 lbox
19 45 0.9500000 lbox
20 44 0.9500000 lbox
21 43 0.9500000 lbox
25 35 0.9500000 lbox
26 34 0.9500000 lbox
27 33 0.9500000 lbox
showpage
end
%%EOF
