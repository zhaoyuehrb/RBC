%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 02:50:57 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (CKAP2L)
} def

/sequence { (\
AAUGAGGACGCGUGGACGCGCGGCACGCCGGUCCUGGCUACAGGCGCGGCGUUUGAAGAAAAACUGUCACUGAAGAGUC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 53 0.004144915 ubox
1 54 0.010666988 ubox
2 13 0.005183541 ubox
2 53 0.010395566 ubox
2 67 0.032411773 ubox
2 78 0.023061387 ubox
3 10 0.007020593 ubox
3 12 0.005298910 ubox
3 22 0.008646903 ubox
3 25 0.031974542 ubox
3 55 0.010152134 ubox
3 66 0.032409316 ubox
3 69 0.153249214 ubox
3 72 0.031456331 ubox
3 77 0.022395132 ubox
4 9 0.017045092 ubox
4 11 0.005871808 ubox
4 21 0.014844078 ubox
4 24 0.054250045 ubox
4 26 0.029299964 ubox
4 53 0.006291038 ubox
4 54 0.021323287 ubox
4 65 0.017189334 ubox
4 68 0.202403235 ubox
4 71 0.038475354 ubox
4 79 0.055367586 ubox
5 35 0.037092707 ubox
5 52 0.004506468 ubox
5 53 0.021269939 ubox
5 54 0.016169661 ubox
5 65 0.106512779 ubox
5 67 0.188735813 ubox
5 71 0.452049673 ubox
5 78 0.047475029 ubox
6 34 0.038102237 ubox
6 52 0.009637716 ubox
6 53 0.015370855 ubox
6 54 0.010838099 ubox
6 64 0.112282514 ubox
6 65 0.116233863 ubox
6 68 0.063022024 ubox
6 70 0.463616024 ubox
6 71 0.042589006 ubox
6 79 0.043051742 ubox
7 33 0.038107278 ubox
7 52 0.006675045 ubox
7 53 0.012741423 ubox
7 54 0.014113336 ubox
7 64 0.127902807 ubox
7 67 0.048227051 ubox
7 68 0.576517732 ubox
7 70 0.045359204 ubox
7 78 0.027003095 ubox
7 79 0.121046872 ubox
8 32 0.038062408 ubox
8 52 0.009447286 ubox
8 53 0.013642501 ubox
8 67 0.574836814 ubox
8 78 0.119337096 ubox
9 20 0.242475654 ubox
9 22 0.758251692 ubox
9 30 0.007456214 ubox
9 31 0.036992458 ubox
9 51 0.006598335 ubox
9 55 0.005728947 ubox
9 66 0.561839882 ubox
9 72 0.008911657 ubox
9 77 0.112853476 ubox
10 19 0.273997061 ubox
10 21 0.825780898 ubox
10 24 0.273094684 ubox
10 26 0.007465296 ubox
10 28 0.036764995 ubox
10 29 0.007407406 ubox
10 38 0.004589106 ubox
10 50 0.004286813 ubox
10 65 0.314571785 ubox
10 67 0.006457071 ubox
10 71 0.006945490 ubox
11 18 0.274101052 ubox
11 20 0.826383379 ubox
11 22 0.394225597 ubox
11 23 0.194974932 ubox
11 27 0.037790143 ubox
11 37 0.004624976 ubox
11 49 0.004187766 ubox
11 66 0.006725429 ubox
11 72 0.005710950 ubox
12 17 0.267027992 ubox
12 19 0.825271765 ubox
12 21 0.442018978 ubox
12 24 0.005781007 ubox
12 26 0.040397024 ubox
12 28 0.003730287 ubox
12 64 0.204863663 ubox
12 70 0.014107133 ubox
12 71 0.003415104 ubox
13 18 0.791321194 ubox
13 20 0.442115197 ubox
13 22 0.023705257 ubox
13 23 0.004906628 ubox
13 25 0.040400816 ubox
13 27 0.003794738 ubox
13 63 0.203483504 ubox
13 69 0.014005061 ubox
14 19 0.440990556 ubox
14 21 0.027156181 ubox
14 24 0.040392155 ubox
14 26 0.003843421 ubox
14 34 0.005225870 ubox
14 68 0.011608936 ubox
14 71 0.003196161 ubox
15 33 0.005274581 ubox
15 67 0.007430084 ubox
15 68 0.012643932 ubox
15 79 0.004776579 ubox
16 32 0.005274295 ubox
16 67 0.014899401 ubox
16 78 0.004844478 ubox
17 31 0.005183926 ubox
17 48 0.004649439 ubox
17 66 0.015658310 ubox
17 77 0.004850350 ubox
18 24 0.014650856 ubox
18 47 0.004689748 ubox
18 65 0.011732230 ubox
19 23 0.014591248 ubox
19 46 0.004690268 ubox
19 55 0.009115748 ubox
20 26 0.004808861 ubox
20 28 0.005635991 ubox
20 45 0.004688487 ubox
20 54 0.007961944 ubox
20 67 0.015282585 ubox
21 27 0.005765462 ubox
21 30 0.004634551 ubox
21 44 0.004674098 ubox
21 55 0.278817866 ubox
21 66 0.027057536 ubox
21 72 0.027216806 ubox
22 26 0.011302136 ubox
22 29 0.005400204 ubox
22 53 0.016717804 ubox
22 54 0.283903059 ubox
22 65 0.028944036 ubox
22 68 0.144642536 ubox
22 71 0.027291654 ubox
22 79 0.040549687 ubox
23 28 0.005371445 ubox
23 50 0.012585410 ubox
23 52 0.021143340 ubox
23 53 0.296139182 ubox
23 64 0.030048265 ubox
23 67 0.160789401 ubox
23 70 0.028083057 ubox
23 78 0.066463169 ubox
24 49 0.012564304 ubox
24 51 0.018678046 ubox
24 55 0.178078517 ubox
24 66 0.162094150 ubox
24 72 0.017266725 ubox
24 77 0.067917304 ubox
25 52 0.885549472 ubox
25 54 0.117828879 ubox
25 65 0.118519583 ubox
25 67 0.013503432 ubox
25 71 0.011382214 ubox
25 78 0.009186931 ubox
26 48 0.012489284 ubox
26 51 0.962235203 ubox
26 66 0.014435078 ubox
26 77 0.009743850 ubox
27 38 0.005105077 ubox
27 47 0.012560855 ubox
27 50 0.999048943 ubox
28 37 0.005115018 ubox
28 46 0.011713347 ubox
28 49 0.999148215 ubox
29 36 0.005113255 ubox
29 46 0.004486337 ubox
29 48 0.999133092 ubox
30 35 0.003895712 ubox
30 45 0.005977422 ubox
30 47 0.997861513 ubox
31 45 0.333061326 ubox
31 47 0.037162476 ubox
32 44 0.052443970 ubox
32 46 0.051996764 ubox
33 43 0.037286307 ubox
33 44 0.997633339 ubox
34 43 0.998532172 ubox
35 42 0.998927376 ubox
36 41 0.998535425 ubox
36 79 0.032144719 ubox
37 45 0.003566937 ubox
37 78 0.033976364 ubox
38 44 0.003572867 ubox
38 75 0.015238044 ubox
38 77 0.034093330 ubox
39 43 0.003219063 ubox
39 74 0.015234129 ubox
39 76 0.033650960 ubox
41 72 0.037732642 ubox
42 71 0.037870326 ubox
43 70 0.037873035 ubox
43 71 0.003796490 ubox
44 70 0.003863093 ubox
46 67 0.037532553 ubox
47 66 0.037731920 ubox
48 65 0.037215689 ubox
48 68 0.007148054 ubox
49 64 0.036226051 ubox
49 67 0.007393429 ubox
50 66 0.007642026 ubox
51 64 0.258761552 ubox
51 65 0.003337146 ubox
51 70 0.006475540 ubox
52 58 0.009427033 ubox
52 59 0.020618035 ubox
52 60 0.029726055 ubox
52 61 0.090142701 ubox
52 62 0.077388851 ubox
52 63 0.271009208 ubox
52 69 0.005957871 ubox
52 73 0.012819309 ubox
52 74 0.013799485 ubox
52 75 0.009105692 ubox
52 76 0.025623420 ubox
52 77 0.009093997 ubox
53 57 0.015857253 ubox
53 58 0.028320329 ubox
53 59 0.053234541 ubox
53 60 0.155701509 ubox
53 61 0.139662642 ubox
53 62 0.308468697 ubox
53 63 0.069887220 ubox
53 72 0.018346959 ubox
53 73 0.025455232 ubox
53 74 0.020086558 ubox
53 75 0.038631361 ubox
53 76 0.024039394 ubox
53 77 0.006976599 ubox
54 58 0.050053019 ubox
54 59 0.164635860 ubox
54 60 0.149623979 ubox
54 61 0.313137608 ubox
54 62 0.081898565 ubox
54 66 0.007546461 ubox
54 69 0.245875110 ubox
54 72 0.023777010 ubox
54 73 0.020008828 ubox
54 74 0.041583308 ubox
54 75 0.024680401 ubox
54 76 0.008742589 ubox
55 65 0.011341318 ubox
55 68 0.307810695 ubox
55 71 0.016675840 ubox
55 79 0.013161062 ubox
56 67 0.293407836 ubox
56 78 0.011947576 ubox
57 65 0.346383928 ubox
57 71 0.058054810 ubox
58 64 0.352782105 ubox
58 68 0.134762564 ubox
58 70 0.058445052 ubox
58 79 0.050027531 ubox
59 67 0.130230760 ubox
59 78 0.049027902 ubox
63 78 0.255943474 ubox
64 75 0.187056563 ubox
64 77 0.271498783 ubox
65 72 0.011018213 ubox
65 74 0.187994662 ubox
65 76 0.265581029 ubox
66 71 0.010531540 ubox
66 78 0.014853618 ubox
67 73 0.150519594 ubox
67 76 0.146859078 ubox
67 77 0.003639760 ubox
68 72 0.151878913 ubox
68 75 0.161026208 ubox
69 78 0.562164631 ubox
70 77 0.613534693 ubox
71 76 0.608142242 ubox
72 79 0.071813493 ubox
73 78 0.066528929 ubox
9 22 0.9500000 lbox
10 21 0.9500000 lbox
11 20 0.9500000 lbox
12 19 0.9500000 lbox
13 18 0.9500000 lbox
25 52 0.9500000 lbox
26 51 0.9500000 lbox
27 50 0.9500000 lbox
28 49 0.9500000 lbox
29 48 0.9500000 lbox
30 47 0.9500000 lbox
33 44 0.9500000 lbox
34 43 0.9500000 lbox
35 42 0.9500000 lbox
36 41 0.9500000 lbox
69 78 0.9500000 lbox
70 77 0.9500000 lbox
71 76 0.9500000 lbox
showpage
end
%%EOF
