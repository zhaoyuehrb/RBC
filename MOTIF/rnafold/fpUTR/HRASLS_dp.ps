%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:08:00 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (HRASLS)
} def

/sequence { (\
GCGGGCGGGCGGGCGAAGCUGGGCUCGGGGCCAAGCGAGGUCUAGCCGGAGCGACUGUGCCCCGCCUCCUGGGCGGAGCGGGCGGCUCCCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 10 0.008407864 ubox
1 19 0.007396008 ubox
1 36 0.013878323 ubox
1 65 0.003333073 ubox
1 74 0.130820382 ubox
2 9 0.008417358 ubox
2 18 0.007405909 ubox
2 27 0.010467023 ubox
2 35 0.013883341 ubox
2 64 0.003351088 ubox
2 71 0.974699548 ubox
2 73 0.126974060 ubox
3 26 0.010662427 ubox
3 47 0.003759741 ubox
3 63 0.003186424 ubox
3 67 0.031597598 ubox
3 68 0.008713051 ubox
3 69 0.035861029 ubox
3 70 0.988140081 ubox
3 90 0.008365116 ubox
3 91 0.039949264 ubox
4 25 0.010658775 ubox
4 32 0.014057037 ubox
4 46 0.003578106 ubox
4 47 0.023701481 ubox
4 61 0.003292892 ubox
4 66 0.034738548 ubox
4 68 0.035690751 ubox
4 69 0.990624556 ubox
4 70 0.059977283 ubox
4 89 0.007430260 ubox
4 90 0.040183505 ubox
4 91 0.011859883 ubox
5 14 0.009408792 ubox
5 24 0.010666250 ubox
5 31 0.014075752 ubox
5 46 0.023743864 ubox
5 60 0.003485458 ubox
5 65 0.034835256 ubox
5 67 0.018939454 ubox
5 68 0.989868879 ubox
5 69 0.061685270 ubox
5 88 0.003744920 ubox
5 89 0.028278533 ubox
5 90 0.011912042 ubox
6 13 0.009415283 ubox
6 23 0.010658476 ubox
6 27 0.004555614 ubox
6 30 0.014055059 ubox
6 45 0.023686320 ubox
6 48 0.024624232 ubox
6 59 0.003660182 ubox
6 64 0.034875442 ubox
6 71 0.004270109 ubox
7 26 0.006901506 ubox
7 43 0.008440541 ubox
7 47 0.034349497 ubox
7 62 0.013895760 ubox
7 63 0.032033337 ubox
7 66 0.141162685 ubox
7 67 0.966986744 ubox
7 68 0.014981149 ubox
7 70 0.004004965 ubox
7 88 0.012112552 ubox
7 90 0.003613003 ubox
8 20 0.010304159 ubox
8 25 0.006918297 ubox
8 42 0.009421171 ubox
8 43 0.003881808 ubox
8 46 0.033870891 ubox
8 47 0.097466661 ubox
8 61 0.019530985 ubox
8 62 0.027576371 ubox
8 65 0.131252680 ubox
8 66 0.983232562 ubox
8 69 0.003913908 ubox
8 87 0.012046080 ubox
9 19 0.010505438 ubox
9 24 0.006933771 ubox
9 41 0.009367123 ubox
9 42 0.003580662 ubox
9 46 0.097736516 ubox
9 58 0.004384245 ubox
9 60 0.023863838 ubox
9 61 0.022134797 ubox
9 65 0.984665359 ubox
9 68 0.003878196 ubox
9 86 0.012060815 ubox
10 18 0.010522133 ubox
10 23 0.006925022 ubox
10 27 0.017945325 ubox
10 40 0.009376473 ubox
10 45 0.097847446 ubox
10 57 0.009446412 ubox
10 59 0.027485126 ubox
10 64 0.985921795 ubox
10 85 0.012028224 ubox
11 26 0.021283461 ubox
11 43 0.093836387 ubox
11 56 0.010127288 ubox
11 58 0.023446752 ubox
11 62 0.502913984 ubox
11 63 0.856536060 ubox
11 67 0.003807145 ubox
12 20 0.007491079 ubox
12 25 0.021310256 ubox
12 42 0.104689665 ubox
12 43 0.006741139 ubox
12 55 0.010378020 ubox
12 56 0.012468392 ubox
12 61 0.700925205 ubox
12 62 0.703965024 ubox
12 66 0.003871435 ubox
13 19 0.007964070 ubox
13 24 0.021337200 ubox
13 41 0.104878625 ubox
13 42 0.007226385 ubox
13 52 0.007310226 ubox
13 55 0.013417965 ubox
13 58 0.033617323 ubox
13 60 0.854078723 ubox
13 61 0.506366843 ubox
13 65 0.003877011 ubox
13 83 0.003493414 ubox
14 18 0.007952149 ubox
14 21 0.003428291 ubox
14 23 0.021336967 ubox
14 27 0.005543429 ubox
14 40 0.105137083 ubox
14 48 0.029904302 ubox
14 51 0.008154161 ubox
14 53 0.016229637 ubox
14 57 0.093173275 ubox
14 59 0.983461350 ubox
14 64 0.003879686 ubox
14 82 0.003489909 ubox
15 26 0.005644709 ubox
15 47 0.029770178 ubox
15 52 0.015629234 ubox
15 56 0.090818820 ubox
15 58 0.952990538 ubox
15 63 0.003740905 ubox
16 25 0.004093388 ubox
17 25 0.004040337 ubox
17 56 0.200476194 ubox
18 24 0.005625272 ubox
18 36 0.106177224 ubox
18 46 0.081636201 ubox
18 52 0.970869330 ubox
18 55 0.169882611 ubox
18 58 0.053007276 ubox
18 60 0.023418558 ubox
19 23 0.005585544 ubox
19 35 0.106200720 ubox
19 45 0.082056950 ubox
19 49 0.042824911 ubox
19 51 0.972723074 ubox
19 57 0.054821071 ubox
19 59 0.023418016 ubox
20 33 0.007642160 ubox
20 34 0.098109747 ubox
20 44 0.082020381 ubox
20 48 0.043632523 ubox
20 50 0.956886125 ubox
20 53 0.051235347 ubox
20 57 0.015570154 ubox
21 32 0.009944172 ubox
21 42 0.010387451 ubox
21 43 0.081466250 ubox
21 47 0.042949619 ubox
21 52 0.047293691 ubox
21 56 0.022156023 ubox
22 31 0.009000689 ubox
22 32 0.105449688 ubox
22 41 0.010455985 ubox
22 42 0.081476264 ubox
22 46 0.032094455 ubox
22 47 0.973631588 ubox
22 55 0.022444780 ubox
23 31 0.105882210 ubox
23 41 0.079369882 ubox
23 46 0.974780723 ubox
23 52 0.171901755 ubox
24 30 0.105938308 ubox
24 39 0.056857755 ubox
24 40 0.059327306 ubox
24 45 0.975037811 ubox
24 49 0.015471932 ubox
24 51 0.172106446 ubox
25 29 0.095438284 ubox
25 38 0.077599574 ubox
25 39 0.026343754 ubox
25 44 0.926222491 ubox
25 48 0.004604714 ubox
25 49 0.040614302 ubox
25 50 0.167456522 ubox
26 37 0.081813333 ubox
26 39 0.004568496 ubox
26 48 0.092184799 ubox
26 49 0.146444862 ubox
27 36 0.081752374 ubox
27 42 0.030689496 ubox
27 43 0.156401799 ubox
27 47 0.122752834 ubox
27 63 0.011177009 ubox
28 41 0.012443621 ubox
28 42 0.129438256 ubox
28 43 0.913183915 ubox
28 46 0.119255476 ubox
28 47 0.117437442 ubox
28 62 0.011221638 ubox
29 41 0.091326080 ubox
29 42 0.974309871 ubox
29 43 0.025442249 ubox
29 46 0.110956009 ubox
29 47 0.023486405 ubox
29 61 0.011237264 ubox
30 36 0.009697114 ubox
30 41 0.984869848 ubox
30 42 0.033720785 ubox
30 46 0.024868692 ubox
30 60 0.011241240 ubox
31 35 0.009696114 ubox
31 40 0.990230733 ubox
31 45 0.026042630 ubox
31 59 0.011236342 ubox
32 39 0.989366621 ubox
32 57 0.010840909 ubox
33 56 0.010243780 ubox
34 43 0.016573324 ubox
35 41 0.017232976 ubox
35 42 0.016866091 ubox
35 52 0.010792650 ubox
36 40 0.018891802 ubox
36 51 0.010801057 ubox
36 53 0.003633005 ubox
37 52 0.003550842 ubox
39 47 0.017893315 ubox
39 56 0.009174144 ubox
40 46 0.017907795 ubox
40 55 0.009937243 ubox
41 45 0.016753321 ubox
41 54 0.009961484 ubox
42 53 0.009897913 ubox
45 52 0.009518009 ubox
45 60 0.006824168 ubox
46 51 0.009540844 ubox
46 59 0.006851708 ubox
47 53 0.018581211 ubox
47 57 0.052821930 ubox
47 59 0.008972359 ubox
48 52 0.017614549 ubox
48 56 0.053661916 ubox
48 58 0.010970110 ubox
48 61 0.008587781 ubox
48 62 0.005783070 ubox
48 89 0.104258253 ubox
48 90 0.006461898 ubox
49 55 0.053599752 ubox
49 60 0.010147468 ubox
49 61 0.006824278 ubox
49 88 0.108273838 ubox
49 89 0.004613286 ubox
50 56 0.013448697 ubox
50 87 0.108432683 ubox
51 55 0.013292964 ubox
51 58 0.015338273 ubox
51 60 0.041643370 ubox
51 86 0.108453307 ubox
52 57 0.016601807 ubox
52 59 0.041728510 ubox
52 84 0.020087663 ubox
52 85 0.106566356 ubox
53 58 0.029639053 ubox
53 83 0.028140956 ubox
55 81 0.026597425 ubox
55 82 0.099308302 ubox
56 80 0.025930988 ubox
56 81 0.092001079 ubox
56 84 0.004559369 ubox
57 79 0.024236301 ubox
57 83 0.004660736 ubox
58 78 0.023911854 ubox
58 80 0.081494925 ubox
58 82 0.004081514 ubox
58 84 0.009551579 ubox
59 79 0.105277378 ubox
59 83 0.009961030 ubox
60 78 0.105268898 ubox
60 82 0.009004630 ubox
61 76 0.006992009 ubox
61 81 0.007927061 ubox
61 82 0.005233275 ubox
62 75 0.005025348 ubox
62 76 0.107828666 ubox
62 80 0.005783004 ubox
62 81 0.006993650 ubox
63 75 0.108110031 ubox
63 80 0.008326698 ubox
63 84 0.010596405 ubox
64 74 0.108284035 ubox
64 79 0.009357989 ubox
64 83 0.010722141 ubox
65 72 0.005852883 ubox
65 73 0.108135174 ubox
65 78 0.006637725 ubox
65 82 0.010718124 ubox
66 71 0.008184520 ubox
66 72 0.107954534 ubox
66 78 0.007125595 ubox
66 81 0.010578460 ubox
67 71 0.097254724 ubox
67 77 0.010165711 ubox
67 80 0.009728051 ubox
68 76 0.010459033 ubox
69 75 0.010451722 ubox
69 78 0.009785970 ubox
70 77 0.009740992 ubox
71 90 0.004018255 ubox
71 91 0.031952797 ubox
72 89 0.003974877 ubox
72 90 0.045149852 ubox
72 91 0.944736305 ubox
73 88 0.003243649 ubox
73 89 0.032806166 ubox
73 90 0.955576917 ubox
75 88 0.010785339 ubox
75 89 0.993031421 ubox
75 90 0.017443547 ubox
76 87 0.004679868 ubox
76 88 0.993856333 ubox
76 89 0.012394888 ubox
77 87 0.993852255 ubox
78 86 0.994003526 ubox
79 85 0.993864370 ubox
2 71 0.9500000 lbox
3 70 0.9500000 lbox
4 69 0.9500000 lbox
5 68 0.9500000 lbox
7 67 0.9500000 lbox
8 66 0.9500000 lbox
9 65 0.9500000 lbox
10 64 0.9500000 lbox
11 63 0.9500000 lbox
12 62 0.9500000 lbox
13 61 0.9500000 lbox
14 59 0.9500000 lbox
15 58 0.9500000 lbox
18 52 0.9500000 lbox
19 51 0.9500000 lbox
20 50 0.9500000 lbox
22 47 0.9500000 lbox
23 46 0.9500000 lbox
24 45 0.9500000 lbox
25 44 0.9500000 lbox
28 43 0.9500000 lbox
29 42 0.9500000 lbox
30 41 0.9500000 lbox
31 40 0.9500000 lbox
32 39 0.9500000 lbox
72 91 0.9500000 lbox
73 90 0.9500000 lbox
75 89 0.9500000 lbox
76 88 0.9500000 lbox
77 87 0.9500000 lbox
78 86 0.9500000 lbox
79 85 0.9500000 lbox
showpage
end
%%EOF
