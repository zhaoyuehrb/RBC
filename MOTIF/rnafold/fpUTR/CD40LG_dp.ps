%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:16:54 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (CD40LG)
} def

/sequence { (\
ACUUUGACAGUCUUCUCAUGCUGCCUCUGCCACCUUCUCUGCCAGAAGAUACCAUUUCAACUUUAACACAGC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 11 0.037618203 ubox
2 10 0.049348481 ubox
2 45 0.004321739 ubox
2 48 0.083504030 ubox
2 71 0.102329467 ubox
3 9 0.048646522 ubox
3 10 0.006539290 ubox
3 44 0.003416142 ubox
3 46 0.105905344 ubox
3 47 0.075593017 ubox
3 48 0.004582398 ubox
3 49 0.009108046 ubox
3 60 0.033185909 ubox
3 66 0.014111203 ubox
3 70 0.100339063 ubox
3 71 0.009722684 ubox
4 9 0.013745487 ubox
4 10 0.004155741 ubox
4 45 0.117299718 ubox
4 46 0.064593250 ubox
4 47 0.004961727 ubox
4 48 0.009391141 ubox
4 49 0.003945418 ubox
4 59 0.031653027 ubox
4 60 0.392497097 ubox
4 65 0.013644454 ubox
4 66 0.062589053 ubox
4 70 0.010501014 ubox
4 71 0.050233245 ubox
5 9 0.009609572 ubox
5 18 0.082956410 ubox
5 29 0.008588335 ubox
5 32 0.058473947 ubox
5 44 0.126828764 ubox
5 45 0.054024078 ubox
5 46 0.003800898 ubox
5 47 0.008738164 ubox
5 48 0.003222381 ubox
5 51 0.016580435 ubox
5 54 0.235097019 ubox
5 59 0.460204609 ubox
5 65 0.072108142 ubox
5 68 0.089959749 ubox
5 70 0.063775970 ubox
6 12 0.022179251 ubox
6 14 0.004350053 ubox
6 15 0.036174315 ubox
6 17 0.092804070 ubox
6 27 0.131697434 ubox
6 28 0.004032831 ubox
6 31 0.065833557 ubox
6 37 0.003893169 ubox
6 43 0.130341144 ubox
6 50 0.011065116 ubox
6 53 0.259746924 ubox
6 56 0.037333595 ubox
6 57 0.024864796 ubox
6 58 0.471040391 ubox
6 63 0.009873555 ubox
6 64 0.072872424 ubox
6 67 0.091716153 ubox
6 69 0.065691864 ubox
7 11 0.019356946 ubox
7 13 0.004682900 ubox
7 14 0.033912823 ubox
7 16 0.090203322 ubox
7 26 0.125804325 ubox
7 36 0.003867439 ubox
7 55 0.041170635 ubox
7 56 0.043340403 ubox
7 57 0.453772986 ubox
7 62 0.010179398 ubox
7 63 0.069623893 ubox
8 20 0.016456927 ubox
8 23 0.431273896 ubox
8 29 0.076673176 ubox
8 41 0.139223974 ubox
9 16 0.038688609 ubox
9 19 0.016212099 ubox
9 22 0.433953711 ubox
9 28 0.076813472 ubox
9 40 0.139475756 ubox
9 56 0.105997737 ubox
9 57 0.010417668 ubox
9 62 0.060784903 ubox
9 63 0.007284511 ubox
9 64 0.016709818 ubox
10 15 0.044858743 ubox
10 19 0.006857171 ubox
10 21 0.434286303 ubox
10 24 0.006133956 ubox
10 27 0.076616572 ubox
10 30 0.004053108 ubox
10 33 0.003892717 ubox
10 39 0.139275633 ubox
10 50 0.830487462 ubox
10 52 0.080137716 ubox
10 55 0.062756930 ubox
10 56 0.011685455 ubox
10 61 0.061959092 ubox
10 62 0.004658766 ubox
10 63 0.013019341 ubox
10 67 0.010316765 ubox
10 69 0.008409717 ubox
10 72 0.003646041 ubox
11 18 0.008600202 ubox
11 20 0.429916286 ubox
11 23 0.006111059 ubox
11 29 0.003953178 ubox
11 32 0.003745409 ubox
11 49 0.859207484 ubox
11 51 0.054404283 ubox
11 54 0.040122792 ubox
11 60 0.055670926 ubox
11 66 0.008873860 ubox
11 68 0.007296543 ubox
12 48 0.865271540 ubox
13 47 0.864827148 ubox
13 49 0.007710853 ubox
13 60 0.010179218 ubox
14 46 0.864487647 ubox
14 48 0.006719949 ubox
14 49 0.043627775 ubox
14 59 0.013323230 ubox
15 45 0.864608366 ubox
15 48 0.044205987 ubox
16 44 0.851552736 ubox
16 46 0.021605089 ubox
16 47 0.041649500 ubox
16 49 0.004955528 ubox
17 23 0.025113804 ubox
17 29 0.014974642 ubox
17 41 0.104304586 ubox
17 45 0.026575674 ubox
17 48 0.004910565 ubox
18 22 0.020504429 ubox
18 28 0.013899382 ubox
18 40 0.100523781 ubox
18 50 0.005045549 ubox
18 55 0.066099725 ubox
19 32 0.068237325 ubox
19 41 0.029544982 ubox
19 44 0.044833880 ubox
19 49 0.005343630 ubox
19 51 0.005638045 ubox
19 54 0.071310830 ubox
19 59 0.003451204 ubox
19 70 0.004169910 ubox
20 30 0.208310440 ubox
20 31 0.058847027 ubox
20 40 0.013529941 ubox
20 42 0.839655443 ubox
20 43 0.048974433 ubox
20 50 0.006078553 ubox
20 53 0.072226797 ubox
20 58 0.003670975 ubox
20 67 0.003430942 ubox
20 69 0.004591098 ubox
20 72 0.124250677 ubox
21 29 0.212184048 ubox
21 41 0.840348061 ubox
21 45 0.008720276 ubox
21 48 0.017188185 ubox
21 71 0.125720548 ubox
22 29 0.014553173 ubox
22 32 0.105060853 ubox
22 41 0.010593978 ubox
22 44 0.011380971 ubox
22 47 0.017087658 ubox
22 51 0.062201209 ubox
22 54 0.004345642 ubox
22 59 0.008959442 ubox
22 68 0.003873604 ubox
22 70 0.125529390 ubox
23 28 0.012856636 ubox
23 30 0.205077571 ubox
23 31 0.085489988 ubox
23 40 0.029937095 ubox
23 42 0.046548393 ubox
23 43 0.012072742 ubox
23 50 0.061814567 ubox
23 53 0.004776136 ubox
23 58 0.009749242 ubox
23 67 0.004315860 ubox
23 69 0.124031393 ubox
23 72 0.004387974 ubox
24 29 0.215662065 ubox
24 41 0.046954014 ubox
24 71 0.005199636 ubox
25 45 0.006515419 ubox
25 48 0.177438395 ubox
25 71 0.006765027 ubox
26 44 0.006401936 ubox
26 46 0.285338213 ubox
26 47 0.125808426 ubox
26 49 0.012498654 ubox
26 70 0.006382334 ubox
27 45 0.322944043 ubox
27 48 0.013129888 ubox
27 71 0.020356894 ubox
28 44 0.323373025 ubox
28 47 0.012714372 ubox
28 51 0.006939001 ubox
28 54 0.100385610 ubox
28 59 0.013833067 ubox
28 65 0.004421783 ubox
28 68 0.011433355 ubox
28 70 0.020766769 ubox
29 40 0.005268567 ubox
29 42 0.075223057 ubox
29 43 0.316777718 ubox
29 50 0.007133044 ubox
29 53 0.110611399 ubox
29 58 0.014829947 ubox
29 64 0.004238495 ubox
29 67 0.011618997 ubox
29 69 0.020726406 ubox
29 72 0.008302005 ubox
30 41 0.096120707 ubox
30 71 0.008371162 ubox
31 41 0.306478154 ubox
32 40 0.288127948 ubox
34 45 0.006446537 ubox
34 48 0.346933750 ubox
35 44 0.006734640 ubox
35 47 0.348359800 ubox
35 49 0.006178746 ubox
36 46 0.348786243 ubox
36 48 0.006267121 ubox
36 49 0.027338820 ubox
37 45 0.348899974 ubox
37 48 0.029121347 ubox
37 71 0.005869182 ubox
38 44 0.334534632 ubox
38 46 0.024441374 ubox
38 47 0.022987095 ubox
38 49 0.043247932 ubox
38 70 0.005818101 ubox
39 45 0.030754468 ubox
39 48 0.046100572 ubox
39 71 0.019110366 ubox
40 44 0.027944711 ubox
40 47 0.045845514 ubox
40 68 0.007308606 ubox
40 70 0.019420802 ubox
41 67 0.007588095 ubox
41 69 0.019411903 ubox
44 62 0.008264411 ubox
44 64 0.004624169 ubox
45 57 0.004698941 ubox
45 58 0.037634989 ubox
45 61 0.009054236 ubox
45 63 0.004976582 ubox
45 64 0.024239582 ubox
46 55 0.003480721 ubox
46 56 0.007873325 ubox
46 57 0.037885799 ubox
46 62 0.005093345 ubox
46 63 0.028397043 ubox
46 64 0.005642473 ubox
47 55 0.012017422 ubox
47 56 0.038806287 ubox
47 57 0.040039301 ubox
47 62 0.035233616 ubox
47 63 0.007027666 ubox
47 64 0.012440782 ubox
48 55 0.027886852 ubox
48 56 0.050092030 ubox
48 57 0.035571900 ubox
48 58 0.145940304 ubox
48 61 0.035593177 ubox
48 62 0.005805014 ubox
48 63 0.013442139 ubox
48 64 0.013717577 ubox
49 55 0.053358196 ubox
49 56 0.046554891 ubox
49 57 0.145049763 ubox
49 62 0.013246147 ubox
49 63 0.015256277 ubox
50 54 0.048024808 ubox
50 65 0.011711648 ubox
51 64 0.012679326 ubox
55 66 0.052594925 ubox
55 71 0.007625425 ubox
56 65 0.062776038 ubox
56 66 0.019684378 ubox
56 70 0.008511000 ubox
56 71 0.008761154 ubox
57 65 0.021412536 ubox
57 70 0.009699231 ubox
61 71 0.112787007 ubox
62 70 0.109185088 ubox
62 71 0.029590978 ubox
63 70 0.033051113 ubox
63 71 0.025434075 ubox
64 70 0.029648960 ubox
10 50 0.9500000 lbox
11 49 0.9500000 lbox
12 48 0.9500000 lbox
13 47 0.9500000 lbox
14 46 0.9500000 lbox
15 45 0.9500000 lbox
16 44 0.9500000 lbox
20 42 0.9500000 lbox
21 41 0.9500000 lbox
showpage
end
%%EOF
