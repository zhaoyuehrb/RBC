%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:14:32 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AAAGGUGCGCGUGUUCCUUUAAGGGGCUGGUCUGGCGGGAGCGCGGGGGUUUUUCUGCUGCCGCUUCCUUUCUGCCCUUUUAAUUUCCCCGAAAUCAGACUGCUGCCUUGGACCGGGACAGCUCGCGGCCCCCGAGAGCUCUAGCCGUCGAGGAGCUGCCUGGGGACG\
) } def
/len { sequence length } bind def

/coor [
[81.54190063 129.08122253]
[75.83386993 142.95272827]
[70.12583160 156.82421875]
[64.41780090 170.69570923]
[58.70976639 184.56719971]
[60.61350250 200.27345276]
[48.61512756 209.09889221]
[42.90709305 222.97038269]
[45.62049103 239.14349365]
[32.80038834 249.36978149]
[17.63500977 243.12933350]
[15.72519588 226.84176636]
[29.03559875 217.26234436]
[34.74363327 203.39085388]
[32.43161774 188.67678833]
[44.83827209 178.85917664]
[50.54630661 164.98767090]
[56.25433731 151.11618042]
[61.96237183 137.24468994]
[67.67041016 123.37319183]
[61.32411575 109.78185272]
[47.02419662 105.25279999]
[32.72427750 100.72374725]
[18.42435646 96.19470215]
[4.12443638 91.66564941]
[-10.17548275 87.13659668]
[-24.47540283 82.60754395]
[-39.96766663 85.81695557]
[-49.76475525 74.59793854]
[-64.06467438 70.06888580]
[-71.08055115 76.90115356]
[-80.05844879 80.66487885]
[-89.73297119 80.87571716]
[-98.75732422 77.54689789]
[-105.89083099 71.18141937]
[-110.16943359 62.69658279]
[-111.03590393 53.29191971]
[-124.95985413 47.71305847]
[-138.88380432 42.13420105]
[-152.80775452 36.55534363]
[-166.73170471 30.97648430]
[-180.65563965 25.39762497]
[-194.57958984 19.81876564]
[-208.55479431 14.36956501]
[-222.58003235 9.05049133]
[-236.60528564 3.73141813]
[-252.25234985 6.07231092]
[-261.40887451 -5.67534351]
[-275.43411255 -10.99441624]
[-290.59503174 -5.74783468]
[-304.07199097 -14.45130634]
[-305.52667236 -30.42827225]
[-293.84313965 -41.42257309]
[-277.98400879 -39.00032043]
[-270.11505127 -25.01966095]
[-256.08981323 -19.70058632]
[-241.44590759 -22.42193604]
[-231.28620911 -10.29382515]
[-217.26097107 -4.97475243]
[-203.23571777 0.34432101]
[-195.83653259 -0.22626710]
[-189.00073242 5.89481783]
[-175.07678223 11.47367668]
[-161.15284729 17.05253601]
[-147.22889709 22.63139343]
[-133.30494690 28.21025276]
[-119.38099670 33.78911209]
[-105.45704651 39.36796951]
[-87.46776581 29.73558426]
[-67.91575623 36.52545547]
[-59.53562546 55.76896667]
[-45.23570633 60.29801941]
[-30.76626587 56.76466370]
[-19.94635201 68.30762482]
[-5.64643192 72.83667755]
[8.65348721 77.36573029]
[22.95340729 81.89478302]
[37.25332642 86.42382812]
[51.55324554 90.95288086]
[65.85316467 95.48193359]
[72.03617859 81.47767639]
[83.43497467 71.87681580]
[97.50070953 68.36206818]
[111.28321838 71.30478668]
[122.04895782 79.75845337]
[127.82294464 91.72106934]
[142.81710815 91.30286407]
[157.81127930 90.88465881]
[172.80545044 90.46645355]
[187.79962158 90.04824829]
[202.79379272 89.63004303]
[188.67459106 84.56562805]
[178.73223877 73.33399963]
[175.41828918 58.70465088]
[179.54991150 44.28488541]
[190.10833740 33.63031769]
[204.49005127 29.36814880]
[219.14883423 32.54934311]
[230.47013855 42.38948441]
[235.66232300 56.46219254]
[233.44514465 71.29742432]
[224.36624146 83.23635864]
[237.16676331 75.41671753]
[249.96728516 67.59707642]
[262.76779175 59.77743530]
[275.49508667 51.83916092]
[288.14804077 43.78293228]
[300.80099487 35.72670364]
[303.98052979 20.24555397]
[317.22143555 11.61688519]
[332.66812134 14.95993233]
[341.15631104 28.29132652]
[337.65014648 43.70178604]
[324.22973633 52.04856110]
[308.85720825 48.37965775]
[296.20425415 56.43588638]
[283.55130005 64.49211121]
[279.58184814 70.76244354]
[270.58743286 72.57795715]
[257.78692627 80.39759064]
[244.98640442 88.21723175]
[232.18588257 96.03687286]
[232.11618042 103.53654480]
[231.97676086 118.53590393]
[231.90704346 126.03557587]
[244.55999756 134.09179688]
[257.21295166 142.14802551]
[269.86590576 150.20425415]
[282.51885986 158.26048279]
[295.24615479 166.19876099]
[308.04666138 174.01840210]
[323.85681152 174.60980225]
[330.68432617 187.84741211]
[343.48483276 195.66705322]
[356.28536987 203.48667908]
[371.46545410 199.99342346]
[384.33560181 208.10600281]
[387.57232666 222.59941101]
[400.37283325 230.41905212]
[416.77145386 230.28434753]
[424.85305786 244.55386353]
[416.30404663 258.54837036]
[399.91885376 257.87152100]
[392.55322266 243.21957397]
[379.75268555 235.39993286]
[365.37988281 239.13594055]
[352.28692627 231.38806152]
[348.46572876 216.28720093]
[335.66519165 208.46755981]
[322.86468506 200.64791870]
[307.97012329 200.61584473]
[300.22702026 186.81892395]
[287.42651367 178.99928284]
[280.04931641 178.19248962]
[274.46261597 170.91343689]
[261.80966187 162.85720825]
[249.15672302 154.80097961]
[236.50376892 146.74475098]
[223.85081482 138.68852234]
[205.04528809 123.06312561]
[203.21199036 104.62421417]
[188.21781921 105.04241943]
[173.22366333 105.46062469]
[158.22949219 105.87882996]
[143.23532104 106.29703522]
[128.24114990 106.71524048]
[123.05734253 119.78526306]
[111.94538879 129.40260315]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[1 20]
[2 19]
[3 18]
[4 17]
[5 16]
[7 14]
[8 13]
[21 80]
[22 79]
[23 78]
[24 77]
[25 76]
[26 75]
[27 74]
[29 72]
[30 71]
[37 68]
[38 67]
[39 66]
[40 65]
[41 64]
[42 63]
[43 62]
[44 60]
[45 59]
[46 58]
[48 56]
[49 55]
[86 166]
[87 165]
[88 164]
[89 163]
[90 162]
[91 161]
[102 122]
[103 121]
[104 120]
[105 119]
[106 117]
[107 116]
[108 115]
[125 159]
[126 158]
[127 157]
[128 156]
[129 155]
[130 153]
[131 152]
[133 150]
[134 149]
[135 148]
[138 145]
[139 144]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
