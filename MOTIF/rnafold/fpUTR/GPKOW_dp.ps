%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:02:19 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (GPKOW)
} def

/sequence { (\
ACUUUGGCCGGCCCCUAGCGAUCUGAACCCAAACUAAAUUUCCCAGCAAGCAGCGCGCCGGCCUGGGAAAAGGAGCAAG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
2 18 0.013151480 ubox
2 66 0.306684867 ubox
2 67 0.864905956 ubox
2 72 0.210577605 ubox
2 73 0.081853956 ubox
2 75 0.082041345 ubox
2 79 0.017139999 ubox
3 17 0.013169565 ubox
3 26 0.011141023 ubox
3 27 0.040405534 ubox
3 32 0.004370360 ubox
3 33 0.070176188 ubox
3 38 0.010165195 ubox
3 65 0.301585831 ubox
3 66 0.866648498 ubox
3 67 0.056633030 ubox
3 68 0.053796105 ubox
3 69 0.041601217 ubox
3 70 0.025587577 ubox
3 71 0.210168594 ubox
3 72 0.081645510 ubox
3 73 0.006276850 ubox
3 74 0.082264690 ubox
3 75 0.006946322 ubox
3 78 0.016614687 ubox
3 79 0.012191262 ubox
4 17 0.003254095 ubox
4 21 0.004138723 ubox
4 25 0.010685748 ubox
4 26 0.047439038 ubox
4 31 0.004117300 ubox
4 32 0.082398275 ubox
4 37 0.011695783 ubox
4 65 0.742084857 ubox
4 66 0.069377333 ubox
4 67 0.056540866 ubox
4 68 0.047698042 ubox
4 69 0.030658542 ubox
4 70 0.207399455 ubox
4 71 0.079698725 ubox
4 72 0.008388366 ubox
4 73 0.080879018 ubox
4 74 0.009018228 ubox
4 77 0.013777485 ubox
4 78 0.020069878 ubox
5 17 0.004557881 ubox
5 20 0.004326562 ubox
5 25 0.047992341 ubox
5 31 0.085162920 ubox
5 36 0.012046351 ubox
5 60 0.003224629 ubox
5 65 0.061675359 ubox
5 66 0.045274337 ubox
5 67 0.048540443 ubox
5 68 0.033327300 ubox
5 69 0.203722799 ubox
5 70 0.077994192 ubox
5 71 0.009485189 ubox
5 72 0.076838289 ubox
5 73 0.009354176 ubox
5 77 0.021705048 ubox
6 13 0.011408974 ubox
6 14 0.012934242 ubox
6 15 0.012924722 ubox
6 16 0.004254026 ubox
6 19 0.003797337 ubox
6 23 0.021045786 ubox
6 24 0.048480662 ubox
6 29 0.007659103 ubox
6 30 0.085619174 ubox
6 35 0.012099998 ubox
6 59 0.003615574 ubox
6 63 0.990892692 ubox
6 64 0.010757494 ubox
6 76 0.021560551 ubox
7 12 0.011413764 ubox
7 13 0.012863921 ubox
7 14 0.012850990 ubox
7 15 0.004240020 ubox
7 19 0.016725915 ubox
7 22 0.019739054 ubox
7 23 0.048669407 ubox
7 28 0.008687677 ubox
7 29 0.085325042 ubox
7 34 0.012053622 ubox
7 58 0.003616616 ubox
7 62 0.991612005 ubox
7 63 0.007767217 ubox
7 76 0.010566138 ubox
8 18 0.017023007 ubox
8 57 0.003553996 ubox
8 61 0.991694711 ubox
8 66 0.030511512 ubox
8 67 0.010681352 ubox
8 73 0.019975428 ubox
8 75 0.010984447 ubox
9 20 0.042243490 ubox
9 25 0.074895117 ubox
9 60 0.991678333 ubox
9 65 0.030556632 ubox
9 66 0.010500619 ubox
9 72 0.019939435 ubox
10 16 0.015375200 ubox
10 19 0.041564209 ubox
10 23 0.008717070 ubox
10 24 0.074284803 ubox
10 29 0.008495192 ubox
10 30 0.013810863 ubox
10 59 0.991676980 ubox
10 63 0.029439876 ubox
10 64 0.013351601 ubox
11 15 0.015354661 ubox
11 19 0.061925319 ubox
11 22 0.004775785 ubox
11 23 0.070133418 ubox
11 28 0.009139079 ubox
11 29 0.013784641 ubox
11 54 0.004107273 ubox
11 56 0.007332377 ubox
11 58 0.991655613 ubox
11 62 0.029833018 ubox
11 63 0.012528962 ubox
11 76 0.055394503 ubox
12 18 0.063646284 ubox
12 53 0.004628098 ubox
12 55 0.009872709 ubox
12 57 0.990100167 ubox
12 61 0.029965140 ubox
12 73 0.004303073 ubox
12 75 0.055435544 ubox
13 60 0.029684330 ubox
13 61 0.011749245 ubox
13 72 0.004290696 ubox
13 73 0.013416923 ubox
14 60 0.012287563 ubox
14 72 0.013217448 ubox
14 73 0.054174718 ubox
15 50 0.029060378 ubox
15 53 0.756057516 ubox
15 72 0.054245566 ubox
15 79 0.008403172 ubox
16 25 0.024198554 ubox
16 36 0.015118114 ubox
16 49 0.028759131 ubox
16 52 0.754727998 ubox
16 71 0.052058941 ubox
16 78 0.008505449 ubox
17 24 0.028301414 ubox
17 35 0.017265815 ubox
18 23 0.028181934 ubox
18 34 0.017403086 ubox
18 47 0.035621598 ubox
18 51 0.960324472 ubox
18 54 0.101783233 ubox
18 56 0.213215763 ubox
18 58 0.023801509 ubox
18 76 0.015537567 ubox
19 25 0.014500884 ubox
19 46 0.035590219 ubox
19 50 0.960767871 ubox
19 53 0.101738896 ubox
19 55 0.213278382 ubox
19 57 0.024003111 ubox
19 75 0.015556773 ubox
20 24 0.009082433 ubox
20 40 0.005775616 ubox
20 41 0.003387549 ubox
20 42 0.014152651 ubox
20 54 0.209103426 ubox
20 56 0.024810744 ubox
21 39 0.006133821 ubox
21 40 0.003550620 ubox
21 41 0.013973303 ubox
22 38 0.006007195 ubox
22 73 0.014157262 ubox
22 74 0.004261483 ubox
23 46 0.958544722 ubox
23 50 0.075384490 ubox
23 53 0.182867623 ubox
23 72 0.014596505 ubox
23 73 0.004485132 ubox
24 31 0.043114828 ubox
24 36 0.006102552 ubox
24 45 0.960518133 ubox
24 48 0.057131940 ubox
24 49 0.072326322 ubox
24 52 0.184851750 ubox
24 71 0.014315323 ubox
24 72 0.004193080 ubox
24 77 0.010148493 ubox
25 30 0.046814226 ubox
25 35 0.006294761 ubox
25 40 0.011200251 ubox
25 41 0.021954643 ubox
25 42 0.117985527 ubox
25 44 0.954160222 ubox
25 47 0.063326626 ubox
25 51 0.184394137 ubox
25 76 0.011145365 ubox
26 39 0.020639807 ubox
26 40 0.058159352 ubox
26 41 0.138117468 ubox
27 39 0.052256926 ubox
27 40 0.128280944 ubox
28 73 0.012477174 ubox
29 72 0.012428514 ubox
29 73 0.009551900 ubox
30 72 0.009543158 ubox
31 40 0.111926666 ubox
31 41 0.121985387 ubox
32 39 0.107637999 ubox
32 40 0.129009300 ubox
32 41 0.052492224 ubox
33 39 0.115873693 ubox
33 40 0.049609742 ubox
34 46 0.034761452 ubox
34 50 0.021496446 ubox
34 53 0.004782335 ubox
34 72 0.029141227 ubox
34 73 0.029026161 ubox
34 75 0.073329587 ubox
35 45 0.033673409 ubox
35 49 0.020872720 ubox
35 52 0.004638549 ubox
35 71 0.028989525 ubox
35 72 0.028821346 ubox
35 74 0.073144730 ubox
39 46 0.006538714 ubox
39 49 0.004009136 ubox
39 50 0.014251588 ubox
39 70 0.111758084 ubox
39 71 0.008655076 ubox
40 45 0.006109791 ubox
40 46 0.004497285 ubox
40 48 0.004345897 ubox
40 49 0.015098543 ubox
40 50 0.004114311 ubox
40 69 0.121676531 ubox
40 70 0.007663554 ubox
41 45 0.004051063 ubox
41 48 0.014029462 ubox
41 49 0.004040816 ubox
41 68 0.123996728 ubox
41 69 0.005487411 ubox
42 67 0.124370723 ubox
43 66 0.124372277 ubox
44 65 0.124370139 ubox
45 64 0.123975335 ubox
46 54 0.026035087 ubox
46 56 0.017174901 ubox
46 62 0.086878030 ubox
46 63 0.088943627 ubox
47 53 0.026830664 ubox
47 55 0.017202819 ubox
47 61 0.122495491 ubox
50 56 0.025852349 ubox
50 58 0.122162658 ubox
50 62 0.006253640 ubox
51 55 0.025699777 ubox
51 57 0.122133815 ubox
51 61 0.006245919 ubox
53 62 0.010401393 ubox
54 60 0.003249071 ubox
54 61 0.010392852 ubox
55 62 0.007237174 ubox
56 61 0.007239883 ubox
62 73 0.010569275 ubox
63 72 0.015943060 ubox
63 73 0.004534509 ubox
64 71 0.022561638 ubox
64 72 0.007346690 ubox
64 74 0.007207859 ubox
64 77 0.059522412 ubox
64 78 0.005724890 ubox
65 76 0.064390405 ubox
2 67 0.9500000 lbox
3 66 0.9500000 lbox
4 65 0.9500000 lbox
6 63 0.9500000 lbox
7 62 0.9500000 lbox
8 61 0.9500000 lbox
9 60 0.9500000 lbox
10 59 0.9500000 lbox
11 58 0.9500000 lbox
12 57 0.9500000 lbox
15 53 0.9500000 lbox
16 52 0.9500000 lbox
18 51 0.9500000 lbox
19 50 0.9500000 lbox
23 46 0.9500000 lbox
24 45 0.9500000 lbox
25 44 0.9500000 lbox
showpage
end
%%EOF
