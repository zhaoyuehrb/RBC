%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:14:53 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (PPIAL4A)
} def

/sequence { (\
ACUAUAAAGACAGUAAAAAGAUCAGUGGUUAUCUUUGCAGACGCCACCAUCACUGUGAGCCCUGUACUAUCAGCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 14 0.150820631 ubox
1 26 0.028914531 ubox
1 29 0.021392301 ubox
1 65 0.225074908 ubox
2 9 0.195767321 ubox
2 13 0.159706758 ubox
2 20 0.015021390 ubox
2 25 0.030630816 ubox
2 28 0.024603170 ubox
2 40 0.008284401 ubox
2 59 0.042772027 ubox
2 64 0.237966118 ubox
2 73 0.085983854 ubox
3 8 0.187674134 ubox
3 12 0.158215734 ubox
3 15 0.041508530 ubox
3 19 0.014702256 ubox
3 24 0.029590871 ubox
3 27 0.024665709 ubox
3 39 0.008247643 ubox
3 57 0.011216986 ubox
3 58 0.039287645 ubox
3 64 0.027039995 ubox
3 66 0.099840177 ubox
3 69 0.012744743 ubox
3 72 0.084416715 ubox
4 14 0.043329495 ubox
4 22 0.013070081 ubox
4 26 0.024851159 ubox
4 32 0.006656809 ubox
4 56 0.007567454 ubox
4 63 0.032209751 ubox
4 65 0.106739569 ubox
4 68 0.012830329 ubox
4 70 0.055108172 ubox
5 13 0.042873453 ubox
5 15 0.010514447 ubox
5 21 0.012871346 ubox
5 25 0.024422559 ubox
5 31 0.007277301 ubox
5 37 0.010007155 ubox
5 55 0.004662379 ubox
5 57 0.023768879 ubox
5 64 0.106652020 ubox
5 66 0.020745297 ubox
5 69 0.055844694 ubox
6 14 0.010752203 ubox
6 30 0.007321915 ubox
6 36 0.014987500 ubox
6 54 0.003825136 ubox
6 56 0.012966801 ubox
6 63 0.099266242 ubox
6 65 0.020837886 ubox
6 68 0.048536687 ubox
7 29 0.006882449 ubox
7 35 0.018555934 ubox
8 34 0.019299183 ubox
8 63 0.046978283 ubox
8 68 0.134459833 ubox
9 23 0.029454116 ubox
9 30 0.007071695 ubox
9 33 0.019389009 ubox
9 51 0.003981609 ubox
9 62 0.049158043 ubox
9 67 0.139929043 ubox
9 71 0.273434380 ubox
10 22 0.027526843 ubox
10 26 0.027527296 ubox
10 29 0.007586547 ubox
10 32 0.018315806 ubox
10 50 0.003862500 ubox
10 56 0.862134733 ubox
10 65 0.170887500 ubox
10 70 0.270473781 ubox
11 25 0.028229078 ubox
11 27 0.011331927 ubox
11 28 0.007745718 ubox
11 55 0.884684207 ubox
11 57 0.010068142 ubox
11 64 0.172724521 ubox
12 26 0.011403333 ubox
12 30 0.007708644 ubox
12 54 0.884700276 ubox
12 56 0.009679986 ubox
12 63 0.172429356 ubox
12 68 0.275596880 ubox
13 22 0.017417628 ubox
13 29 0.006667482 ubox
13 32 0.004797991 ubox
13 38 0.021438510 ubox
13 42 0.014975655 ubox
13 53 0.884891728 ubox
13 60 0.023740799 ubox
13 62 0.170664496 ubox
13 67 0.282215752 ubox
13 70 0.009730061 ubox
13 74 0.033685221 ubox
14 21 0.018321226 ubox
14 27 0.005271906 ubox
14 28 0.003824616 ubox
14 31 0.007123881 ubox
14 37 0.021467144 ubox
14 41 0.015035970 ubox
14 52 0.879838576 ubox
14 55 0.008333718 ubox
14 57 0.054741654 ubox
14 59 0.026471887 ubox
14 66 0.279433304 ubox
14 69 0.010323581 ubox
14 73 0.032807738 ubox
15 26 0.005316980 ubox
15 30 0.007018022 ubox
15 36 0.019038072 ubox
15 54 0.008156994 ubox
15 56 0.055032982 ubox
15 63 0.004295436 ubox
15 65 0.259972254 ubox
15 68 0.009687265 ubox
16 29 0.006231763 ubox
16 35 0.015062665 ubox
16 36 0.012714878 ubox
17 34 0.009461300 ubox
17 35 0.012143249 ubox
17 36 0.153261410 ubox
18 34 0.009144907 ubox
18 35 0.177639873 ubox
18 36 0.004977648 ubox
19 34 0.183482410 ubox
19 35 0.004156324 ubox
19 54 0.070557066 ubox
19 63 0.043267037 ubox
19 68 0.054205381 ubox
20 30 0.021966616 ubox
20 33 0.184572169 ubox
20 51 0.897799854 ubox
20 53 0.069220161 ubox
20 62 0.044661050 ubox
20 67 0.056048816 ubox
20 71 0.045208414 ubox
21 29 0.023660787 ubox
21 32 0.183961095 ubox
21 50 0.895832431 ubox
21 56 0.050273716 ubox
21 65 0.015687489 ubox
21 70 0.045086882 ubox
22 28 0.025387912 ubox
22 31 0.180350480 ubox
22 41 0.005298265 ubox
22 49 0.853085652 ubox
22 55 0.011440140 ubox
22 58 0.187179411 ubox
22 64 0.003850538 ubox
22 69 0.044176967 ubox
23 27 0.026427509 ubox
23 37 0.004284861 ubox
23 40 0.005752717 ubox
23 55 0.183477619 ubox
23 57 0.186345210 ubox
23 64 0.119517824 ubox
24 30 0.040566286 ubox
24 34 0.005756870 ubox
24 36 0.004454882 ubox
24 54 0.186804196 ubox
24 56 0.180869383 ubox
24 63 0.119713333 ubox
24 68 0.032852541 ubox
25 29 0.028291579 ubox
25 33 0.006163190 ubox
25 35 0.003905578 ubox
25 38 0.007436812 ubox
25 42 0.003886466 ubox
25 44 0.005581771 ubox
25 47 0.926244660 ubox
25 50 0.052494286 ubox
25 53 0.189262806 ubox
25 62 0.119690992 ubox
25 67 0.033136705 ubox
25 70 0.031048124 ubox
25 74 0.014219627 ubox
26 31 0.003183209 ubox
26 37 0.007416621 ubox
26 41 0.003843271 ubox
26 43 0.005578434 ubox
26 46 0.928793983 ubox
26 49 0.056171124 ubox
26 52 0.187950081 ubox
26 55 0.020033938 ubox
26 66 0.030905488 ubox
26 69 0.032724785 ubox
26 72 0.021969345 ubox
26 73 0.010510732 ubox
27 33 0.005763972 ubox
27 34 0.009526306 ubox
27 36 0.007122295 ubox
27 42 0.005533870 ubox
27 45 0.929352484 ubox
27 48 0.059303301 ubox
27 51 0.186439046 ubox
27 54 0.029379837 ubox
27 61 0.120082959 ubox
27 65 0.021941316 ubox
27 68 0.033525515 ubox
27 71 0.024992800 ubox
27 75 0.204715936 ubox
28 32 0.003778558 ubox
28 33 0.010691567 ubox
28 35 0.006921348 ubox
28 38 0.005890870 ubox
28 42 0.008544984 ubox
28 44 0.929314803 ubox
28 47 0.060153355 ubox
28 50 0.183564691 ubox
28 53 0.029691759 ubox
28 60 0.120085061 ubox
28 67 0.033579071 ubox
28 70 0.024924011 ubox
28 74 0.207163660 ubox
29 37 0.005997454 ubox
29 40 0.006270576 ubox
29 41 0.011950601 ubox
29 43 0.913486527 ubox
29 46 0.058407936 ubox
29 49 0.176801592 ubox
29 52 0.028833455 ubox
29 58 0.004670136 ubox
29 59 0.114835449 ubox
29 66 0.029133611 ubox
29 69 0.024231234 ubox
29 73 0.206270322 ubox
30 37 0.042426304 ubox
30 39 0.019191654 ubox
30 40 0.018530025 ubox
30 57 0.005491642 ubox
30 58 0.061986193 ubox
30 69 0.007297547 ubox
30 72 0.184340612 ubox
31 36 0.041926020 ubox
31 50 0.022355988 ubox
31 56 0.005348841 ubox
31 68 0.008396472 ubox
31 70 0.057683930 ubox
32 41 0.897501284 ubox
32 49 0.023626671 ubox
32 55 0.004732566 ubox
32 58 0.037377356 ubox
32 69 0.054881756 ubox
33 40 0.914674277 ubox
33 57 0.040523681 ubox
33 59 0.021309895 ubox
34 39 0.835657875 ubox
34 40 0.016626767 ubox
34 41 0.023890864 ubox
34 58 0.020138805 ubox
34 59 0.031565676 ubox
35 39 0.031029873 ubox
35 40 0.023191175 ubox
35 41 0.011580359 ubox
35 57 0.015106806 ubox
35 58 0.093526718 ubox
36 40 0.010885691 ubox
36 43 0.036493295 ubox
36 46 0.028489013 ubox
36 49 0.004347459 ubox
36 52 0.004628896 ubox
36 57 0.106409889 ubox
36 58 0.003226469 ubox
36 66 0.215705971 ubox
37 42 0.043044119 ubox
37 44 0.172677524 ubox
37 45 0.022226792 ubox
37 48 0.004821678 ubox
37 51 0.004564084 ubox
37 56 0.116932413 ubox
37 60 0.009717491 ubox
37 65 0.270531003 ubox
38 43 0.173851055 ubox
38 55 0.117740736 ubox
38 59 0.009749258 ubox
38 64 0.281110080 ubox
39 54 0.117542342 ubox
39 63 0.281084873 ubox
39 68 0.004474242 ubox
40 51 0.014829664 ubox
40 53 0.116408441 ubox
40 62 0.280250761 ubox
40 67 0.004651685 ubox
41 50 0.017370635 ubox
41 56 0.009317246 ubox
41 65 0.005730274 ubox
42 55 0.009344390 ubox
42 57 0.008187188 ubox
42 64 0.005916690 ubox
43 54 0.007354007 ubox
43 56 0.008256087 ubox
43 60 0.283696803 ubox
44 55 0.008012919 ubox
44 59 0.284023753 ubox
45 55 0.004525218 ubox
45 57 0.285065375 ubox
46 54 0.004632250 ubox
46 56 0.284872698 ubox
47 55 0.275186422 ubox
48 55 0.081728003 ubox
48 57 0.056944715 ubox
48 64 0.004482781 ubox
49 54 0.094579499 ubox
49 56 0.056079429 ubox
49 63 0.004382816 ubox
50 55 0.051963591 ubox
50 58 0.038409623 ubox
51 57 0.041065705 ubox
52 56 0.033347250 ubox
52 65 0.007551413 ubox
53 59 0.022299151 ubox
53 64 0.009081344 ubox
53 73 0.166512039 ubox
54 58 0.020216981 ubox
54 72 0.167509416 ubox
55 67 0.010372056 ubox
55 70 0.003856559 ubox
55 71 0.167630070 ubox
55 74 0.009283340 ubox
56 66 0.010619480 ubox
56 69 0.014761181 ubox
56 72 0.046968347 ubox
56 73 0.005993744 ubox
57 63 0.006271770 ubox
57 65 0.010653052 ubox
57 68 0.013294340 ubox
57 71 0.103350539 ubox
58 68 0.172413924 ubox
58 70 0.101918811 ubox
59 65 0.049707779 ubox
59 67 0.172986280 ubox
59 74 0.245758631 ubox
60 64 0.051851595 ubox
60 73 0.226170184 ubox
62 73 0.737721630 ubox
63 69 0.019119576 ubox
63 72 0.768691520 ubox
64 68 0.017210177 ubox
64 70 0.023935547 ubox
64 71 0.772617985 ubox
64 74 0.051334801 ubox
65 69 0.044764110 ubox
65 73 0.050795510 ubox
67 73 0.053757918 ubox
68 72 0.048787016 ubox
10 56 0.9500000 lbox
11 55 0.9500000 lbox
12 54 0.9500000 lbox
13 53 0.9500000 lbox
14 52 0.9500000 lbox
20 51 0.9500000 lbox
21 50 0.9500000 lbox
22 49 0.9500000 lbox
25 47 0.9500000 lbox
26 46 0.9500000 lbox
27 45 0.9500000 lbox
28 44 0.9500000 lbox
29 43 0.9500000 lbox
32 41 0.9500000 lbox
33 40 0.9500000 lbox
34 39 0.9500000 lbox
62 73 0.9500000 lbox
63 72 0.9500000 lbox
64 71 0.9500000 lbox
showpage
end
%%EOF
