%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:22:45 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (FANCL)
} def

/sequence { (\
AGCGGACUGCGCAUGUGCAGGACCCAGCAGGUCUAGAGCUUUUCUGUGUUUCUCCGGACUUCGAGCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 8 0.003392763 ubox
1 40 0.016007701 ubox
1 50 0.008909835 ubox
1 60 0.089539053 ubox
1 61 0.013778541 ubox
2 7 0.003826600 ubox
2 10 0.016788032 ubox
2 12 0.093372604 ubox
2 18 0.007816603 ubox
2 28 0.603429276 ubox
2 39 0.018430902 ubox
2 47 0.047707404 ubox
2 49 0.012449439 ubox
2 59 0.101833957 ubox
2 60 0.017522636 ubox
2 66 0.124387578 ubox
3 9 0.016809010 ubox
3 11 0.093470500 ubox
3 17 0.007818489 ubox
3 27 0.602815908 ubox
3 38 0.018423713 ubox
3 46 0.050139747 ubox
3 48 0.012673498 ubox
3 56 0.674558029 ubox
3 63 0.076954374 ubox
3 65 0.123955178 ubox
4 8 0.010375363 ubox
4 10 0.093309450 ubox
4 16 0.006561319 ubox
4 24 0.489739476 ubox
4 25 0.479989720 ubox
4 33 0.005765770 ubox
4 34 0.018618284 ubox
4 44 0.003683880 ubox
4 45 0.050093317 ubox
4 47 0.009271506 ubox
4 51 0.005012402 ubox
4 52 0.015803789 ubox
4 53 0.035459366 ubox
4 54 0.013449198 ubox
4 55 0.689627887 ubox
4 60 0.006103273 ubox
4 62 0.078581999 ubox
4 67 0.035274628 ubox
5 23 0.494373387 ubox
5 24 0.476874999 ubox
5 32 0.003223251 ubox
5 33 0.019468945 ubox
5 43 0.003688486 ubox
5 44 0.050116842 ubox
5 50 0.006314596 ubox
5 51 0.015736471 ubox
5 52 0.039909326 ubox
5 53 0.008721862 ubox
5 54 0.689515324 ubox
5 59 0.006439741 ubox
5 61 0.074550415 ubox
5 62 0.041640820 ubox
5 66 0.035238902 ubox
6 16 0.004503726 ubox
6 32 0.019289867 ubox
6 42 0.005069039 ubox
6 43 0.046319921 ubox
6 49 0.007660794 ubox
6 50 0.015411634 ubox
6 51 0.040662762 ubox
6 53 0.653097140 ubox
6 60 0.067380532 ubox
6 61 0.037799530 ubox
7 15 0.005120843 ubox
7 20 0.774858191 ubox
7 21 0.046794340 ubox
7 30 0.020958595 ubox
7 31 0.015169360 ubox
7 48 0.008904642 ubox
7 57 0.010539824 ubox
7 65 0.010106698 ubox
8 19 0.780202659 ubox
8 20 0.029056138 ubox
8 29 0.024240606 ubox
8 30 0.009335925 ubox
8 48 0.009063608 ubox
8 56 0.010490593 ubox
8 64 0.009475390 ubox
9 16 0.006352876 ubox
9 18 0.781395899 ubox
9 28 0.025267729 ubox
9 39 0.014113558 ubox
9 47 0.015193307 ubox
9 49 0.605720197 ubox
9 55 0.008399931 ubox
10 15 0.007311706 ubox
10 17 0.780979491 ubox
10 27 0.025269476 ubox
10 38 0.014111696 ubox
10 46 0.015427139 ubox
10 48 0.613815488 ubox
10 56 0.003921439 ubox
10 63 0.004581071 ubox
11 16 0.505893279 ubox
11 18 0.038547893 ubox
11 28 0.006269050 ubox
11 45 0.013675479 ubox
11 47 0.613678433 ubox
11 49 0.029856670 ubox
11 55 0.003550464 ubox
11 62 0.004238442 ubox
11 66 0.005008639 ubox
12 17 0.038683173 ubox
12 27 0.006268324 ubox
12 46 0.613826461 ubox
12 48 0.030362719 ubox
12 65 0.005016165 ubox
13 32 0.015385483 ubox
13 45 0.589720100 ubox
13 47 0.030015847 ubox
14 26 0.004098649 ubox
14 29 0.003486454 ubox
14 31 0.016605037 ubox
14 35 0.003224719 ubox
14 46 0.029187434 ubox
14 63 0.003626863 ubox
15 23 0.023826363 ubox
15 25 0.004097044 ubox
15 28 0.004468038 ubox
15 39 0.149645819 ubox
15 45 0.012992745 ubox
15 49 0.004514085 ubox
15 59 0.006957456 ubox
15 62 0.003847467 ubox
15 66 0.004031986 ubox
16 22 0.023800622 ubox
16 27 0.004297317 ubox
16 29 0.029811828 ubox
16 35 0.003791070 ubox
16 38 0.149384814 ubox
16 48 0.010214307 ubox
16 58 0.006842887 ubox
16 65 0.003795331 ubox
17 28 0.036101764 ubox
17 39 0.594525107 ubox
17 47 0.019407323 ubox
17 49 0.003300647 ubox
17 66 0.019978332 ubox
18 27 0.036107359 ubox
18 38 0.594566762 ubox
18 46 0.020064211 ubox
18 48 0.003409158 ubox
18 65 0.020019718 ubox
19 34 0.025499620 ubox
19 40 0.009549167 ubox
19 45 0.020105462 ubox
19 53 0.003892516 ubox
20 33 0.019983069 ubox
20 34 0.617569238 ubox
20 39 0.009050207 ubox
20 44 0.019969183 ubox
20 51 0.005954527 ubox
20 52 0.004581595 ubox
20 55 0.008942291 ubox
20 62 0.003715560 ubox
20 67 0.004757780 ubox
21 32 0.010850864 ubox
21 33 0.708131303 ubox
21 43 0.018976715 ubox
21 50 0.043327776 ubox
21 51 0.005324784 ubox
21 52 0.017936902 ubox
21 54 0.009193200 ubox
21 62 0.015657278 ubox
21 66 0.005395182 ubox
22 32 0.708699403 ubox
22 42 0.018667479 ubox
22 49 0.045960577 ubox
22 50 0.004556174 ubox
22 51 0.017604149 ubox
22 53 0.008952657 ubox
22 61 0.014762605 ubox
23 31 0.706962013 ubox
23 48 0.046310392 ubox
24 30 0.703998765 ubox
24 31 0.054668962 ubox
24 57 0.003197938 ubox
25 30 0.076064349 ubox
25 46 0.046179698 ubox
25 48 0.013470762 ubox
25 56 0.003219365 ubox
26 40 0.019815417 ubox
26 45 0.046233058 ubox
26 47 0.010964970 ubox
26 50 0.006595540 ubox
26 60 0.003296015 ubox
26 61 0.004145655 ubox
27 39 0.020220982 ubox
27 44 0.046100744 ubox
27 47 0.027856117 ubox
27 49 0.007724942 ubox
27 59 0.003392917 ubox
27 66 0.275507598 ubox
28 38 0.020210869 ubox
28 46 0.030499837 ubox
28 48 0.007807202 ubox
28 65 0.275989989 ubox
29 40 0.017284830 ubox
29 41 0.036701137 ubox
29 42 0.012609843 ubox
29 43 0.006952065 ubox
29 45 0.030516727 ubox
29 47 0.007685009 ubox
29 53 0.004310931 ubox
29 60 0.023077382 ubox
29 61 0.584237239 ubox
30 39 0.017553867 ubox
30 40 0.041670331 ubox
30 41 0.010801128 ubox
30 42 0.005685036 ubox
30 44 0.030463929 ubox
30 52 0.004661552 ubox
30 55 0.020212145 ubox
30 59 0.018002473 ubox
30 60 0.685640595 ubox
30 61 0.020788825 ubox
30 62 0.031582129 ubox
30 67 0.043902527 ubox
31 39 0.042965076 ubox
31 40 0.007438675 ubox
31 41 0.005162265 ubox
31 43 0.028215292 ubox
31 51 0.004388982 ubox
31 54 0.020239431 ubox
31 59 0.698622700 ubox
31 60 0.003556838 ubox
31 61 0.008009337 ubox
31 66 0.044247999 ubox
32 38 0.042035528 ubox
32 48 0.003417362 ubox
32 57 0.005914182 ubox
32 58 0.698880012 ubox
32 64 0.008806813 ubox
32 65 0.029112201 ubox
33 56 0.010834788 ubox
33 57 0.698911290 ubox
33 63 0.010252289 ubox
33 65 0.031855778 ubox
34 46 0.177372512 ubox
34 48 0.032310453 ubox
34 56 0.674399203 ubox
34 64 0.030752636 ubox
35 41 0.004467710 ubox
35 42 0.006197234 ubox
35 43 0.006206565 ubox
35 45 0.200512583 ubox
35 47 0.035786804 ubox
35 50 0.027251204 ubox
35 51 0.031240091 ubox
35 53 0.464048828 ubox
35 60 0.004484840 ubox
36 40 0.003570940 ubox
36 41 0.005987923 ubox
36 42 0.008406802 ubox
36 43 0.007463634 ubox
36 44 0.204018964 ubox
36 49 0.022197907 ubox
36 50 0.032932903 ubox
36 51 0.244496788 ubox
36 52 0.493774505 ubox
36 54 0.485659971 ubox
36 59 0.004693601 ubox
36 61 0.030400332 ubox
36 62 0.033748852 ubox
37 41 0.007411021 ubox
37 42 0.010588449 ubox
37 43 0.200457062 ubox
37 45 0.038034172 ubox
37 49 0.029661220 ubox
37 50 0.376097761 ubox
37 51 0.411976382 ubox
37 53 0.482590171 ubox
37 60 0.032976856 ubox
37 61 0.032280110 ubox
38 42 0.135975027 ubox
38 44 0.038093843 ubox
38 47 0.170175073 ubox
38 49 0.492704514 ubox
38 50 0.279161847 ubox
38 52 0.443025858 ubox
38 59 0.034511870 ubox
38 60 0.026910315 ubox
38 66 0.112045487 ubox
39 46 0.229336934 ubox
39 48 0.619219176 ubox
39 57 0.005325791 ubox
39 65 0.112340271 ubox
40 56 0.005043083 ubox
40 58 0.005135873 ubox
40 64 0.111520133 ubox
40 65 0.003776622 ubox
41 57 0.003847296 ubox
41 63 0.105785706 ubox
41 64 0.009277267 ubox
42 58 0.013411015 ubox
42 63 0.012043275 ubox
42 64 0.003625001 ubox
42 65 0.016256977 ubox
43 57 0.010340910 ubox
43 58 0.118722636 ubox
43 63 0.003553602 ubox
43 64 0.022264321 ubox
44 56 0.010314638 ubox
44 57 0.122894230 ubox
44 63 0.023234321 ubox
44 65 0.008000455 ubox
45 56 0.122797513 ubox
45 63 0.010705830 ubox
45 64 0.007979863 ubox
46 55 0.122614863 ubox
46 59 0.026294349 ubox
46 62 0.018686322 ubox
46 66 0.003516020 ubox
47 56 0.012013628 ubox
47 58 0.025236727 ubox
47 63 0.007001857 ubox
47 65 0.003373519 ubox
48 55 0.014211296 ubox
48 59 0.065202472 ubox
48 62 0.010299846 ubox
48 66 0.014167278 ubox
49 57 0.003887453 ubox
49 58 0.064404119 ubox
49 65 0.013373360 ubox
50 56 0.004161759 ubox
50 57 0.062420690 ubox
50 58 0.010758126 ubox
50 64 0.012708514 ubox
50 65 0.005815764 ubox
51 56 0.047462470 ubox
51 57 0.012481923 ubox
51 58 0.055895444 ubox
51 63 0.008640947 ubox
51 64 0.008298150 ubox
52 56 0.013646254 ubox
52 57 0.063544014 ubox
52 63 0.008869184 ubox
52 65 0.054908336 ubox
53 64 0.056833469 ubox
54 63 0.052178165 ubox
55 63 0.058649581 ubox
56 62 0.065656607 ubox
56 67 0.100182107 ubox
57 61 0.043056404 ubox
57 66 0.124679202 ubox
59 65 0.124393927 ubox
60 64 0.112409982 ubox
3 56 0.9500000 lbox
4 55 0.9500000 lbox
5 54 0.9500000 lbox
6 53 0.9500000 lbox
9 49 0.9500000 lbox
10 48 0.9500000 lbox
11 47 0.9500000 lbox
12 46 0.9500000 lbox
13 45 0.9500000 lbox
17 39 0.9500000 lbox
18 38 0.9500000 lbox
20 34 0.9500000 lbox
21 33 0.9500000 lbox
22 32 0.9500000 lbox
23 31 0.9500000 lbox
24 30 0.9500000 lbox
showpage
end
%%EOF
