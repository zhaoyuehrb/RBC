%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:07:56 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (BOP1)
} def

/sequence { (\
CUCCUGCGCACGCGGCCCGGUCGCUGUCGGAAGCGGCUGUGCGGGUGGCGGCCGGCGCGCGGUGGGGC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 65 0.111407779 ubox
1 66 0.601136317 ubox
1 67 0.515130297 ubox
2 62 0.006187408 ubox
2 64 0.107053581 ubox
2 65 0.602318747 ubox
2 66 0.518179749 ubox
2 67 0.344345368 ubox
3 14 0.004098733 ubox
3 15 0.011154612 ubox
3 51 0.004235370 ubox
3 61 0.008191525 ubox
3 62 0.048460804 ubox
3 64 0.603715758 ubox
3 65 0.523766229 ubox
3 66 0.458944830 ubox
3 67 0.203281883 ubox
4 14 0.015502775 ubox
4 15 0.046863165 ubox
4 50 0.004282611 ubox
4 51 0.017851036 ubox
4 55 0.008040382 ubox
4 61 0.048871555 ubox
4 62 0.615106915 ubox
4 64 0.520660636 ubox
4 65 0.459331333 ubox
4 66 0.205283181 ubox
4 67 0.287335352 ubox
5 14 0.066032332 ubox
5 50 0.021116184 ubox
5 54 0.008420841 ubox
5 57 0.007236130 ubox
5 59 0.069504968 ubox
5 61 0.620157436 ubox
5 64 0.449521767 ubox
5 65 0.186129679 ubox
5 66 0.290034554 ubox
6 11 0.003453470 ubox
6 13 0.075776348 ubox
6 49 0.023412423 ubox
6 53 0.008789526 ubox
6 56 0.008366383 ubox
6 58 0.075011810 ubox
6 60 0.623738494 ubox
6 63 0.399538949 ubox
6 68 0.010009846 ubox
7 12 0.075686092 ubox
7 14 0.010209467 ubox
7 48 0.023393743 ubox
7 50 0.008491965 ubox
7 54 0.004983432 ubox
7 55 0.007930128 ubox
7 57 0.075189708 ubox
7 59 0.623721747 ubox
7 61 0.605752571 ubox
7 62 0.296150365 ubox
7 64 0.361464975 ubox
7 67 0.010094068 ubox
8 13 0.010069841 ubox
8 49 0.008658335 ubox
8 52 0.046814472 ubox
8 53 0.008500093 ubox
8 56 0.075589885 ubox
8 58 0.621757177 ubox
8 60 0.664428991 ubox
8 63 0.374128621 ubox
9 47 0.026687766 ubox
9 48 0.007597393 ubox
9 51 0.050153142 ubox
9 55 0.075141318 ubox
9 57 0.609934428 ubox
9 59 0.664590715 ubox
9 62 0.374470834 ubox
9 64 0.014578347 ubox
10 25 0.009414706 ubox
10 46 0.029773449 ubox
10 63 0.014810934 ubox
11 26 0.003368936 ubox
11 29 0.003540491 ubox
11 43 0.011021848 ubox
11 45 0.030061820 ubox
11 47 0.020673357 ubox
11 50 0.249408409 ubox
11 54 0.088013275 ubox
11 57 0.672083046 ubox
11 59 0.031381556 ubox
11 61 0.391373737 ubox
11 62 0.011175249 ubox
12 24 0.091814648 ubox
12 28 0.003488394 ubox
12 40 0.004848751 ubox
12 42 0.011130985 ubox
12 46 0.020783327 ubox
12 49 0.256496655 ubox
12 52 0.058761258 ubox
12 53 0.054670840 ubox
12 56 0.713790242 ubox
12 58 0.038208233 ubox
12 60 0.392984000 ubox
13 23 0.091931913 ubox
13 26 0.004599925 ubox
13 39 0.004977383 ubox
13 41 0.011127694 ubox
13 43 0.029921433 ubox
13 45 0.020782968 ubox
13 47 0.003216907 ubox
13 48 0.257308858 ubox
13 50 0.007426368 ubox
13 51 0.076730765 ubox
13 54 0.704630469 ubox
13 55 0.506261982 ubox
13 57 0.038254877 ubox
13 59 0.392891716 ubox
13 61 0.005818560 ubox
14 22 0.091925744 ubox
14 25 0.005412474 ubox
14 38 0.004953718 ubox
14 40 0.010532496 ubox
14 42 0.022314591 ubox
14 49 0.008084320 ubox
14 53 0.866998875 ubox
14 56 0.033720779 ubox
14 58 0.377391758 ubox
14 60 0.005830133 ubox
15 21 0.091611838 ubox
15 24 0.005521293 ubox
15 37 0.004948183 ubox
15 42 0.041451896 ubox
15 46 0.257114491 ubox
15 49 0.076668311 ubox
15 52 0.868156922 ubox
15 56 0.190640944 ubox
15 58 0.108391414 ubox
15 68 0.061310739 ubox
16 20 0.091074741 ubox
16 23 0.005512439 ubox
16 36 0.004870050 ubox
16 39 0.003338866 ubox
16 41 0.046053113 ubox
16 44 0.003701577 ubox
16 45 0.257668961 ubox
16 48 0.069888845 ubox
16 51 0.867526461 ubox
16 55 0.156908341 ubox
16 57 0.152817893 ubox
16 66 0.011489871 ubox
16 67 0.077594500 ubox
17 30 0.003756716 ubox
17 35 0.004454045 ubox
17 43 0.004423180 ubox
17 44 0.257776749 ubox
17 45 0.015241119 ubox
17 47 0.061642564 ubox
17 48 0.269726751 ubox
17 50 0.821191698 ubox
17 51 0.019733635 ubox
17 54 0.111968171 ubox
17 55 0.363074172 ubox
17 65 0.011540298 ubox
17 66 0.077725048 ubox
18 29 0.004211746 ubox
18 39 0.763087759 ubox
18 41 0.005612961 ubox
18 43 0.255814789 ubox
18 44 0.021486271 ubox
18 47 0.381562372 ubox
18 50 0.027379605 ubox
18 54 0.379501406 ubox
18 64 0.011553824 ubox
18 65 0.077715860 ubox
19 28 0.004232254 ubox
19 38 0.781496619 ubox
19 40 0.003978194 ubox
19 42 0.230787953 ubox
19 46 0.389011944 ubox
19 49 0.022853670 ubox
19 53 0.395092744 ubox
19 63 0.010229149 ubox
20 27 0.003265566 ubox
20 37 0.806780491 ubox
20 40 0.005405634 ubox
20 42 0.042049928 ubox
20 49 0.075685818 ubox
20 52 0.395016645 ubox
20 63 0.070288674 ubox
21 36 0.806562739 ubox
21 39 0.011036835 ubox
21 41 0.010748645 ubox
21 44 0.390015222 ubox
21 48 0.078248906 ubox
21 51 0.394798962 ubox
21 62 0.074401802 ubox
22 35 0.806793679 ubox
22 39 0.042656846 ubox
22 41 0.119699434 ubox
22 43 0.391572471 ubox
22 47 0.078409942 ubox
22 50 0.394813871 ubox
22 59 0.003540427 ubox
22 61 0.078461014 ubox
23 34 0.806902457 ubox
23 37 0.053801601 ubox
23 38 0.014947803 ubox
23 40 0.124380368 ubox
23 42 0.391540675 ubox
23 46 0.077620754 ubox
23 49 0.394295121 ubox
23 52 0.009190084 ubox
23 58 0.003630228 ubox
23 60 0.078481439 ubox
24 33 0.806905227 ubox
24 36 0.054499843 ubox
24 39 0.125129015 ubox
24 41 0.390904193 ubox
24 44 0.032086886 ubox
24 45 0.072599378 ubox
24 48 0.394001596 ubox
24 51 0.012208236 ubox
24 57 0.003555598 ubox
24 59 0.078460067 ubox
25 32 0.801910200 ubox
25 35 0.054504943 ubox
25 39 0.088496136 ubox
25 41 0.004374396 ubox
25 43 0.048022549 ubox
25 44 0.066408992 ubox
25 47 0.385344636 ubox
25 50 0.013161538 ubox
25 57 0.077138619 ubox
26 34 0.054725370 ubox
26 37 0.472882934 ubox
26 40 0.008209966 ubox
26 42 0.068314820 ubox
26 46 0.188754672 ubox
26 49 0.017887050 ubox
26 56 0.120635519 ubox
27 33 0.053516298 ubox
27 36 0.473709588 ubox
27 41 0.066244609 ubox
27 44 0.186042195 ubox
27 45 0.205935105 ubox
27 48 0.019348437 ubox
27 55 0.120668545 ubox
28 35 0.474549262 ubox
28 39 0.076355877 ubox
28 41 0.009661902 ubox
28 43 0.192665154 ubox
28 44 0.210335535 ubox
28 47 0.055159769 ubox
28 54 0.120800043 ubox
29 34 0.472530206 ubox
29 38 0.077398327 ubox
29 40 0.008678543 ubox
29 42 0.186925883 ubox
29 46 0.067351776 ubox
29 53 0.120814937 ubox
30 37 0.077694601 ubox
30 52 0.120790274 ubox
32 38 0.095739766 ubox
33 37 0.094709523 ubox
33 40 0.193434614 ubox
33 42 0.183107829 ubox
33 46 0.010669706 ubox
33 49 0.120850962 ubox
33 56 0.003573343 ubox
34 39 0.195497263 ubox
34 41 0.185069575 ubox
34 43 0.041286160 ubox
34 45 0.010817530 ubox
34 47 0.004636811 ubox
34 48 0.120856102 ubox
34 54 0.004827150 ubox
35 40 0.164052798 ubox
35 42 0.041025808 ubox
35 46 0.005918349 ubox
35 53 0.005773432 ubox
36 42 0.019238277 ubox
36 46 0.122679692 ubox
36 49 0.006088131 ubox
36 52 0.005859049 ubox
37 41 0.019804221 ubox
37 44 0.009419627 ubox
37 45 0.123115498 ubox
37 48 0.006108012 ubox
37 51 0.005922503 ubox
38 43 0.011024566 ubox
38 44 0.122442571 ubox
38 47 0.006615452 ubox
38 50 0.005912722 ubox
39 46 0.007226636 ubox
39 49 0.019768647 ubox
39 58 0.007015966 ubox
40 45 0.010826975 ubox
40 47 0.005302279 ubox
40 48 0.020079195 ubox
40 50 0.056814586 ubox
40 57 0.009714988 ubox
41 46 0.005808071 ubox
41 49 0.756300174 ubox
41 52 0.004590265 ubox
41 56 0.021342792 ubox
42 48 0.756979691 ubox
42 50 0.017014551 ubox
42 51 0.004508638 ubox
42 54 0.003738887 ubox
42 55 0.021395078 ubox
43 49 0.044095177 ubox
43 53 0.008299715 ubox
44 52 0.008151145 ubox
44 53 0.041338593 ubox
45 52 0.041404118 ubox
46 51 0.040948302 ubox
47 53 0.004944130 ubox
48 52 0.004871880 ubox
48 56 0.025148833 ubox
48 58 0.010206161 ubox
49 55 0.025190776 ubox
49 57 0.010399106 ubox
50 56 0.024229943 ubox
51 58 0.038996662 ubox
51 60 0.004134087 ubox
51 63 0.022422759 ubox
51 68 0.003312372 ubox
52 57 0.039025760 ubox
52 59 0.004093589 ubox
52 62 0.023590986 ubox
52 66 0.018638010 ubox
52 67 0.003489491 ubox
53 61 0.031677647 ubox
53 65 0.018845018 ubox
53 66 0.003201666 ubox
54 58 0.003646218 ubox
54 60 0.031764843 ubox
55 63 0.019138510 ubox
56 62 0.019210821 ubox
56 64 0.003805177 ubox
57 63 0.003907767 ubox
57 68 0.005115442 ubox
58 62 0.003896001 ubox
58 67 0.005156706 ubox
59 68 0.009091645 ubox
60 67 0.009202085 ubox
1 66 0.9500000 lbox
2 65 0.9500000 lbox
3 64 0.9500000 lbox
4 62 0.9500000 lbox
5 61 0.9500000 lbox
6 60 0.9500000 lbox
7 59 0.9500000 lbox
8 58 0.9500000 lbox
9 57 0.9500000 lbox
13 54 0.9500000 lbox
14 53 0.9500000 lbox
15 52 0.9500000 lbox
16 51 0.9500000 lbox
17 50 0.9500000 lbox
18 39 0.9500000 lbox
19 38 0.9500000 lbox
20 37 0.9500000 lbox
21 36 0.9500000 lbox
22 35 0.9500000 lbox
23 34 0.9500000 lbox
24 33 0.9500000 lbox
25 32 0.9500000 lbox
41 49 0.9500000 lbox
42 48 0.9500000 lbox
showpage
end
%%EOF
