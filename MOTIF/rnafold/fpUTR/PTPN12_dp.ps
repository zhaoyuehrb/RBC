%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:14:02 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (PTPN12)
} def

/sequence { (\
GGGGAACGAGCUGGGGAAGACGGAGCGGGCUCUGUGCCGGGCGGGCGGGCGGCGGGGGGGCCAGCGACCGCAGCCGGGGGGACGCGGGAGG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 12 0.012850449 ubox
1 31 0.022968931 ubox
1 32 0.059870822 ubox
1 33 0.707627188 ubox
1 62 0.003761958 ubox
2 11 0.013650299 ubox
2 12 0.009294019 ubox
2 30 0.032434126 ubox
2 31 0.081670239 ubox
2 32 0.797709309 ubox
2 33 0.028328757 ubox
2 61 0.003589751 ubox
3 11 0.009790212 ubox
3 12 0.007306191 ubox
3 30 0.084032669 ubox
3 31 0.917990599 ubox
3 32 0.031277120 ubox
3 33 0.005755685 ubox
4 11 0.007677518 ubox
4 30 0.962948873 ubox
4 31 0.006866131 ubox
4 32 0.006361054 ubox
5 31 0.006344782 ubox
6 35 0.003922454 ubox
7 13 0.004377191 ubox
7 22 0.021255714 ubox
7 27 0.992669417 ubox
7 34 0.004094858 ubox
7 47 0.008907127 ubox
7 66 0.007588354 ubox
7 76 0.036964775 ubox
7 84 0.009427830 ubox
7 86 0.007498618 ubox
8 21 0.021285473 ubox
8 26 0.994076050 ubox
8 32 0.011813869 ubox
8 46 0.008878222 ubox
8 65 0.006522464 ubox
8 75 0.037312945 ubox
8 83 0.009564864 ubox
8 85 0.007455164 ubox
9 31 0.012756992 ubox
10 26 0.027704705 ubox
10 30 0.013104034 ubox
10 42 0.014266861 ubox
10 65 0.019715000 ubox
10 74 0.039035991 ubox
10 85 0.004139956 ubox
11 19 0.025571224 ubox
11 23 0.997195155 ubox
11 25 0.027869450 ubox
11 28 0.005730351 ubox
11 29 0.012382290 ubox
11 41 0.014295968 ubox
11 64 0.019744932 ubox
11 73 0.039747180 ubox
11 77 0.004664088 ubox
11 78 0.010723949 ubox
11 80 0.007027880 ubox
11 84 0.004123051 ubox
11 87 0.004156928 ubox
11 90 0.004630591 ubox
12 18 0.025582626 ubox
12 22 0.996511484 ubox
12 24 0.027352114 ubox
12 27 0.007161717 ubox
12 28 0.011463643 ubox
12 40 0.014238203 ubox
12 63 0.019702060 ubox
12 72 0.039746357 ubox
12 76 0.004687983 ubox
12 77 0.010749767 ubox
12 79 0.006770353 ubox
12 86 0.004168586 ubox
12 89 0.004501366 ubox
13 21 0.996579609 ubox
13 26 0.008431782 ubox
13 62 0.019198479 ubox
13 71 0.039741135 ubox
13 75 0.004711675 ubox
13 85 0.004142385 ubox
14 38 0.013993781 ubox
14 61 0.018914814 ubox
14 69 0.007878934 ubox
14 74 0.004694207 ubox
14 75 0.010889799 ubox
15 37 0.013767725 ubox
15 38 0.003263024 ubox
15 68 0.007880690 ubox
15 69 0.036485719 ubox
15 74 0.010864349 ubox
15 75 0.006185517 ubox
16 37 0.003760748 ubox
16 68 0.036414696 ubox
16 74 0.006243800 ubox
20 35 0.019365194 ubox
21 27 0.006202740 ubox
21 34 0.021115657 ubox
21 54 0.015572213 ubox
21 66 0.014456096 ubox
21 70 0.019624033 ubox
22 26 0.005880305 ubox
22 33 0.021147985 ubox
22 53 0.015536853 ubox
22 65 0.013755483 ubox
22 69 0.019831661 ubox
23 32 0.021171442 ubox
23 68 0.019833497 ubox
24 31 0.021157683 ubox
25 30 0.020981936 ubox
25 50 0.015445900 ubox
25 65 0.095049886 ubox
25 85 0.009650996 ubox
26 49 0.015427006 ubox
26 64 0.095052032 ubox
26 66 0.003176946 ubox
26 84 0.009665254 ubox
27 62 0.098539573 ubox
27 65 0.003374955 ubox
27 83 0.009662002 ubox
28 38 0.003381389 ubox
28 61 0.100194108 ubox
28 62 0.107910782 ubox
29 37 0.003399608 ubox
29 46 0.015454240 ubox
29 50 0.005077724 ubox
29 61 0.108101580 ubox
29 85 0.038970287 ubox
30 36 0.003411931 ubox
30 45 0.015402744 ubox
30 49 0.005079198 ubox
30 59 0.108836727 ubox
30 60 0.099760941 ubox
30 80 0.006393872 ubox
30 81 0.007162729 ubox
30 84 0.038990136 ubox
30 87 0.008791486 ubox
30 88 0.047103946 ubox
30 90 0.165830183 ubox
30 91 0.009566300 ubox
31 44 0.007653429 ubox
31 48 0.004746365 ubox
31 56 0.003472251 ubox
31 58 0.116480191 ubox
31 59 0.090262567 ubox
31 79 0.006261325 ubox
31 80 0.007191163 ubox
31 81 0.004026909 ubox
31 82 0.039223772 ubox
31 86 0.008856429 ubox
31 87 0.036644294 ubox
31 88 0.255100917 ubox
31 89 0.165480058 ubox
31 90 0.009070680 ubox
31 91 0.003230682 ubox
32 43 0.007451181 ubox
32 44 0.013641157 ubox
32 47 0.004406885 ubox
32 48 0.005504130 ubox
32 55 0.004449462 ubox
32 57 0.124006064 ubox
32 58 0.080020212 ubox
32 78 0.005553995 ubox
32 79 0.007461243 ubox
32 80 0.007296927 ubox
32 81 0.040867414 ubox
32 86 0.041329391 ubox
32 87 0.555727320 ubox
32 88 0.140793110 ubox
32 90 0.011062450 ubox
33 43 0.013735314 ubox
33 47 0.005793996 ubox
33 48 0.005029403 ubox
33 51 0.004528646 ubox
33 54 0.004778694 ubox
33 56 0.130682391 ubox
33 57 0.067116057 ubox
33 78 0.005860210 ubox
33 79 0.007724407 ubox
33 80 0.039291942 ubox
33 84 0.149141499 ubox
33 86 0.612963381 ubox
33 87 0.101265303 ubox
33 89 0.010885228 ubox
33 90 0.004220207 ubox
34 42 0.015554388 ubox
34 46 0.007021671 ubox
34 50 0.019271888 ubox
34 53 0.005830164 ubox
34 65 0.004273330 ubox
34 83 0.421640419 ubox
34 85 0.808900968 ubox
35 41 0.015474725 ubox
35 45 0.006558630 ubox
35 47 0.127985702 ubox
35 49 0.017747149 ubox
35 51 0.011715326 ubox
35 52 0.004256907 ubox
35 54 0.145072150 ubox
35 64 0.003925548 ubox
35 66 0.005721716 ubox
35 82 0.416587580 ubox
35 84 0.808444097 ubox
35 86 0.018998560 ubox
36 42 0.004140077 ubox
36 46 0.168722789 ubox
36 50 0.022404047 ubox
36 53 0.146983726 ubox
36 65 0.007426050 ubox
36 74 0.003358520 ubox
36 83 0.805896998 ubox
36 85 0.024857554 ubox
37 41 0.004114721 ubox
37 44 0.009582855 ubox
37 45 0.168761920 ubox
37 48 0.051201071 ubox
37 49 0.020337055 ubox
37 52 0.146991557 ubox
37 55 0.016527295 ubox
37 64 0.007406246 ubox
37 73 0.003428713 ubox
37 77 0.144984463 ubox
37 78 0.784061713 ubox
37 79 0.155163000 ubox
37 80 0.370343967 ubox
37 81 0.382124419 ubox
37 84 0.018684392 ubox
37 87 0.020700138 ubox
37 88 0.010525359 ubox
37 91 0.004442436 ubox
38 43 0.010413776 ubox
38 44 0.168691389 ubox
38 47 0.052221045 ubox
38 48 0.018005063 ubox
38 51 0.146756701 ubox
38 54 0.016577564 ubox
38 76 0.145860354 ubox
38 77 0.789332504 ubox
38 78 0.152831014 ubox
38 79 0.364324446 ubox
38 80 0.377837808 ubox
38 86 0.020767042 ubox
38 87 0.010502563 ubox
38 90 0.004522574 ubox
39 46 0.052976103 ubox
39 50 0.123274075 ubox
39 53 0.016537700 ubox
39 75 0.134138070 ubox
39 85 0.020412114 ubox
40 62 0.007157955 ubox
40 74 0.118086340 ubox
40 75 0.889382784 ubox
41 50 0.080800085 ubox
41 61 0.007179338 ubox
41 71 0.073443042 ubox
41 74 0.892548809 ubox
41 85 0.011384731 ubox
42 49 0.088361570 ubox
42 51 0.006216132 ubox
42 60 0.007196977 ubox
42 70 0.073794987 ubox
42 73 0.894431063 ubox
42 76 0.360210753 ubox
42 84 0.011458172 ubox
43 50 0.006674294 ubox
43 69 0.073922457 ubox
43 75 0.357708550 ubox
43 83 0.011370682 ubox
44 68 0.073728495 ubox
44 69 0.007919195 ubox
44 74 0.352910657 ubox
44 75 0.083502716 ubox
45 53 0.005703881 ubox
45 65 0.017705459 ubox
45 68 0.008278721 ubox
45 71 0.960921466 ubox
45 74 0.095547272 ubox
46 52 0.005708347 ubox
46 54 0.005112582 ubox
46 64 0.017707439 ubox
46 66 0.036163002 ubox
46 70 0.962327587 ubox
46 73 0.106164619 ubox
46 76 0.003723329 ubox
47 53 0.005152939 ubox
47 65 0.035592083 ubox
47 69 0.960912782 ubox
47 75 0.003658245 ubox
48 62 0.022938170 ubox
48 68 0.955158691 ubox
48 69 0.056545603 ubox
48 74 0.003547070 ubox
48 75 0.004314260 ubox
49 61 0.023048574 ubox
49 65 0.747300535 ubox
49 68 0.076380987 ubox
49 71 0.117129792 ubox
49 74 0.004408667 ubox
50 60 0.023052446 ubox
50 64 0.750153844 ubox
50 66 0.434261238 ubox
50 70 0.117235929 ubox
50 73 0.004477412 ubox
51 62 0.763702548 ubox
51 65 0.412208383 ubox
51 69 0.117231337 ubox
52 61 0.767324935 ubox
52 65 0.452439777 ubox
52 68 0.116803968 ubox
52 71 0.004581923 ubox
53 60 0.767177021 ubox
53 64 0.480225525 ubox
53 66 0.115551174 ubox
53 70 0.004599041 ubox
54 62 0.411496652 ubox
54 65 0.113741249 ubox
54 69 0.004592839 ubox
55 61 0.411258307 ubox
55 62 0.455835768 ubox
55 68 0.004579305 ubox
56 61 0.457498019 ubox
56 62 0.089315531 ubox
57 61 0.088044665 ubox
64 85 0.003646306 ubox
65 84 0.003651947 ubox
66 83 0.003629297 ubox
68 87 0.227634058 ubox
68 88 0.009875880 ubox
69 86 0.228201038 ubox
69 87 0.007042172 ubox
70 85 0.228368753 ubox
71 84 0.228265919 ubox
74 80 0.010710678 ubox
74 81 0.228281154 ubox
74 87 0.014627584 ubox
75 79 0.010794807 ubox
75 80 0.228237578 ubox
75 84 0.006751101 ubox
75 86 0.016708758 ubox
76 83 0.015274407 ubox
76 85 0.017049648 ubox
1 33 0.9500000 lbox
2 32 0.9500000 lbox
3 31 0.9500000 lbox
4 30 0.9500000 lbox
7 27 0.9500000 lbox
8 26 0.9500000 lbox
11 23 0.9500000 lbox
12 22 0.9500000 lbox
13 21 0.9500000 lbox
34 85 0.9500000 lbox
35 84 0.9500000 lbox
36 83 0.9500000 lbox
37 78 0.9500000 lbox
38 77 0.9500000 lbox
40 75 0.9500000 lbox
41 74 0.9500000 lbox
42 73 0.9500000 lbox
45 71 0.9500000 lbox
46 70 0.9500000 lbox
47 69 0.9500000 lbox
48 68 0.9500000 lbox
49 65 0.9500000 lbox
50 64 0.9500000 lbox
51 62 0.9500000 lbox
52 61 0.9500000 lbox
53 60 0.9500000 lbox
showpage
end
%%EOF
