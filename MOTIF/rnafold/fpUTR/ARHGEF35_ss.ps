%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:39:03 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AAACUUCCUAGGAGAACCCGAUCCCUCCCUCCCGUCGGGCGGCCAGGGGCGGGCCGCGGGUGGGGCGGCCGGGCCUGCGCUGGGGACGGCUCUGGGGACUGCGGCCGGCGCCGGGACCUGGAGGGGACGCUGGGGCCGAAGCAGCAUGUGACACCGACCAGGAUUCAGCCCUG\
) } def
/len { sequence length } bind def

/coor [
[327.55822754 230.74867249]
[312.58468628 229.85813904]
[302.07373047 219.15673828]
[301.45220947 204.16961670]
[311.04098511 192.63465881]
[325.89138794 190.50785828]
[311.59243774 185.97575378]
[297.29348755 181.44364929]
[282.99453735 176.91154480]
[268.52432251 180.44180298]
[257.70687866 168.89653015]
[243.40794373 164.36442566]
[229.10899353 159.83232117]
[214.81002808 155.30021667]
[211.50367737 156.61614990]
[207.39012146 156.37477112]
[203.21813965 154.21195984]
[199.87156677 150.11622620]
[185.83895874 144.81663513]
[171.80633545 139.51704407]
[164.41233826 140.09742737]
[157.56964111 133.99302673]
[143.63499451 128.44094849]
[129.70034790 122.88888550]
[115.76569366 117.33680725]
[101.83104706 111.78473663]
[86.88052368 110.56735992]
[72.23121643 113.79191589]
[57.58190918 117.01647186]
[42.93260193 120.24102783]
[29.65124130 132.97280884]
[13.14262295 127.06385803]
[-1.44608140 130.55236816]
[-16.03478622 134.04087830]
[-30.62348938 137.52938843]
[-44.62213516 147.09361267]
[-57.68778992 136.28967285]
[-50.92301178 120.74380493]
[-34.11199951 122.94068909]
[-19.52329636 119.45217896]
[-4.93459320 115.96366119]
[9.65411091 112.47515106]
[16.26584435 102.31954956]
[28.41786003 99.30855560]
[39.70804596 105.59172058]
[54.35735321 102.36716461]
[69.00666046 99.14260864]
[83.65596771 95.91805267]
[87.40730286 81.39470673]
[76.15205383 71.47908783]
[64.89680481 61.56347656]
[53.64155960 51.64786148]
[42.38631058 41.73224640]
[31.13106346 31.81663322]
[19.87581635 21.90102005]
[11.33625507 18.56006432]
[8.50895309 11.70335007]
[-2.56544209 1.58614838]
[-13.63983727 -8.53105354]
[-29.04706383 -12.12660122]
[-33.22486496 -26.42328835]
[-44.29925919 -36.54048920]
[-60.07131577 -42.75970078]
[-58.46129227 -59.63702774]
[-41.79784012 -62.76203537]
[-34.18205643 -47.61488342]
[-23.10766029 -37.49768448]
[-8.49254990 -34.62578583]
[-3.52263498 -19.60544777]
[7.55176020 -9.48824692]
[18.62615395 0.62895566]
[29.79143143 10.64577198]
[41.04667664 20.56138611]
[52.30192566 30.47700119]
[63.55717468 40.39261627]
[74.81242371 50.30822754]
[86.06766510 60.22384262]
[97.32291412 70.13945770]
[106.15198517 76.38035583]
[110.61970520 84.44427490]
[110.73533630 92.21257782]
[107.38311768 97.85009003]
[121.31777191 103.40216064]
[135.25242615 108.95423126]
[149.18707275 114.50630188]
[163.12171936 120.05838013]
[177.10592651 125.48442841]
[191.13854980 130.78401184]
[205.17115784 136.08360291]
[219.34214783 141.00125122]
[233.64109802 145.53337097]
[247.94004822 150.06547546]
[262.23898315 154.59757996]
[277.73193359 151.39147949]
[287.52664185 162.61259460]
[301.82559204 167.14469910]
[316.12454224 171.67680359]
[330.42349243 176.20890808]
[361.60522461 168.09938049]
[375.82003784 163.30986023]
[390.03482056 158.52032471]
[404.24963379 153.73080444]
[408.81604004 141.03747559]
[419.70684814 133.41220093]
[432.80688477 133.46212769]
[443.32174683 140.94444275]
[457.62069702 136.41232300]
[471.91964722 131.88021851]
[486.21859741 127.34811401]
[497.03604126 115.80284119]
[511.50622559 119.33310699]
[525.80517578 114.80099487]
[540.10412598 110.26889038]
[554.40307617 105.73678589]
[562.15551758 90.07343292]
[578.51055908 84.94731140]
[593.22546387 93.05812836]
[607.44024658 88.26860046]
[621.65509033 83.47908020]
[632.08367920 70.82299805]
[648.21166992 73.79290771]
[653.44793701 89.33361053]
[642.40588379 101.45816803]
[626.44458008 97.69387817]
[612.22979736 102.48339844]
[598.01501465 107.27291870]
[593.95050049 119.52146912]
[583.40972900 127.29998016]
[570.11773682 127.58045959]
[558.93518066 120.03573608]
[544.63623047 124.56784058]
[530.33728027 129.09994507]
[516.03833008 133.63204956]
[506.24365234 144.85316467]
[490.75070190 141.64706421]
[476.45175171 146.17916870]
[462.15280151 150.71128845]
[447.85385132 155.24339294]
[440.77160645 170.48007202]
[424.54690552 176.00480652]
[409.03915405 167.94560242]
[394.82437134 172.73512268]
[380.60955811 177.52465820]
[366.39477539 182.31417847]
[381.16564941 184.92590332]
[395.93652344 187.53764343]
[410.58883667 184.32684326]
[425.16857910 187.85272217]
[436.73455811 197.40402222]
[442.95370483 211.05401611]
[442.57141113 226.04914856]
[435.66482544 239.36450195]
[423.62713623 248.31405640]
[408.88671875 251.09243774]
[394.41702271 247.13919067]
[383.13699341 237.25177002]
[377.32244873 223.42669678]
[366.67895508 212.85711670]
[356.03546143 202.28752136]
[360.30868530 216.66596985]
[364.58187866 231.04441833]
[368.85510254 245.42286682]
[383.27236938 251.47897339]
[390.37780762 265.40902710]
[386.81646729 280.63568115]
[374.26992798 289.96936035]
[358.66223145 289.00302124]
[347.36288452 278.19290161]
[345.70706177 262.64321899]
[354.47665405 249.69607544]
[350.20343018 235.31762695]
[345.93023682 220.93917847]
[341.65701294 206.56074524]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[6 98]
[7 97]
[8 96]
[9 95]
[11 93]
[12 92]
[13 91]
[14 90]
[18 89]
[19 88]
[20 87]
[22 86]
[23 85]
[24 84]
[25 83]
[26 82]
[27 48]
[28 47]
[29 46]
[30 45]
[32 42]
[33 41]
[34 40]
[35 39]
[49 78]
[50 77]
[51 76]
[52 75]
[53 74]
[54 73]
[55 72]
[57 71]
[58 70]
[59 69]
[61 67]
[62 66]
[99 144]
[100 143]
[101 142]
[102 141]
[106 138]
[107 137]
[108 136]
[109 135]
[111 133]
[112 132]
[113 131]
[114 130]
[117 126]
[118 125]
[119 124]
[159 173]
[160 172]
[161 171]
[162 170]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
