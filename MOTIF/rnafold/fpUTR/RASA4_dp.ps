%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:52:27 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (RASA4)
} def

/sequence { (\
CCAGUCCAGCGCCCGCCGCCCGCCACCCCGGACCCCGGUGUCUGGCUUCCCCCGAGCCGGGACCCCGCG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 31 0.062434729 ubox
1 38 0.016529524 ubox
1 45 0.040910743 ubox
1 60 0.006834394 ubox
1 61 0.008605158 ubox
2 30 0.062638688 ubox
2 37 0.017207271 ubox
2 44 0.042767138 ubox
2 59 0.006856603 ubox
2 60 0.007851095 ubox
3 43 0.042859317 ubox
3 47 0.349657034 ubox
3 48 0.053588389 ubox
4 10 0.046353936 ubox
4 12 0.033187024 ubox
4 16 0.011182003 ubox
4 19 0.069360051 ubox
4 23 0.061226214 ubox
4 26 0.060359856 ubox
4 33 0.508365653 ubox
4 42 0.042821336 ubox
4 46 0.374083771 ubox
4 47 0.059776750 ubox
4 57 0.003845432 ubox
4 63 0.324044824 ubox
4 68 0.064958405 ubox
5 9 0.043445942 ubox
5 11 0.032395760 ubox
5 15 0.010861662 ubox
5 18 0.069048872 ubox
5 22 0.060026112 ubox
5 25 0.059540634 ubox
5 32 0.509885284 ubox
5 45 0.076911865 ubox
5 56 0.003706479 ubox
5 61 0.012878260 ubox
5 62 0.324898226 ubox
5 67 0.058703883 ubox
6 31 0.509639827 ubox
6 38 0.003644575 ubox
6 44 0.064901935 ubox
6 45 0.390630856 ubox
6 60 0.018989919 ubox
6 61 0.324197228 ubox
7 30 0.508119461 ubox
7 37 0.003719550 ubox
7 40 0.018795663 ubox
7 44 0.394266720 ubox
7 59 0.021906712 ubox
7 60 0.299452261 ubox
8 39 0.018722699 ubox
8 43 0.398914743 ubox
8 47 0.023947347 ubox
8 48 0.007179192 ubox
9 16 0.170272646 ubox
9 19 0.473751816 ubox
9 23 0.290448859 ubox
9 41 0.170473218 ubox
9 42 0.396429086 ubox
9 46 0.025560610 ubox
9 47 0.008551227 ubox
9 57 0.083599002 ubox
9 68 0.457772152 ubox
10 15 0.170387349 ubox
10 18 0.474730676 ubox
10 22 0.290555526 ubox
10 30 0.011252707 ubox
10 37 0.018014253 ubox
10 40 0.390478622 ubox
10 44 0.004991662 ubox
10 45 0.025423592 ubox
10 54 0.005451030 ubox
10 56 0.083529725 ubox
10 59 0.035647678 ubox
10 67 0.458258652 ubox
10 69 0.190571590 ubox
11 17 0.464287465 ubox
11 19 0.178421599 ubox
11 21 0.249484186 ubox
11 23 0.091637956 ubox
11 29 0.023898627 ubox
11 36 0.018390312 ubox
11 39 0.389548860 ubox
11 41 0.161897670 ubox
11 43 0.009472117 ubox
11 46 0.080979766 ubox
11 53 0.006126203 ubox
11 57 0.128273124 ubox
11 58 0.026044026 ubox
11 66 0.441290005 ubox
11 68 0.206550553 ubox
12 18 0.189284643 ubox
12 22 0.091514356 ubox
12 31 0.006740993 ubox
12 38 0.354652074 ubox
12 40 0.163363335 ubox
12 45 0.081389277 ubox
12 56 0.130653568 ubox
12 60 0.020684234 ubox
12 61 0.268093226 ubox
12 67 0.205976480 ubox
13 30 0.006604469 ubox
13 31 0.041157736 ubox
13 37 0.315276496 ubox
13 38 0.232160911 ubox
13 44 0.081321221 ubox
13 59 0.021323634 ubox
13 60 0.267957001 ubox
13 61 0.015651942 ubox
14 22 0.099849179 ubox
14 30 0.041340523 ubox
14 37 0.282896481 ubox
14 40 0.434593114 ubox
14 54 0.141208986 ubox
14 59 0.267135184 ubox
14 60 0.009242784 ubox
14 67 0.006682961 ubox
14 69 0.071385671 ubox
15 21 0.099614844 ubox
15 23 0.313024379 ubox
15 29 0.039360606 ubox
15 36 0.323670303 ubox
15 39 0.455931816 ubox
15 41 0.004113832 ubox
15 46 0.024567904 ubox
15 53 0.140598248 ubox
15 57 0.164959787 ubox
15 58 0.197700522 ubox
15 66 0.009274971 ubox
15 68 0.076276780 ubox
16 22 0.313218590 ubox
16 31 0.122590224 ubox
16 38 0.457563807 ubox
16 40 0.003333576 ubox
16 45 0.024636506 ubox
16 56 0.232220771 ubox
16 60 0.017397138 ubox
16 61 0.020908483 ubox
16 67 0.074040154 ubox
17 30 0.122747071 ubox
17 37 0.457623709 ubox
17 40 0.024713040 ubox
17 44 0.024631447 ubox
17 54 0.236176482 ubox
17 59 0.017513136 ubox
17 60 0.019194467 ubox
17 67 0.017211224 ubox
17 69 0.102577361 ubox
18 29 0.119831350 ubox
18 36 0.454359035 ubox
18 39 0.025522741 ubox
18 41 0.011263414 ubox
18 43 0.022363372 ubox
18 46 0.044294722 ubox
18 53 0.234236175 ubox
18 57 0.097075294 ubox
18 58 0.012289546 ubox
18 66 0.022662188 ubox
18 68 0.109627636 ubox
19 31 0.103430299 ubox
19 38 0.025024055 ubox
19 40 0.012078800 ubox
19 45 0.044323759 ubox
19 56 0.097962709 ubox
19 60 0.003754149 ubox
19 61 0.045193324 ubox
19 67 0.108761694 ubox
20 30 0.093338455 ubox
20 31 0.614106176 ubox
20 37 0.024295711 ubox
20 38 0.018136795 ubox
20 44 0.043850270 ubox
20 45 0.015341666 ubox
20 59 0.004143909 ubox
20 60 0.045225074 ubox
20 61 0.004337306 ubox
21 30 0.617380909 ubox
21 37 0.018933736 ubox
21 40 0.030662486 ubox
21 44 0.016757790 ubox
21 54 0.091036217 ubox
21 59 0.045164152 ubox
21 60 0.004013567 ubox
21 67 0.009921800 ubox
21 69 0.108288344 ubox
22 29 0.604263164 ubox
22 36 0.019668230 ubox
22 39 0.031117333 ubox
22 41 0.021844294 ubox
22 43 0.016910622 ubox
22 46 0.298263952 ubox
22 53 0.078528023 ubox
22 57 0.007479775 ubox
22 58 0.015574975 ubox
22 66 0.010770976 ubox
22 68 0.115731159 ubox
23 31 0.374206140 ubox
23 38 0.030114336 ubox
23 40 0.019349622 ubox
23 45 0.299377410 ubox
23 56 0.009932342 ubox
23 60 0.004337899 ubox
23 61 0.006793305 ubox
23 67 0.114646974 ubox
24 30 0.374279263 ubox
24 37 0.029437671 ubox
24 40 0.087130385 ubox
24 44 0.298966469 ubox
24 59 0.004883405 ubox
24 60 0.006031517 ubox
25 39 0.086799812 ubox
25 41 0.243578255 ubox
25 43 0.228757934 ubox
26 38 0.074218022 ubox
26 40 0.307585603 ubox
26 45 0.004899827 ubox
26 61 0.004277524 ubox
27 37 0.068393055 ubox
27 38 0.028346641 ubox
27 44 0.004860818 ubox
27 45 0.005122725 ubox
27 60 0.004081824 ubox
27 61 0.009403061 ubox
28 37 0.022817526 ubox
28 38 0.376827713 ubox
28 44 0.003685360 ubox
28 45 0.084991915 ubox
28 59 0.003613510 ubox
28 60 0.009292103 ubox
29 37 0.379221343 ubox
29 44 0.085462468 ubox
29 59 0.009296601 ubox
29 67 0.110051473 ubox
29 69 0.012093509 ubox
30 36 0.385238241 ubox
30 43 0.086283027 ubox
30 50 0.016351188 ubox
30 58 0.007713751 ubox
30 64 0.039327367 ubox
30 65 0.108028683 ubox
30 66 0.116442014 ubox
30 68 0.012422432 ubox
31 35 0.379069087 ubox
31 42 0.086710077 ubox
31 49 0.016399049 ubox
31 57 0.007683492 ubox
31 63 0.039408151 ubox
31 64 0.109906116 ubox
31 65 0.114655398 ubox
32 39 0.008090432 ubox
32 41 0.086801748 ubox
32 48 0.016315678 ubox
33 38 0.008330911 ubox
33 40 0.086491417 ubox
33 61 0.017108153 ubox
34 60 0.014067571 ubox
34 61 0.246998433 ubox
35 45 0.016777233 ubox
35 59 0.010056564 ubox
35 60 0.247976195 ubox
36 44 0.016812080 ubox
36 54 0.006816263 ubox
36 59 0.248782876 ubox
36 67 0.552528882 ubox
36 69 0.012893188 ubox
37 43 0.016745450 ubox
37 53 0.006851385 ubox
37 58 0.248985355 ubox
37 64 0.184162497 ubox
37 65 0.145576608 ubox
37 66 0.577227489 ubox
37 68 0.010037178 ubox
38 42 0.016409096 ubox
38 52 0.006826722 ubox
38 57 0.248957337 ubox
38 63 0.185054074 ubox
38 64 0.148683720 ubox
38 65 0.575944319 ubox
38 68 0.019016616 ubox
39 56 0.239376490 ubox
39 62 0.184577689 ubox
39 67 0.019331815 ubox
40 53 0.006607778 ubox
40 57 0.003904381 ubox
40 63 0.602910723 ubox
40 66 0.018611693 ubox
40 68 0.005851734 ubox
41 55 0.187096977 ubox
41 56 0.004962448 ubox
41 60 0.042229553 ubox
41 61 0.412852192 ubox
41 62 0.571269056 ubox
41 67 0.005411009 ubox
42 54 0.199309833 ubox
42 56 0.008818248 ubox
42 59 0.062647760 ubox
42 60 0.608722435 ubox
42 61 0.468538284 ubox
43 54 0.084004713 ubox
43 55 0.009036267 ubox
43 59 0.719905712 ubox
43 60 0.329007800 ubox
43 67 0.016507922 ubox
44 50 0.044160219 ubox
44 51 0.098290449 ubox
44 52 0.174292282 ubox
44 53 0.140794883 ubox
44 58 0.816218889 ubox
44 64 0.007723343 ubox
44 65 0.009645136 ubox
44 66 0.030880032 ubox
45 49 0.043617499 ubox
45 50 0.097639774 ubox
45 51 0.173376810 ubox
45 52 0.139746791 ubox
45 57 0.817153114 ubox
45 63 0.007853253 ubox
45 64 0.009835897 ubox
45 65 0.031175192 ubox
45 68 0.028048784 ubox
46 56 0.816655500 ubox
46 67 0.028998182 ubox
47 55 0.789407522 ubox
47 56 0.036274628 ubox
47 62 0.015495365 ubox
48 54 0.732445231 ubox
48 55 0.209056958 ubox
48 61 0.017842159 ubox
48 62 0.173509434 ubox
49 54 0.289706312 ubox
49 60 0.019387360 ubox
49 61 0.186632763 ubox
50 59 0.019686563 ubox
50 60 0.186054479 ubox
50 61 0.117323510 ubox
51 59 0.185237204 ubox
51 60 0.117369879 ubox
51 61 0.348078696 ubox
52 59 0.116943459 ubox
52 60 0.349422565 ubox
52 61 0.022517902 ubox
53 59 0.350013489 ubox
53 60 0.022571441 ubox
53 69 0.012915404 ubox
54 58 0.328049515 ubox
54 68 0.013417440 ubox
56 68 0.069752613 ubox
57 67 0.054487452 ubox
58 67 0.059120132 ubox
58 69 0.007358988 ubox
59 65 0.034927333 ubox
59 66 0.081019138 ubox
59 68 0.008440435 ubox
60 64 0.034434883 ubox
60 65 0.080861776 ubox
60 66 0.023555477 ubox
61 65 0.027426125 ubox
9 68 0.9500000 lbox
10 67 0.9500000 lbox
11 66 0.9500000 lbox
14 40 0.9500000 lbox
15 39 0.9500000 lbox
16 38 0.9500000 lbox
17 37 0.9500000 lbox
18 36 0.9500000 lbox
23 31 0.9500000 lbox
24 30 0.9500000 lbox
41 61 0.9500000 lbox
42 60 0.9500000 lbox
43 59 0.9500000 lbox
44 58 0.9500000 lbox
45 57 0.9500000 lbox
46 56 0.9500000 lbox
47 55 0.9500000 lbox
48 54 0.9500000 lbox
showpage
end
%%EOF
