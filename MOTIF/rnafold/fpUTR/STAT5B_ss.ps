%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 02:38:09 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
GGCGGGAGGAGAGUCGGCGGCCGGAGCCGUCACCCCGGGCGGGGACCCAGCGCAGGCAACUCCGCGCGGCGGCCCGGCCGAGGGAGGGAGCGAGCGGGCGGGCGGGCAAGCCAGACAGCUGGGCCGGAGCAGCCGCGGGCGCCCGAGGGGCCGAGCGAGAUUGUAAACC\
) } def
/len { sequence length } bind def

/coor [
[106.45285034 144.13034058]
[101.81759644 129.86448669]
[97.18233490 115.59864044]
[89.68746185 115.32150269]
[74.69770813 114.76723480]
[67.20282745 114.49009705]
[61.52666092 128.37466431]
[67.87243652 142.84901428]
[62.04691696 157.54046631]
[47.50628662 163.73284912]
[32.87724304 157.75233459]
[26.83893585 143.14704895]
[32.97378540 128.58204651]
[47.64209747 122.69849396]
[53.31826019 108.81392670]
[41.18300629 99.99714661]
[29.73203278 109.68607330]
[18.28105927 119.37499237]
[6.83008432 129.06391907]
[-4.62089014 138.75283813]
[-16.07186508 148.44175720]
[-21.10514259 164.04939270]
[-37.19304276 167.22924805]
[-47.78571320 154.71015930]
[-41.98632050 139.37069702]
[-25.76078606 136.99078369]
[-14.30981064 127.30185699]
[-2.85883665 117.61293793]
[8.59213734 107.92401886]
[20.04311180 98.23509979]
[31.49408531 88.54617310]
[68.47032166 77.26763916]
[96.12275696 92.68019867]
[99.42195129 78.04751587]
[102.72114563 63.41483688]
[105.88499451 48.75229645]
[108.91323090 34.06114960]
[111.94146729 19.37000465]
[114.96970367 4.67885733]
[117.99794006 -10.01228905]
[121.02617645 -24.70343590]
[119.47515106 -28.85465813]
[119.36192322 -32.87410736]
[120.46363068 -36.31943130]
[122.43495941 -38.86851501]
[124.85897064 -40.34936142]
[128.96391296 -54.77674484]
[133.06886292 -69.20413208]
[126.16545868 -68.86804199]
[118.79580688 -71.15202332]
[106.04254913 -79.04850769]
[93.28929138 -86.94498444]
[77.48298645 -87.63145447]
[70.73520660 -100.90988922]
[57.98194885 -108.80637360]
[41.58283997 -108.77027893]
[33.58718109 -123.08815002]
[42.22021866 -137.03099060]
[58.60102463 -136.25559998]
[65.87843323 -121.55962372]
[78.63168335 -113.66314697]
[93.52579498 -113.54148102]
[101.18577576 -99.69824219]
[113.93903351 -91.80176544]
[126.69229126 -83.90528107]
[141.35482788 -87.06912994]
[149.71716309 -99.52188873]
[158.07951355 -111.97465515]
[166.44184875 -124.42741394]
[174.80419922 -136.88017273]
[176.07426453 -152.65031433]
[189.59295654 -158.90283203]
[197.95530701 -171.35559082]
[206.20222473 -183.88508606]
[214.33302307 -196.49024963]
[222.46382141 -209.09541321]
[230.59463501 -221.70057678]
[238.72543335 -234.30574036]
[246.85623169 -246.91088867]
[247.83467102 -262.70181274]
[261.23553467 -269.20306396]
[269.36633301 -281.80822754]
[260.97912598 -297.21325684]
[261.52255249 -314.65621948]
[270.75799561 -329.35891724]
[286.07803345 -337.33905029]
[303.24209595 -336.48892212]
[310.90155029 -349.38589478]
[310.20135498 -369.50643921]
[327.39547729 -378.30242920]
[334.57315063 -391.47363281]
[330.33416748 -406.46258545]
[337.80096436 -419.71783447]
[352.11679077 -423.66668701]
[359.29446411 -436.83789062]
[354.58926392 -451.92553711]
[362.00466919 -465.88217163]
[377.14120483 -470.42755127]
[391.01864624 -462.86502075]
[395.40377808 -447.68127441]
[387.69494629 -433.88455200]
[372.46566772 -429.66021729]
[365.28799438 -416.48901367]
[369.72955322 -402.31832886]
[362.63800049 -388.85858154]
[347.74435425 -384.29595947]
[340.56668091 -371.12475586]
[344.33511353 -361.57522583]
[342.15890503 -351.31729126]
[334.52410889 -343.81164551]
[323.79855347 -341.72644043]
[316.13906860 -328.82943726]
[323.49114990 -318.50247192]
[326.38885498 -306.11331177]
[324.36480713 -293.50439453]
[317.68627930 -282.56469727]
[307.32052612 -274.94674683]
[294.79483032 -271.81701660]
[281.97149658 -273.67742920]
[273.84066772 -261.07226562]
[273.44381714 -246.18295288]
[259.46139526 -238.78009033]
[251.33059692 -226.17492676]
[243.19978333 -213.56977844]
[235.06898499 -200.96461487]
[226.93818665 -188.35945129]
[218.80738831 -175.75428772]
[217.82025146 -168.39999390]
[210.40806580 -162.99325562]
[202.04573059 -150.54049683]
[201.37379456 -135.66105652]
[187.25695801 -128.51783752]
[178.89460754 -116.06507111]
[170.53227234 -103.61231232]
[162.16992188 -91.15954590]
[153.80758667 -78.70678711]
[147.49624634 -65.09918213]
[143.39129639 -50.67179871]
[139.28634644 -36.24441528]
[135.71733093 -21.67519951]
[132.68908691 -6.98405313]
[129.66085815 7.70709372]
[126.63261414 22.39823914]
[123.60437775 37.08938599]
[120.57614136 51.78053284]
[122.31234741 58.99480820]
[117.35382843 66.71403503]
[114.05462646 81.34671021]
[110.75543213 95.97939301]
[111.44818878 110.96338654]
[116.08344269 125.22923279]
[120.71869659 139.49508667]
[135.84664917 139.47683716]
[150.23919678 144.13619995]
[162.48631287 153.01670837]
[171.38813782 165.24833679]
[176.07257080 179.63273621]
[176.08068848 194.76069641]
[171.41166687 209.15013123]
[162.52296448 221.39128113]
[150.28536987 230.28491211]
[135.89782715 234.95971680]
[120.76986694 234.95768738]
[106.38357544 230.27903748]
[94.14837646 221.38212585]
[85.26294708 209.13858032]
[80.59779358 194.74790955]
[80.60995483 179.61994934]
[85.29824829 165.23680115]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[1 152]
[2 151]
[3 150]
[6 15]
[7 14]
[16 31]
[17 30]
[18 29]
[19 28]
[20 27]
[21 26]
[33 149]
[34 148]
[35 147]
[36 145]
[37 144]
[38 143]
[39 142]
[40 141]
[41 140]
[46 139]
[47 138]
[48 137]
[50 65]
[51 64]
[52 63]
[54 61]
[55 60]
[66 136]
[67 135]
[68 134]
[69 133]
[70 132]
[72 130]
[73 129]
[74 127]
[75 126]
[76 125]
[77 124]
[78 123]
[79 122]
[81 120]
[82 119]
[87 112]
[88 111]
[90 107]
[91 106]
[94 103]
[95 102]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
