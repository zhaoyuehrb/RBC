%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:55:28 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (TMEM256)
} def

/sequence { (\
UGGCCUCUUGGGUGGCCUGGGCGGCGUUGGUCCGGUGCGUCCUGUUCUACAGCU\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 14 0.129203072 ubox
1 19 0.020372264 ubox
1 23 0.003568259 ubox
1 26 0.003619389 ubox
1 34 0.003376498 ubox
1 39 0.006007519 ubox
1 44 0.004440496 ubox
1 49 0.075897392 ubox
1 51 0.179963087 ubox
2 8 0.019173163 ubox
2 9 0.008952665 ubox
2 13 0.203093912 ubox
2 17 0.755651362 ubox
2 18 0.008843883 ubox
2 22 0.007177596 ubox
2 25 0.007755847 ubox
2 32 0.004149335 ubox
2 33 0.004521777 ubox
2 38 0.007083513 ubox
2 41 0.021054293 ubox
2 42 0.017805128 ubox
2 43 0.004471354 ubox
2 46 0.038441267 ubox
2 47 0.025986869 ubox
2 48 0.086995850 ubox
2 50 0.199501323 ubox
2 54 0.224086135 ubox
3 7 0.020311311 ubox
3 8 0.007479626 ubox
3 13 0.341530385 ubox
3 16 0.763628478 ubox
3 17 0.006597597 ubox
3 22 0.105107652 ubox
3 25 0.170565990 ubox
3 31 0.004215376 ubox
3 32 0.004345280 ubox
3 38 0.004221200 ubox
3 40 0.017960475 ubox
3 41 0.016879817 ubox
3 42 0.004089717 ubox
3 45 0.050496739 ubox
3 46 0.021489336 ubox
3 47 0.087839106 ubox
3 53 0.252778100 ubox
4 11 0.248195003 ubox
4 12 0.352724634 ubox
4 15 0.763697670 ubox
4 20 0.005429307 ubox
4 21 0.105263369 ubox
4 24 0.170902001 ubox
4 30 0.005791602 ubox
4 37 0.004163797 ubox
4 39 0.017638874 ubox
4 44 0.052370378 ubox
4 52 0.250165244 ubox
5 10 0.249657583 ubox
5 11 0.352318343 ubox
5 12 0.011816874 ubox
5 14 0.763676363 ubox
5 19 0.005440473 ubox
5 20 0.105155236 ubox
5 21 0.004395571 ubox
5 23 0.170846343 ubox
5 29 0.005784415 ubox
5 52 0.032838795 ubox
6 10 0.317439840 ubox
6 11 0.015045712 ubox
6 12 0.130744549 ubox
6 19 0.095172491 ubox
6 20 0.005651883 ubox
6 21 0.045512136 ubox
6 51 0.042367356 ubox
7 11 0.133591185 ubox
7 14 0.015091179 ubox
7 15 0.006409243 ubox
7 19 0.037743647 ubox
7 20 0.046551630 ubox
7 21 0.164440356 ubox
7 52 0.012965171 ubox
8 14 0.006631171 ubox
8 19 0.044153544 ubox
8 20 0.164193447 ubox
8 51 0.013960729 ubox
8 52 0.008050134 ubox
9 19 0.160712225 ubox
9 34 0.003208027 ubox
9 44 0.238561325 ubox
9 49 0.023698626 ubox
9 51 0.015138578 ubox
10 17 0.112774872 ubox
10 18 0.165147779 ubox
10 33 0.003704184 ubox
10 41 0.011036450 ubox
10 42 0.267031885 ubox
10 43 0.325872924 ubox
10 46 0.007468864 ubox
10 47 0.019496833 ubox
10 48 0.023381753 ubox
10 50 0.014418358 ubox
10 54 0.007721178 ubox
11 16 0.112749562 ubox
11 17 0.165951823 ubox
11 18 0.004971430 ubox
11 32 0.003699647 ubox
11 40 0.010149666 ubox
11 41 0.268527734 ubox
11 42 0.335578727 ubox
11 43 0.022683020 ubox
11 45 0.004464703 ubox
11 46 0.012746931 ubox
11 47 0.022919683 ubox
11 48 0.007155965 ubox
11 53 0.008725973 ubox
11 54 0.003610922 ubox
12 16 0.163276105 ubox
12 17 0.005073011 ubox
12 25 0.006799869 ubox
12 31 0.003316834 ubox
12 38 0.016636459 ubox
12 40 0.257106059 ubox
12 41 0.335715864 ubox
12 42 0.024344293 ubox
12 45 0.011398139 ubox
12 46 0.021085583 ubox
12 47 0.007760189 ubox
12 50 0.044520521 ubox
12 53 0.005705498 ubox
13 24 0.006795003 ubox
13 37 0.015449352 ubox
13 39 0.220892749 ubox
13 44 0.004465842 ubox
13 49 0.044607214 ubox
13 51 0.008040748 ubox
13 52 0.003676449 ubox
14 36 0.009734338 ubox
14 38 0.226237080 ubox
14 41 0.045839871 ubox
14 42 0.019010738 ubox
14 43 0.005405474 ubox
14 46 0.012692376 ubox
14 47 0.007696879 ubox
14 48 0.044487263 ubox
14 50 0.008475941 ubox
14 54 0.013011423 ubox
15 22 0.007433069 ubox
15 25 0.007845630 ubox
15 36 0.070222376 ubox
15 38 0.562104483 ubox
15 40 0.040737581 ubox
15 41 0.015881454 ubox
15 45 0.017670295 ubox
15 46 0.006297647 ubox
15 47 0.043734059 ubox
15 53 0.014640859 ubox
16 21 0.007411749 ubox
16 24 0.007861768 ubox
16 35 0.072472952 ubox
16 37 0.567429637 ubox
16 39 0.042022576 ubox
16 44 0.019242396 ubox
16 52 0.014219233 ubox
17 23 0.007862014 ubox
17 34 0.071529909 ubox
17 35 0.614924132 ubox
17 52 0.006823348 ubox
18 34 0.650149922 ubox
18 37 0.003902970 ubox
18 39 0.079228961 ubox
18 44 0.105818825 ubox
18 49 0.058212136 ubox
18 51 0.017150958 ubox
19 25 0.003537277 ubox
19 32 0.006488409 ubox
19 33 0.680365192 ubox
19 36 0.004488145 ubox
19 38 0.104731842 ubox
19 41 0.108762786 ubox
19 42 0.558787199 ubox
19 43 0.175116336 ubox
19 46 0.004211234 ubox
19 47 0.199306590 ubox
19 48 0.059481541 ubox
19 50 0.016146635 ubox
19 54 0.014550786 ubox
20 31 0.006531415 ubox
20 32 0.680410658 ubox
20 33 0.008877913 ubox
20 40 0.099616682 ubox
20 41 0.565177110 ubox
20 42 0.182198345 ubox
20 43 0.054034787 ubox
20 45 0.004549798 ubox
20 46 0.200680048 ubox
20 47 0.059895855 ubox
20 48 0.005700635 ubox
20 53 0.016254100 ubox
20 54 0.036634835 ubox
21 31 0.679888728 ubox
21 32 0.008702164 ubox
21 36 0.102721166 ubox
21 38 0.268827487 ubox
21 40 0.557361845 ubox
21 41 0.181450591 ubox
21 42 0.057527507 ubox
21 45 0.205228478 ubox
21 46 0.044871935 ubox
21 47 0.005793136 ubox
21 53 0.040065472 ubox
22 29 0.040389326 ubox
22 30 0.679000288 ubox
22 34 0.081006737 ubox
22 35 0.080902353 ubox
22 37 0.269817408 ubox
22 39 0.558650407 ubox
22 44 0.208401142 ubox
22 52 0.039736691 ubox
23 28 0.042081437 ubox
23 32 0.069235074 ubox
23 33 0.106027083 ubox
23 36 0.269997622 ubox
23 38 0.460687214 ubox
23 41 0.163526414 ubox
23 42 0.146867328 ubox
23 43 0.097421478 ubox
23 46 0.004375134 ubox
23 54 0.118847349 ubox
24 31 0.091968366 ubox
24 32 0.106111853 ubox
24 36 0.258646973 ubox
24 38 0.351463442 ubox
24 40 0.176170475 ubox
24 41 0.147977398 ubox
24 42 0.081231321 ubox
24 45 0.005208900 ubox
24 53 0.131982461 ubox
25 30 0.138971991 ubox
25 34 0.322601883 ubox
25 35 0.266418156 ubox
25 37 0.465675379 ubox
25 39 0.242197583 ubox
25 44 0.005304451 ubox
25 52 0.132013632 ubox
26 33 0.323358636 ubox
26 36 0.435409096 ubox
26 38 0.242820796 ubox
26 40 0.005176721 ubox
26 43 0.004417537 ubox
26 50 0.077354133 ubox
26 53 0.151488846 ubox
27 35 0.415220441 ubox
27 37 0.238885964 ubox
27 39 0.003177847 ubox
27 49 0.060174220 ubox
27 52 0.151240967 ubox
28 34 0.442902485 ubox
28 37 0.026732721 ubox
28 39 0.022875950 ubox
28 49 0.137282063 ubox
28 51 0.144516931 ubox
29 33 0.424840553 ubox
29 36 0.033923541 ubox
29 38 0.025358276 ubox
29 42 0.012547508 ubox
29 47 0.037026215 ubox
29 48 0.155784934 ubox
29 50 0.139741426 ubox
29 54 0.009894333 ubox
30 36 0.011098551 ubox
30 38 0.013932770 ubox
30 41 0.012769567 ubox
30 42 0.003569876 ubox
30 45 0.003301223 ubox
30 46 0.037475735 ubox
30 47 0.169560174 ubox
30 50 0.024629606 ubox
30 53 0.011163215 ubox
31 35 0.009741387 ubox
31 37 0.013636241 ubox
31 49 0.030996546 ubox
31 52 0.010887416 ubox
33 39 0.012959982 ubox
33 44 0.192060016 ubox
34 38 0.013771883 ubox
34 41 0.019549151 ubox
34 42 0.124509808 ubox
34 43 0.182361924 ubox
34 46 0.004612010 ubox
34 47 0.028102045 ubox
34 48 0.072697781 ubox
34 54 0.028688999 ubox
35 40 0.013649145 ubox
35 41 0.126257952 ubox
35 42 0.181208527 ubox
35 45 0.003181460 ubox
35 46 0.023914794 ubox
35 47 0.082953250 ubox
35 50 0.026433394 ubox
35 53 0.037066185 ubox
36 49 0.026334922 ubox
36 51 0.007321391 ubox
36 52 0.034694279 ubox
37 45 0.093953161 ubox
37 48 0.020741702 ubox
37 50 0.008361987 ubox
37 53 0.119846423 ubox
38 44 0.096155833 ubox
38 52 0.118557932 ubox
39 43 0.059375470 ubox
39 45 0.007586396 ubox
39 50 0.088705009 ubox
39 53 0.111397429 ubox
40 49 0.087691107 ubox
40 52 0.063751915 ubox
42 52 0.538440484 ubox
43 49 0.019533219 ubox
43 51 0.595366436 ubox
44 48 0.017825278 ubox
44 50 0.605476749 ubox
44 53 0.271353093 ubox
45 49 0.545500363 ubox
45 52 0.268476052 ubox
46 51 0.211651266 ubox
3 13 0.9500000 lbox
4 12 0.9500000 lbox
5 11 0.9500000 lbox
6 10 0.9500000 lbox
15 38 0.9500000 lbox
16 37 0.9500000 lbox
17 35 0.9500000 lbox
18 34 0.9500000 lbox
19 33 0.9500000 lbox
20 32 0.9500000 lbox
21 31 0.9500000 lbox
22 30 0.9500000 lbox
42 52 0.9500000 lbox
43 51 0.9500000 lbox
44 50 0.9500000 lbox
45 49 0.9500000 lbox
showpage
end
%%EOF
