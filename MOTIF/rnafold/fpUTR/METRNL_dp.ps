%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 02:23:32 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (METRNL)
} def

/sequence { (\
GCGGGGGGCGCGCGACGUGACCACCCGGACUCGAAGCCCGCCCCGCCCCCGCCCGGCUCGCCGGCUCCGGGGUCUGCUCCGGGGGUCGCGGACGCGGGGCCGGGCGGCGGAGCCGGCGCCAGAGC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 52 0.007103443 ubox
1 117 0.008618942 ubox
1 119 0.009363290 ubox
1 125 0.013177785 ubox
2 27 0.981549370 ubox
2 51 0.007130636 ubox
2 115 0.003971722 ubox
2 116 0.008375890 ubox
2 118 0.009308954 ubox
2 124 0.006450164 ubox
3 25 0.007691253 ubox
3 26 0.992732582 ubox
3 47 0.004147121 ubox
3 50 0.007141897 ubox
3 114 0.004490661 ubox
3 117 0.007474117 ubox
4 24 0.008223872 ubox
4 25 0.992264962 ubox
4 26 0.118586522 ubox
4 46 0.004189220 ubox
4 49 0.007120885 ubox
4 113 0.004159813 ubox
4 114 0.007567064 ubox
5 22 0.005768479 ubox
5 24 0.989164237 ubox
5 25 0.122817712 ubox
5 44 0.013314270 ubox
5 48 0.006170987 ubox
6 21 0.007239457 ubox
6 22 0.699268574 ubox
6 24 0.126692688 ubox
6 43 0.013869498 ubox
6 47 0.005034910 ubox
7 21 0.694933263 ubox
7 22 0.701336451 ubox
7 42 0.014365220 ubox
7 46 0.003563823 ubox
8 18 0.038881838 ubox
8 21 0.713023134 ubox
8 41 0.014807708 ubox
9 17 0.040872563 ubox
9 19 0.957464813 ubox
9 40 0.014824976 ubox
10 16 0.040445243 ubox
10 18 0.997935100 ubox
10 39 0.014805933 ubox
11 17 0.998380542 ubox
11 19 0.029107848 ubox
12 16 0.933991479 ubox
12 18 0.029533924 ubox
12 37 0.014847970 ubox
13 17 0.029413846 ubox
13 36 0.014860933 ubox
16 33 0.014711963 ubox
17 32 0.014690678 ubox
21 28 0.015058316 ubox
22 27 0.015059804 ubox
27 114 0.004033718 ubox
28 113 0.004062498 ubox
30 112 0.003498394 ubox
30 122 0.035837403 ubox
30 124 0.990219748 ubox
31 111 0.003386440 ubox
31 121 0.034966485 ubox
31 123 0.996230322 ubox
32 122 0.996614358 ubox
33 108 0.003493648 ubox
36 105 0.006684256 ubox
36 117 0.971555708 ubox
36 119 0.233532480 ubox
37 104 0.006690676 ubox
37 116 0.971315156 ubox
37 118 0.233779500 ubox
38 103 0.006690953 ubox
38 115 0.970310093 ubox
38 116 0.236542345 ubox
39 102 0.006689460 ubox
39 115 0.238488756 ubox
39 118 0.012061278 ubox
40 100 0.004734484 ubox
40 101 0.004729496 ubox
40 113 0.984090946 ubox
40 114 0.171988065 ubox
40 117 0.015782636 ubox
41 99 0.006693135 ubox
41 110 0.010413941 ubox
41 112 0.998082229 ubox
41 116 0.015611081 ubox
42 98 0.006693483 ubox
42 109 0.010914349 ubox
42 110 0.055218804 ubox
42 115 0.015389487 ubox
42 116 0.003413927 ubox
43 97 0.006693498 ubox
43 107 0.011594835 ubox
43 109 0.039071158 ubox
43 110 0.997377683 ubox
43 115 0.004231584 ubox
44 96 0.006693400 ubox
44 106 0.012060318 ubox
44 109 0.998871285 ubox
45 95 0.006693239 ubox
45 105 0.012148390 ubox
45 108 0.999628624 ubox
45 113 0.019274132 ubox
46 94 0.006681904 ubox
46 104 0.011935979 ubox
46 107 0.998874239 ubox
46 110 0.004706986 ubox
46 112 0.019397002 ubox
47 103 0.011718874 ubox
47 104 0.015767303 ubox
47 106 0.997731975 ubox
47 107 0.006279139 ubox
47 109 0.004722818 ubox
47 110 0.019909834 ubox
48 102 0.011481620 ubox
48 103 0.022293395 ubox
48 104 0.993708219 ubox
48 106 0.007902232 ubox
48 107 0.003547575 ubox
48 109 0.019918297 ubox
49 91 0.006638808 ubox
49 102 0.022907508 ubox
49 103 0.993818909 ubox
49 104 0.016164374 ubox
49 106 0.003738266 ubox
49 107 0.043749391 ubox
50 90 0.006655660 ubox
50 102 0.993545924 ubox
50 103 0.015799506 ubox
50 106 0.060588678 ubox
51 89 0.006658763 ubox
51 100 0.702793912 ubox
51 101 0.702954823 ubox
51 105 0.106099775 ubox
51 119 0.004184594 ubox
52 88 0.006641999 ubox
52 98 0.043596700 ubox
52 99 0.993244869 ubox
52 104 0.106156447 ubox
52 118 0.004199336 ubox
53 64 0.006698466 ubox
53 97 0.047537731 ubox
53 98 0.993124062 ubox
53 99 0.006244770 ubox
53 103 0.106157048 ubox
53 116 0.005751410 ubox
54 63 0.006804454 ubox
54 96 0.050991650 ubox
54 97 0.992495512 ubox
54 98 0.005916062 ubox
54 102 0.106155785 ubox
54 115 0.005984439 ubox
55 62 0.006891714 ubox
55 93 0.003663508 ubox
55 95 0.052430190 ubox
55 101 0.106156105 ubox
55 114 0.006166863 ubox
55 120 0.005513076 ubox
56 61 0.006849392 ubox
56 95 0.992361609 ubox
56 100 0.106139426 ubox
56 113 0.006167151 ubox
56 119 0.005514105 ubox
57 91 0.010358291 ubox
57 94 0.991714695 ubox
57 98 0.051091093 ubox
57 99 0.093043286 ubox
57 112 0.006166900 ubox
57 118 0.005024089 ubox
58 90 0.003276262 ubox
58 91 0.521580519 ubox
58 92 0.768385601 ubox
58 97 0.072185798 ubox
58 98 0.076621593 ubox
58 111 0.005828049 ubox
59 90 0.652014255 ubox
59 91 0.749485356 ubox
59 94 0.010454769 ubox
59 96 0.088890958 ubox
59 97 0.055279053 ubox
59 98 0.006354290 ubox
59 109 0.004375636 ubox
59 110 0.004198063 ubox
60 86 0.004184319 ubox
60 89 0.677338014 ubox
60 93 0.016042825 ubox
60 95 0.102587048 ubox
60 108 0.005881883 ubox
60 117 0.006121232 ubox
61 85 0.004398290 ubox
61 88 0.502740621 ubox
61 91 0.024076824 ubox
61 94 0.102467957 ubox
61 97 0.008484297 ubox
61 107 0.005865552 ubox
61 116 0.006140176 ubox
62 84 0.003936647 ubox
62 88 0.862910402 ubox
62 90 0.024273893 ubox
62 94 0.004305147 ubox
62 96 0.008690001 ubox
62 106 0.005830929 ubox
62 115 0.006140166 ubox
63 87 0.975579858 ubox
63 89 0.020767798 ubox
63 93 0.003759195 ubox
63 95 0.008274210 ubox
63 105 0.004973637 ubox
63 114 0.006140167 ubox
64 86 0.966745364 ubox
64 89 0.003204528 ubox
64 113 0.006140273 ubox
65 83 0.005749901 ubox
65 84 0.465358929 ubox
65 85 0.884871925 ubox
65 94 0.003166150 ubox
65 103 0.003308631 ubox
65 104 0.003905746 ubox
65 112 0.006140238 ubox
66 83 0.606996713 ubox
66 84 0.790800805 ubox
66 92 0.008016010 ubox
66 111 0.006139366 ubox
67 82 0.725096136 ubox
67 83 0.688313566 ubox
67 84 0.005906895 ubox
67 91 0.008067357 ubox
67 103 0.003977602 ubox
67 110 0.006140075 ubox
68 81 0.823501998 ubox
68 82 0.566857231 ubox
68 83 0.005413552 ubox
68 90 0.008067441 ubox
68 102 0.003995561 ubox
68 109 0.006139723 ubox
69 78 0.003522220 ubox
69 79 0.020096883 ubox
69 80 0.911274563 ubox
69 89 0.008055773 ubox
69 101 0.003525001 ubox
69 108 0.006058554 ubox
70 77 0.003815746 ubox
70 78 0.021591139 ubox
70 79 0.911867457 ubox
70 80 0.406727272 ubox
70 87 0.004668180 ubox
70 101 0.003202812 ubox
71 77 0.075836200 ubox
71 78 0.905596465 ubox
71 79 0.406296104 ubox
71 80 0.046760402 ubox
71 86 0.004668539 ubox
71 87 0.006540316 ubox
71 100 0.003731194 ubox
72 77 0.908362623 ubox
72 78 0.326840783 ubox
72 79 0.049455150 ubox
72 86 0.005998535 ubox
72 105 0.003741322 ubox
73 84 0.004902445 ubox
73 85 0.005234462 ubox
73 98 0.004661769 ubox
73 104 0.003745731 ubox
74 83 0.004968515 ubox
74 84 0.005485428 ubox
74 97 0.004774465 ubox
74 103 0.003745627 ubox
74 107 0.004720435 ubox
75 82 0.004918406 ubox
75 83 0.005421677 ubox
75 96 0.004778193 ubox
75 102 0.003708489 ubox
75 106 0.004724758 ubox
76 95 0.004787022 ubox
76 105 0.004764144 ubox
77 94 0.004786001 ubox
77 99 0.003748967 ubox
77 104 0.004737340 ubox
78 92 0.004770271 ubox
78 98 0.003746304 ubox
79 91 0.004788759 ubox
79 97 0.003748663 ubox
79 103 0.004509154 ubox
80 90 0.004788621 ubox
80 96 0.003748366 ubox
80 102 0.004526480 ubox
81 89 0.004780127 ubox
81 95 0.003706169 ubox
81 101 0.004417314 ubox
82 100 0.004379954 ubox
84 101 0.003872302 ubox
85 93 0.010597993 ubox
85 100 0.003996970 ubox
86 92 0.010630694 ubox
86 97 0.004291515 ubox
86 99 0.004049835 ubox
87 91 0.010548892 ubox
87 96 0.011409103 ubox
87 98 0.004058723 ubox
88 95 0.012387748 ubox
89 94 0.012396637 ubox
89 96 0.012118007 ubox
90 95 0.012682745 ubox
106 120 0.005365892 ubox
107 119 0.005374930 ubox
108 118 0.005375782 ubox
109 117 0.005366641 ubox
116 125 0.004531967 ubox
117 124 0.004671147 ubox
118 125 0.027598662 ubox
119 124 0.027712043 ubox
2 27 0.9500000 lbox
3 26 0.9500000 lbox
4 25 0.9500000 lbox
5 24 0.9500000 lbox
7 22 0.9500000 lbox
8 21 0.9500000 lbox
9 19 0.9500000 lbox
10 18 0.9500000 lbox
11 17 0.9500000 lbox
12 16 0.9500000 lbox
30 124 0.9500000 lbox
31 123 0.9500000 lbox
32 122 0.9500000 lbox
36 117 0.9500000 lbox
37 116 0.9500000 lbox
38 115 0.9500000 lbox
40 113 0.9500000 lbox
41 112 0.9500000 lbox
43 110 0.9500000 lbox
44 109 0.9500000 lbox
45 108 0.9500000 lbox
46 107 0.9500000 lbox
47 106 0.9500000 lbox
48 104 0.9500000 lbox
49 103 0.9500000 lbox
50 102 0.9500000 lbox
51 101 0.9500000 lbox
52 99 0.9500000 lbox
53 98 0.9500000 lbox
54 97 0.9500000 lbox
56 95 0.9500000 lbox
57 94 0.9500000 lbox
58 92 0.9500000 lbox
59 91 0.9500000 lbox
62 88 0.9500000 lbox
63 87 0.9500000 lbox
64 86 0.9500000 lbox
65 85 0.9500000 lbox
66 84 0.9500000 lbox
67 83 0.9500000 lbox
68 82 0.9500000 lbox
69 80 0.9500000 lbox
70 79 0.9500000 lbox
71 78 0.9500000 lbox
72 77 0.9500000 lbox
showpage
end
%%EOF
