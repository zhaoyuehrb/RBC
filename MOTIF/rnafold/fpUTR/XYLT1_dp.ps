%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:07:58 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (XYLT1)
} def

/sequence { (\
GCGGCCGCGGGAGCUGCGGGGAGCGCGGGGGCGGCCCGGAGCGUGCCGGGGUCCCCGCGCCUCGCUCGCCGGCCGCGCUCCGAAG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 8 0.003180848 ubox
1 17 0.004172209 ubox
1 24 0.004287040 ubox
1 76 0.990625489 ubox
1 78 0.013287918 ubox
2 7 0.003179563 ubox
2 16 0.004175306 ubox
2 23 0.004288800 ubox
2 75 0.991422433 ubox
2 77 0.012551540 ubox
2 82 0.125125353 ubox
3 15 0.004172099 ubox
3 74 0.991498483 ubox
3 76 0.006807801 ubox
3 79 0.016485788 ubox
3 80 0.010591864 ubox
3 81 0.126769057 ubox
4 14 0.004172330 ubox
4 73 0.991526346 ubox
4 76 0.004109426 ubox
4 78 0.019129312 ubox
4 79 0.009490730 ubox
4 80 0.126422205 ubox
5 13 0.004156568 ubox
5 19 0.016171183 ubox
5 72 0.991474166 ubox
5 75 0.005694093 ubox
5 77 0.014077109 ubox
6 18 0.016319899 ubox
6 71 0.985336409 ubox
6 77 0.123357660 ubox
7 14 0.179974431 ubox
7 17 0.024231367 ubox
7 69 0.554919611 ubox
7 70 0.758197018 ubox
7 73 0.006050933 ubox
7 76 0.124909573 ubox
7 78 0.030288621 ubox
8 13 0.183062241 ubox
8 16 0.025870128 ubox
8 68 0.784581026 ubox
8 71 0.106232343 ubox
8 72 0.005938323 ubox
8 75 0.124911336 ubox
8 77 0.030319585 ubox
9 15 0.031659555 ubox
9 66 0.004423917 ubox
9 67 0.766469256 ubox
9 70 0.244770725 ubox
9 74 0.124557221 ubox
9 76 0.030224870 ubox
10 14 0.032765824 ubox
10 65 0.015017234 ubox
10 66 0.746604705 ubox
10 67 0.213863199 ubox
10 69 0.267160480 ubox
10 70 0.057469601 ubox
10 73 0.110941794 ubox
10 74 0.019442410 ubox
10 81 0.003992264 ubox
11 63 0.013633893 ubox
11 65 0.353893836 ubox
11 66 0.190355463 ubox
11 67 0.445316264 ubox
11 69 0.063320485 ubox
11 73 0.018816569 ubox
11 80 0.004014393 ubox
12 62 0.014406262 ubox
12 66 0.468300684 ubox
12 79 0.004031677 ubox
13 61 0.014358666 ubox
13 65 0.463049270 ubox
13 69 0.198488505 ubox
13 73 0.061967746 ubox
13 78 0.003993796 ubox
14 20 0.009323090 ubox
14 21 0.007167478 ubox
14 59 0.003468873 ubox
14 64 0.459806590 ubox
14 68 0.198629415 ubox
14 72 0.081199267 ubox
14 77 0.003932356 ubox
15 19 0.008561761 ubox
15 20 0.008199873 ubox
15 59 0.008304551 ubox
15 64 0.025238160 ubox
15 68 0.003877483 ubox
15 71 0.080477828 ubox
16 58 0.009174758 ubox
16 63 0.050804452 ubox
16 65 0.734019457 ubox
16 67 0.009960643 ubox
16 69 0.338133829 ubox
16 70 0.058844184 ubox
17 57 0.009175829 ubox
17 64 0.812142293 ubox
17 68 0.343861562 ubox
18 56 0.009175827 ubox
18 61 0.017546149 ubox
18 62 0.037940510 ubox
18 63 0.806860203 ubox
18 66 0.039824267 ubox
18 67 0.343573785 ubox
18 70 0.012099188 ubox
19 55 0.009175965 ubox
19 60 0.011905023 ubox
19 61 0.042995770 ubox
19 62 0.788553735 ubox
19 63 0.467079029 ubox
19 65 0.113421990 ubox
19 66 0.326979351 ubox
19 69 0.012110451 ubox
20 54 0.009175919 ubox
20 60 0.029203724 ubox
20 61 0.766866301 ubox
20 62 0.498656181 ubox
20 63 0.038246766 ubox
20 65 0.326598614 ubox
20 81 0.016172741 ubox
21 53 0.009172765 ubox
21 60 0.524980037 ubox
21 61 0.526545111 ubox
21 62 0.035750405 ubox
21 63 0.347622580 ubox
21 67 0.012220764 ubox
21 80 0.016189812 ubox
22 52 0.008550747 ubox
22 62 0.347327795 ubox
22 66 0.012209937 ubox
22 79 0.016189064 ubox
23 58 0.014205271 ubox
23 60 0.812148385 ubox
23 61 0.245754235 ubox
23 65 0.011089014 ubox
23 78 0.016190044 ubox
24 33 0.008501030 ubox
24 57 0.013261612 ubox
24 59 0.993490790 ubox
24 64 0.010761542 ubox
24 77 0.016189437 ubox
25 32 0.008687166 ubox
25 56 0.006667676 ubox
25 58 0.999600331 ubox
25 60 0.008996405 ubox
25 63 0.008380581 ubox
25 76 0.016186459 ubox
26 31 0.008684842 ubox
26 57 0.999637180 ubox
26 59 0.009115035 ubox
26 75 0.016178953 ubox
26 82 0.004224366 ubox
27 55 0.003749313 ubox
27 56 0.999691469 ubox
27 58 0.009097708 ubox
27 62 0.007671230 ubox
27 74 0.015299082 ubox
27 81 0.004317494 ubox
28 54 0.003389520 ubox
28 55 0.999715586 ubox
28 56 0.004558367 ubox
28 61 0.007801773 ubox
28 73 0.015048311 ubox
28 80 0.004316053 ubox
29 54 0.999708968 ubox
29 55 0.006070334 ubox
29 56 0.008903970 ubox
29 60 0.007811937 ubox
29 74 0.005097766 ubox
29 79 0.004107389 ubox
30 53 0.999660792 ubox
30 54 0.007260749 ubox
30 55 0.008911616 ubox
30 70 0.012535986 ubox
30 73 0.005718007 ubox
30 78 0.004103192 ubox
31 52 0.997315947 ubox
31 53 0.008234276 ubox
31 54 0.008915424 ubox
31 58 0.007880072 ubox
31 69 0.012544866 ubox
31 76 0.004346834 ubox
32 48 0.007908166 ubox
32 51 0.991492681 ubox
32 57 0.007880803 ubox
32 68 0.012545172 ubox
32 71 0.010137342 ubox
32 75 0.004349981 ubox
33 47 0.014695759 ubox
33 53 0.009754878 ubox
33 56 0.007856435 ubox
33 67 0.012345946 ubox
33 70 0.010229584 ubox
33 74 0.004351331 ubox
34 46 0.014705098 ubox
34 52 0.016270193 ubox
34 55 0.007827262 ubox
34 65 0.011164279 ubox
34 66 0.005150267 ubox
34 69 0.010229846 ubox
34 73 0.004351650 ubox
35 45 0.014688624 ubox
35 49 0.017513730 ubox
35 50 0.994249379 ubox
35 51 0.015084173 ubox
35 64 0.011212319 ubox
35 68 0.010213053 ubox
35 72 0.004216942 ubox
36 48 0.012417520 ubox
36 49 0.999478621 ubox
36 50 0.012776606 ubox
36 71 0.004064770 ubox
37 43 0.014438183 ubox
37 48 0.999607098 ubox
37 49 0.009137375 ubox
38 42 0.013530394 ubox
38 47 0.999712843 ubox
39 46 0.996966769 ubox
39 63 0.012311876 ubox
39 67 0.010875039 ubox
40 62 0.012435033 ubox
40 66 0.011045545 ubox
41 61 0.012452738 ubox
41 65 0.011083781 ubox
42 64 0.011083645 ubox
43 60 0.012480942 ubox
43 63 0.011024633 ubox
44 59 0.012491834 ubox
45 58 0.012495592 ubox
45 60 0.011020277 ubox
46 57 0.009173624 ubox
46 59 0.011020423 ubox
47 57 0.013934111 ubox
48 55 0.003569616 ubox
48 56 0.016333542 ubox
49 54 0.003563155 ubox
49 55 0.016335884 ubox
50 54 0.016072024 ubox
76 82 0.010539228 ubox
77 81 0.042842540 ubox
78 85 0.086221929 ubox
79 84 0.081908745 ubox
1 76 0.9500000 lbox
2 75 0.9500000 lbox
3 74 0.9500000 lbox
4 73 0.9500000 lbox
5 72 0.9500000 lbox
6 71 0.9500000 lbox
7 70 0.9500000 lbox
8 68 0.9500000 lbox
9 67 0.9500000 lbox
10 66 0.9500000 lbox
16 65 0.9500000 lbox
17 64 0.9500000 lbox
18 63 0.9500000 lbox
19 62 0.9500000 lbox
20 61 0.9500000 lbox
23 60 0.9500000 lbox
24 59 0.9500000 lbox
25 58 0.9500000 lbox
26 57 0.9500000 lbox
27 56 0.9500000 lbox
28 55 0.9500000 lbox
29 54 0.9500000 lbox
30 53 0.9500000 lbox
31 52 0.9500000 lbox
32 51 0.9500000 lbox
35 50 0.9500000 lbox
36 49 0.9500000 lbox
37 48 0.9500000 lbox
38 47 0.9500000 lbox
39 46 0.9500000 lbox
showpage
end
%%EOF
