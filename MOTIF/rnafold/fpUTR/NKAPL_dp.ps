%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 02:27:10 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (NKAPL)
} def

/sequence { (\
AGUGCGCCUGCGUGGCCGCGAAUCACCAGCCAGCCUCUGGGUCUGUAGCAACCGCCCAGCGUUGAGGCGCGGCUC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 9 0.008456426 ubox
1 74 0.198384952 ubox
2 8 0.008948692 ubox
2 11 0.026136582 ubox
2 13 0.037604992 ubox
2 19 0.739111338 ubox
2 23 0.035482113 ubox
2 26 0.077238233 ubox
2 70 0.003576510 ubox
2 73 0.227784765 ubox
3 10 0.025644894 ubox
3 12 0.116109471 ubox
3 14 0.031056875 ubox
3 18 0.739570138 ubox
3 20 0.429517157 ubox
3 22 0.029500990 ubox
3 25 0.074804959 ubox
3 69 0.003511778 ubox
3 71 0.205155758 ubox
3 72 0.160703271 ubox
4 9 0.013488159 ubox
4 11 0.160916848 ubox
4 13 0.108990795 ubox
4 16 0.004320298 ubox
4 17 0.739968325 ubox
4 19 0.565493987 ubox
4 24 0.064470614 ubox
4 68 0.003460893 ubox
4 70 0.282993476 ubox
4 73 0.003578897 ubox
5 10 0.160768079 ubox
5 12 0.112141212 ubox
5 14 0.042449569 ubox
5 15 0.004940677 ubox
5 18 0.565967232 ubox
5 20 0.030920812 ubox
5 67 0.003453431 ubox
5 69 0.283448751 ubox
5 72 0.003459249 ubox
6 11 0.109356406 ubox
6 13 0.044904809 ubox
6 16 0.842322201 ubox
6 17 0.401104751 ubox
6 19 0.030229517 ubox
6 68 0.283449776 ubox
6 73 0.009236826 ubox
7 12 0.044988050 ubox
7 15 0.932243232 ubox
7 18 0.030009630 ubox
7 67 0.283451997 ubox
7 72 0.009139467 ubox
8 14 0.932044432 ubox
8 15 0.038380179 ubox
8 29 0.008794278 ubox
8 66 0.283271189 ubox
8 71 0.009019611 ubox
9 14 0.036187094 ubox
9 20 0.064317401 ubox
9 28 0.020600955 ubox
9 58 0.004351884 ubox
9 61 0.015632988 ubox
9 64 0.009767357 ubox
9 65 0.268592554 ubox
10 16 0.032590036 ubox
10 17 0.003947898 ubox
10 19 0.142449118 ubox
10 27 0.039174821 ubox
10 30 0.115720262 ubox
10 31 0.004380162 ubox
10 34 0.055452917 ubox
10 46 0.003361858 ubox
10 57 0.005598209 ubox
10 60 0.031978592 ubox
10 62 0.189156339 ubox
10 63 0.019894984 ubox
10 70 0.008706706 ubox
11 15 0.032440573 ubox
11 18 0.142565511 ubox
11 20 0.029935146 ubox
11 29 0.115888698 ubox
11 33 0.055572342 ubox
11 45 0.003427828 ubox
11 59 0.031907586 ubox
11 61 0.195545372 ubox
11 64 0.030497187 ubox
11 69 0.008704218 ubox
12 17 0.138296890 ubox
12 19 0.030328619 ubox
12 26 0.071146895 ubox
12 30 0.011268359 ubox
12 34 0.008044940 ubox
12 44 0.003201677 ubox
12 55 0.018496158 ubox
12 60 0.193936604 ubox
12 62 0.008876819 ubox
12 63 0.021504827 ubox
12 68 0.005068214 ubox
13 18 0.029081772 ubox
13 20 0.003745190 ubox
13 25 0.071493457 ubox
13 28 0.103553873 ubox
13 29 0.006795552 ubox
13 32 0.065489866 ubox
13 33 0.004821046 ubox
13 54 0.018752523 ubox
13 58 0.099315607 ubox
13 59 0.121619682 ubox
13 61 0.005469406 ubox
13 67 0.004502399 ubox
14 19 0.004994098 ubox
14 24 0.071521752 ubox
14 27 0.108384260 ubox
14 31 0.070996327 ubox
14 35 0.135166160 ubox
14 43 0.003788504 ubox
14 53 0.020162758 ubox
14 56 0.066267243 ubox
14 57 0.121281862 ubox
14 60 0.003617037 ubox
14 74 0.187886069 ubox
14 75 0.023257815 ubox
15 23 0.059518064 ubox
15 26 0.108045562 ubox
15 30 0.071148698 ubox
15 34 0.135415576 ubox
15 42 0.003798814 ubox
15 49 0.003253788 ubox
15 52 0.020133938 ubox
15 55 0.067263986 ubox
15 56 0.120509646 ubox
15 60 0.012408709 ubox
15 73 0.210886455 ubox
16 29 0.071017984 ubox
16 33 0.135252811 ubox
16 41 0.003808028 ubox
16 48 0.003418426 ubox
16 54 0.065909350 ubox
16 59 0.012458469 ubox
16 72 0.211023031 ubox
17 40 0.003768272 ubox
17 54 0.052737424 ubox
17 71 0.211089486 ubox
18 30 0.137439998 ubox
18 34 0.003625978 ubox
18 46 0.004681332 ubox
18 49 0.056557763 ubox
18 53 0.054061976 ubox
18 55 0.116899414 ubox
18 70 0.211090739 ubox
19 29 0.137598558 ubox
19 33 0.003637435 ubox
19 45 0.004918330 ubox
19 48 0.056782797 ubox
19 54 0.117374144 ubox
19 69 0.211088003 ubox
20 44 0.004411002 ubox
20 53 0.116427724 ubox
20 68 0.209430957 ubox
20 75 0.023862968 ubox
21 74 0.019032157 ubox
22 42 0.003378472 ubox
22 46 0.013307873 ubox
23 41 0.003312681 ubox
23 45 0.010616432 ubox
23 65 0.162526817 ubox
23 67 0.009965446 ubox
24 45 0.037915871 ubox
24 64 0.157972338 ubox
24 66 0.011787525 ubox
25 42 0.017874188 ubox
25 44 0.036850391 ubox
25 46 0.042035592 ubox
25 62 0.029389391 ubox
25 63 0.143861443 ubox
26 40 0.045124372 ubox
26 41 0.017670081 ubox
26 45 0.038407759 ubox
26 61 0.041439469 ubox
26 67 0.127890719 ubox
26 72 0.034979251 ubox
27 39 0.045616157 ubox
27 40 0.013080311 ubox
27 45 0.124034791 ubox
27 64 0.031368137 ubox
27 66 0.127871740 ubox
27 71 0.035030935 ubox
28 36 0.010004820 ubox
28 38 0.045918369 ubox
28 44 0.126068688 ubox
28 63 0.037743040 ubox
28 74 0.873875202 ubox
29 35 0.010638359 ubox
29 37 0.045562172 ubox
29 42 0.026856319 ubox
29 43 0.124732320 ubox
29 46 0.009194404 ubox
29 49 0.018510239 ubox
29 60 0.074856412 ubox
29 62 0.060307178 ubox
29 68 0.026177785 ubox
29 70 0.030725097 ubox
29 73 0.934317974 ubox
30 40 0.114033495 ubox
30 41 0.080378003 ubox
30 45 0.008104119 ubox
30 48 0.018460695 ubox
30 59 0.066748634 ubox
30 61 0.060250845 ubox
30 67 0.027396633 ubox
30 69 0.030605363 ubox
30 72 0.934595217 ubox
31 39 0.119670117 ubox
31 40 0.073562706 ubox
31 45 0.028157694 ubox
31 64 0.229575260 ubox
31 66 0.025322541 ubox
31 71 0.933448174 ubox
32 38 0.123687002 ubox
32 44 0.028781718 ubox
32 63 0.234943693 ubox
32 74 0.005992280 ubox
33 37 0.121355378 ubox
33 42 0.023697887 ubox
33 43 0.028518119 ubox
33 55 0.005407551 ubox
33 60 0.051397276 ubox
33 62 0.256307777 ubox
33 68 0.934968359 ubox
33 70 0.016632445 ubox
33 73 0.006415576 ubox
34 40 0.006033828 ubox
34 41 0.036944139 ubox
34 54 0.005404050 ubox
34 59 0.045725211 ubox
34 61 0.256180583 ubox
34 67 0.935175844 ubox
34 69 0.015915078 ubox
34 72 0.006416582 ubox
35 39 0.006307826 ubox
35 40 0.036817153 ubox
35 41 0.003820501 ubox
35 59 0.021036748 ubox
35 66 0.935178425 ubox
35 67 0.014192782 ubox
35 71 0.006404939 ubox
36 40 0.003453146 ubox
36 58 0.014806243 ubox
36 65 0.933182087 ubox
36 66 0.014012126 ubox
37 48 0.003401633 ubox
37 59 0.612811303 ubox
37 64 0.766701312 ubox
38 47 0.003727364 ubox
38 50 0.003496880 ubox
38 54 0.006686022 ubox
38 58 0.920142275 ubox
38 61 0.020316240 ubox
38 64 0.007736991 ubox
39 46 0.003689802 ubox
39 49 0.003773816 ubox
39 53 0.008671715 ubox
39 57 0.924160855 ubox
39 60 0.014541629 ubox
39 63 0.070487920 ubox
40 52 0.008669975 ubox
40 53 0.021172878 ubox
40 56 0.924201616 ubox
40 57 0.008380483 ubox
40 62 0.086688510 ubox
40 63 0.008353549 ubox
41 49 0.011273743 ubox
41 52 0.023190980 ubox
41 55 0.924025597 ubox
41 56 0.008360320 ubox
41 60 0.327640380 ubox
41 62 0.009316182 ubox
42 48 0.011296179 ubox
42 51 0.024397020 ubox
42 54 0.905614169 ubox
42 59 0.055626164 ubox
42 61 0.008321589 ubox
43 59 0.344712752 ubox
44 50 0.292516792 ubox
44 54 0.043965871 ubox
44 58 0.347747491 ubox
44 61 0.008478586 ubox
45 49 0.291289949 ubox
45 52 0.744879729 ubox
45 53 0.115103012 ubox
45 55 0.010103361 ubox
45 57 0.346391563 ubox
45 60 0.009939278 ubox
46 51 0.711751493 ubox
46 54 0.011125811 ubox
46 59 0.009893072 ubox
47 74 0.005792874 ubox
48 55 0.345938252 ubox
48 60 0.007216255 ubox
48 73 0.006263314 ubox
49 54 0.346155184 ubox
49 59 0.007219424 ubox
49 64 0.020322621 ubox
49 72 0.006191668 ubox
50 63 0.021371288 ubox
51 62 0.021848659 ubox
52 61 0.016172508 ubox
52 72 0.006436319 ubox
53 61 0.028847751 ubox
53 69 0.006206364 ubox
53 71 0.006545889 ubox
54 60 0.035118656 ubox
54 62 0.003822048 ubox
54 68 0.006919085 ubox
54 70 0.006546171 ubox
54 73 0.003945714 ubox
55 59 0.034872905 ubox
55 61 0.004009657 ubox
55 67 0.006953656 ubox
55 69 0.006544379 ubox
55 72 0.003918701 ubox
56 66 0.006952653 ubox
56 67 0.006349181 ubox
56 71 0.003868516 ubox
57 64 0.007356215 ubox
57 66 0.006351152 ubox
58 63 0.007816185 ubox
59 68 0.004067219 ubox
59 70 0.009610761 ubox
60 67 0.004222596 ubox
60 69 0.009890162 ubox
61 68 0.009961555 ubox
62 67 0.009484967 ubox
2 19 0.9500000 lbox
3 18 0.9500000 lbox
4 17 0.9500000 lbox
6 16 0.9500000 lbox
7 15 0.9500000 lbox
8 14 0.9500000 lbox
28 74 0.9500000 lbox
29 73 0.9500000 lbox
30 72 0.9500000 lbox
31 71 0.9500000 lbox
33 68 0.9500000 lbox
34 67 0.9500000 lbox
35 66 0.9500000 lbox
36 65 0.9500000 lbox
37 64 0.9500000 lbox
38 58 0.9500000 lbox
39 57 0.9500000 lbox
40 56 0.9500000 lbox
41 55 0.9500000 lbox
42 54 0.9500000 lbox
45 52 0.9500000 lbox
46 51 0.9500000 lbox
showpage
end
%%EOF
