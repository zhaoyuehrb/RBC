%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:13:01 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (KDF1)
} def

/sequence { (\
AGGUGAGCGGCGAGGGGGCGGGGGAGGGGCUGAGCCGGAGGCGGCUCACCUGGCGGGACAGGUGCCUGGCUGCUACAAACCAUGCAAUGAGCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 51 0.066839672 ubox
2 50 0.076912668 ubox
2 81 0.900076921 ubox
2 93 0.179088621 ubox
3 49 0.076959266 ubox
3 76 0.278542186 ubox
3 80 0.899817858 ubox
3 83 0.034771334 ubox
3 85 0.015336411 ubox
3 92 0.180542931 ubox
4 48 0.076946389 ubox
4 75 0.273876805 ubox
4 77 0.540235818 ubox
4 79 0.693438136 ubox
4 82 0.035918799 ubox
4 84 0.014183527 ubox
4 86 0.005983990 ubox
4 91 0.178227986 ubox
5 47 0.076989463 ubox
5 74 0.170543553 ubox
5 76 0.797175818 ubox
5 81 0.036277164 ubox
5 83 0.010923313 ubox
5 85 0.007132255 ubox
5 88 0.003478040 ubox
6 46 0.076979485 ubox
6 74 0.932402869 ubox
7 45 0.076990322 ubox
7 73 0.981621934 ubox
7 85 0.009463732 ubox
7 92 0.004282004 ubox
8 44 0.076957965 ubox
8 72 0.981691244 ubox
8 84 0.009461222 ubox
8 89 0.013093570 ubox
8 91 0.004267932 ubox
9 71 0.980977508 ubox
9 74 0.008485832 ubox
9 81 0.005461971 ubox
9 83 0.007781744 ubox
9 88 0.010853197 ubox
9 93 0.011240033 ubox
10 42 0.076945572 ubox
10 70 0.981713770 ubox
10 73 0.008795555 ubox
10 80 0.005520300 ubox
10 85 0.173018300 ubox
10 92 0.011321656 ubox
11 41 0.076956456 ubox
11 68 0.005077912 ubox
11 69 0.981567163 ubox
11 72 0.008792043 ubox
11 84 0.173078372 ubox
11 91 0.011317805 ubox
12 67 0.003514819 ubox
12 71 0.006558887 ubox
12 83 0.170789531 ubox
13 67 0.973186609 ubox
13 71 0.003940826 ubox
13 74 0.005406698 ubox
14 36 0.007162088 ubox
14 66 0.973774983 ubox
14 67 0.092218052 ubox
14 70 0.004533289 ubox
14 73 0.005433509 ubox
14 74 0.006184092 ubox
14 81 0.163445237 ubox
15 35 0.007056020 ubox
15 36 0.036158593 ubox
15 65 0.968991465 ubox
15 66 0.111964137 ubox
15 67 0.014983594 ubox
15 73 0.006910088 ubox
15 80 0.163096987 ubox
15 81 0.054944978 ubox
16 30 0.012719778 ubox
16 31 0.066378879 ubox
16 35 0.036171511 ubox
16 36 0.020547993 ubox
16 46 0.010982894 ubox
16 47 0.007138497 ubox
16 65 0.127549086 ubox
16 66 0.016350747 ubox
16 67 0.032413490 ubox
16 71 0.006550565 ubox
16 74 0.007272108 ubox
16 80 0.055375630 ubox
16 81 0.012654420 ubox
17 30 0.056990921 ubox
17 31 0.861555835 ubox
17 35 0.019856381 ubox
17 36 0.069003409 ubox
17 45 0.011627613 ubox
17 46 0.008519455 ubox
17 65 0.015664518 ubox
17 66 0.051573565 ubox
17 70 0.006646029 ubox
17 71 0.009039716 ubox
17 73 0.005271807 ubox
17 74 0.078589596 ubox
17 80 0.012703541 ubox
18 30 0.918894719 ubox
18 35 0.069245908 ubox
18 45 0.008679245 ubox
18 54 0.099129597 ubox
18 63 0.109787924 ubox
18 65 0.055382010 ubox
18 70 0.009662593 ubox
18 73 0.087614266 ubox
18 85 0.010869697 ubox
19 29 0.919957835 ubox
19 32 0.214922968 ubox
19 34 0.069361739 ubox
19 43 0.011851240 ubox
19 44 0.008394150 ubox
19 52 0.007434328 ubox
19 53 0.099062263 ubox
19 55 0.019715353 ubox
19 62 0.109626681 ubox
19 64 0.058367726 ubox
19 68 0.007319441 ubox
19 69 0.009677016 ubox
19 72 0.087780367 ubox
19 84 0.010871716 ubox
20 31 0.236906337 ubox
20 42 0.012032511 ubox
20 51 0.008689731 ubox
20 54 0.020066602 ubox
20 63 0.025981985 ubox
20 67 0.007317776 ubox
20 71 0.087107227 ubox
20 74 0.136794403 ubox
20 83 0.009542020 ubox
21 30 0.239886458 ubox
21 31 0.070132456 ubox
21 50 0.008982814 ubox
21 51 0.098154656 ubox
21 66 0.007326813 ubox
21 67 0.009616942 ubox
21 70 0.086740492 ubox
21 71 0.007210271 ubox
21 73 0.141786540 ubox
21 74 0.024419286 ubox
21 81 0.008532795 ubox
22 30 0.074794257 ubox
22 31 0.125749287 ubox
22 49 0.008979930 ubox
22 50 0.098125541 ubox
22 51 0.009951933 ubox
22 65 0.007287432 ubox
22 66 0.009667646 ubox
22 67 0.003610864 ubox
22 70 0.010066642 ubox
22 71 0.005552879 ubox
22 73 0.024380484 ubox
22 74 0.034326833 ubox
22 80 0.008535095 ubox
22 81 0.005965694 ubox
23 30 0.132803286 ubox
23 31 0.044236861 ubox
23 49 0.097844710 ubox
23 50 0.011495981 ubox
23 65 0.009628732 ubox
23 66 0.003911511 ubox
23 70 0.006296662 ubox
23 71 0.143214192 ubox
23 73 0.034752647 ubox
23 80 0.005959522 ubox
24 30 0.047685137 ubox
24 47 0.008565901 ubox
24 49 0.012739718 ubox
24 65 0.003920763 ubox
24 70 0.143893581 ubox
25 31 0.027382866 ubox
25 46 0.008374579 ubox
25 51 0.013791961 ubox
25 67 0.017608502 ubox
25 71 0.034608575 ubox
25 74 0.008352786 ubox
26 30 0.027924793 ubox
26 36 0.006422611 ubox
26 45 0.008010292 ubox
26 47 0.004997659 ubox
26 50 0.014173502 ubox
26 51 0.022103825 ubox
26 66 0.017909252 ubox
26 67 0.017509483 ubox
26 70 0.034466156 ubox
26 73 0.008481194 ubox
27 35 0.006401324 ubox
27 36 0.007143907 ubox
27 46 0.004084982 ubox
27 47 0.018243870 ubox
27 49 0.014268127 ubox
27 50 0.022390893 ubox
27 51 0.110644812 ubox
27 65 0.017844425 ubox
27 66 0.016073288 ubox
27 67 0.169020206 ubox
28 35 0.007106491 ubox
28 36 0.011089742 ubox
28 46 0.019444437 ubox
28 49 0.022201410 ubox
28 50 0.112547893 ubox
28 51 0.016938290 ubox
28 65 0.014312916 ubox
28 66 0.170860303 ubox
28 71 0.008472919 ubox
29 35 0.011129167 ubox
29 42 0.007940031 ubox
29 45 0.019770881 ubox
29 49 0.113014260 ubox
29 50 0.017095200 ubox
29 54 0.012503286 ubox
29 63 0.013397921 ubox
29 65 0.171030321 ubox
29 70 0.008506410 ubox
30 34 0.011083089 ubox
30 41 0.007941239 ubox
30 44 0.019931904 ubox
30 53 0.012504854 ubox
30 62 0.011437660 ubox
30 64 0.170873095 ubox
30 69 0.008496252 ubox
31 40 0.007900324 ubox
31 43 0.018624042 ubox
31 48 0.244009410 ubox
31 52 0.008812891 ubox
31 61 0.003424655 ubox
31 68 0.007970666 ubox
32 42 0.006730767 ubox
32 47 0.929629733 ubox
33 46 0.989191413 ubox
34 42 0.019426035 ubox
34 45 0.996314230 ubox
35 41 0.020142859 ubox
35 44 0.996353624 ubox
36 40 0.020003849 ubox
36 43 0.996329695 ubox
37 42 0.991880114 ubox
37 46 0.003322272 ubox
38 45 0.003544746 ubox
38 47 0.018982225 ubox
39 46 0.020041615 ubox
40 45 0.020144414 ubox
40 74 0.011747455 ubox
41 73 0.012192014 ubox
42 72 0.012208761 ubox
43 71 0.012200229 ubox
44 70 0.012209425 ubox
45 69 0.012208763 ubox
46 68 0.012036381 ubox
47 64 0.354405353 ubox
48 63 0.925573012 ubox
49 56 0.008048507 ubox
49 57 0.008247552 ubox
49 62 0.984036191 ubox
50 55 0.008055358 ubox
50 56 0.008280018 ubox
50 61 0.984990457 ubox
51 55 0.007462433 ubox
51 60 0.984828784 ubox
51 75 0.030344527 ubox
52 59 0.984801276 ubox
52 66 0.045124398 ubox
52 71 0.009470761 ubox
52 74 0.053733686 ubox
52 93 0.016183136 ubox
53 63 0.008363586 ubox
53 65 0.045275177 ubox
53 70 0.010540973 ubox
53 73 0.055674955 ubox
53 85 0.003699306 ubox
53 92 0.016368882 ubox
54 62 0.008682313 ubox
54 64 0.045336743 ubox
54 68 0.005992009 ubox
54 69 0.009975601 ubox
54 72 0.055684224 ubox
54 84 0.003710429 ubox
54 91 0.016348999 ubox
55 63 0.043245975 ubox
55 66 0.005122028 ubox
55 67 0.007596544 ubox
55 71 0.055444523 ubox
55 83 0.003259346 ubox
55 93 0.019692581 ubox
56 65 0.005285888 ubox
56 66 0.007893965 ubox
56 67 0.009034625 ubox
56 70 0.055153671 ubox
56 71 0.004413947 ubox
56 81 0.003505303 ubox
56 92 0.019832824 ubox
56 93 0.005646859 ubox
57 65 0.007897221 ubox
57 66 0.009063243 ubox
57 70 0.006110807 ubox
57 80 0.003504367 ubox
57 92 0.005718179 ubox
59 68 0.055600959 ubox
59 84 0.003770708 ubox
59 89 0.021723106 ubox
60 67 0.055637755 ubox
60 83 0.003761870 ubox
60 88 0.021709538 ubox
61 66 0.055405751 ubox
61 81 0.004009981 ubox
62 80 0.004016516 ubox
63 79 0.003987633 ubox
63 86 0.025215492 ubox
64 73 0.003574507 ubox
64 85 0.025954117 ubox
65 72 0.003611092 ubox
65 84 0.025933276 ubox
67 82 0.025920539 ubox
68 81 0.026141724 ubox
68 93 0.043922677 ubox
69 80 0.026066964 ubox
69 92 0.044542624 ubox
70 91 0.044538249 ubox
71 77 0.011435216 ubox
71 86 0.027654843 ubox
71 90 0.035241005 ubox
72 76 0.011622625 ubox
72 85 0.039085991 ubox
72 92 0.008028580 ubox
73 84 0.039076969 ubox
73 91 0.008063785 ubox
74 90 0.008020735 ubox
75 83 0.003644526 ubox
76 84 0.026458950 ubox
76 89 0.013990479 ubox
77 83 0.025342586 ubox
77 88 0.013103874 ubox
81 89 0.119834179 ubox
82 88 0.119079183 ubox
83 87 0.105764812 ubox
83 89 0.008312168 ubox
84 88 0.008331910 ubox
84 92 0.688239134 ubox
85 91 0.690048652 ubox
2 81 0.9500000 lbox
3 80 0.9500000 lbox
4 77 0.9500000 lbox
5 76 0.9500000 lbox
6 74 0.9500000 lbox
7 73 0.9500000 lbox
8 72 0.9500000 lbox
9 71 0.9500000 lbox
10 70 0.9500000 lbox
11 69 0.9500000 lbox
13 67 0.9500000 lbox
14 66 0.9500000 lbox
15 65 0.9500000 lbox
17 31 0.9500000 lbox
18 30 0.9500000 lbox
19 29 0.9500000 lbox
32 47 0.9500000 lbox
33 46 0.9500000 lbox
34 45 0.9500000 lbox
35 44 0.9500000 lbox
36 43 0.9500000 lbox
37 42 0.9500000 lbox
48 63 0.9500000 lbox
49 62 0.9500000 lbox
50 61 0.9500000 lbox
51 60 0.9500000 lbox
52 59 0.9500000 lbox
showpage
end
%%EOF
