%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 02:31:21 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (FRMD1)
} def

/sequence { (\
GUGAUCUGGGAGGUGCUGAGCACCCACCUGCGACCCAUGGCGGGGGAGGGCCGAGUAACGACAGC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 16 0.007857354 ubox
1 21 0.003752385 ubox
1 23 0.012277911 ubox
1 27 0.009453076 ubox
1 31 0.014399574 ubox
1 34 0.022303003 ubox
1 38 0.020509491 ubox
1 51 0.020434800 ubox
1 59 0.373415760 ubox
1 62 0.214680080 ubox
1 65 0.059565243 ubox
2 15 0.007643222 ubox
2 20 0.003477921 ubox
2 22 0.013621755 ubox
2 26 0.009623237 ubox
2 30 0.014242074 ubox
2 32 0.013759815 ubox
2 33 0.021785428 ubox
2 37 0.021863786 ubox
2 50 0.020340666 ubox
2 53 0.005747507 ubox
2 57 0.024582715 ubox
2 58 0.368001381 ubox
2 60 0.063862231 ubox
2 61 0.208255969 ubox
2 63 0.037560431 ubox
2 64 0.050952814 ubox
3 21 0.013936591 ubox
3 25 0.009664158 ubox
3 29 0.012066414 ubox
3 31 0.019180515 ubox
3 36 0.022244445 ubox
3 52 0.007510264 ubox
3 56 0.026244594 ubox
3 59 0.096379749 ubox
3 62 0.041830126 ubox
4 14 0.044530124 ubox
4 56 0.119046714 ubox
5 11 0.018051603 ubox
5 13 0.048575863 ubox
5 19 0.010548922 ubox
5 33 0.028361390 ubox
5 47 0.020855769 ubox
5 49 0.007190966 ubox
5 50 0.005227683 ubox
5 54 0.077167693 ubox
5 55 0.057309166 ubox
5 61 0.057292630 ubox
6 10 0.019123677 ubox
6 12 0.054967034 ubox
6 13 0.023411244 ubox
6 18 0.011412322 ubox
6 20 0.012531128 ubox
6 32 0.030211705 ubox
6 46 0.021107797 ubox
6 48 0.008611378 ubox
6 49 0.006100793 ubox
6 53 0.077152563 ubox
6 55 0.436674975 ubox
6 60 0.057424350 ubox
6 64 0.848365276 ubox
7 11 0.049575594 ubox
7 12 0.023423825 ubox
7 18 0.003267980 ubox
7 19 0.012800853 ubox
7 26 0.029001261 ubox
7 30 0.020236663 ubox
7 37 0.010789304 ubox
7 45 0.019330135 ubox
7 47 0.008379699 ubox
7 48 0.005560018 ubox
7 53 0.071338659 ubox
7 54 0.436334573 ubox
7 57 0.025738375 ubox
7 60 0.011975735 ubox
7 63 0.862235182 ubox
8 17 0.011393370 ubox
8 25 0.033373809 ubox
8 28 0.123031782 ubox
8 29 0.029602486 ubox
8 36 0.012026821 ubox
8 52 0.101995298 ubox
8 56 0.027582152 ubox
8 59 0.021689468 ubox
8 62 0.864108453 ubox
9 16 0.012120915 ubox
9 17 0.012906461 ubox
9 24 0.031349918 ubox
9 25 0.013808336 ubox
9 27 0.126528698 ubox
9 28 0.031501873 ubox
9 29 0.003389776 ubox
9 35 0.012027599 ubox
9 51 0.101643608 ubox
9 52 0.436691934 ubox
10 16 0.012988931 ubox
10 23 0.029173685 ubox
10 24 0.010421698 ubox
10 27 0.031592041 ubox
10 28 0.003519036 ubox
10 34 0.012009638 ubox
10 51 0.435279525 ubox
11 17 0.008828835 ubox
11 29 0.008164512 ubox
12 16 0.008862978 ubox
12 24 0.416482654 ubox
12 25 0.033850878 ubox
12 28 0.008192577 ubox
12 52 0.049076685 ubox
13 21 0.040841180 ubox
13 23 0.459838592 ubox
13 24 0.024036644 ubox
13 27 0.008171611 ubox
13 51 0.049221117 ubox
13 56 0.003285379 ubox
13 59 0.499211390 ubox
13 62 0.016773474 ubox
14 20 0.040575473 ubox
14 22 0.468245012 ubox
14 26 0.008102522 ubox
14 50 0.048915496 ubox
14 57 0.785808729 ubox
14 58 0.357936551 ubox
14 61 0.014550120 ubox
15 21 0.470734417 ubox
15 25 0.007979860 ubox
15 51 0.003222434 ubox
15 56 0.872475354 ubox
15 59 0.003183141 ubox
15 65 0.021017363 ubox
16 20 0.467317777 ubox
16 48 0.049122223 ubox
16 50 0.003761532 ubox
16 55 0.878295245 ubox
16 64 0.021260974 ubox
17 47 0.048736990 ubox
17 49 0.003721148 ubox
17 53 0.112520951 ubox
17 54 0.869905765 ubox
17 63 0.021235886 ubox
18 52 0.227111636 ubox
18 62 0.021090026 ubox
20 51 0.871214101 ubox
20 56 0.005185413 ubox
21 50 0.863636306 ubox
21 55 0.005272766 ubox
23 44 0.014389929 ubox
23 46 0.110778098 ubox
23 49 0.761488503 ubox
23 50 0.189348261 ubox
24 43 0.014414403 ubox
24 45 0.110076849 ubox
24 46 0.415110414 ubox
24 48 0.748388267 ubox
24 49 0.244426728 ubox
24 50 0.040009477 ubox
25 42 0.014429550 ubox
25 44 0.099113168 ubox
25 45 0.465892778 ubox
25 48 0.264885715 ubox
25 49 0.085331446 ubox
27 40 0.014586974 ubox
27 43 0.087341343 ubox
27 44 0.842347958 ubox
27 45 0.314363289 ubox
27 46 0.367572238 ubox
27 49 0.102503989 ubox
27 50 0.127314823 ubox
28 39 0.014585372 ubox
28 42 0.086198851 ubox
28 43 0.859248100 ubox
28 44 0.270961931 ubox
28 45 0.368302924 ubox
28 46 0.004720329 ubox
28 48 0.102752110 ubox
28 49 0.127860662 ubox
28 50 0.009201633 ubox
28 64 0.032254655 ubox
29 37 0.011011360 ubox
29 42 0.873607345 ubox
29 43 0.207938071 ubox
29 44 0.367124085 ubox
29 45 0.004269729 ubox
29 47 0.101714616 ubox
29 48 0.127037842 ubox
29 49 0.009701077 ubox
29 53 0.006519965 ubox
29 54 0.004244402 ubox
29 57 0.011231468 ubox
29 60 0.021751541 ubox
29 63 0.074353576 ubox
30 36 0.011490313 ubox
30 41 0.893427405 ubox
30 51 0.051167680 ubox
30 52 0.006171230 ubox
30 56 0.011981359 ubox
30 59 0.027705508 ubox
30 62 0.079517135 ubox
30 65 0.010757819 ubox
31 39 0.022654883 ubox
31 40 0.893300872 ubox
31 42 0.395314450 ubox
31 50 0.051695714 ubox
31 53 0.017741025 ubox
31 55 0.011946914 ubox
31 60 0.086302661 ubox
31 64 0.010860933 ubox
32 38 0.020741250 ubox
32 41 0.395986479 ubox
32 52 0.018149788 ubox
32 59 0.085853349 ubox
33 56 0.049240309 ubox
34 40 0.384774358 ubox
34 43 0.014195687 ubox
34 44 0.148436973 ubox
34 45 0.094456075 ubox
34 46 0.022357687 ubox
34 50 0.019520226 ubox
34 55 0.051238468 ubox
35 39 0.382155731 ubox
35 42 0.014188923 ubox
35 43 0.148623018 ubox
35 44 0.094494925 ubox
35 45 0.022366871 ubox
35 46 0.003703200 ubox
35 49 0.019550298 ubox
36 42 0.148577242 ubox
36 43 0.094342456 ubox
36 44 0.022291899 ubox
36 45 0.003723660 ubox
36 48 0.019533551 ubox
37 56 0.005938356 ubox
38 53 0.090401427 ubox
38 55 0.005255111 ubox
39 52 0.106670976 ubox
40 51 0.106719072 ubox
40 56 0.009526092 ubox
41 50 0.106714700 ubox
41 53 0.012193265 ubox
41 55 0.009715134 ubox
42 52 0.013852070 ubox
43 51 0.013819895 ubox
43 52 0.020923033 ubox
44 51 0.020971400 ubox
44 52 0.023007822 ubox
45 51 0.024602323 ubox
45 52 0.067609967 ubox
46 51 0.067532680 ubox
50 56 0.008115487 ubox
50 65 0.010605684 ubox
51 55 0.008287284 ubox
51 64 0.010752556 ubox
52 60 0.041718869 ubox
53 59 0.042719816 ubox
55 62 0.031073679 ubox
55 65 0.009196023 ubox
56 61 0.029739204 ubox
56 64 0.009275331 ubox
6 64 0.9500000 lbox
7 63 0.9500000 lbox
8 62 0.9500000 lbox
14 57 0.9500000 lbox
15 56 0.9500000 lbox
16 55 0.9500000 lbox
17 54 0.9500000 lbox
20 51 0.9500000 lbox
21 50 0.9500000 lbox
23 49 0.9500000 lbox
24 48 0.9500000 lbox
27 44 0.9500000 lbox
28 43 0.9500000 lbox
29 42 0.9500000 lbox
30 41 0.9500000 lbox
31 40 0.9500000 lbox
showpage
end
%%EOF
