%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 02:03:01 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (TSFM)
} def

/sequence { (\
GUAGGUUUGUUGCCUCACCAGUGCGCCCGCCGGAGGGUGUUUAUCGCGGCUAGAGAG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 10 0.006039267 ubox
1 13 0.310903117 ubox
1 18 0.340918005 ubox
1 24 0.015426132 ubox
1 44 0.003973519 ubox
1 47 0.031586926 ubox
1 50 0.032298083 ubox
2 9 0.019835533 ubox
2 12 0.311636614 ubox
2 17 0.343043425 ubox
2 21 0.003967989 ubox
2 23 0.015425063 ubox
2 43 0.004485277 ubox
2 46 0.030585680 ubox
2 49 0.030125395 ubox
2 52 0.016677327 ubox
3 8 0.020918710 ubox
3 11 0.311101023 ubox
3 15 0.518778492 ubox
3 22 0.011071883 ubox
3 42 0.003788013 ubox
3 51 0.017177780 ubox
4 10 0.299003786 ubox
4 11 0.011877794 ubox
4 14 0.554236618 ubox
4 15 0.008921986 ubox
4 16 0.004368993 ubox
4 19 0.040041832 ubox
4 27 0.013117492 ubox
4 28 0.007239496 ubox
4 45 0.008568284 ubox
4 50 0.011937846 ubox
4 51 0.020210041 ubox
5 10 0.012178733 ubox
5 13 0.560213581 ubox
5 14 0.009244501 ubox
5 18 0.040055378 ubox
5 26 0.013172229 ubox
5 27 0.007193976 ubox
5 44 0.008547202 ubox
5 47 0.004219246 ubox
5 50 0.020268866 ubox
6 12 0.556168500 ubox
6 17 0.034838526 ubox
6 25 0.012641686 ubox
6 43 0.008409429 ubox
6 46 0.004116633 ubox
6 49 0.018920219 ubox
6 53 0.075875967 ubox
6 54 0.203172797 ubox
6 55 0.186676183 ubox
6 56 0.356982540 ubox
6 57 0.140295344 ubox
7 21 0.006266470 ubox
7 48 0.012690659 ubox
7 49 0.007119945 ubox
7 52 0.079672446 ubox
7 53 0.218827626 ubox
7 54 0.229260275 ubox
7 55 0.384392591 ubox
7 56 0.215493952 ubox
7 57 0.074361435 ubox
8 17 0.019370549 ubox
8 20 0.008025029 ubox
8 23 0.006235858 ubox
8 46 0.005185340 ubox
8 48 0.009837716 ubox
8 52 0.214381544 ubox
8 53 0.230204018 ubox
8 54 0.386215190 ubox
8 55 0.220349366 ubox
8 56 0.113224093 ubox
9 16 0.027185548 ubox
9 18 0.004362490 ubox
9 19 0.008235783 ubox
9 22 0.005996504 ubox
9 24 0.004299358 ubox
9 26 0.007342229 ubox
9 45 0.005649371 ubox
9 47 0.011929091 ubox
9 50 0.281373156 ubox
9 51 0.145193625 ubox
10 17 0.004230128 ubox
10 21 0.009262435 ubox
10 23 0.003966955 ubox
10 25 0.005199413 ubox
10 46 0.011265368 ubox
10 49 0.281635934 ubox
10 53 0.129596236 ubox
10 54 0.115265854 ubox
10 55 0.016107218 ubox
10 56 0.023031920 ubox
10 57 0.017683308 ubox
11 17 0.008173655 ubox
11 20 0.010948179 ubox
11 25 0.008098869 ubox
11 39 0.006155646 ubox
11 46 0.003320718 ubox
11 48 0.281390473 ubox
11 52 0.155313055 ubox
11 53 0.106220963 ubox
11 54 0.018716056 ubox
11 55 0.024169381 ubox
11 56 0.026249341 ubox
12 16 0.008501307 ubox
12 19 0.011084350 ubox
12 22 0.004632078 ubox
12 24 0.014098971 ubox
12 38 0.007501161 ubox
12 40 0.005223840 ubox
12 45 0.004399989 ubox
12 47 0.282547409 ubox
12 50 0.669936733 ubox
12 51 0.033005121 ubox
13 21 0.004794485 ubox
13 23 0.014138191 ubox
13 36 0.003918736 ubox
13 37 0.007564617 ubox
13 39 0.005295888 ubox
13 46 0.282076997 ubox
13 49 0.671284261 ubox
14 21 0.043020997 ubox
14 35 0.004026922 ubox
14 36 0.007556449 ubox
14 37 0.008435791 ubox
14 48 0.670049561 ubox
14 49 0.020654906 ubox
14 53 0.091740449 ubox
14 55 0.376932331 ubox
14 57 0.067176382 ubox
15 20 0.039798710 ubox
15 34 0.003974621 ubox
15 35 0.006147140 ubox
15 36 0.008734673 ubox
15 48 0.022729689 ubox
15 49 0.015062886 ubox
15 52 0.093597755 ubox
15 54 0.388852044 ubox
15 56 0.080929530 ubox
16 23 0.013991416 ubox
16 33 0.003436153 ubox
16 35 0.009840007 ubox
16 39 0.013139924 ubox
16 48 0.034977115 ubox
16 53 0.396229798 ubox
16 55 0.088629037 ubox
17 22 0.012944674 ubox
17 38 0.013164058 ubox
17 40 0.003984360 ubox
18 33 0.013219198 ubox
18 37 0.013149748 ubox
18 39 0.003645055 ubox
18 49 0.502488767 ubox
19 32 0.013332944 ubox
19 36 0.013128296 ubox
19 48 0.503844738 ubox
20 41 0.042887583 ubox
20 42 0.157585735 ubox
20 51 0.236913398 ubox
21 30 0.013293324 ubox
21 40 0.014916619 ubox
21 41 0.142125194 ubox
21 44 0.138522820 ubox
21 47 0.502757041 ubox
21 50 0.245629804 ubox
22 29 0.013269529 ubox
22 43 0.135295049 ubox
22 46 0.502301136 ubox
22 48 0.129510669 ubox
22 49 0.216116499 ubox
22 52 0.010391256 ubox
23 28 0.013014890 ubox
23 30 0.009733019 ubox
23 40 0.904286131 ubox
23 42 0.055476565 ubox
23 45 0.342651933 ubox
23 47 0.179219331 ubox
23 50 0.013023593 ubox
23 51 0.010651411 ubox
24 29 0.009984050 ubox
24 32 0.008109554 ubox
24 39 0.978450019 ubox
24 46 0.179085615 ubox
24 48 0.046896646 ubox
24 49 0.010454080 ubox
25 31 0.007939937 ubox
25 38 0.979895466 ubox
25 40 0.005856853 ubox
25 45 0.172517227 ubox
25 47 0.048228166 ubox
25 50 0.042767113 ubox
26 33 0.004394364 ubox
26 37 0.982182195 ubox
26 39 0.007232940 ubox
26 46 0.048101906 ubox
26 49 0.041607544 ubox
27 32 0.004385915 ubox
27 36 0.982189477 ubox
27 37 0.005796631 ubox
27 48 0.040330685 ubox
27 49 0.012969496 ubox
28 35 0.981954748 ubox
28 36 0.006154934 ubox
28 39 0.178684629 ubox
28 46 0.013047589 ubox
28 48 0.016520435 ubox
29 38 0.180601305 ubox
29 45 0.011687725 ubox
29 47 0.019361019 ubox
29 50 0.040796475 ubox
30 37 0.180915575 ubox
30 46 0.017549884 ubox
30 49 0.040848685 ubox
31 35 0.003205885 ubox
31 36 0.180855788 ubox
31 46 0.008538925 ubox
31 48 0.040849387 ubox
32 42 0.008904720 ubox
32 45 0.011621250 ubox
32 47 0.040602934 ubox
33 41 0.009438438 ubox
33 42 0.010318350 ubox
33 44 0.009632546 ubox
33 45 0.036388403 ubox
34 40 0.009393074 ubox
34 41 0.010738236 ubox
34 42 0.006702270 ubox
34 44 0.036033591 ubox
35 40 0.010159891 ubox
35 41 0.006790644 ubox
35 42 0.008886159 ubox
35 45 0.011409403 ubox
35 51 0.004586295 ubox
36 40 0.004554739 ubox
36 41 0.008387509 ubox
36 42 0.010125899 ubox
36 44 0.010855219 ubox
36 45 0.012181421 ubox
36 50 0.004808047 ubox
37 41 0.008670968 ubox
37 44 0.012061129 ubox
37 47 0.006707278 ubox
38 43 0.011638663 ubox
38 46 0.006910061 ubox
38 48 0.005104155 ubox
39 45 0.010767603 ubox
39 47 0.008746895 ubox
39 50 0.007537196 ubox
40 46 0.008651552 ubox
40 49 0.007854222 ubox
40 54 0.014715134 ubox
40 55 0.004271089 ubox
40 56 0.006916517 ubox
40 57 0.009800479 ubox
41 48 0.009009538 ubox
41 49 0.006795608 ubox
41 52 0.004783929 ubox
41 53 0.024253699 ubox
41 54 0.010215649 ubox
41 55 0.010925702 ubox
41 56 0.037126923 ubox
41 57 0.034807840 ubox
42 48 0.008401921 ubox
42 52 0.026925186 ubox
42 53 0.010326097 ubox
42 54 0.007270487 ubox
42 55 0.034380337 ubox
42 56 0.041783878 ubox
43 51 0.026414421 ubox
44 54 0.136169037 ubox
44 56 0.088407644 ubox
45 53 0.144795955 ubox
45 55 0.094684498 ubox
50 57 0.050756380 ubox
51 56 0.050714704 ubox
12 50 0.9500000 lbox
13 49 0.9500000 lbox
14 48 0.9500000 lbox
23 40 0.9500000 lbox
24 39 0.9500000 lbox
25 38 0.9500000 lbox
26 37 0.9500000 lbox
27 36 0.9500000 lbox
28 35 0.9500000 lbox
showpage
end
%%EOF
