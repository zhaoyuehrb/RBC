%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:41:23 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (CLC)
} def

/sequence { (\
CAUUUAAAUUCUGCAGCUCAGAGAUUCACACAGAAGUCUGGACACAAUUCAGAAGAGCCACCCAGAAGGAGACAACA\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 13 0.004779303 ubox
2 9 0.015072212 ubox
2 12 0.004483637 ubox
2 25 0.003763453 ubox
3 8 0.017500001 ubox
3 24 0.004147460 ubox
3 53 0.007005841 ubox
3 56 0.006064469 ubox
3 57 0.007907561 ubox
3 67 0.005130786 ubox
3 68 0.013408019 ubox
3 69 0.021306489 ubox
3 70 0.105636159 ubox
3 71 0.123025453 ubox
3 72 0.416745312 ubox
3 75 0.050093538 ubox
4 23 0.003728842 ubox
4 52 0.007554057 ubox
4 55 0.006489166 ubox
4 56 0.010183756 ubox
4 57 0.005230915 ubox
4 66 0.003525572 ubox
4 67 0.011684997 ubox
4 68 0.032224825 ubox
4 69 0.111635428 ubox
4 70 0.179141542 ubox
4 71 0.460099185 ubox
4 72 0.267834228 ubox
4 74 0.053896780 ubox
4 75 0.034988696 ubox
5 13 0.003384903 ubox
5 51 0.007142584 ubox
5 54 0.004914731 ubox
5 55 0.010275277 ubox
5 56 0.005686081 ubox
5 66 0.005803490 ubox
5 67 0.021992621 ubox
5 68 0.109952941 ubox
5 69 0.174827217 ubox
5 70 0.450751600 ubox
5 71 0.282896244 ubox
5 74 0.037818158 ubox
6 12 0.003611376 ubox
6 26 0.017344096 ubox
7 25 0.019925877 ubox
7 26 0.020028519 ubox
7 49 0.009525737 ubox
8 25 0.022385866 ubox
8 48 0.010277074 ubox
9 23 0.044899735 ubox
9 24 0.017448846 ubox
9 35 0.032481496 ubox
9 47 0.010299991 ubox
9 54 0.054258516 ubox
9 57 0.005252716 ubox
9 66 0.018581963 ubox
9 67 0.892732569 ubox
9 68 0.033380182 ubox
9 69 0.011568393 ubox
9 70 0.022491676 ubox
9 71 0.013108669 ubox
9 72 0.006188069 ubox
9 75 0.003591841 ubox
10 22 0.063366369 ubox
10 23 0.009657949 ubox
10 24 0.008378010 ubox
10 34 0.037360903 ubox
10 46 0.009338592 ubox
10 53 0.062178730 ubox
10 56 0.006813803 ubox
10 64 0.003428401 ubox
10 65 0.004101955 ubox
10 66 0.981111718 ubox
10 67 0.029579869 ubox
10 68 0.005179557 ubox
10 69 0.020560988 ubox
10 70 0.017614257 ubox
10 71 0.003773000 ubox
10 72 0.030683083 ubox
11 21 0.065625038 ubox
11 23 0.009069348 ubox
11 33 0.037884385 ubox
11 52 0.062988629 ubox
11 55 0.006951920 ubox
11 65 0.990065340 ubox
11 68 0.019655322 ubox
11 69 0.017850147 ubox
11 71 0.033167461 ubox
12 20 0.065601060 ubox
12 22 0.009012742 ubox
12 32 0.037850548 ubox
12 44 0.009912775 ubox
12 46 0.008530227 ubox
12 51 0.062908358 ubox
12 54 0.006732592 ubox
12 60 0.026027315 ubox
12 64 0.989634827 ubox
12 67 0.018790712 ubox
12 68 0.017167647 ubox
12 70 0.032257098 ubox
12 74 0.008082764 ubox
12 77 0.004210575 ubox
13 19 0.065147496 ubox
13 31 0.037700963 ubox
13 43 0.010075428 ubox
13 45 0.009703610 ubox
13 50 0.062620996 ubox
13 58 0.007621215 ubox
13 59 0.030426663 ubox
13 63 0.986626125 ubox
13 73 0.008696861 ubox
13 76 0.005503925 ubox
14 57 0.008069670 ubox
15 26 0.005047178 ubox
15 49 0.020424363 ubox
16 25 0.005627875 ubox
16 48 0.018936263 ubox
16 58 0.992961432 ubox
17 23 0.010187532 ubox
17 36 0.003907911 ubox
17 41 0.027149709 ubox
17 55 0.006639505 ubox
17 57 0.994195333 ubox
17 71 0.009396846 ubox
18 22 0.009203977 ubox
18 24 0.012648520 ubox
18 34 0.004346252 ubox
18 40 0.004854711 ubox
18 41 0.061033203 ubox
18 42 0.018528579 ubox
18 53 0.020344159 ubox
18 54 0.005556304 ubox
18 56 0.993134775 ubox
18 70 0.009387786 ubox
19 23 0.013645452 ubox
19 33 0.005620684 ubox
19 40 0.088227904 ubox
19 41 0.017148623 ubox
19 52 0.025662995 ubox
19 55 0.990350510 ubox
19 69 0.009227365 ubox
20 26 0.027300191 ubox
20 39 0.119830903 ubox
20 49 0.009089430 ubox
21 25 0.023652329 ubox
21 27 0.277658888 ubox
21 38 0.128734771 ubox
21 48 0.008181042 ubox
21 49 0.020837363 ubox
21 50 0.194571855 ubox
22 26 0.241875994 ubox
22 37 0.130240908 ubox
22 39 0.190466686 ubox
22 48 0.022356626 ubox
22 49 0.191165354 ubox
23 38 0.208965684 ubox
23 48 0.162877040 ubox
23 49 0.145004792 ubox
23 50 0.171033958 ubox
24 37 0.214723232 ubox
24 48 0.166528482 ubox
24 49 0.161331846 ubox
25 33 0.019000181 ubox
25 34 0.077500049 ubox
25 35 0.712766830 ubox
25 36 0.194140792 ubox
25 42 0.068368669 ubox
25 47 0.179813828 ubox
25 54 0.032543742 ubox
25 67 0.005217881 ubox
25 71 0.004636079 ubox
26 32 0.024910110 ubox
26 33 0.076238255 ubox
26 34 0.821171447 ubox
26 35 0.164616461 ubox
26 41 0.070361349 ubox
26 42 0.019942953 ubox
26 46 0.167254421 ubox
26 53 0.030957476 ubox
26 54 0.008455422 ubox
26 56 0.003766410 ubox
26 66 0.006062719 ubox
26 70 0.006996796 ubox
26 72 0.005242882 ubox
27 33 0.837085506 ubox
27 40 0.072187749 ubox
27 41 0.020811487 ubox
27 52 0.030427623 ubox
27 55 0.003939207 ubox
27 65 0.006150129 ubox
27 69 0.007242237 ubox
27 71 0.005776080 ubox
28 37 0.121853472 ubox
28 39 0.071414572 ubox
29 36 0.177449743 ubox
29 40 0.015888564 ubox
30 37 0.125017210 ubox
30 39 0.014979579 ubox
31 36 0.166746500 ubox
31 40 0.307597641 ubox
32 39 0.307660817 ubox
33 38 0.306424618 ubox
33 50 0.016698531 ubox
34 49 0.016456297 ubox
35 48 0.015720560 ubox
35 49 0.005435410 ubox
36 43 0.009983265 ubox
36 45 0.009759256 ubox
36 48 0.007926979 ubox
36 58 0.004288591 ubox
36 73 0.013879334 ubox
36 76 0.003569365 ubox
37 42 0.009260599 ubox
37 44 0.009238168 ubox
37 47 0.008447954 ubox
37 53 0.841567820 ubox
37 66 0.044340374 ubox
37 72 0.013580352 ubox
38 52 0.913311446 ubox
38 65 0.047616853 ubox
38 71 0.013300681 ubox
39 46 0.057888296 ubox
39 51 0.916138045 ubox
39 60 0.003686266 ubox
39 64 0.047699690 ubox
39 70 0.012111513 ubox
40 45 0.104513211 ubox
40 49 0.008316382 ubox
40 50 0.923084694 ubox
40 59 0.007133856 ubox
40 63 0.047765964 ubox
41 48 0.015446844 ubox
41 49 0.908665595 ubox
41 50 0.133653823 ubox
41 58 0.007153414 ubox
41 62 0.047659984 ubox
42 48 0.850711572 ubox
42 49 0.131073655 ubox
48 54 0.012691778 ubox
48 55 0.005086635 ubox
48 56 0.010265648 ubox
48 57 0.038641807 ubox
49 53 0.011953216 ubox
49 54 0.009475457 ubox
49 55 0.009643957 ubox
49 56 0.049777346 ubox
50 55 0.051710210 ubox
58 69 0.054457047 ubox
59 68 0.054889790 ubox
61 69 0.042107081 ubox
62 68 0.042127537 ubox
62 69 0.094503755 ubox
63 68 0.094651109 ubox
9 67 0.9500000 lbox
10 66 0.9500000 lbox
11 65 0.9500000 lbox
12 64 0.9500000 lbox
13 63 0.9500000 lbox
16 58 0.9500000 lbox
17 57 0.9500000 lbox
18 56 0.9500000 lbox
19 55 0.9500000 lbox
25 35 0.9500000 lbox
26 34 0.9500000 lbox
27 33 0.9500000 lbox
37 53 0.9500000 lbox
38 52 0.9500000 lbox
39 51 0.9500000 lbox
40 50 0.9500000 lbox
41 49 0.9500000 lbox
42 48 0.9500000 lbox
showpage
end
%%EOF
