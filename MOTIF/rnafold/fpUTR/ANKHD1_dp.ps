%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:16:37 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (ANKHD1)
} def

/sequence { (\
GGGAGGCAGCAGGUUAGGCAGUGAGAAGUUAGUGGCGCUGCUGGGACGGGGGAAAGGAGACGCUUCUUCCUCUUGCUGCUCUUCUCGUUCCCGAGAUCAGCGGCGGCGGUGACCGCGAGUGGGUCGGCACCGUCUCCGGCUCCGGGUGCGAACA\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 81 0.009333283 ubox
1 82 0.019995599 ubox
1 83 0.157848868 ubox
1 84 0.198075314 ubox
1 85 0.441970026 ubox
1 86 0.120626583 ubox
2 80 0.005755673 ubox
2 81 0.022248807 ubox
2 82 0.240120931 ubox
2 83 0.183644693 ubox
2 84 0.924874872 ubox
2 85 0.132239663 ubox
2 86 0.004138684 ubox
2 143 0.003643804 ubox
3 79 0.003588021 ubox
3 80 0.010868130 ubox
3 81 0.255028475 ubox
3 82 0.163721713 ubox
3 83 0.933570638 ubox
3 84 0.153384469 ubox
3 86 0.003979417 ubox
3 142 0.003656246 ubox
4 80 0.241188365 ubox
4 82 0.937272298 ubox
4 83 0.142333147 ubox
4 85 0.004165061 ubox
4 141 0.003640418 ubox
5 79 0.170702500 ubox
5 80 0.238543936 ubox
5 81 0.933491945 ubox
5 82 0.102753973 ubox
5 84 0.004047918 ubox
5 140 0.003574583 ubox
6 79 0.974841471 ubox
6 80 0.103999469 ubox
6 81 0.096665767 ubox
7 43 0.004485805 ubox
7 78 0.995323691 ubox
8 42 0.004594602 ubox
8 77 0.995140158 ubox
8 80 0.095116922 ubox
9 41 0.004627855 ubox
9 76 0.995373963 ubox
9 79 0.095772047 ubox
10 40 0.004630936 ubox
10 75 0.995261080 ubox
10 78 0.095774415 ubox
11 39 0.004630490 ubox
11 73 0.047983795 ubox
11 74 0.940018450 ubox
11 77 0.095674812 ubox
12 38 0.004606835 ubox
12 42 0.007806058 ubox
12 71 0.003182709 ubox
12 72 0.065042192 ubox
12 73 0.523801762 ubox
12 74 0.020422106 ubox
12 76 0.095305776 ubox
13 36 0.004215385 ubox
13 41 0.008639197 ubox
13 47 0.972571833 ubox
13 71 0.011706747 ubox
13 72 0.149339183 ubox
13 73 0.003991533 ubox
14 35 0.004210486 ubox
14 40 0.007245357 ubox
14 44 0.053416950 ubox
14 45 0.116663265 ubox
14 46 0.969680708 ubox
15 34 0.003550066 ubox
15 40 0.006510441 ubox
15 43 0.063002345 ubox
15 44 0.123769669 ubox
15 45 0.933402868 ubox
16 33 0.003269088 ubox
16 39 0.008386007 ubox
16 42 0.067095160 ubox
16 71 0.012050272 ubox
17 38 0.008514587 ubox
17 41 0.047948445 ubox
17 42 0.984083708 ubox
17 70 0.011587697 ubox
18 29 0.003521049 ubox
18 36 0.010228221 ubox
18 41 0.998585595 ubox
18 69 0.011445763 ubox
19 28 0.003570411 ubox
19 34 0.009166654 ubox
19 35 0.007593739 ubox
19 40 0.999805640 ubox
19 43 0.007363211 ubox
20 33 0.011482366 ubox
20 39 0.999572663 ubox
20 42 0.007388090 ubox
21 36 0.003909648 ubox
21 38 0.999791302 ubox
21 41 0.007390294 ubox
22 31 0.016059002 ubox
22 35 0.004606297 ubox
22 37 0.998940503 ubox
22 40 0.007211202 ubox
23 30 0.029246363 ubox
23 33 0.006152245 ubox
23 36 0.988096499 ubox
23 39 0.003338535 ubox
23 68 0.011058744 ubox
24 29 0.047850555 ubox
24 30 0.041072081 ubox
24 39 0.005439154 ubox
24 67 0.011266066 ubox
25 29 0.028487711 ubox
25 38 0.005803147 ubox
25 66 0.011301661 ubox
26 65 0.011293721 ubox
27 64 0.010807722 ubox
28 36 0.086436667 ubox
28 63 0.010648143 ubox
29 35 0.092364035 ubox
29 62 0.010314218 ubox
30 34 0.068202001 ubox
32 61 0.005183036 ubox
33 60 0.005185719 ubox
34 64 0.004257099 ubox
35 63 0.004893444 ubox
36 62 0.004986863 ubox
37 47 0.003325502 ubox
37 61 0.005032097 ubox
38 45 0.003657621 ubox
38 52 0.010508042 ubox
38 59 0.005184291 ubox
39 44 0.003592587 ubox
39 51 0.010487244 ubox
39 58 0.005168994 ubox
41 49 0.011098192 ubox
41 56 0.005172818 ubox
42 48 0.012030168 ubox
42 55 0.005146486 ubox
43 47 0.018992096 ubox
43 70 0.011641122 ubox
43 71 0.028995829 ubox
43 72 0.003474368 ubox
43 73 0.005025127 ubox
43 74 0.021707255 ubox
44 69 0.011643212 ubox
44 70 0.031488775 ubox
44 71 0.003587624 ubox
44 72 0.006038619 ubox
44 73 0.040706477 ubox
45 68 0.011512271 ubox
45 69 0.031501377 ubox
45 71 0.005440298 ubox
45 72 0.046968947 ubox
45 74 0.004066285 ubox
46 67 0.011214267 ubox
46 68 0.031016956 ubox
46 71 0.047971466 ubox
46 73 0.004242384 ubox
47 75 0.012144286 ubox
48 66 0.028328819 ubox
48 67 0.015254180 ubox
48 69 0.003236703 ubox
48 70 0.182946047 ubox
48 71 0.032886923 ubox
48 72 0.245136762 ubox
48 73 0.776322235 ubox
48 74 0.038703163 ubox
49 65 0.028327223 ubox
49 66 0.015685748 ubox
49 68 0.003301285 ubox
49 69 0.183172077 ubox
49 70 0.036005883 ubox
49 71 0.245543349 ubox
49 72 0.938993377 ubox
49 73 0.062418389 ubox
50 64 0.028363375 ubox
50 65 0.015585720 ubox
50 67 0.004270938 ubox
50 68 0.182618136 ubox
50 69 0.035954465 ubox
50 70 0.243969598 ubox
50 71 0.946164212 ubox
50 72 0.070324983 ubox
51 63 0.028380792 ubox
51 64 0.015538503 ubox
51 66 0.004532040 ubox
51 67 0.183325876 ubox
51 68 0.032093198 ubox
51 69 0.241437674 ubox
51 70 0.949141794 ubox
51 71 0.057412438 ubox
51 72 0.003321207 ubox
51 73 0.004324012 ubox
52 63 0.015516875 ubox
52 65 0.003848889 ubox
52 66 0.184065972 ubox
52 67 0.026507012 ubox
52 68 0.213906341 ubox
52 69 0.949694197 ubox
52 70 0.057359320 ubox
52 72 0.004891518 ubox
53 64 0.003199113 ubox
53 65 0.153048499 ubox
53 67 0.183187421 ubox
53 68 0.780397484 ubox
53 71 0.004543596 ubox
54 64 0.110722883 ubox
54 65 0.180070955 ubox
54 67 0.548810802 ubox
54 68 0.545242243 ubox
55 64 0.219823917 ubox
55 65 0.118662178 ubox
55 67 0.775341273 ubox
55 68 0.035203619 ubox
55 71 0.007895407 ubox
56 63 0.243505445 ubox
56 64 0.126329268 ubox
56 65 0.024630805 ubox
56 66 0.950345003 ubox
56 67 0.099851804 ubox
56 69 0.009665311 ubox
56 70 0.008593434 ubox
57 63 0.127170897 ubox
57 64 0.021713054 ubox
57 65 0.949888582 ubox
57 66 0.117584834 ubox
57 68 0.016696019 ubox
57 69 0.008588717 ubox
58 64 0.948940817 ubox
58 65 0.116258051 ubox
58 67 0.026614542 ubox
58 68 0.006809274 ubox
59 63 0.928298746 ubox
59 64 0.093964074 ubox
59 65 0.003829355 ubox
59 66 0.029649771 ubox
59 67 0.004029659 ubox
60 64 0.004920335 ubox
60 65 0.026728045 ubox
75 104 0.004034110 ubox
76 103 0.004039634 ubox
77 102 0.004036718 ubox
78 101 0.004058145 ubox
79 100 0.004065373 ubox
80 99 0.004045078 ubox
82 152 0.004394623 ubox
83 96 0.004361067 ubox
83 151 0.004809528 ubox
84 95 0.004421214 ubox
84 150 0.004442107 ubox
85 94 0.004422104 ubox
85 151 0.842885776 ubox
86 93 0.004422857 ubox
86 150 0.989776355 ubox
87 92 0.004289158 ubox
87 149 0.999565954 ubox
87 153 0.018794818 ubox
88 148 0.980693594 ubox
88 152 0.018724053 ubox
89 146 0.007398404 ubox
89 151 0.018449834 ubox
90 145 0.008861910 ubox
90 146 0.999470451 ubox
90 150 0.011782154 ubox
91 144 0.008744055 ubox
91 145 0.999908085 ubox
91 146 0.007525135 ubox
92 144 0.999885404 ubox
92 145 0.007505052 ubox
92 148 0.003579110 ubox
93 142 0.115271296 ubox
93 143 0.992494010 ubox
93 147 0.003450978 ubox
94 141 0.161837960 ubox
95 140 0.159114918 ubox
95 142 0.966045481 ubox
96 141 0.893234112 ubox
97 139 0.120209081 ubox
98 138 0.071624983 ubox
99 141 0.366331726 ubox
100 140 0.561746543 ubox
101 138 0.912979201 ubox
101 139 0.398428468 ubox
102 134 0.003310724 ubox
102 136 0.012620850 ubox
102 137 0.999022722 ubox
103 133 0.003342138 ubox
103 135 0.012867914 ubox
103 136 0.999252278 ubox
104 132 0.003409628 ubox
105 131 0.003405976 ubox
105 134 0.997644900 ubox
105 135 0.024339388 ubox
106 130 0.003399632 ubox
106 133 0.999320425 ubox
106 134 0.024533663 ubox
107 132 0.999965518 ubox
108 131 0.999971389 ubox
109 130 0.999979615 ubox
110 126 0.032208002 ubox
110 129 0.999210135 ubox
111 125 0.069905167 ubox
111 128 0.997286572 ubox
112 124 0.084836718 ubox
113 122 0.006261179 ubox
113 123 0.085076580 ubox
113 127 0.995718552 ubox
114 121 0.007453209 ubox
114 122 0.084978044 ubox
114 126 0.995590262 ubox
115 120 0.005520791 ubox
115 124 0.208585322 ubox
115 125 0.972187619 ubox
116 123 0.986325949 ubox
116 126 0.021660278 ubox
117 125 0.044017785 ubox
118 124 0.050392698 ubox
2 84 0.9500000 lbox
3 83 0.9500000 lbox
4 82 0.9500000 lbox
5 81 0.9500000 lbox
6 79 0.9500000 lbox
7 78 0.9500000 lbox
8 77 0.9500000 lbox
9 76 0.9500000 lbox
10 75 0.9500000 lbox
11 74 0.9500000 lbox
13 47 0.9500000 lbox
14 46 0.9500000 lbox
15 45 0.9500000 lbox
17 42 0.9500000 lbox
18 41 0.9500000 lbox
19 40 0.9500000 lbox
20 39 0.9500000 lbox
21 38 0.9500000 lbox
22 37 0.9500000 lbox
23 36 0.9500000 lbox
48 73 0.9500000 lbox
49 72 0.9500000 lbox
50 71 0.9500000 lbox
51 70 0.9500000 lbox
52 69 0.9500000 lbox
53 68 0.9500000 lbox
54 67 0.9500000 lbox
56 66 0.9500000 lbox
57 65 0.9500000 lbox
58 64 0.9500000 lbox
59 63 0.9500000 lbox
85 151 0.9500000 lbox
86 150 0.9500000 lbox
87 149 0.9500000 lbox
88 148 0.9500000 lbox
90 146 0.9500000 lbox
91 145 0.9500000 lbox
92 144 0.9500000 lbox
93 143 0.9500000 lbox
95 142 0.9500000 lbox
96 141 0.9500000 lbox
101 138 0.9500000 lbox
102 137 0.9500000 lbox
103 136 0.9500000 lbox
105 134 0.9500000 lbox
106 133 0.9500000 lbox
107 132 0.9500000 lbox
108 131 0.9500000 lbox
109 130 0.9500000 lbox
110 129 0.9500000 lbox
111 128 0.9500000 lbox
113 127 0.9500000 lbox
114 126 0.9500000 lbox
115 124 0.9500000 lbox
116 123 0.9500000 lbox
showpage
end
%%EOF
