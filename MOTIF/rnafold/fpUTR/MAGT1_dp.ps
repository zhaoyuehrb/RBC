%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:09:29 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (MAGT1)
} def

/sequence { (\
GUGUAGCGCCAGCGCGCUGUGACGUAAUGUGAGGGGUCUCCCGGCAGGGCUGAGCUGGACCA\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 7 0.083195572 ubox
1 9 0.015023402 ubox
1 15 0.004355811 ubox
1 17 0.029426388 ubox
1 20 0.012206997 ubox
1 23 0.546377773 ubox
1 25 0.024271593 ubox
1 28 0.006443246 ubox
1 55 0.011720082 ubox
1 60 0.705221674 ubox
2 6 0.077878100 ubox
2 8 0.020313160 ubox
2 14 0.004361230 ubox
2 16 0.029474845 ubox
2 19 0.005213749 ubox
2 21 0.121911965 ubox
2 22 0.537301851 ubox
2 24 0.064003645 ubox
2 26 0.009162135 ubox
2 27 0.006042418 ubox
2 29 0.003341822 ubox
2 54 0.011625598 ubox
2 59 0.707625208 ubox
2 62 0.040968530 ubox
3 7 0.023376620 ubox
3 9 0.003288125 ubox
3 13 0.004298691 ubox
3 15 0.029514696 ubox
3 17 0.003985469 ubox
3 20 0.204476118 ubox
3 23 0.088197717 ubox
3 25 0.009724838 ubox
3 28 0.005520024 ubox
3 60 0.048908030 ubox
3 61 0.051456920 ubox
4 8 0.004168211 ubox
4 12 0.004241288 ubox
4 14 0.027614818 ubox
4 16 0.003773183 ubox
4 19 0.586721303 ubox
4 21 0.016642695 ubox
4 22 0.076191154 ubox
4 27 0.004918606 ubox
4 52 0.009925893 ubox
4 57 0.705712200 ubox
4 59 0.048508708 ubox
5 18 0.618966857 ubox
5 20 0.009772922 ubox
5 39 0.006720464 ubox
5 51 0.011847358 ubox
5 56 0.708826936 ubox
6 13 0.029901881 ubox
6 15 0.006460049 ubox
6 17 0.622493055 ubox
6 25 0.005498705 ubox
6 37 0.007873166 ubox
6 38 0.007259031 ubox
6 50 0.011892401 ubox
6 55 0.709078191 ubox
7 12 0.029913232 ubox
7 14 0.006489307 ubox
7 16 0.622502870 ubox
7 24 0.005615825 ubox
7 31 0.005037455 ubox
7 36 0.008982398 ubox
7 49 0.011882633 ubox
7 54 0.708911987 ubox
7 57 0.007051600 ubox
8 13 0.006818376 ubox
8 15 0.622483121 ubox
8 17 0.004359415 ubox
8 23 0.005698476 ubox
8 30 0.005248611 ubox
8 37 0.005794489 ubox
8 45 0.004402039 ubox
8 50 0.068753157 ubox
8 55 0.026120523 ubox
9 14 0.620771120 ubox
9 16 0.004396366 ubox
9 29 0.004592037 ubox
9 34 0.008246397 ubox
9 35 0.015152433 ubox
9 36 0.006302847 ubox
9 44 0.004406017 ubox
9 48 0.012107536 ubox
9 49 0.068732517 ubox
9 54 0.027252615 ubox
9 58 0.326723865 ubox
10 19 0.005592651 ubox
10 21 0.003908374 ubox
10 29 0.004902813 ubox
10 33 0.008233517 ubox
10 34 0.015308998 ubox
10 35 0.006207865 ubox
10 43 0.004394531 ubox
10 47 0.012582547 ubox
10 48 0.068602538 ubox
10 52 0.702482417 ubox
10 57 0.328096899 ubox
11 18 0.005961871 ubox
11 20 0.003760632 ubox
11 28 0.006221719 ubox
11 51 0.703242758 ubox
11 56 0.328027041 ubox
12 17 0.005941749 ubox
12 20 0.003388614 ubox
12 25 0.025589586 ubox
12 30 0.006381775 ubox
12 45 0.057243568 ubox
12 50 0.697377108 ubox
12 55 0.328100680 ubox
13 19 0.003862425 ubox
13 21 0.008386218 ubox
13 24 0.026368635 ubox
13 29 0.006485479 ubox
13 31 0.017157909 ubox
13 43 0.003324693 ubox
13 44 0.057154228 ubox
13 49 0.695068981 ubox
13 52 0.009469295 ubox
13 54 0.327687517 ubox
14 20 0.015929203 ubox
14 23 0.029994832 ubox
14 25 0.215963083 ubox
14 28 0.003996672 ubox
14 30 0.020772521 ubox
14 37 0.042835101 ubox
14 45 0.044909455 ubox
14 50 0.260554743 ubox
14 51 0.010480396 ubox
15 19 0.016210414 ubox
15 21 0.025620663 ubox
15 24 0.222704506 ubox
15 29 0.021115358 ubox
15 31 0.066646384 ubox
15 36 0.044720603 ubox
15 43 0.034213552 ubox
15 44 0.044549782 ubox
15 49 0.265284615 ubox
15 52 0.174355660 ubox
16 20 0.015872977 ubox
16 23 0.219390867 ubox
16 25 0.041715134 ubox
16 28 0.016242770 ubox
16 30 0.068495553 ubox
16 37 0.008230692 ubox
16 42 0.033764718 ubox
16 45 0.615022920 ubox
16 50 0.223180714 ubox
16 51 0.038879351 ubox
17 24 0.043097933 ubox
17 29 0.068653231 ubox
17 33 0.006121191 ubox
17 34 0.044054846 ubox
17 35 0.011147639 ubox
17 36 0.008673992 ubox
17 44 0.616718114 ubox
17 47 0.327313578 ubox
17 48 0.017829777 ubox
17 49 0.226380933 ubox
18 24 0.008253115 ubox
18 26 0.012918188 ubox
18 29 0.011158760 ubox
18 32 0.006409735 ubox
18 33 0.043627849 ubox
18 34 0.011961828 ubox
18 35 0.008605721 ubox
18 43 0.615258135 ubox
18 46 0.327754629 ubox
18 47 0.017126750 ubox
18 48 0.225381412 ubox
19 23 0.013281715 ubox
19 25 0.012671751 ubox
19 28 0.051679521 ubox
19 42 0.600935647 ubox
19 45 0.327472299 ubox
19 50 0.006303638 ubox
19 55 0.018604374 ubox
19 60 0.006376780 ubox
20 24 0.004870049 ubox
20 26 0.028448229 ubox
20 27 0.055495400 ubox
20 29 0.006139963 ubox
20 31 0.013606026 ubox
20 43 0.023767058 ubox
20 44 0.314288220 ubox
20 46 0.224995149 ubox
20 49 0.006273006 ubox
20 54 0.018659603 ubox
20 59 0.006361483 ubox
20 62 0.007253099 ubox
21 25 0.024747650 ubox
21 28 0.008778639 ubox
21 30 0.018366743 ubox
21 38 0.614664886 ubox
21 40 0.081122766 ubox
21 42 0.022427130 ubox
21 45 0.222351242 ubox
21 61 0.009377885 ubox
22 30 0.281269828 ubox
22 37 0.615492582 ubox
22 39 0.073840602 ubox
23 29 0.288942467 ubox
23 31 0.065073875 ubox
23 36 0.616098143 ubox
23 43 0.122413066 ubox
23 52 0.010628122 ubox
24 28 0.178538515 ubox
24 30 0.053408918 ubox
24 37 0.015908530 ubox
24 42 0.098224437 ubox
24 45 0.009921576 ubox
24 50 0.058957242 ubox
24 51 0.004436353 ubox
24 55 0.004278842 ubox
24 60 0.032411159 ubox
25 29 0.016828740 ubox
25 31 0.026515991 ubox
25 36 0.013563679 ubox
25 44 0.011166020 ubox
25 49 0.058461607 ubox
25 54 0.004200565 ubox
25 59 0.031916257 ubox
26 30 0.025600185 ubox
27 37 0.021390343 ubox
28 36 0.022178146 ubox
28 43 0.092415627 ubox
28 46 0.218970860 ubox
28 62 0.067084717 ubox
29 37 0.003670542 ubox
29 42 0.096618166 ubox
29 45 0.239711168 ubox
29 50 0.003447492 ubox
29 55 0.019670358 ubox
29 60 0.106109413 ubox
29 61 0.081126799 ubox
30 36 0.007146562 ubox
30 43 0.043315563 ubox
30 44 0.236404162 ubox
30 46 0.074904779 ubox
30 49 0.003308166 ubox
30 54 0.019644926 ubox
30 57 0.003230150 ubox
30 59 0.105694697 ubox
30 62 0.029597404 ubox
31 38 0.063357517 ubox
31 40 0.240368209 ubox
31 42 0.045242168 ubox
31 45 0.083030114 ubox
31 61 0.037174115 ubox
32 37 0.061796743 ubox
32 39 0.241172131 ubox
32 56 0.007103146 ubox
33 38 0.240263317 ubox
33 39 0.007328884 ubox
33 40 0.013856126 ubox
33 41 0.095046687 ubox
33 42 0.426627255 ubox
33 51 0.016805287 ubox
33 55 0.006881133 ubox
33 56 0.030087806 ubox
33 61 0.052121987 ubox
34 38 0.008840928 ubox
34 39 0.010953845 ubox
34 40 0.095249326 ubox
34 41 0.429646109 ubox
34 42 0.151284977 ubox
34 50 0.016725113 ubox
34 51 0.006397718 ubox
34 55 0.026605449 ubox
34 56 0.159620418 ubox
34 60 0.051224046 ubox
34 61 0.052534081 ubox
35 39 0.061717473 ubox
35 40 0.428287688 ubox
35 41 0.152385101 ubox
35 42 0.017621394 ubox
35 50 0.006647803 ubox
35 51 0.008059487 ubox
35 55 0.167911215 ubox
35 56 0.028985436 ubox
35 60 0.046370192 ubox
35 61 0.540546145 ubox
36 40 0.150113042 ubox
36 41 0.017641531 ubox
36 45 0.009624789 ubox
36 50 0.008278204 ubox
36 55 0.029733092 ubox
36 60 0.541790844 ubox
37 44 0.009663135 ubox
37 48 0.005330059 ubox
37 49 0.006503186 ubox
37 53 0.171329755 ubox
37 54 0.017203850 ubox
37 58 0.007956919 ubox
37 59 0.539360931 ubox
38 43 0.009834590 ubox
38 47 0.006319728 ubox
38 48 0.006626589 ubox
38 52 0.172288376 ubox
38 54 0.017832177 ubox
38 57 0.013491036 ubox
38 58 0.464271321 ubox
39 46 0.005989356 ubox
39 47 0.005993923 ubox
39 49 0.005389380 ubox
39 53 0.021458081 ubox
39 57 0.410363100 ubox
39 58 0.006150329 ubox
39 59 0.054633431 ubox
40 47 0.004037293 ubox
40 48 0.017053533 ubox
40 49 0.367178308 ubox
40 52 0.018993382 ubox
40 57 0.050680583 ubox
40 58 0.053629134 ubox
41 47 0.016938592 ubox
41 48 0.372413977 ubox
41 49 0.035583336 ubox
41 57 0.041830218 ubox
41 58 0.356873472 ubox
42 47 0.372323098 ubox
42 48 0.035951027 ubox
42 52 0.207743526 ubox
42 57 0.409921470 ubox
43 51 0.210093957 ubox
43 56 0.442049385 ubox
43 61 0.054764502 ubox
44 50 0.210447794 ubox
44 55 0.443310874 ubox
44 60 0.054700639 ubox
45 49 0.208918998 ubox
45 52 0.016087407 ubox
45 54 0.443165623 ubox
45 57 0.030846754 ubox
46 51 0.019162435 ubox
46 56 0.031418591 ubox
47 55 0.031323468 ubox
47 56 0.014920273 ubox
47 61 0.047297646 ubox
48 55 0.015290477 ubox
48 56 0.053668764 ubox
48 60 0.047038531 ubox
48 61 0.038792720 ubox
49 55 0.056164717 ubox
49 60 0.038877745 ubox
50 54 0.056004899 ubox
50 58 0.054008740 ubox
51 57 0.053208883 ubox
51 62 0.008597605 ubox
52 56 0.024848081 ubox
52 61 0.011303923 ubox
56 62 0.003564399 ubox
57 61 0.006133992 ubox
1 60 0.9500000 lbox
2 59 0.9500000 lbox
4 57 0.9500000 lbox
5 56 0.9500000 lbox
6 55 0.9500000 lbox
7 54 0.9500000 lbox
10 52 0.9500000 lbox
11 51 0.9500000 lbox
12 50 0.9500000 lbox
13 49 0.9500000 lbox
16 45 0.9500000 lbox
17 44 0.9500000 lbox
18 43 0.9500000 lbox
19 42 0.9500000 lbox
21 38 0.9500000 lbox
22 37 0.9500000 lbox
23 36 0.9500000 lbox
showpage
end
%%EOF
