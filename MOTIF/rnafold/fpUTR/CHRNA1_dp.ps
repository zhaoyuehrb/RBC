%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 04:03:17 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (CHRNA1)
} def

/sequence { (\
AGACAAGCACCCAGCCAGAGUGCCAGUGAGAAGCACAGGCCACCACUCUGCCCUGGUCCACACAAGCUCCGGUAGCCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 68 0.037513625 ubox
2 58 0.111411674 ubox
2 67 0.043067852 ubox
2 69 0.037352584 ubox
3 57 0.110945827 ubox
3 68 0.031004517 ubox
3 73 0.137100565 ubox
4 55 0.003490348 ubox
4 56 0.063963304 ubox
4 72 0.141225130 ubox
5 54 0.003939687 ubox
6 54 0.021106183 ubox
6 68 0.253582866 ubox
7 15 0.053536744 ubox
7 23 0.007051998 ubox
7 51 0.005738942 ubox
7 53 0.022495658 ubox
7 57 0.028542560 ubox
7 67 0.268577533 ubox
7 73 0.022806153 ubox
7 76 0.395152915 ubox
8 14 0.053719888 ubox
8 22 0.007070488 ubox
8 50 0.005421843 ubox
8 55 0.010993081 ubox
8 56 0.019701705 ubox
8 66 0.268350433 ubox
8 72 0.023261886 ubox
8 75 0.395842347 ubox
9 21 0.007070925 ubox
9 49 0.003877992 ubox
9 54 0.010638582 ubox
9 57 0.271671011 ubox
9 73 0.293500304 ubox
10 20 0.007056175 ubox
10 56 0.245265088 ubox
10 72 0.294989231 ubox
11 55 0.197715916 ubox
11 56 0.896447673 ubox
11 71 0.280069722 ubox
11 72 0.061424357 ubox
12 50 0.003414554 ubox
12 55 0.923983087 ubox
12 71 0.062069905 ubox
13 49 0.003367177 ubox
13 54 0.934678250 ubox
13 68 0.234593012 ubox
14 40 0.008142264 ubox
14 48 0.003274464 ubox
14 51 0.145441277 ubox
14 53 0.928893287 ubox
14 57 0.015745489 ubox
14 67 0.242438525 ubox
14 73 0.173096429 ubox
14 76 0.015022829 ubox
15 39 0.008162128 ubox
15 50 0.107227449 ubox
15 56 0.016400961 ubox
15 66 0.241952090 ubox
15 72 0.176952318 ubox
15 75 0.014831785 ubox
16 38 0.008159464 ubox
16 50 0.973665809 ubox
16 55 0.016405419 ubox
16 71 0.176902248 ubox
17 47 0.005199207 ubox
17 49 0.982784652 ubox
17 54 0.015261707 ubox
18 46 0.005545654 ubox
18 48 0.983464319 ubox
18 53 0.014025017 ubox
18 69 0.178130013 ubox
19 47 0.983298152 ubox
19 68 0.178273567 ubox
20 36 0.010503916 ubox
20 43 0.078586236 ubox
20 46 0.980372086 ubox
20 51 0.011923678 ubox
20 61 0.016669257 ubox
20 63 0.006151192 ubox
20 67 0.178111096 ubox
21 35 0.010563439 ubox
21 42 0.105580955 ubox
21 45 0.971268119 ubox
21 50 0.011829989 ubox
21 60 0.016480704 ubox
21 62 0.006139057 ubox
21 64 0.007065958 ubox
21 66 0.177189999 ubox
22 34 0.010651851 ubox
22 40 0.865022552 ubox
22 41 0.092646331 ubox
22 44 0.458756021 ubox
22 49 0.003418464 ubox
22 51 0.003194310 ubox
22 57 0.014090293 ubox
22 59 0.013805650 ubox
22 61 0.005009408 ubox
22 63 0.011485003 ubox
22 67 0.008992414 ubox
23 33 0.010638410 ubox
23 39 0.978120583 ubox
23 50 0.003177337 ubox
23 56 0.019638305 ubox
23 66 0.009943226 ubox
24 38 0.976602843 ubox
24 55 0.019683376 ubox
25 47 0.006186679 ubox
25 54 0.019486189 ubox
26 34 0.052692233 ubox
26 36 0.972732357 ubox
26 40 0.022529720 ubox
26 43 0.099004447 ubox
26 46 0.006495896 ubox
26 53 0.018856017 ubox
26 61 0.161519794 ubox
26 63 0.071227825 ubox
27 33 0.052364002 ubox
27 35 0.976151464 ubox
27 37 0.017803700 ubox
27 39 0.022303131 ubox
27 42 0.099144491 ubox
27 45 0.006546399 ubox
27 60 0.162019096 ubox
27 62 0.071387677 ubox
28 34 0.974474391 ubox
28 36 0.019070833 ubox
28 41 0.099029809 ubox
28 44 0.006533929 ubox
28 48 0.006714874 ubox
28 58 0.008264309 ubox
28 59 0.161768336 ubox
28 61 0.071169835 ubox
29 47 0.006738337 ubox
29 49 0.006452243 ubox
29 54 0.003687846 ubox
29 57 0.010122681 ubox
30 46 0.006717275 ubox
30 48 0.006547725 ubox
30 53 0.003837139 ubox
30 58 0.151105143 ubox
31 47 0.005904869 ubox
31 57 0.108045084 ubox
32 54 0.015246901 ubox
33 40 0.088679220 ubox
33 46 0.003493361 ubox
33 51 0.017386921 ubox
33 53 0.015582824 ubox
33 57 0.130196107 ubox
34 39 0.088578820 ubox
34 50 0.017449740 ubox
34 55 0.023714518 ubox
34 56 0.161838846 ubox
35 49 0.017286011 ubox
35 54 0.022369763 ubox
35 57 0.004631893 ubox
36 50 0.016922823 ubox
36 55 0.173360587 ubox
36 56 0.004959685 ubox
37 47 0.016802253 ubox
37 49 0.016951959 ubox
37 54 0.173960105 ubox
38 44 0.004954611 ubox
38 46 0.017181615 ubox
38 48 0.016925039 ubox
38 52 0.036937628 ubox
38 53 0.172427978 ubox
38 58 0.007014667 ubox
38 59 0.003932157 ubox
38 77 0.005425515 ubox
39 43 0.005019652 ubox
39 46 0.008723655 ubox
39 47 0.012538407 ubox
39 51 0.044235293 ubox
39 52 0.170491126 ubox
39 57 0.007111529 ubox
39 58 0.003923793 ubox
39 76 0.005441320 ubox
40 50 0.047310975 ubox
40 56 0.007659210 ubox
40 75 0.005421111 ubox
41 50 0.168096383 ubox
41 55 0.007669999 ubox
42 49 0.152484407 ubox
42 54 0.007244810 ubox
42 57 0.018929748 ubox
42 73 0.005254369 ubox
43 56 0.020312522 ubox
43 72 0.005356073 ubox
44 50 0.008874763 ubox
44 55 0.020336232 ubox
44 71 0.005346855 ubox
45 49 0.007369148 ubox
45 54 0.019809944 ubox
48 75 0.015237227 ubox
49 74 0.018157889 ubox
50 57 0.005939848 ubox
50 63 0.003376809 ubox
50 67 0.010296908 ubox
50 73 0.021560307 ubox
50 76 0.012199399 ubox
51 56 0.015023269 ubox
51 66 0.011048946 ubox
51 72 0.030260617 ubox
51 75 0.014126951 ubox
52 71 0.030321722 ubox
52 72 0.026978207 ubox
53 66 0.023715393 ubox
53 71 0.026973914 ubox
53 72 0.070992854 ubox
53 75 0.003421508 ubox
54 60 0.019815566 ubox
54 62 0.116312355 ubox
54 64 0.116933512 ubox
54 65 0.024839979 ubox
54 71 0.071657502 ubox
54 74 0.003410370 ubox
55 59 0.022015104 ubox
55 61 0.131306121 ubox
55 63 0.126504686 ubox
55 68 0.046352236 ubox
55 69 0.015644398 ubox
55 70 0.088248623 ubox
55 77 0.028612344 ubox
56 63 0.093952745 ubox
56 67 0.083837214 ubox
56 68 0.004824215 ubox
56 69 0.088646400 ubox
56 73 0.004904763 ubox
56 76 0.030326958 ubox
56 77 0.003478572 ubox
57 62 0.087612249 ubox
57 66 0.083771722 ubox
57 72 0.013651853 ubox
57 75 0.029779416 ubox
58 71 0.019860153 ubox
58 72 0.149343262 ubox
59 71 0.150847997 ubox
60 73 0.044475290 ubox
61 72 0.046597117 ubox
62 73 0.098432337 ubox
63 72 0.103343528 ubox
66 73 0.459329273 ubox
66 76 0.630363198 ubox
67 72 0.469741536 ubox
67 75 0.631747209 ubox
68 74 0.601515830 ubox
71 77 0.167333733 ubox
71 78 0.165882938 ubox
72 76 0.165007741 ubox
72 77 0.165840528 ubox
11 56 0.9500000 lbox
12 55 0.9500000 lbox
13 54 0.9500000 lbox
14 53 0.9500000 lbox
16 50 0.9500000 lbox
17 49 0.9500000 lbox
18 48 0.9500000 lbox
19 47 0.9500000 lbox
20 46 0.9500000 lbox
21 45 0.9500000 lbox
22 40 0.9500000 lbox
23 39 0.9500000 lbox
24 38 0.9500000 lbox
26 36 0.9500000 lbox
27 35 0.9500000 lbox
28 34 0.9500000 lbox
66 76 0.9500000 lbox
67 75 0.9500000 lbox
68 74 0.9500000 lbox
showpage
end
%%EOF
