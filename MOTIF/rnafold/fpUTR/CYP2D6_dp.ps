%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:20:01 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (CYP2D6)
} def

/sequence { (\
GUGCUGAGAGUGUCCUGCCUGGUCCUCUGUGCCUGGUGGGGUGGGGGUGCCAGGUGUGUCCAGAGGAGCCCAUUUGGUAGUGAGGCAGGU\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 11 0.007913256 ubox
1 13 0.072311525 ubox
1 86 0.007975035 ubox
1 90 0.005780705 ubox
2 10 0.013965339 ubox
2 12 0.251970379 ubox
2 79 0.008219080 ubox
2 82 0.007413164 ubox
2 85 0.007767540 ubox
2 87 0.054857558 ubox
2 89 0.005539873 ubox
3 11 0.450976722 ubox
3 13 0.238692429 ubox
3 18 0.003322779 ubox
3 78 0.009040619 ubox
3 81 0.013997148 ubox
3 86 0.060832335 ubox
3 90 0.097483778 ubox
4 10 0.460807443 ubox
4 12 0.250732912 ubox
4 17 0.003474631 ubox
4 63 0.070565415 ubox
4 65 0.004175853 ubox
4 66 0.005587433 ubox
4 77 0.009088538 ubox
4 80 0.014226048 ubox
4 85 0.060790169 ubox
4 88 0.090972296 ubox
4 89 0.104890021 ubox
5 9 0.415281283 ubox
5 12 0.018241504 ubox
5 62 0.070875309 ubox
5 64 0.004007503 ubox
5 65 0.005528616 ubox
5 76 0.008941234 ubox
5 79 0.014172314 ubox
5 84 0.060115266 ubox
5 87 0.091159689 ubox
5 88 0.100320122 ubox
6 11 0.020142906 ubox
6 14 0.034961349 ubox
6 61 0.070886422 ubox
6 75 0.007850130 ubox
6 78 0.013386102 ubox
6 86 0.062940524 ubox
7 13 0.040401405 ubox
7 16 0.016010414 ubox
7 59 0.003881687 ubox
7 74 0.007711349 ubox
8 14 0.016666775 ubox
8 15 0.016597611 ubox
8 60 0.070226017 ubox
8 73 0.006837237 ubox
8 75 0.016153934 ubox
9 13 0.016266579 ubox
9 16 0.009450323 ubox
9 59 0.069831264 ubox
9 74 0.016341743 ubox
10 15 0.009923439 ubox
10 57 0.005439972 ubox
10 69 0.005043581 ubox
10 73 0.016547227 ubox
10 81 0.005927017 ubox
10 86 0.372261559 ubox
10 90 0.017641103 ubox
11 56 0.007860489 ubox
11 58 0.016017404 ubox
11 62 0.005907977 ubox
11 68 0.004784917 ubox
11 72 0.016593163 ubox
11 79 0.005757276 ubox
11 80 0.003411960 ubox
11 82 0.004167833 ubox
11 85 0.374962070 ubox
11 87 0.027455885 ubox
12 57 0.018742023 ubox
12 61 0.006365091 ubox
12 69 0.003532005 ubox
12 71 0.016524087 ubox
12 78 0.005613318 ubox
12 86 0.030522125 ubox
12 90 0.127644461 ubox
13 56 0.011188945 ubox
13 58 0.006714630 ubox
13 66 0.004027250 ubox
13 67 0.076736233 ubox
13 83 0.381912965 ubox
13 85 0.028944874 ubox
13 89 0.008638986 ubox
14 65 0.005186717 ubox
14 66 0.082203913 ubox
14 77 0.007386214 ubox
14 82 0.382503463 ubox
14 84 0.028346129 ubox
14 85 0.009253808 ubox
14 88 0.008727409 ubox
14 89 0.907026353 ubox
15 63 0.007357400 ubox
15 65 0.082215012 ubox
15 76 0.007379516 ubox
15 80 0.383912511 ubox
15 84 0.009292517 ubox
15 88 0.915364276 ubox
15 89 0.005631402 ubox
16 56 0.058092815 ubox
16 62 0.007724085 ubox
16 64 0.079780097 ubox
16 79 0.383820821 ubox
16 83 0.008921108 ubox
16 87 0.915067202 ubox
16 88 0.003865999 ubox
17 55 0.127078882 ubox
17 61 0.006941951 ubox
17 78 0.383787859 ubox
17 86 0.914175206 ubox
17 90 0.012153087 ubox
18 54 0.129225105 ubox
18 77 0.383847201 ubox
18 85 0.914146876 ubox
18 89 0.013145505 ubox
19 53 0.129469803 ubox
19 76 0.383529575 ubox
19 84 0.914010690 ubox
19 88 0.013168479 ubox
20 52 0.130309180 ubox
20 72 0.350814054 ubox
20 76 0.004118024 ubox
20 82 0.016162623 ubox
20 83 0.891722488 ubox
20 87 0.012926251 ubox
21 48 0.007530231 ubox
21 51 0.132435565 ubox
21 70 0.816621670 ubox
21 71 0.354104474 ubox
21 74 0.016063385 ubox
21 75 0.003681330 ubox
21 81 0.021343534 ubox
21 86 0.010186295 ubox
22 48 0.021576972 ubox
22 50 0.132468409 ubox
22 69 0.821914852 ubox
22 70 0.346224978 ubox
22 73 0.017354770 ubox
22 74 0.004071412 ubox
22 81 0.301886386 ubox
23 45 0.004713848 ubox
23 46 0.013859122 ubox
23 47 0.081105372 ubox
23 49 0.128656109 ubox
23 67 0.821091237 ubox
23 68 0.431178298 ubox
23 72 0.009652531 ubox
23 80 0.091501171 ubox
23 83 0.004441123 ubox
24 44 0.006118965 ubox
24 45 0.017196816 ubox
24 46 0.112746791 ubox
24 47 0.305210630 ubox
24 66 0.940805742 ubox
24 82 0.005439385 ubox
24 85 0.009531718 ubox
25 43 0.006123659 ubox
25 44 0.017212759 ubox
25 45 0.112864307 ubox
25 46 0.307427690 ubox
25 47 0.059185542 ubox
25 65 0.940988820 ubox
25 66 0.003786956 ubox
25 80 0.008854329 ubox
25 84 0.009610094 ubox
26 43 0.016100813 ubox
26 44 0.109315703 ubox
26 45 0.306617311 ubox
26 46 0.055978932 ubox
26 47 0.044635231 ubox
26 64 0.940865674 ubox
26 79 0.004802019 ubox
26 83 0.009688146 ubox
27 41 0.007479732 ubox
27 43 0.108266634 ubox
27 44 0.307882721 ubox
27 45 0.059248290 ubox
27 46 0.060104779 ubox
27 63 0.940992779 ubox
27 82 0.009717570 ubox
28 40 0.007544938 ubox
28 43 0.298228479 ubox
28 44 0.057627222 ubox
28 45 0.060253266 ubox
28 58 0.011475153 ubox
28 62 0.940572472 ubox
29 42 0.193329944 ubox
29 57 0.044653287 ubox
29 59 0.016133566 ubox
29 61 0.938092394 ubox
30 38 0.007177126 ubox
30 41 0.222201963 ubox
30 43 0.076058628 ubox
30 56 0.808312151 ubox
30 58 0.095618020 ubox
30 79 0.009775243 ubox
31 37 0.007315926 ubox
31 42 0.222191920 ubox
31 55 0.932483508 ubox
31 57 0.035426277 ubox
31 59 0.066643033 ubox
31 78 0.009943707 ubox
32 36 0.007288116 ubox
32 39 0.245203725 ubox
32 40 0.045404062 ubox
32 41 0.228458764 ubox
32 54 0.939652737 ubox
32 56 0.023275272 ubox
32 58 0.043240514 ubox
32 77 0.009957674 ubox
33 38 0.245111009 ubox
33 39 0.045500092 ubox
33 40 0.228431915 ubox
33 53 0.940777169 ubox
33 54 0.009339439 ubox
33 76 0.009952496 ubox
34 38 0.041127521 ubox
34 39 0.224087008 ubox
34 52 0.940571902 ubox
34 53 0.006196198 ubox
34 56 0.006464434 ubox
35 51 0.940730189 ubox
35 55 0.006632522 ubox
35 74 0.008415939 ubox
36 50 0.940671008 ubox
36 73 0.009866607 ubox
37 47 0.009382203 ubox
37 49 0.934010369 ubox
37 52 0.013721843 ubox
37 72 0.009899511 ubox
38 42 0.008067671 ubox
38 48 0.812858942 ubox
38 51 0.014961553 ubox
38 71 0.009820679 ubox
39 50 0.015274103 ubox
39 51 0.003714101 ubox
39 70 0.009736965 ubox
40 50 0.003848067 ubox
40 51 0.013218597 ubox
40 69 0.009614079 ubox
41 48 0.043260501 ubox
41 50 0.014299108 ubox
42 47 0.064171153 ubox
42 49 0.015694222 ubox
42 52 0.006068854 ubox
43 48 0.036467298 ubox
43 51 0.008128071 ubox
43 61 0.004061465 ubox
44 50 0.008170082 ubox
44 51 0.006469457 ubox
44 60 0.004160412 ubox
45 50 0.006546305 ubox
45 59 0.004118957 ubox
45 61 0.006643072 ubox
46 60 0.006691754 ubox
47 57 0.003860190 ubox
47 59 0.006351591 ubox
47 81 0.008152374 ubox
48 56 0.003268942 ubox
48 58 0.005582128 ubox
48 79 0.282084036 ubox
48 80 0.004684292 ubox
49 55 0.004183772 ubox
49 57 0.007151187 ubox
49 78 0.309441007 ubox
50 54 0.004177722 ubox
50 56 0.007167557 ubox
50 77 0.311183636 ubox
51 76 0.311210499 ubox
52 75 0.310946477 ubox
53 61 0.007084130 ubox
53 70 0.016664031 ubox
53 71 0.015824452 ubox
53 74 0.309798052 ubox
54 60 0.007244224 ubox
54 69 0.016729503 ubox
54 70 0.015999842 ubox
54 73 0.310658153 ubox
55 62 0.004126814 ubox
55 68 0.016635296 ubox
55 72 0.310879955 ubox
55 82 0.004344123 ubox
56 61 0.009479193 ubox
56 69 0.020126302 ubox
56 71 0.309840124 ubox
56 81 0.006410504 ubox
57 68 0.020488788 ubox
57 79 0.010556812 ubox
57 80 0.014018977 ubox
58 69 0.265761074 ubox
58 78 0.011520337 ubox
58 86 0.003437512 ubox
59 66 0.009255506 ubox
59 67 0.277801834 ubox
59 68 0.149512938 ubox
59 85 0.003399603 ubox
60 65 0.013119831 ubox
60 66 0.310740477 ubox
60 77 0.028096888 ubox
60 84 0.003173763 ubox
61 65 0.308531574 ubox
61 76 0.028280258 ubox
62 75 0.028240419 ubox
63 74 0.028178412 ubox
64 73 0.028031756 ubox
65 71 0.023711217 ubox
66 70 0.023370215 ubox
68 78 0.237916112 ubox
68 81 0.021945801 ubox
68 86 0.125697640 ubox
69 77 0.242386090 ubox
69 80 0.024074305 ubox
69 85 0.126164481 ubox
70 76 0.241035367 ubox
70 77 0.099918582 ubox
70 84 0.126171693 ubox
71 76 0.110421648 ubox
71 82 0.786182132 ubox
72 78 0.013568776 ubox
72 81 0.787818532 ubox
73 77 0.013147316 ubox
73 80 0.783216824 ubox
73 83 0.006455412 ubox
74 79 0.725431855 ubox
74 80 0.018391656 ubox
74 82 0.011063365 ubox
74 83 0.012314034 ubox
75 79 0.019601938 ubox
75 82 0.018972915 ubox
75 83 0.004268315 ubox
76 81 0.019534790 ubox
14 89 0.9500000 lbox
15 88 0.9500000 lbox
16 87 0.9500000 lbox
17 86 0.9500000 lbox
18 85 0.9500000 lbox
19 84 0.9500000 lbox
20 83 0.9500000 lbox
21 70 0.9500000 lbox
22 69 0.9500000 lbox
23 67 0.9500000 lbox
24 66 0.9500000 lbox
25 65 0.9500000 lbox
26 64 0.9500000 lbox
27 63 0.9500000 lbox
28 62 0.9500000 lbox
29 61 0.9500000 lbox
30 56 0.9500000 lbox
31 55 0.9500000 lbox
32 54 0.9500000 lbox
33 53 0.9500000 lbox
34 52 0.9500000 lbox
35 51 0.9500000 lbox
36 50 0.9500000 lbox
37 49 0.9500000 lbox
38 48 0.9500000 lbox
71 82 0.9500000 lbox
72 81 0.9500000 lbox
73 80 0.9500000 lbox
74 79 0.9500000 lbox
showpage
end
%%EOF
