%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:30:56 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (SPTBN4)
} def

/sequence { (\
GGCCGGGCCGGGCAGCGGACGCCGACAGGGAGGGCGGUCGGUCGCGGCGAGCAGCGGAGACAGCGACGCUGGCGGCCGCGGGCCCAGGCCUCACCUUCCCCG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 9 0.155613730 ubox
1 23 0.777327264 ubox
1 90 0.346626095 ubox
1 92 0.012364072 ubox
1 95 0.422687631 ubox
1 96 0.016155103 ubox
1 98 0.005552078 ubox
1 99 0.020888502 ubox
1 100 0.011615054 ubox
1 101 0.034176998 ubox
2 8 0.155786566 ubox
2 13 0.158258393 ubox
2 22 0.777935091 ubox
2 89 0.347242216 ubox
2 91 0.006146112 ubox
2 94 0.423138827 ubox
2 95 0.018408602 ubox
2 97 0.004931048 ubox
2 98 0.020903988 ubox
2 99 0.011493264 ubox
2 100 0.024596398 ubox
3 7 0.154654553 ubox
3 11 0.013535656 ubox
3 12 0.158270515 ubox
3 18 0.028495840 ubox
3 21 0.644009049 ubox
3 88 0.347253781 ubox
4 10 0.016212456 ubox
4 11 0.158054417 ubox
4 17 0.038107165 ubox
4 21 0.435403381 ubox
4 24 0.193549352 ubox
4 87 0.347065627 ubox
4 102 0.011962882 ubox
5 9 0.016817302 ubox
5 16 0.037986719 ubox
5 20 0.615032878 ubox
5 23 0.195395309 ubox
5 85 0.345902262 ubox
5 90 0.003440278 ubox
5 91 0.418320054 ubox
5 92 0.064187046 ubox
5 95 0.008583262 ubox
5 101 0.012720408 ubox
6 22 0.194883008 ubox
6 23 0.025386609 ubox
6 84 0.347227261 ubox
6 85 0.003296285 ubox
6 90 0.429487598 ubox
6 91 0.007932551 ubox
6 94 0.006085358 ubox
6 100 0.011708907 ubox
7 13 0.035919539 ubox
7 16 0.064539310 ubox
7 22 0.026394172 ubox
7 83 0.347237785 ubox
7 89 0.429603985 ubox
7 90 0.005632027 ubox
7 99 0.009830617 ubox
8 12 0.035678128 ubox
8 15 0.064448895 ubox
8 18 0.798239941 ubox
8 21 0.020429944 ubox
8 81 0.006078908 ubox
8 82 0.347165833 ubox
8 88 0.429651346 ubox
9 17 0.799390749 ubox
9 21 0.010016401 ubox
9 24 0.010963978 ubox
9 80 0.008446456 ubox
9 81 0.346544159 ubox
9 87 0.429418497 ubox
10 16 0.798149698 ubox
10 20 0.015970001 ubox
10 23 0.017142953 ubox
10 43 0.007404675 ubox
10 79 0.007618611 ubox
10 85 0.427983024 ubox
10 96 0.004166869 ubox
10 101 0.009614583 ubox
11 22 0.015176692 ubox
11 23 0.153246826 ubox
11 39 0.029579377 ubox
11 42 0.005727785 ubox
11 43 0.080165687 ubox
11 77 0.007148177 ubox
11 84 0.429622437 ubox
11 85 0.005007193 ubox
11 95 0.004224071 ubox
11 100 0.004459167 ubox
12 22 0.153627883 ubox
12 38 0.029727464 ubox
12 42 0.096135666 ubox
12 45 0.006691837 ubox
12 76 0.007151402 ubox
12 79 0.012084868 ubox
12 83 0.429629409 ubox
12 84 0.004087951 ubox
12 94 0.004204896 ubox
13 21 0.153751750 ubox
13 37 0.029717851 ubox
13 41 0.096741878 ubox
13 44 0.006848799 ubox
13 75 0.007125870 ubox
13 78 0.012051597 ubox
13 82 0.429109288 ubox
15 22 0.052539547 ubox
15 35 0.028202716 ubox
15 38 0.008300426 ubox
15 42 0.383742662 ubox
15 45 0.006348459 ubox
15 73 0.005651249 ubox
15 79 0.041709254 ubox
16 21 0.052702974 ubox
16 24 0.144938013 ubox
16 34 0.028301088 ubox
16 36 0.003980488 ubox
16 37 0.008411697 ubox
16 40 0.352866668 ubox
16 41 0.407470557 ubox
16 44 0.006366043 ubox
16 72 0.005642804 ubox
16 78 0.041717123 ubox
16 80 0.007426599 ubox
16 102 0.006508337 ubox
17 23 0.146967131 ubox
17 35 0.004050704 ubox
17 39 0.358629137 ubox
17 43 0.006502272 ubox
17 77 0.039941381 ubox
17 79 0.006174430 ubox
17 101 0.007013148 ubox
18 22 0.144599248 ubox
18 38 0.199066871 ubox
18 39 0.411361268 ubox
18 43 0.003421238 ubox
18 76 0.038340535 ubox
18 100 0.006413631 ubox
19 38 0.407604966 ubox
20 36 0.465039493 ubox
20 37 0.288939514 ubox
20 40 0.004628559 ubox
20 44 0.003869196 ubox
20 74 0.037295121 ubox
20 102 0.005678737 ubox
21 35 0.547041541 ubox
21 38 0.003513083 ubox
21 39 0.004600971 ubox
21 42 0.047503816 ubox
21 43 0.004447779 ubox
21 73 0.037777087 ubox
21 76 0.006736146 ubox
21 101 0.005951300 ubox
22 29 0.025508652 ubox
22 30 0.014848720 ubox
22 33 0.050706258 ubox
22 34 0.545448841 ubox
22 37 0.006139727 ubox
22 41 0.051360966 ubox
22 72 0.037763616 ubox
22 75 0.009081892 ubox
23 28 0.025745003 ubox
23 29 0.015277583 ubox
23 32 0.069592856 ubox
23 33 0.543253515 ubox
23 36 0.006242781 ubox
23 40 0.051633201 ubox
23 71 0.037145244 ubox
23 74 0.009085315 ubox
23 102 0.022594799 ubox
24 35 0.006188956 ubox
24 39 0.051950743 ubox
24 43 0.004460761 ubox
24 70 0.018596995 ubox
24 73 0.008775149 ubox
24 98 0.013084307 ubox
24 101 0.092766997 ubox
25 38 0.051937363 ubox
25 42 0.004681969 ubox
25 97 0.013001820 ubox
26 37 0.051880076 ubox
26 41 0.004676441 ubox
26 71 0.011021987 ubox
27 70 0.015885433 ubox
27 96 0.015982970 ubox
28 39 0.004064643 ubox
28 69 0.017175416 ubox
28 70 0.014491117 ubox
28 95 0.016526834 ubox
28 99 0.102257852 ubox
28 100 0.819984007 ubox
28 101 0.091205779 ubox
29 38 0.004071679 ubox
29 69 0.016801852 ubox
29 70 0.006462466 ubox
29 94 0.016526006 ubox
29 98 0.102605662 ubox
29 99 0.823550889 ubox
29 100 0.075256973 ubox
30 39 0.003298595 ubox
30 69 0.007457075 ubox
30 92 0.007279345 ubox
30 97 0.102650985 ubox
30 98 0.825192315 ubox
30 99 0.054584882 ubox
31 38 0.003263124 ubox
31 91 0.007090607 ubox
31 96 0.114272056 ubox
31 97 0.824935926 ubox
32 90 0.006189499 ubox
32 91 0.015930395 ubox
32 95 0.124205103 ubox
32 96 0.823268976 ubox
33 70 0.024486583 ubox
33 89 0.005137474 ubox
33 90 0.016793108 ubox
33 92 0.003997017 ubox
33 94 0.124223177 ubox
33 95 0.823994430 ubox
34 42 0.003387760 ubox
34 52 0.004168205 ubox
34 64 0.025758027 ubox
34 69 0.028388628 ubox
34 89 0.017314264 ubox
34 91 0.009013289 ubox
34 94 0.823543977 ubox
35 41 0.003960701 ubox
35 51 0.004175261 ubox
35 63 0.025669091 ubox
35 68 0.028387021 ubox
35 88 0.017694622 ubox
36 67 0.020786242 ubox
36 84 0.006207221 ubox
36 90 0.830586033 ubox
36 91 0.012963570 ubox
36 92 0.059630618 ubox
37 48 0.008509607 ubox
37 61 0.025745638 ubox
37 67 0.019484158 ubox
37 79 0.007753604 ubox
37 83 0.006238853 ubox
37 89 0.832729566 ubox
37 90 0.018936137 ubox
37 91 0.019260632 ubox
38 47 0.008531892 ubox
38 60 0.025956276 ubox
38 66 0.027437038 ubox
38 82 0.006244189 ubox
38 88 0.832477862 ubox
39 46 0.008650549 ubox
39 59 0.025951392 ubox
39 65 0.027744635 ubox
39 78 0.010007637 ubox
39 81 0.005797210 ubox
39 87 0.811890116 ubox
40 45 0.008621483 ubox
40 64 0.027145771 ubox
40 77 0.019206891 ubox
40 84 0.750647266 ubox
40 85 0.338567893 ubox
40 90 0.004361595 ubox
41 61 0.027923555 ubox
41 76 0.019552383 ubox
41 83 0.761338868 ubox
41 84 0.322539508 ubox
41 89 0.004361773 ubox
42 57 0.024016154 ubox
42 60 0.028166031 ubox
42 75 0.019575352 ubox
42 81 0.577232781 ubox
42 82 0.626252897 ubox
42 88 0.004162972 ubox
43 56 0.026064693 ubox
43 59 0.028132366 ubox
43 74 0.019857228 ubox
43 80 0.888016780 ubox
43 81 0.443323983 ubox
44 52 0.003325496 ubox
44 55 0.026215426 ubox
44 73 0.019826112 ubox
44 76 0.006077182 ubox
44 79 0.998256236 ubox
45 51 0.003335681 ubox
45 54 0.026214321 ubox
45 56 0.006908355 ubox
45 71 0.013074056 ubox
45 72 0.015018465 ubox
45 75 0.007264075 ubox
45 78 0.998909922 ubox
46 55 0.006076508 ubox
46 70 0.018475995 ubox
46 77 0.998951332 ubox
47 55 0.027371272 ubox
47 69 0.019702240 ubox
47 73 0.008895202 ubox
47 76 0.998953003 ubox
48 54 0.027580240 ubox
48 68 0.019703090 ubox
48 72 0.009277643 ubox
48 74 0.119643035 ubox
48 75 0.991408185 ubox
49 67 0.019580002 ubox
49 73 0.168589178 ubox
50 70 0.011610844 ubox
51 64 0.012137395 ubox
51 69 0.012216370 ubox
51 73 0.387438519 ubox
52 63 0.012129662 ubox
52 68 0.012207987 ubox
52 71 0.958358156 ubox
52 72 0.279786381 ubox
53 70 0.995522070 ubox
54 64 0.016396830 ubox
54 69 0.998946529 ubox
55 63 0.016405934 ubox
55 65 0.012428322 ubox
55 68 0.998922811 ubox
56 64 0.017611537 ubox
56 67 0.997415122 ubox
61 71 0.007451296 ubox
62 70 0.007526801 ubox
63 69 0.007544378 ubox
64 68 0.007489921 ubox
80 91 0.008467127 ubox
81 90 0.019931018 ubox
82 89 0.020041900 ubox
83 88 0.020037384 ubox
1 23 0.9500000 lbox
2 22 0.9500000 lbox
3 21 0.9500000 lbox
8 18 0.9500000 lbox
9 17 0.9500000 lbox
10 16 0.9500000 lbox
28 100 0.9500000 lbox
29 99 0.9500000 lbox
30 98 0.9500000 lbox
31 97 0.9500000 lbox
32 96 0.9500000 lbox
33 95 0.9500000 lbox
34 94 0.9500000 lbox
36 90 0.9500000 lbox
37 89 0.9500000 lbox
38 88 0.9500000 lbox
39 87 0.9500000 lbox
40 84 0.9500000 lbox
41 83 0.9500000 lbox
42 82 0.9500000 lbox
43 81 0.9500000 lbox
44 79 0.9500000 lbox
45 78 0.9500000 lbox
46 77 0.9500000 lbox
47 76 0.9500000 lbox
48 75 0.9500000 lbox
52 71 0.9500000 lbox
53 70 0.9500000 lbox
54 69 0.9500000 lbox
55 68 0.9500000 lbox
56 67 0.9500000 lbox
showpage
end
%%EOF
