%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:39:22 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (SHQ1)
} def

/sequence { (\
GUCCCUCACACCGAGAGUUCCUGCGCGUGGGGAGUUGGAGAGUUUGCGUGGCGGGAACGCGGCGGCAGUGAGAGCGAGCGGCGCCGGCCCUUGCGUCCGGUGCGGCG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 9 0.015003468 ubox
1 11 0.005256835 ubox
1 58 0.012377602 ubox
1 60 0.023979512 ubox
1 63 0.003955343 ubox
1 75 0.579186496 ubox
1 79 0.008440181 ubox
1 103 0.008970136 ubox
1 106 0.033520891 ubox
2 8 0.014401258 ubox
2 10 0.005096977 ubox
2 14 0.004193328 ubox
2 16 0.007264849 ubox
2 33 0.007686036 ubox
2 39 0.004052451 ubox
2 56 0.012310414 ubox
2 57 0.009474631 ubox
2 59 0.022985277 ubox
2 62 0.003663995 ubox
2 73 0.041452480 ubox
2 74 0.569556558 ubox
2 77 0.301196035 ubox
2 78 0.005514203 ubox
2 102 0.008725846 ubox
2 105 0.030977600 ubox
3 13 0.004481197 ubox
3 15 0.006559347 ubox
3 32 0.008210668 ubox
3 38 0.004344876 ubox
3 55 0.015116746 ubox
3 61 0.006789650 ubox
3 72 0.036938868 ubox
3 76 0.321725636 ubox
3 100 0.008804132 ubox
3 104 0.030490933 ubox
3 105 0.013894649 ubox
4 31 0.008192409 ubox
4 32 0.008310242 ubox
4 37 0.004305397 ubox
4 54 0.015114378 ubox
4 55 0.005879800 ubox
4 61 0.006197316 ubox
4 99 0.008823553 ubox
4 100 0.004403250 ubox
4 104 0.013949333 ubox
4 105 0.006343237 ubox
5 15 0.151181710 ubox
5 17 0.005783848 ubox
5 30 0.008162722 ubox
5 31 0.008372949 ubox
5 34 0.004103073 ubox
5 42 0.007705455 ubox
5 53 0.015092029 ubox
5 54 0.005901812 ubox
5 72 0.980590509 ubox
5 74 0.055612176 ubox
5 99 0.004150153 ubox
5 104 0.006405149 ubox
6 14 0.151739831 ubox
6 16 0.011206865 ubox
6 30 0.008356477 ubox
6 33 0.004157150 ubox
6 41 0.007766919 ubox
6 51 0.008230260 ubox
6 53 0.005832043 ubox
6 71 0.984251953 ubox
6 73 0.052499318 ubox
6 105 0.006522933 ubox
7 13 0.151707789 ubox
7 15 0.011615468 ubox
7 29 0.011110541 ubox
7 32 0.004138558 ubox
7 40 0.007768491 ubox
7 50 0.008346669 ubox
7 64 0.003164919 ubox
7 70 0.984807722 ubox
7 72 0.050467928 ubox
7 104 0.008937462 ubox
8 28 0.011151898 ubox
8 49 0.008330826 ubox
8 69 0.984545708 ubox
9 27 0.011110014 ubox
9 29 0.005667918 ubox
9 48 0.008286760 ubox
9 50 0.013997974 ubox
9 68 0.982044732 ubox
9 70 0.045787845 ubox
9 102 0.011413512 ubox
10 28 0.005860167 ubox
10 49 0.014009383 ubox
10 69 0.045486077 ubox
10 101 0.011434465 ubox
11 27 0.005882178 ubox
11 38 0.015231632 ubox
11 48 0.013982498 ubox
11 62 0.063244071 ubox
11 65 0.982137590 ubox
11 68 0.026071383 ubox
11 100 0.011447189 ubox
12 25 0.011218475 ubox
12 37 0.015286738 ubox
12 46 0.015327515 ubox
12 61 0.075902650 ubox
12 64 0.983809293 ubox
12 99 0.011449842 ubox
13 24 0.011214129 ubox
13 36 0.013253402 ubox
13 45 0.015267758 ubox
13 60 0.075326709 ubox
13 63 0.982171696 ubox
13 98 0.011343760 ubox
14 22 0.011745382 ubox
14 35 0.011814901 ubox
14 44 0.015130004 ubox
14 45 0.004660165 ubox
15 21 0.011783431 ubox
15 36 0.007861698 ubox
15 43 0.013195125 ubox
15 44 0.004756056 ubox
15 97 0.007971281 ubox
16 35 0.009912047 ubox
16 43 0.004844547 ubox
16 96 0.007445718 ubox
17 58 0.998720841 ubox
17 60 0.020172967 ubox
18 33 0.013524347 ubox
18 34 0.007037742 ubox
18 40 0.013684004 ubox
18 41 0.003503449 ubox
18 56 0.003392515 ubox
18 57 0.998872002 ubox
18 59 0.018318133 ubox
19 31 0.003310564 ubox
19 32 0.013901009 ubox
19 33 0.007400814 ubox
19 39 0.015717701 ubox
19 55 0.003901275 ubox
19 56 0.999280134 ubox
20 30 0.003443372 ubox
20 31 0.013980714 ubox
20 32 0.007478816 ubox
20 38 0.015912550 ubox
20 54 0.005209597 ubox
20 55 0.999638820 ubox
21 29 0.003453143 ubox
21 30 0.013982624 ubox
21 31 0.007471052 ubox
21 37 0.015903137 ubox
21 53 0.006222842 ubox
21 54 0.999628356 ubox
22 29 0.013532867 ubox
22 30 0.007409383 ubox
22 53 0.998808061 ubox
23 28 0.006701778 ubox
23 35 0.014601674 ubox
23 49 0.005852652 ubox
23 52 0.998160130 ubox
24 34 0.015056796 ubox
24 48 0.007842971 ubox
24 50 0.549899918 ubox
24 51 0.834137378 ubox
24 53 0.007369700 ubox
25 35 0.004648898 ubox
25 47 0.014087187 ubox
25 49 0.775842530 ubox
25 52 0.008449656 ubox
26 34 0.004755453 ubox
26 46 0.014092466 ubox
26 48 0.802994957 ubox
26 50 0.582471131 ubox
26 51 0.008298000 ubox
27 45 0.012386093 ubox
27 47 0.802143780 ubox
27 49 0.555413644 ubox
28 46 0.796264302 ubox
28 48 0.561559580 ubox
29 36 0.011532662 ubox
29 44 0.021071928 ubox
29 45 0.680290722 ubox
29 47 0.595080792 ubox
30 35 0.011997533 ubox
30 36 0.004911825 ubox
30 43 0.030300984 ubox
30 44 0.654808937 ubox
30 45 0.035323120 ubox
31 35 0.004402919 ubox
31 43 0.615408107 ubox
31 44 0.045829379 ubox
31 45 0.658632404 ubox
32 43 0.042129032 ubox
32 44 0.710104360 ubox
32 45 0.127701155 ubox
33 43 0.716090298 ubox
33 44 0.134396025 ubox
33 45 0.015892133 ubox
34 43 0.130298401 ubox
34 44 0.016931692 ubox
35 41 0.682343937 ubox
35 42 0.202507097 ubox
35 77 0.004011642 ubox
36 40 0.616625905 ubox
36 41 0.213489181 ubox
36 76 0.004332471 ubox
37 44 0.007853550 ubox
37 45 0.012682504 ubox
37 75 0.004489851 ubox
38 43 0.008053717 ubox
38 44 0.014154309 ubox
38 45 0.013063035 ubox
39 43 0.012478028 ubox
39 44 0.012673186 ubox
39 45 0.005443371 ubox
40 44 0.004123042 ubox
44 68 0.005332376 ubox
45 61 0.005130974 ubox
45 67 0.012962185 ubox
46 60 0.006340121 ubox
46 66 0.013855390 ubox
47 59 0.006342526 ubox
47 64 0.015979235 ubox
47 65 0.009833425 ubox
48 58 0.006341704 ubox
48 63 0.018891355 ubox
49 57 0.006317715 ubox
49 62 0.018879642 ubox
51 60 0.019143413 ubox
52 59 0.019146003 ubox
53 58 0.019093450 ubox
59 66 0.030235497 ubox
59 103 0.008292317 ubox
59 106 0.005040321 ubox
60 65 0.030257408 ubox
60 102 0.008300705 ubox
60 105 0.004982013 ubox
60 107 0.030130358 ubox
61 101 0.008263502 ubox
61 106 0.027907673 ubox
62 103 0.003891899 ubox
62 106 0.159947207 ubox
63 99 0.008333281 ubox
63 102 0.003825226 ubox
63 104 0.022494355 ubox
63 105 0.161974408 ubox
64 98 0.008323100 ubox
64 103 0.015968479 ubox
65 97 0.008230533 ubox
65 103 0.164272492 ubox
66 95 0.004184083 ubox
66 102 0.165120455 ubox
67 101 0.165031467 ubox
68 94 0.004651122 ubox
69 93 0.004638013 ubox
69 99 0.163750374 ubox
69 100 0.003865774 ubox
70 92 0.004621234 ubox
70 97 0.010913516 ubox
70 98 0.164216355 ubox
71 91 0.004641153 ubox
71 96 0.013901632 ubox
72 90 0.004636112 ubox
72 97 0.154350700 ubox
73 96 0.150416199 ubox
74 82 0.005705565 ubox
74 88 0.004599441 ubox
74 94 0.173457264 ubox
74 103 0.003983720 ubox
74 106 0.010952576 ubox
75 81 0.005762613 ubox
75 87 0.004546366 ubox
75 93 0.173745511 ubox
75 102 0.003987313 ubox
75 105 0.010635298 ubox
75 107 0.034310630 ubox
76 92 0.173597832 ubox
76 101 0.003796139 ubox
76 106 0.021684067 ubox
77 91 0.173702012 ubox
78 84 0.004559902 ubox
78 90 0.173705390 ubox
78 106 0.982569507 ubox
79 83 0.004527631 ubox
79 99 0.003965649 ubox
79 104 0.016075421 ubox
79 105 0.983480410 ubox
79 107 0.005725485 ubox
80 89 0.173744214 ubox
80 98 0.003986359 ubox
80 103 0.012406060 ubox
80 106 0.006108495 ubox
81 88 0.173765418 ubox
81 97 0.003961830 ubox
81 103 0.984254497 ubox
82 87 0.173707738 ubox
82 95 0.004251837 ubox
82 102 0.984693476 ubox
82 107 0.005827690 ubox
83 94 0.004253652 ubox
83 101 0.984336095 ubox
83 106 0.008455671 ubox
84 93 0.004212794 ubox
84 100 0.984722046 ubox
84 105 0.008460552 ubox
85 99 0.984701284 ubox
85 104 0.008457731 ubox
86 97 0.101720824 ubox
86 98 0.979370231 ubox
86 103 0.008054981 ubox
87 94 0.068286407 ubox
87 96 0.143837151 ubox
87 97 0.970608989 ubox
88 93 0.092254164 ubox
88 95 0.917527373 ubox
88 102 0.003593406 ubox
89 100 0.008060771 ubox
90 99 0.008066056 ubox
94 107 0.005269614 ubox
95 103 0.007466904 ubox
95 106 0.042654324 ubox
96 102 0.007247099 ubox
96 105 0.026998001 ubox
97 104 0.026549045 ubox
97 105 0.038784515 ubox
98 104 0.039104264 ubox
98 107 0.006663789 ubox
99 103 0.036766952 ubox
99 106 0.007097620 ubox
5 72 0.9500000 lbox
6 71 0.9500000 lbox
7 70 0.9500000 lbox
8 69 0.9500000 lbox
9 68 0.9500000 lbox
11 65 0.9500000 lbox
12 64 0.9500000 lbox
13 63 0.9500000 lbox
17 58 0.9500000 lbox
18 57 0.9500000 lbox
19 56 0.9500000 lbox
20 55 0.9500000 lbox
21 54 0.9500000 lbox
22 53 0.9500000 lbox
23 52 0.9500000 lbox
24 51 0.9500000 lbox
26 50 0.9500000 lbox
27 49 0.9500000 lbox
28 48 0.9500000 lbox
29 47 0.9500000 lbox
31 45 0.9500000 lbox
32 44 0.9500000 lbox
33 43 0.9500000 lbox
35 41 0.9500000 lbox
36 40 0.9500000 lbox
78 106 0.9500000 lbox
79 105 0.9500000 lbox
81 103 0.9500000 lbox
82 102 0.9500000 lbox
83 101 0.9500000 lbox
84 100 0.9500000 lbox
85 99 0.9500000 lbox
86 98 0.9500000 lbox
87 97 0.9500000 lbox
showpage
end
%%EOF
