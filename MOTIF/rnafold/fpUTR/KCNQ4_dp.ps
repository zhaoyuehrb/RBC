%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:46:31 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (KCNQ4)
} def

/sequence { (\
AGCCAUGCGUCUCUGAGCGCCCCGAGCGCGCCCCCGCCCCGGACCGUGCCCGGGCCCCGGCGCCCCCAGCCCGGCGCCGCCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 12 0.007626505 ubox
1 14 0.004066940 ubox
2 8 0.052687582 ubox
2 10 0.016740210 ubox
2 11 0.008686905 ubox
2 13 0.004188716 ubox
2 18 0.203944296 ubox
2 20 0.109243488 ubox
2 27 0.006966129 ubox
2 31 0.011887182 ubox
2 37 0.008857125 ubox
2 49 0.010717700 ubox
2 55 0.078585768 ubox
2 75 0.005765080 ubox
2 77 0.004433559 ubox
2 80 0.261782510 ubox
3 7 0.052418445 ubox
3 9 0.018421885 ubox
3 17 0.204160216 ubox
3 19 0.108492737 ubox
3 26 0.006966008 ubox
3 30 0.011807888 ubox
3 36 0.008867821 ubox
3 48 0.007732930 ubox
3 54 0.075354516 ubox
3 74 0.005760900 ubox
3 76 0.004425504 ubox
3 79 0.257551755 ubox
4 15 0.202321877 ubox
4 48 0.010975330 ubox
4 53 0.061376584 ubox
4 73 0.005711571 ubox
5 14 0.197883168 ubox
5 47 0.013312729 ubox
6 15 0.006301505 ubox
6 19 0.141105619 ubox
6 30 0.015587122 ubox
6 46 0.013330791 ubox
6 76 0.005234026 ubox
6 79 0.006882198 ubox
7 14 0.006188928 ubox
7 18 0.362510109 ubox
7 20 0.884450153 ubox
7 29 0.025604249 ubox
7 31 0.016489394 ubox
7 37 0.017706392 ubox
7 45 0.013310663 ubox
7 75 0.005961884 ubox
7 77 0.159949716 ubox
7 78 0.006890399 ubox
7 80 0.019461541 ubox
8 15 0.022603618 ubox
8 17 0.362759061 ubox
8 19 0.887370639 ubox
8 28 0.025619832 ubox
8 30 0.016535025 ubox
8 36 0.017766030 ubox
8 74 0.005920863 ubox
8 76 0.160217791 ubox
8 79 0.019091819 ubox
9 14 0.016760377 ubox
9 18 0.887792702 ubox
9 20 0.011154547 ubox
9 27 0.025612212 ubox
9 29 0.016355294 ubox
9 35 0.017675660 ubox
9 44 0.013337062 ubox
9 55 0.003295233 ubox
9 75 0.160218994 ubox
9 78 0.013127218 ubox
9 80 0.003911758 ubox
10 16 0.202467478 ubox
10 17 0.805663360 ubox
10 19 0.011070056 ubox
10 26 0.004404412 ubox
10 28 0.016170613 ubox
10 43 0.013306521 ubox
10 74 0.159917328 ubox
11 15 0.228259587 ubox
11 17 0.262638043 ubox
11 26 0.029826914 ubox
11 42 0.013185797 ubox
11 73 0.159432725 ubox
11 74 0.008075568 ubox
12 16 0.239064976 ubox
12 25 0.030055550 ubox
12 41 0.011837848 ubox
12 54 0.003943237 ubox
12 73 0.008025799 ubox
13 24 0.029925139 ubox
13 41 0.003813360 ubox
13 53 0.005808860 ubox
13 69 0.159955393 ubox
14 36 0.003671510 ubox
14 52 0.006046293 ubox
14 68 0.160106762 ubox
14 79 0.007109020 ubox
15 23 0.014226897 ubox
15 35 0.004423617 ubox
15 40 0.003877608 ubox
15 51 0.008204944 ubox
15 58 0.004356804 ubox
15 67 0.159959667 ubox
15 78 0.009879526 ubox
17 27 0.009292098 ubox
17 29 0.026581359 ubox
17 31 0.009718171 ubox
17 49 0.009543981 ubox
17 55 0.005869713 ubox
17 63 0.159721902 ubox
17 77 0.017280297 ubox
17 80 0.018908379 ubox
18 26 0.009301281 ubox
18 28 0.026661750 ubox
18 30 0.009736614 ubox
18 48 0.009554820 ubox
18 54 0.004357428 ubox
18 62 0.159793816 ubox
18 76 0.017292665 ubox
18 79 0.018797658 ubox
19 27 0.027076647 ubox
19 29 0.009749797 ubox
19 47 0.009552247 ubox
19 55 0.349274758 ubox
19 58 0.016246207 ubox
19 61 0.159790272 ubox
19 75 0.017255953 ubox
19 77 0.012091815 ubox
19 78 0.009035584 ubox
19 80 0.020307848 ubox
20 26 0.027038998 ubox
20 28 0.009739711 ubox
20 46 0.009550156 ubox
20 54 0.306341110 ubox
20 60 0.159764299 ubox
20 74 0.016385877 ubox
20 76 0.014879085 ubox
20 79 0.019812950 ubox
21 53 0.254714238 ubox
21 54 0.930863734 ubox
21 59 0.113331245 ubox
21 73 0.015153590 ubox
22 42 0.010598994 ubox
22 52 0.189095957 ubox
22 53 0.962141167 ubox
22 54 0.012714594 ubox
22 74 0.016064169 ubox
23 41 0.010612321 ubox
23 52 0.979591889 ubox
23 53 0.010139501 ubox
23 73 0.016946531 ubox
24 40 0.010543923 ubox
24 51 0.993484850 ubox
24 72 0.020071056 ubox
26 37 0.010123996 ubox
26 49 0.997755393 ubox
26 70 0.022312901 ubox
27 36 0.010139166 ubox
27 48 0.998490237 ubox
27 69 0.022324368 ubox
28 35 0.009837725 ubox
28 37 0.009194651 ubox
28 47 0.998121076 ubox
28 49 0.018893017 ubox
28 63 0.024938244 ubox
29 36 0.009214681 ubox
29 46 0.998475701 ubox
29 48 0.018913240 ubox
29 62 0.024991837 ubox
30 35 0.008916510 ubox
30 37 0.013016175 ubox
30 45 0.993800137 ubox
30 47 0.019010068 ubox
30 55 0.005831016 ubox
30 61 0.025652281 ubox
31 36 0.013165338 ubox
31 42 0.153216229 ubox
31 46 0.019004626 ubox
31 54 0.005844310 ubox
31 60 0.025640087 ubox
32 41 0.153837322 ubox
32 42 0.151523411 ubox
32 53 0.005837941 ubox
32 59 0.025589473 ubox
33 41 0.151137528 ubox
33 42 0.774088422 ubox
33 52 0.005826632 ubox
34 41 0.765793879 ubox
34 42 0.590761746 ubox
35 41 0.601460807 ubox
35 48 0.004673485 ubox
36 40 0.571606905 ubox
36 47 0.004689857 ubox
36 49 0.003173631 ubox
36 55 0.040133454 ubox
37 46 0.004690038 ubox
37 48 0.003172001 ubox
37 54 0.038524467 ubox
38 53 0.036772483 ubox
38 54 0.026968734 ubox
39 52 0.034910574 ubox
39 53 0.029552721 ubox
40 52 0.031765046 ubox
41 50 0.033029890 ubox
41 51 0.033729098 ubox
42 49 0.033025434 ubox
42 50 0.033623002 ubox
52 72 0.003299792 ubox
52 82 0.043773297 ubox
53 71 0.003304253 ubox
53 78 0.016885889 ubox
53 81 0.051400053 ubox
53 82 0.010266671 ubox
54 70 0.003308238 ubox
54 77 0.019769636 ubox
54 80 0.057822534 ubox
54 81 0.024604783 ubox
55 69 0.003304820 ubox
55 76 0.020477179 ubox
55 79 0.054340878 ubox
56 74 0.006691525 ubox
57 73 0.006714650 ubox
57 74 0.021083861 ubox
58 73 0.021380399 ubox
58 79 0.928203585 ubox
59 71 0.010433347 ubox
59 72 0.021372961 ubox
59 78 0.986307034 ubox
59 81 0.011156580 ubox
60 70 0.010935114 ubox
60 71 0.021126579 ubox
60 77 0.986446019 ubox
60 80 0.011142637 ubox
61 69 0.011399118 ubox
61 76 0.986433420 ubox
61 79 0.011109565 ubox
62 70 0.020964286 ubox
62 75 0.986435384 ubox
62 77 0.007422379 ubox
62 78 0.008106419 ubox
63 69 0.020937081 ubox
63 74 0.985945070 ubox
63 76 0.010425915 ubox
64 73 0.985052209 ubox
64 74 0.030714362 ubox
65 73 0.042915901 ubox
65 74 0.011363616 ubox
66 73 0.013843162 ubox
66 74 0.006522382 ubox
67 73 0.008851172 ubox
7 20 0.9500000 lbox
8 19 0.9500000 lbox
9 18 0.9500000 lbox
10 17 0.9500000 lbox
21 54 0.9500000 lbox
22 53 0.9500000 lbox
23 52 0.9500000 lbox
24 51 0.9500000 lbox
26 49 0.9500000 lbox
27 48 0.9500000 lbox
28 47 0.9500000 lbox
29 46 0.9500000 lbox
30 45 0.9500000 lbox
33 42 0.9500000 lbox
34 41 0.9500000 lbox
58 79 0.9500000 lbox
59 78 0.9500000 lbox
60 77 0.9500000 lbox
61 76 0.9500000 lbox
62 75 0.9500000 lbox
63 74 0.9500000 lbox
64 73 0.9500000 lbox
showpage
end
%%EOF
