%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:43:16 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (CHERP)
} def

/sequence { (\
UUCCGGCCGGCUUCCGCAGACGGCGCUGGUGGUCGAUCGUGUGGCGCCGGAGGACGUUCCCCGCGGCCGGAGCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 71 0.026016835 ubox
1 72 0.717870880 ubox
2 54 0.027549639 ubox
2 70 0.003758514 ubox
2 71 0.975933147 ubox
3 53 0.029790886 ubox
3 70 0.999404044 ubox
4 52 0.029795222 ubox
4 69 0.999500120 ubox
5 68 0.999504563 ubox
5 74 0.003552405 ubox
6 30 0.004001178 ubox
6 67 0.999514074 ubox
6 73 0.003569871 ubox
7 29 0.004602471 ubox
7 50 0.035064286 ubox
7 66 0.999340227 ubox
7 70 0.004255713 ubox
8 16 0.003500963 ubox
8 28 0.004777682 ubox
8 35 0.006373585 ubox
8 49 0.042114885 ubox
8 63 0.012537399 ubox
8 65 0.998374691 ubox
8 69 0.004985019 ubox
9 15 0.013848378 ubox
9 21 0.003297598 ubox
9 27 0.008753497 ubox
9 34 0.008460450 ubox
9 45 0.007730764 ubox
9 48 0.627135443 ubox
9 58 0.045260411 ubox
9 59 0.014144489 ubox
9 60 0.026665799 ubox
9 61 0.024658671 ubox
9 62 0.026907361 ubox
9 64 0.761741951 ubox
9 68 0.005017600 ubox
10 14 0.014245561 ubox
10 17 0.190306090 ubox
10 24 0.007286295 ubox
10 26 0.017065103 ubox
10 30 0.007264304 ubox
10 33 0.008709019 ubox
10 42 0.003832189 ubox
10 45 0.141875384 ubox
10 47 0.914270980 ubox
10 57 0.216800655 ubox
10 58 0.017329026 ubox
10 59 0.028813977 ubox
10 60 0.026486141 ubox
10 61 0.028280212 ubox
10 64 0.062646225 ubox
10 67 0.005017300 ubox
11 16 0.190220586 ubox
11 19 0.020434462 ubox
11 23 0.007206715 ubox
11 25 0.017110132 ubox
11 29 0.007641874 ubox
11 32 0.008727767 ubox
11 41 0.003976108 ubox
11 44 0.137800771 ubox
11 46 0.914302794 ubox
11 53 0.024112609 ubox
11 56 0.220906249 ubox
11 63 0.087780791 ubox
11 66 0.004878228 ubox
12 18 0.019751881 ubox
12 19 0.005839128 ubox
12 20 0.006752795 ubox
12 22 0.006903849 ubox
12 28 0.007538893 ubox
12 31 0.008467827 ubox
12 43 0.130246742 ubox
12 44 0.017557096 ubox
12 52 0.024475007 ubox
12 54 0.008648127 ubox
13 18 0.005496392 ubox
13 19 0.006957521 ubox
13 20 0.032894097 ubox
13 43 0.019387878 ubox
13 44 0.106990908 ubox
13 51 0.026935955 ubox
13 53 0.003913352 ubox
13 54 0.228870068 ubox
14 19 0.035366430 ubox
14 23 0.019896473 ubox
14 29 0.008567991 ubox
14 43 0.107493273 ubox
14 44 0.928712927 ubox
14 50 0.027197490 ubox
14 52 0.003819143 ubox
14 53 0.232129691 ubox
15 22 0.022283121 ubox
15 25 0.014940782 ubox
15 28 0.008492475 ubox
15 39 0.056006541 ubox
15 41 0.154471727 ubox
15 43 0.931691838 ubox
15 46 0.023795875 ubox
15 49 0.026012341 ubox
15 52 0.232071637 ubox
15 56 0.027411699 ubox
15 63 0.009504099 ubox
16 21 0.024764171 ubox
16 24 0.015694517 ubox
16 26 0.008101788 ubox
16 38 0.056419100 ubox
16 40 0.154783682 ubox
16 42 0.932277374 ubox
16 45 0.025349954 ubox
16 47 0.003672735 ubox
16 48 0.019582849 ubox
16 55 0.027413549 ubox
16 57 0.015306045 ubox
16 62 0.009387082 ubox
16 64 0.006198834 ubox
17 23 0.015687369 ubox
17 25 0.008274405 ubox
17 39 0.154051362 ubox
17 41 0.932540842 ubox
17 43 0.022291854 ubox
17 44 0.018753828 ubox
17 46 0.004536867 ubox
17 56 0.015570773 ubox
17 63 0.006359113 ubox
18 40 0.899008263 ubox
18 42 0.028310450 ubox
19 34 0.349326877 ubox
19 38 0.861809628 ubox
19 58 0.010876566 ubox
19 59 0.006335161 ubox
20 33 0.349902132 ubox
20 37 0.860650901 ubox
20 40 0.043475573 ubox
20 57 0.012158253 ubox
20 58 0.004850663 ubox
21 32 0.350521411 ubox
21 35 0.878186690 ubox
21 39 0.054035018 ubox
21 46 0.036426678 ubox
21 49 0.264491299 ubox
21 56 0.012874759 ubox
21 63 0.003504405 ubox
22 34 0.879182560 ubox
22 38 0.054273584 ubox
22 45 0.037219996 ubox
22 48 0.312184914 ubox
22 55 0.012849243 ubox
23 30 0.350400924 ubox
23 33 0.878485549 ubox
23 37 0.053672601 ubox
23 42 0.003906785 ubox
23 47 0.313500864 ubox
24 29 0.350996770 ubox
24 31 0.043853396 ubox
24 32 0.877646022 ubox
24 35 0.054730209 ubox
24 41 0.004437917 ubox
24 43 0.037327152 ubox
24 46 0.313531698 ubox
25 30 0.039074018 ubox
25 33 0.023619161 ubox
25 34 0.053658288 ubox
25 40 0.004502577 ubox
25 42 0.037403615 ubox
25 45 0.313526874 ubox
26 32 0.054773202 ubox
26 39 0.004552350 ubox
26 41 0.037515586 ubox
26 44 0.313498832 ubox
26 50 0.018962656 ubox
27 31 0.050237329 ubox
27 35 0.005574105 ubox
27 39 0.087005570 ubox
27 41 0.004279203 ubox
27 43 0.299818256 ubox
27 49 0.019115166 ubox
28 34 0.009231827 ubox
28 38 0.167056713 ubox
28 40 0.009875571 ubox
28 42 0.226138755 ubox
28 48 0.027069657 ubox
29 33 0.006063635 ubox
29 37 0.168507455 ubox
29 40 0.099938154 ubox
29 42 0.008874405 ubox
29 47 0.027237253 ubox
30 36 0.168119983 ubox
30 39 0.228404287 ubox
30 41 0.014600500 ubox
30 46 0.026418399 ubox
31 38 0.241768605 ubox
31 40 0.035611912 ubox
31 42 0.005070659 ubox
31 45 0.019791371 ubox
31 48 0.004004962 ubox
32 37 0.164177729 ubox
32 40 0.006966632 ubox
32 42 0.005950782 ubox
32 45 0.020421629 ubox
32 47 0.004051472 ubox
33 39 0.006287161 ubox
33 44 0.026899962 ubox
34 41 0.016745045 ubox
34 43 0.027752236 ubox
34 46 0.003962795 ubox
35 40 0.012077526 ubox
35 42 0.021802783 ubox
35 45 0.005313945 ubox
36 42 0.004872511 ubox
37 41 0.004607840 ubox
37 44 0.006011323 ubox
38 43 0.007034608 ubox
38 46 0.014752628 ubox
38 65 0.004113624 ubox
39 45 0.015670804 ubox
39 47 0.016192212 ubox
39 64 0.005188864 ubox
40 44 0.014662254 ubox
40 46 0.016195913 ubox
40 63 0.005234640 ubox
41 45 0.015464348 ubox
41 47 0.003385373 ubox
41 62 0.005278072 ubox
41 64 0.005636717 ubox
42 46 0.003176494 ubox
42 63 0.005785668 ubox
43 60 0.003616050 ubox
43 61 0.003245389 ubox
43 62 0.006024040 ubox
43 68 0.004140118 ubox
44 57 0.004353218 ubox
44 59 0.003551739 ubox
44 60 0.003186618 ubox
44 61 0.006009189 ubox
44 64 0.011339159 ubox
44 67 0.004169017 ubox
45 56 0.007177570 ubox
45 63 0.020163034 ubox
45 65 0.017360013 ubox
45 66 0.004062349 ubox
46 55 0.007274889 ubox
46 57 0.003199712 ubox
46 62 0.020415592 ubox
46 64 0.069802731 ubox
46 67 0.003494328 ubox
47 53 0.007298688 ubox
47 63 0.052598507 ubox
47 66 0.003555645 ubox
48 52 0.007254485 ubox
48 56 0.007824460 ubox
48 63 0.680150981 ubox
48 65 0.003659203 ubox
49 55 0.009839501 ubox
49 59 0.011709158 ubox
49 60 0.229622694 ubox
49 61 0.039774913 ubox
49 62 0.930064405 ubox
49 64 0.055080333 ubox
50 58 0.012155851 ubox
50 59 0.231945993 ubox
50 60 0.038419698 ubox
50 61 0.931955632 ubox
51 57 0.013396664 ubox
51 58 0.230422225 ubox
52 57 0.210706514 ubox
52 58 0.006300107 ubox
52 59 0.083820213 ubox
52 60 0.933224018 ubox
52 61 0.079399452 ubox
52 62 0.050893835 ubox
53 57 0.005673135 ubox
53 58 0.066174390 ubox
53 59 0.933060306 ubox
53 60 0.079486030 ubox
53 61 0.050746009 ubox
54 58 0.811793387 ubox
55 63 0.036793660 ubox
55 65 0.016586570 ubox
56 62 0.037421641 ubox
56 64 0.018224025 ubox
56 73 0.029671055 ubox
57 63 0.017799402 ubox
57 72 0.029707300 ubox
58 71 0.029719969 ubox
59 70 0.029688784 ubox
60 69 0.029627076 ubox
62 69 0.003164443 ubox
63 68 0.003664594 ubox
1 72 0.9500000 lbox
2 71 0.9500000 lbox
3 70 0.9500000 lbox
4 69 0.9500000 lbox
5 68 0.9500000 lbox
6 67 0.9500000 lbox
7 66 0.9500000 lbox
8 65 0.9500000 lbox
9 64 0.9500000 lbox
10 47 0.9500000 lbox
11 46 0.9500000 lbox
14 44 0.9500000 lbox
15 43 0.9500000 lbox
16 42 0.9500000 lbox
17 41 0.9500000 lbox
18 40 0.9500000 lbox
19 38 0.9500000 lbox
20 37 0.9500000 lbox
21 35 0.9500000 lbox
22 34 0.9500000 lbox
23 33 0.9500000 lbox
24 32 0.9500000 lbox
48 63 0.9500000 lbox
49 62 0.9500000 lbox
50 61 0.9500000 lbox
52 60 0.9500000 lbox
53 59 0.9500000 lbox
54 58 0.9500000 lbox
showpage
end
%%EOF
