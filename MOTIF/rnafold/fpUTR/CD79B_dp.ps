%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:12:47 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (CD79B)
} def

/sequence { (\
AGGGGACAGGCUGCAGCCGGUGCAGUUACACGUUUUCCUCCAAGGAGCCUCGGACGUUGUCACGGGUUUGGGGUCGGGGACAGAGCGGUGACC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 12 0.046762085 ubox
1 27 0.003531230 ubox
1 39 0.014118014 ubox
2 11 0.062894019 ubox
2 12 0.026569438 ubox
2 18 0.023117404 ubox
2 26 0.004391151 ubox
2 27 0.003650888 ubox
2 37 0.023141814 ubox
2 38 0.018268447 ubox
2 39 0.006088467 ubox
2 40 0.009557665 ubox
2 41 0.008071723 ubox
2 51 0.003421023 ubox
2 93 0.357651892 ubox
3 11 0.038625139 ubox
3 12 0.055057648 ubox
3 17 0.023110607 ubox
3 18 0.022094631 ubox
3 26 0.003340152 ubox
3 27 0.003697233 ubox
3 36 0.023467410 ubox
3 37 0.018316507 ubox
3 38 0.006846170 ubox
3 39 0.010278255 ubox
3 40 0.008052878 ubox
3 50 0.003439012 ubox
3 92 0.360169941 ubox
3 93 0.166965761 ubox
4 11 0.071623231 ubox
4 12 0.021196596 ubox
4 17 0.022102727 ubox
4 18 0.012497727 ubox
4 27 0.005286669 ubox
4 35 0.025089177 ubox
4 36 0.016155487 ubox
4 37 0.006847181 ubox
4 38 0.012784417 ubox
4 39 0.003298025 ubox
4 49 0.003447772 ubox
4 92 0.168368651 ubox
4 93 0.121718082 ubox
5 11 0.027369101 ubox
5 17 0.012474948 ubox
5 27 0.010373751 ubox
5 34 0.026962993 ubox
5 35 0.013892451 ubox
5 36 0.005733185 ubox
5 37 0.012795186 ubox
5 48 0.003433567 ubox
5 92 0.122315344 ubox
6 21 0.563377914 ubox
6 26 0.008350768 ubox
6 33 0.028583559 ubox
6 34 0.011137648 ubox
6 35 0.004876038 ubox
6 36 0.012342313 ubox
6 89 0.320812684 ubox
7 13 0.020298060 ubox
7 20 0.573455849 ubox
7 22 0.079803925 ubox
7 25 0.007357429 ubox
7 32 0.029824885 ubox
7 88 0.321309446 ubox
7 90 0.092478957 ubox
8 12 0.016557293 ubox
8 21 0.073998979 ubox
8 27 0.030477315 ubox
8 34 0.007996500 ubox
8 35 0.003452853 ubox
8 89 0.073245328 ubox
9 18 0.632120861 ubox
9 26 0.029382639 ubox
9 27 0.509730312 ubox
9 33 0.006162526 ubox
9 75 0.007847364 ubox
9 93 0.042403774 ubox
10 17 0.634240036 ubox
10 21 0.047244222 ubox
10 23 0.032043444 ubox
10 26 0.671895825 ubox
10 74 0.007898510 ubox
10 86 0.007586477 ubox
10 89 0.006182006 ubox
10 92 0.041658383 ubox
11 16 0.632181937 ubox
11 20 0.048949843 ubox
11 22 0.031893926 ubox
11 25 0.712238254 ubox
11 73 0.007905448 ubox
11 83 0.004560848 ubox
11 85 0.007448149 ubox
11 88 0.006347209 ubox
12 19 0.048882521 ubox
12 22 0.004301456 ubox
12 24 0.757927837 ubox
12 72 0.007880227 ubox
12 82 0.004657444 ubox
12 84 0.006882671 ubox
12 87 0.006307548 ubox
13 18 0.047253863 ubox
13 21 0.024664320 ubox
13 23 0.769473001 ubox
13 81 0.004748903 ubox
13 86 0.006310471 ubox
14 20 0.025544688 ubox
14 22 0.769480631 ubox
14 70 0.007894168 ubox
14 85 0.006303656 ubox
15 21 0.754921067 ubox
15 68 0.004560325 ubox
15 69 0.006410907 ubox
16 23 0.020392234 ubox
16 67 0.006491643 ubox
16 68 0.004512866 ubox
17 22 0.020329507 ubox
17 66 0.007932728 ubox
17 77 0.006560486 ubox
18 65 0.007928451 ubox
18 76 0.006573935 ubox
19 75 0.006521257 ubox
19 93 0.018693961 ubox
20 29 0.006584330 ubox
20 31 0.011101559 ubox
20 63 0.007922952 ubox
20 92 0.017995027 ubox
21 28 0.006528478 ubox
21 30 0.011284845 ubox
21 62 0.007928512 ubox
21 91 0.015355564 ubox
22 27 0.005694782 ubox
22 29 0.011335093 ubox
22 61 0.007824602 ubox
22 89 0.005389094 ubox
23 59 0.006556566 ubox
23 88 0.005540657 ubox
23 90 0.005873083 ubox
24 58 0.006510591 ubox
24 89 0.004369701 ubox
25 57 0.003164967 ubox
25 86 0.006061134 ubox
25 92 0.697825253 ubox
26 85 0.006065388 ubox
26 91 0.728400623 ubox
27 84 0.005916128 ubox
27 90 0.813075265 ubox
28 60 0.004318062 ubox
28 89 0.862936719 ubox
29 59 0.004369533 ubox
29 88 0.867547141 ubox
29 90 0.300069661 ubox
30 57 0.007821710 ubox
30 89 0.296094823 ubox
31 56 0.008897894 ubox
31 87 0.971127577 ubox
31 88 0.212063469 ubox
32 55 0.008910560 ubox
32 81 0.039935808 ubox
32 86 0.997082089 ubox
32 92 0.003605122 ubox
33 54 0.008889533 ubox
33 80 0.039930553 ubox
33 83 0.013454715 ubox
33 84 0.062259947 ubox
33 85 0.994261489 ubox
33 91 0.003592581 ubox
34 53 0.008809048 ubox
34 79 0.040056162 ubox
34 80 0.039615591 ubox
34 82 0.035214642 ubox
34 83 0.073097015 ubox
34 84 0.986455142 ubox
34 85 0.044295970 ubox
34 90 0.003508584 ubox
35 47 0.007028798 ubox
35 52 0.006880817 ubox
35 78 0.040123007 ubox
35 79 0.045780789 ubox
35 80 0.095843353 ubox
35 82 0.086465713 ubox
35 83 0.944473967 ubox
35 84 0.054837504 ubox
35 85 0.016820947 ubox
36 46 0.019670634 ubox
36 77 0.041450327 ubox
36 78 0.062612261 ubox
36 79 0.133008917 ubox
36 80 0.714063625 ubox
36 82 0.589691294 ubox
36 83 0.060534395 ubox
36 84 0.039597957 ubox
37 45 0.021722813 ubox
37 72 0.003984633 ubox
37 73 0.019953066 ubox
37 76 0.041583840 ubox
37 77 0.070452412 ubox
37 78 0.150676314 ubox
37 79 0.771293520 ubox
37 83 0.042432404 ubox
38 44 0.021745490 ubox
38 47 0.008959396 ubox
38 71 0.003974140 ubox
38 72 0.020223754 ubox
38 73 0.047690913 ubox
38 76 0.069345087 ubox
38 77 0.150699361 ubox
38 78 0.770183229 ubox
38 79 0.355479397 ubox
38 83 0.009015202 ubox
39 43 0.019594731 ubox
39 46 0.019299870 ubox
39 70 0.003800522 ubox
39 71 0.010162628 ubox
39 72 0.066659392 ubox
39 73 0.048967801 ubox
39 76 0.138435162 ubox
39 77 0.635652082 ubox
39 78 0.357054558 ubox
39 79 0.145423852 ubox
39 80 0.460289759 ubox
39 82 0.006006183 ubox
40 44 0.004067783 ubox
40 45 0.024414134 ubox
40 70 0.010121220 ubox
40 71 0.096466055 ubox
40 72 0.086691644 ubox
40 73 0.223027163 ubox
40 76 0.603191153 ubox
40 77 0.558518972 ubox
40 78 0.160929581 ubox
40 79 0.469722058 ubox
41 70 0.098418513 ubox
41 71 0.088705198 ubox
41 72 0.230786258 ubox
41 76 0.559056151 ubox
41 77 0.161354537 ubox
41 78 0.469409860 ubox
42 69 0.089705786 ubox
43 68 0.072582424 ubox
43 69 0.012934778 ubox
44 67 0.032579970 ubox
44 68 0.010788964 ubox
44 69 0.097352409 ubox
44 75 0.424522446 ubox
45 67 0.005012781 ubox
45 68 0.070229223 ubox
45 69 0.352445870 ubox
45 74 0.167135818 ubox
45 75 0.693098895 ubox
46 67 0.061692537 ubox
46 68 0.368018468 ubox
46 69 0.017940965 ubox
46 74 0.606729413 ubox
47 67 0.377342734 ubox
47 68 0.016010889 ubox
47 74 0.659742327 ubox
48 65 0.031772491 ubox
48 66 0.380335462 ubox
48 71 0.006579374 ubox
48 72 0.240822793 ubox
48 73 0.890217972 ubox
48 79 0.003445180 ubox
49 64 0.031240217 ubox
49 65 0.379156777 ubox
49 66 0.051339123 ubox
49 70 0.006389468 ubox
49 71 0.239656793 ubox
49 72 0.890855860 ubox
49 78 0.003456418 ubox
50 64 0.170145009 ubox
50 65 0.063615683 ubox
50 70 0.063492487 ubox
50 71 0.890503524 ubox
50 77 0.003375127 ubox
51 64 0.344266687 ubox
51 65 0.003623077 ubox
51 70 0.919945233 ubox
51 71 0.004238941 ubox
51 76 0.003353882 ubox
52 61 0.009129369 ubox
52 63 0.347913989 ubox
52 68 0.025798065 ubox
52 69 0.917085490 ubox
53 60 0.007205892 ubox
53 61 0.385244140 ubox
53 67 0.024286216 ubox
53 68 0.918082729 ubox
53 69 0.006118442 ubox
54 60 0.385111213 ubox
54 67 0.917124778 ubox
54 68 0.006996023 ubox
54 74 0.003536455 ubox
55 59 0.381325930 ubox
55 64 0.160974598 ubox
55 66 0.906427958 ubox
55 73 0.003766943 ubox
56 63 0.236104726 ubox
57 62 0.216927712 ubox
57 65 0.347149608 ubox
57 66 0.008886859 ubox
57 71 0.003412512 ubox
58 64 0.393333562 ubox
58 65 0.047563760 ubox
58 70 0.003171038 ubox
59 63 0.380071696 ubox
59 92 0.006186023 ubox
60 91 0.006244554 ubox
61 65 0.011153524 ubox
61 90 0.006276370 ubox
62 89 0.006273740 ubox
63 88 0.006249890 ubox
66 86 0.004928099 ubox
67 84 0.003887798 ubox
67 85 0.004868381 ubox
68 83 0.003954459 ubox
68 84 0.004786578 ubox
69 82 0.004047907 ubox
69 83 0.004523572 ubox
70 75 0.010356274 ubox
70 81 0.004064793 ubox
72 93 0.015955449 ubox
73 81 0.010944271 ubox
73 92 0.016375049 ubox
74 80 0.011498914 ubox
74 84 0.003229464 ubox
74 88 0.003354378 ubox
74 91 0.016403140 ubox
75 79 0.011604879 ubox
75 83 0.004325086 ubox
75 87 0.006484537 ubox
75 90 0.016392946 ubox
76 86 0.006622674 ubox
76 89 0.014905986 ubox
76 93 0.022071265 ubox
77 92 0.022228582 ubox
77 93 0.006391717 ubox
78 92 0.006472811 ubox
78 93 0.006627391 ubox
79 92 0.006735863 ubox
80 89 0.023186363 ubox
81 88 0.023374997 ubox
81 90 0.011365686 ubox
82 89 0.011153758 ubox
87 93 0.008289288 ubox
88 92 0.009791103 ubox
6 21 0.9500000 lbox
7 20 0.9500000 lbox
9 18 0.9500000 lbox
10 17 0.9500000 lbox
11 16 0.9500000 lbox
25 92 0.9500000 lbox
26 91 0.9500000 lbox
27 90 0.9500000 lbox
28 89 0.9500000 lbox
29 88 0.9500000 lbox
31 87 0.9500000 lbox
32 86 0.9500000 lbox
33 85 0.9500000 lbox
34 84 0.9500000 lbox
35 83 0.9500000 lbox
36 80 0.9500000 lbox
37 79 0.9500000 lbox
38 78 0.9500000 lbox
39 77 0.9500000 lbox
40 76 0.9500000 lbox
45 75 0.9500000 lbox
46 74 0.9500000 lbox
48 73 0.9500000 lbox
49 72 0.9500000 lbox
50 71 0.9500000 lbox
51 70 0.9500000 lbox
52 69 0.9500000 lbox
53 68 0.9500000 lbox
54 67 0.9500000 lbox
55 66 0.9500000 lbox
showpage
end
%%EOF
