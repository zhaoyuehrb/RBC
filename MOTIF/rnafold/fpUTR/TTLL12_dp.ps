%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 04:15:19 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (TTLL12)
} def

/sequence { (\
GCCGACGGACGGCGGGCGGCGGCGGCGGUGGCGGCGCUGGAGUCGGCGCGGGUGCUGGCGCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 13 0.869824841 ubox
1 17 0.057556494 ubox
1 20 0.473556040 ubox
1 23 0.036383110 ubox
1 26 0.004108820 ubox
1 32 0.005156807 ubox
1 47 0.101220969 ubox
1 59 0.047198007 ubox
2 8 0.003215049 ubox
2 12 0.870481815 ubox
2 15 0.018039934 ubox
2 16 0.056604201 ubox
2 19 0.473914419 ubox
2 22 0.036410427 ubox
2 25 0.004112504 ubox
2 31 0.005160797 ubox
2 46 0.101378921 ubox
2 58 0.047233840 ubox
3 7 0.003215102 ubox
3 11 0.870462882 ubox
3 14 0.021406343 ubox
3 15 0.055415569 ubox
3 18 0.473900977 ubox
3 21 0.036408818 ubox
3 24 0.004113197 ubox
3 30 0.005159359 ubox
3 45 0.101534074 ubox
3 57 0.047228296 ubox
4 10 0.860242614 ubox
4 13 0.023857255 ubox
4 17 0.470959827 ubox
4 20 0.035150862 ubox
4 23 0.003976958 ubox
4 29 0.003470887 ubox
4 44 0.101749395 ubox
4 56 0.045619518 ubox
5 43 0.101737637 ubox
5 53 0.003238590 ubox
6 14 0.474169052 ubox
6 18 0.035660159 ubox
6 21 0.003996962 ubox
6 27 0.004787265 ubox
6 42 0.101701156 ubox
6 52 0.003354705 ubox
6 54 0.045978150 ubox
7 13 0.473727942 ubox
7 17 0.036047002 ubox
7 20 0.004049792 ubox
7 26 0.004768015 ubox
7 53 0.045224940 ubox
8 44 0.003869232 ubox
9 43 0.003890427 ubox
10 18 0.005026109 ubox
10 24 0.005138404 ubox
10 39 0.101431111 ubox
10 42 0.003905062 ubox
10 50 0.046948098 ubox
11 17 0.005117099 ubox
11 23 0.005161157 ubox
11 38 0.101517933 ubox
11 49 0.046821079 ubox
12 37 0.101598788 ubox
12 47 0.047120826 ubox
13 21 0.005182504 ubox
13 36 0.101343078 ubox
13 39 0.005939932 ubox
13 46 0.047140747 ubox
14 20 0.014320994 ubox
14 35 0.067010365 ubox
14 38 0.006646995 ubox
14 44 0.008402274 ubox
14 62 0.068033162 ubox
15 37 0.006645742 ubox
15 38 0.010067006 ubox
15 43 0.006578260 ubox
15 44 0.127658155 ubox
15 61 0.048559799 ubox
15 62 0.832481191 ubox
16 23 0.023240803 ubox
16 32 0.036114082 ubox
16 35 0.076249166 ubox
16 37 0.010625514 ubox
16 43 0.128243019 ubox
16 49 0.010577591 ubox
16 61 0.843530308 ubox
17 22 0.023254599 ubox
17 30 0.007861318 ubox
17 31 0.035799581 ubox
17 33 0.021573288 ubox
17 34 0.083591114 ubox
17 36 0.010679329 ubox
17 39 0.007513749 ubox
17 42 0.128376530 ubox
17 48 0.010587986 ubox
17 60 0.844947883 ubox
18 29 0.009198147 ubox
18 32 0.016636529 ubox
18 35 0.010675334 ubox
18 38 0.008492807 ubox
18 44 0.003294658 ubox
18 47 0.010589046 ubox
18 59 0.844753869 ubox
18 62 0.163088776 ubox
19 29 0.035152486 ubox
19 32 0.093488587 ubox
19 37 0.008553554 ubox
19 43 0.003299803 ubox
19 59 0.006743151 ubox
19 61 0.164286642 ubox
20 27 0.015493174 ubox
20 28 0.033176962 ubox
20 30 0.009134407 ubox
20 31 0.094532975 ubox
20 33 0.010604999 ubox
20 36 0.008547599 ubox
20 39 0.128359154 ubox
20 42 0.003205167 ubox
20 45 0.010600952 ubox
20 57 0.844453836 ubox
20 58 0.007260133 ubox
20 60 0.164291483 ubox
21 26 0.019387479 ubox
21 29 0.006997076 ubox
21 32 0.010582801 ubox
21 35 0.007497637 ubox
21 38 0.128750845 ubox
21 44 0.011219100 ubox
21 56 0.844295325 ubox
21 59 0.164263290 ubox
21 62 0.474393489 ubox
22 29 0.094541177 ubox
22 35 0.004310332 ubox
22 37 0.128885556 ubox
22 43 0.011221727 ubox
22 55 0.844938042 ubox
22 61 0.477870553 ubox
23 28 0.094849094 ubox
23 30 0.010534840 ubox
23 33 0.006337066 ubox
23 34 0.005963960 ubox
23 36 0.128884444 ubox
23 42 0.011220420 ubox
23 54 0.844669265 ubox
23 57 0.164216123 ubox
23 60 0.477880157 ubox
24 29 0.009366117 ubox
24 32 0.005840752 ubox
24 35 0.128844225 ubox
24 53 0.804429689 ubox
24 56 0.164194066 ubox
24 59 0.477774548 ubox
24 62 0.057166006 ubox
25 32 0.082692760 ubox
25 49 0.031626499 ubox
25 53 0.194619322 ubox
25 55 0.164320408 ubox
25 59 0.004046473 ubox
25 61 0.057593381 ubox
26 31 0.082875755 ubox
26 33 0.131413900 ubox
26 39 0.011203344 ubox
26 48 0.031646844 ubox
26 50 0.143103032 ubox
26 52 0.275783367 ubox
26 54 0.164258709 ubox
26 57 0.477603541 ubox
26 58 0.004528364 ubox
26 60 0.057594845 ubox
27 32 0.131051570 ubox
27 38 0.011224577 ubox
27 47 0.031416059 ubox
27 49 0.105019620 ubox
27 53 0.156453947 ubox
27 56 0.477479740 ubox
27 59 0.057588467 ubox
27 62 0.004289994 ubox
28 37 0.011235302 ubox
28 47 0.005480574 ubox
28 49 0.837214057 ubox
28 53 0.005147877 ubox
28 55 0.477800154 ubox
28 61 0.004321618 ubox
29 36 0.011229082 ubox
29 45 0.031167803 ubox
29 46 0.005374566 ubox
29 48 0.842901333 ubox
29 50 0.008053467 ubox
29 52 0.008582637 ubox
29 54 0.468935739 ubox
29 57 0.055545570 ubox
29 60 0.004319903 ubox
30 35 0.011198877 ubox
30 44 0.031289627 ubox
30 47 0.843661586 ubox
30 49 0.005543764 ubox
30 53 0.418866504 ubox
30 56 0.057578959 ubox
30 59 0.004316001 ubox
31 43 0.031265242 ubox
31 47 0.009552911 ubox
31 49 0.051995136 ubox
31 53 0.132354043 ubox
31 55 0.057882959 ubox
32 42 0.031264736 ubox
32 45 0.844030192 ubox
32 46 0.008133414 ubox
32 48 0.051996761 ubox
32 50 0.122401581 ubox
32 52 0.170145436 ubox
32 54 0.057849066 ubox
32 57 0.004308664 ubox
33 44 0.844136114 ubox
33 47 0.051650579 ubox
33 49 0.086959222 ubox
33 53 0.055485831 ubox
33 56 0.004306833 ubox
33 62 0.004981029 ubox
34 43 0.843917901 ubox
34 49 0.498469559 ubox
34 55 0.004285578 ubox
34 61 0.005017782 ubox
35 42 0.844025814 ubox
35 45 0.051512901 ubox
35 48 0.506107991 ubox
35 54 0.004278607 ubox
35 60 0.005017909 ubox
36 43 0.010471463 ubox
36 44 0.050296103 ubox
36 47 0.506192896 ubox
36 53 0.004217976 ubox
36 59 0.005016644 ubox
37 42 0.043240588 ubox
37 46 0.506202846 ubox
37 52 0.004041599 ubox
37 58 0.005015955 ubox
38 45 0.505390377 ubox
38 51 0.003722682 ubox
38 57 0.004960588 ubox
39 44 0.500703674 ubox
39 56 0.004910510 ubox
39 62 0.012263825 ubox
40 55 0.004920802 ubox
40 61 0.012613434 ubox
42 59 0.014331763 ubox
43 52 0.004536853 ubox
43 58 0.014431116 ubox
44 51 0.004681980 ubox
44 57 0.014525438 ubox
45 56 0.014533179 ubox
45 62 0.119282759 ubox
46 55 0.014545455 ubox
46 61 0.120304853 ubox
47 54 0.014537322 ubox
47 60 0.120376222 ubox
48 53 0.009417470 ubox
48 55 0.008341294 ubox
48 59 0.122109041 ubox
48 61 0.087124230 ubox
49 54 0.008342674 ubox
49 57 0.015401408 ubox
49 58 0.121181914 ubox
49 60 0.087296523 ubox
50 56 0.021361273 ubox
50 59 0.087165939 ubox
50 62 0.012817799 ubox
51 55 0.022271206 ubox
51 61 0.012638058 ubox
51 62 0.044468897 ubox
52 59 0.013030361 ubox
52 61 0.045057933 ubox
53 58 0.013092158 ubox
53 60 0.045070656 ubox
54 59 0.044247989 ubox
54 61 0.004848093 ubox
55 60 0.004867068 ubox
1 13 0.9500000 lbox
2 12 0.9500000 lbox
3 11 0.9500000 lbox
4 10 0.9500000 lbox
15 62 0.9500000 lbox
16 61 0.9500000 lbox
17 60 0.9500000 lbox
18 59 0.9500000 lbox
20 57 0.9500000 lbox
21 56 0.9500000 lbox
22 55 0.9500000 lbox
23 54 0.9500000 lbox
24 53 0.9500000 lbox
28 49 0.9500000 lbox
29 48 0.9500000 lbox
30 47 0.9500000 lbox
32 45 0.9500000 lbox
33 44 0.9500000 lbox
34 43 0.9500000 lbox
35 42 0.9500000 lbox
showpage
end
%%EOF
