%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:57:04 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (HLA-B)
} def

/sequence { (\
UCUAGAGAAGCCAAUCAGCGUCGCCGCGGUCCCAGUUCUAAAGUCCCCACGCACCCACCCGGACUCAGAGUCUCCUCAGACGCCGAG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 8 0.189253604 ubox
1 63 0.003414607 ubox
1 69 0.035846078 ubox
1 80 0.079238661 ubox
1 86 0.051533788 ubox
2 7 0.201534749 ubox
2 10 0.108899766 ubox
2 18 0.021840773 ubox
2 28 0.003294816 ubox
2 35 0.003399635 ubox
2 43 0.144547120 ubox
2 62 0.003732124 ubox
2 68 0.038306578 ubox
2 79 0.087951880 ubox
2 85 0.054939672 ubox
2 87 0.021932875 ubox
3 9 0.108253416 ubox
3 17 0.032907485 ubox
3 34 0.003317192 ubox
3 40 0.186200777 ubox
3 42 0.144467179 ubox
3 61 0.003198510 ubox
3 67 0.036091796 ubox
3 78 0.087069776 ubox
3 86 0.020553061 ubox
4 39 0.194820366 ubox
4 65 0.003937717 ubox
4 73 0.003327715 ubox
4 76 0.023075383 ubox
5 16 0.221677973 ubox
5 22 0.026955833 ubox
5 31 0.004317391 ubox
5 38 0.195685517 ubox
5 45 0.006273582 ubox
5 64 0.003734374 ubox
5 66 0.024869295 ubox
5 72 0.003530213 ubox
5 74 0.051042267 ubox
5 75 0.018917549 ubox
5 77 0.078688538 ubox
6 15 0.221470638 ubox
6 21 0.026054663 ubox
6 30 0.003726845 ubox
6 36 0.006180169 ubox
6 37 0.194548361 ubox
6 39 0.207912289 ubox
6 44 0.005120930 ubox
6 65 0.018307906 ubox
6 73 0.052884438 ubox
6 76 0.078646961 ubox
7 16 0.121253147 ubox
7 22 0.115153446 ubox
7 31 0.009091085 ubox
7 36 0.184987137 ubox
7 37 0.011514293 ubox
7 38 0.211822525 ubox
7 64 0.016486867 ubox
7 72 0.052880396 ubox
7 74 0.015312837 ubox
7 75 0.077576437 ubox
8 15 0.114793102 ubox
8 21 0.108961195 ubox
8 30 0.006835755 ubox
8 36 0.020261568 ubox
8 37 0.208954568 ubox
8 71 0.049128747 ubox
8 73 0.017293938 ubox
9 36 0.203056039 ubox
9 37 0.037243036 ubox
9 73 0.037816849 ubox
10 19 0.133786090 ubox
10 21 0.008726814 ubox
10 24 0.012520249 ubox
10 27 0.004232561 ubox
10 30 0.126448641 ubox
10 36 0.059288987 ubox
10 52 0.004493720 ubox
10 71 0.015649689 ubox
10 72 0.037911075 ubox
10 83 0.024801565 ubox
11 18 0.133735131 ubox
11 20 0.009376108 ubox
11 23 0.012536531 ubox
11 26 0.004251726 ubox
11 29 0.129250716 ubox
11 35 0.068857561 ubox
11 51 0.004489728 ubox
11 62 0.006706674 ubox
11 70 0.026667865 ubox
11 82 0.024806344 ubox
12 28 0.129155373 ubox
12 61 0.006699617 ubox
14 21 0.003935798 ubox
14 30 0.205122525 ubox
15 20 0.003823177 ubox
15 29 0.212351466 ubox
15 69 0.018602100 ubox
15 80 0.004685713 ubox
15 86 0.798027290 ubox
16 28 0.210593314 ubox
16 68 0.018700921 ubox
16 79 0.004758968 ubox
16 85 0.851455647 ubox
18 24 0.023456453 ubox
18 27 0.311130635 ubox
18 30 0.003756568 ubox
18 36 0.003344094 ubox
18 52 0.028525869 ubox
18 83 0.936749221 ubox
19 23 0.023336689 ubox
19 26 0.311437864 ubox
19 28 0.022993380 ubox
19 29 0.003325448 ubox
19 35 0.003445990 ubox
19 51 0.028558771 ubox
19 82 0.937464141 ubox
19 85 0.005958642 ubox
20 25 0.302046357 ubox
20 27 0.024146090 ubox
20 50 0.028544261 ubox
20 54 0.008492788 ubox
20 58 0.004978729 ubox
20 64 0.004998911 ubox
20 81 0.937447070 ubox
20 84 0.006077540 ubox
21 26 0.022811065 ubox
21 29 0.005975475 ubox
21 49 0.027644557 ubox
21 53 0.008469293 ubox
21 57 0.004841652 ubox
21 63 0.004876372 ubox
21 80 0.937279803 ubox
21 86 0.056012562 ubox
22 28 0.010688240 ubox
22 62 0.003171331 ubox
22 68 0.003287663 ubox
22 79 0.936699462 ubox
22 82 0.003258352 ubox
22 85 0.059976000 ubox
23 27 0.031287383 ubox
23 30 0.128588610 ubox
23 36 0.019767021 ubox
23 44 0.008764052 ubox
23 52 0.063073323 ubox
23 71 0.038787887 ubox
23 83 0.008867059 ubox
23 84 0.058967578 ubox
24 29 0.134052303 ubox
24 35 0.020709449 ubox
24 43 0.008989066 ubox
24 51 0.048996915 ubox
24 62 0.198197289 ubox
24 70 0.038925122 ubox
24 82 0.009664372 ubox
25 51 0.048986205 ubox
25 61 0.200237474 ubox
25 82 0.014811634 ubox
25 85 0.074180301 ubox
26 36 0.085174353 ubox
26 44 0.024732738 ubox
26 50 0.063570089 ubox
26 52 0.123404622 ubox
26 60 0.200303044 ubox
26 71 0.032304752 ubox
26 81 0.013980375 ubox
26 83 0.076034526 ubox
26 84 0.072107545 ubox
27 35 0.089398374 ubox
27 43 0.025220918 ubox
27 51 0.123552566 ubox
27 61 0.010184477 ubox
27 70 0.032888510 ubox
27 82 0.078806084 ubox
27 85 0.083383895 ubox
28 37 0.006011365 ubox
28 38 0.037663464 ubox
28 39 0.059637300 ubox
28 46 0.026849440 ubox
28 47 0.021891284 ubox
28 48 0.063809092 ubox
28 50 0.122329258 ubox
28 55 0.019929998 ubox
28 56 0.015161319 ubox
28 59 0.199940766 ubox
28 60 0.010910237 ubox
28 65 0.241497711 ubox
28 66 0.090563781 ubox
28 72 0.046164018 ubox
28 73 0.077281415 ubox
28 74 0.072488840 ubox
28 75 0.816100104 ubox
28 76 0.099631690 ubox
28 77 0.031935406 ubox
28 81 0.063309328 ubox
28 84 0.091754899 ubox
29 36 0.006186939 ubox
29 37 0.036082741 ubox
29 38 0.062705856 ubox
29 45 0.027246864 ubox
29 46 0.022223515 ubox
29 47 0.063615866 ubox
29 50 0.006707794 ubox
29 54 0.020118224 ubox
29 55 0.014955023 ubox
29 58 0.199932000 ubox
29 59 0.010718412 ubox
29 64 0.273347526 ubox
29 65 0.011186730 ubox
29 71 0.044423058 ubox
29 72 0.080433201 ubox
29 73 0.045724132 ubox
29 74 0.817088887 ubox
29 75 0.102334486 ubox
29 76 0.030007795 ubox
29 81 0.086793395 ubox
29 83 0.091611599 ubox
30 35 0.005071108 ubox
30 43 0.004400079 ubox
30 49 0.008786477 ubox
30 53 0.019530478 ubox
30 57 0.192382900 ubox
30 63 0.273737239 ubox
30 69 0.041540218 ubox
30 70 0.017101852 ubox
30 80 0.098367869 ubox
30 82 0.087611718 ubox
31 62 0.273731673 ubox
31 68 0.042155046 ubox
31 79 0.099106994 ubox
31 85 0.003478423 ubox
32 61 0.273304226 ubox
32 62 0.008937937 ubox
33 61 0.011875454 ubox
34 65 0.043302918 ubox
34 73 0.742317710 ubox
34 76 0.068106073 ubox
35 44 0.009668943 ubox
35 50 0.083983527 ubox
35 52 0.128462773 ubox
35 54 0.054570797 ubox
35 58 0.237081242 ubox
35 64 0.044158893 ubox
35 71 0.156847384 ubox
35 72 0.751960972 ubox
35 75 0.068839506 ubox
35 81 0.011361134 ubox
35 83 0.003846718 ubox
36 42 0.035444236 ubox
36 43 0.014201571 ubox
36 49 0.080012428 ubox
36 51 0.124577303 ubox
36 53 0.052402836 ubox
36 57 0.229840748 ubox
36 63 0.043969937 ubox
36 68 0.011981127 ubox
36 69 0.039442296 ubox
36 70 0.800688129 ubox
36 80 0.009984200 ubox
36 82 0.003719661 ubox
37 41 0.030532611 ubox
37 42 0.014329865 ubox
37 62 0.043606358 ubox
37 63 0.003996203 ubox
37 67 0.011223342 ubox
37 68 0.023988077 ubox
37 69 0.853467613 ubox
37 79 0.007750971 ubox
37 80 0.006396416 ubox
38 61 0.043305312 ubox
38 62 0.005491305 ubox
38 68 0.856273638 ubox
38 70 0.077489948 ubox
38 79 0.008312465 ubox
39 61 0.005256602 ubox
39 67 0.829892198 ubox
39 69 0.076329225 ubox
39 78 0.007966162 ubox
42 65 0.864206017 ubox
43 50 0.259254728 ubox
43 52 0.099438788 ubox
43 54 0.043287796 ubox
43 58 0.015338578 ubox
43 64 0.895643085 ubox
43 81 0.004292364 ubox
44 49 0.237099264 ubox
44 51 0.096094257 ubox
44 53 0.042876437 ubox
44 57 0.014667274 ubox
44 63 0.896397040 ubox
44 80 0.004300007 ubox
45 61 0.004082934 ubox
45 62 0.895365896 ubox
45 79 0.004287452 ubox
46 61 0.891163245 ubox
46 62 0.048116479 ubox
47 61 0.065315307 ubox
47 62 0.029818482 ubox
48 61 0.031711822 ubox
50 61 0.055840380 ubox
50 85 0.006209315 ubox
51 60 0.121488623 ubox
51 83 0.012908064 ubox
51 84 0.004931078 ubox
52 82 0.013493243 ubox
54 62 0.051636017 ubox
55 61 0.052107741 ubox
55 62 0.107087038 ubox
56 61 0.107692175 ubox
60 85 0.222017527 ubox
61 73 0.092819127 ubox
61 74 0.025288979 ubox
61 75 0.019852243 ubox
61 84 0.224326495 ubox
62 72 0.106146551 ubox
62 74 0.019262209 ubox
62 83 0.224292706 ubox
63 71 0.109131875 ubox
63 73 0.017044651 ubox
64 70 0.109763868 ubox
64 79 0.013417520 ubox
64 87 0.102734525 ubox
65 69 0.098898558 ubox
65 78 0.015784492 ubox
65 80 0.219530705 ubox
65 86 0.120045233 ubox
66 79 0.221957717 ubox
66 85 0.132948126 ubox
67 73 0.010017935 ubox
67 76 0.033024484 ubox
68 72 0.010520881 ubox
68 74 0.019289154 ubox
68 75 0.034989636 ubox
68 77 0.440328244 ubox
69 73 0.016983677 ubox
69 76 0.440755804 ubox
70 75 0.436507871 ubox
70 81 0.210811056 ubox
70 83 0.010773686 ubox
71 80 0.211206230 ubox
71 82 0.010588292 ubox
72 79 0.211254209 ubox
72 87 0.007877995 ubox
73 78 0.193113382 ubox
73 80 0.011734103 ubox
73 86 0.008138021 ubox
74 79 0.012373045 ubox
74 85 0.008163026 ubox
75 87 0.035992741 ubox
76 86 0.036857743 ubox
77 85 0.036932294 ubox
15 86 0.9500000 lbox
16 85 0.9500000 lbox
18 83 0.9500000 lbox
19 82 0.9500000 lbox
20 81 0.9500000 lbox
21 80 0.9500000 lbox
22 79 0.9500000 lbox
28 75 0.9500000 lbox
29 74 0.9500000 lbox
34 73 0.9500000 lbox
35 72 0.9500000 lbox
36 70 0.9500000 lbox
37 69 0.9500000 lbox
38 68 0.9500000 lbox
39 67 0.9500000 lbox
42 65 0.9500000 lbox
43 64 0.9500000 lbox
44 63 0.9500000 lbox
45 62 0.9500000 lbox
46 61 0.9500000 lbox
showpage
end
%%EOF
