%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:20:05 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (DBNL)
} def

/sequence { (\
GUUUCCGGUUGUCGGAGGCGAGGCUUGUCGGCUGUCAAAGGGGCGGCCCGGCCCGGCCCGGAAGCUACAGCAGCGGCGCGGAGACUGCGGGGCGGGCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 19 0.990110371 ubox
1 24 0.013814448 ubox
1 44 0.003761918 ubox
1 65 0.023408527 ubox
2 18 0.990178244 ubox
2 23 0.013682421 ubox
2 43 0.003342859 ubox
2 64 0.023431674 ubox
3 16 0.006135678 ubox
3 17 0.987739022 ubox
3 22 0.012206189 ubox
3 63 0.023438188 ubox
4 16 0.998072107 ubox
4 21 0.010844296 ubox
4 62 0.023487268 ubox
5 15 0.999563122 ubox
5 20 0.008334990 ubox
5 41 0.003556125 ubox
5 61 0.023497243 ubox
6 14 0.999551255 ubox
6 20 0.007072975 ubox
6 27 0.003990063 ubox
6 40 0.003562923 ubox
6 60 0.023496915 ubox
7 13 0.995909401 ubox
7 19 0.009662489 ubox
7 25 0.008643796 ubox
7 48 0.004694494 ubox
7 59 0.023489006 ubox
8 12 0.645180970 ubox
8 19 0.004120443 ubox
8 24 0.009538698 ubox
8 47 0.004720927 ubox
8 58 0.023304597 ubox
9 17 0.009384725 ubox
9 18 0.004204051 ubox
9 23 0.009481822 ubox
9 38 0.004182283 ubox
9 46 0.004735210 ubox
10 16 0.009367736 ubox
10 17 0.003977226 ubox
10 22 0.006669639 ubox
10 37 0.004445640 ubox
10 45 0.004720866 ubox
11 19 0.003336828 ubox
11 36 0.004462110 ubox
11 44 0.004734447 ubox
11 57 0.023224421 ubox
12 18 0.003332975 ubox
12 21 0.009499250 ubox
12 43 0.004721856 ubox
12 56 0.023360176 ubox
13 17 0.003217863 ubox
13 20 0.009872436 ubox
13 34 0.004277923 ubox
13 42 0.004696634 ubox
13 55 0.023374742 ubox
14 19 0.009837193 ubox
14 33 0.004173149 ubox
14 54 0.023340964 ubox
15 32 0.004132108 ubox
15 53 0.022513425 ubox
16 25 0.004261981 ubox
16 26 0.024966342 ubox
16 33 0.004458579 ubox
17 24 0.005202564 ubox
17 25 0.033712890 ubox
17 29 0.119141938 ubox
17 32 0.005011276 ubox
17 36 0.004924228 ubox
17 53 0.005978156 ubox
18 24 0.036513944 ubox
18 28 0.121626019 ubox
18 35 0.004995470 ubox
18 52 0.008369260 ubox
19 23 0.036277042 ubox
19 27 0.121997869 ubox
19 30 0.013511657 ubox
19 34 0.004990766 ubox
19 50 0.006069639 ubox
19 51 0.008291148 ubox
20 26 0.120169295 ubox
20 29 0.562874457 ubox
20 36 0.055561192 ubox
20 49 0.129351008 ubox
20 54 0.012132880 ubox
21 25 0.102754929 ubox
21 28 0.554462280 ubox
21 33 0.003620143 ubox
21 35 0.052257058 ubox
22 29 0.137264755 ubox
22 33 0.057128900 ubox
22 36 0.011618992 ubox
22 48 0.180124570 ubox
22 49 0.057997911 ubox
22 53 0.017372012 ubox
22 54 0.006047271 ubox
22 98 0.026022321 ubox
23 28 0.093658760 ubox
23 32 0.063192329 ubox
23 35 0.011614744 ubox
23 47 0.180507933 ubox
23 48 0.052537766 ubox
23 52 0.017529912 ubox
23 53 0.006000875 ubox
23 97 0.026149270 ubox
24 31 0.063232429 ubox
24 34 0.011621138 ubox
24 46 0.179902974 ubox
24 51 0.017556241 ubox
24 96 0.026034656 ubox
25 30 0.057767708 ubox
25 38 0.003281180 ubox
25 45 0.127295531 ubox
25 46 0.023687814 ubox
25 50 0.015123680 ubox
25 95 0.016832319 ubox
26 37 0.003876047 ubox
26 45 0.125511798 ubox
26 50 0.020524550 ubox
26 94 0.016077328 ubox
27 36 0.003976144 ubox
27 44 0.177524663 ubox
27 47 0.049198690 ubox
27 49 0.111421600 ubox
27 52 0.030775925 ubox
27 93 0.015605285 ubox
28 41 0.003528345 ubox
28 42 0.013121272 ubox
28 43 0.177464658 ubox
28 46 0.049332725 ubox
28 51 0.031323310 ubox
28 92 0.015416610 ubox
29 40 0.004019838 ubox
29 41 0.013647485 ubox
29 42 0.176693162 ubox
29 45 0.053059777 ubox
29 50 0.077695222 ubox
29 91 0.015149061 ubox
30 36 0.004106043 ubox
30 44 0.053323170 ubox
30 48 0.971633159 ubox
30 49 0.107200485 ubox
31 44 0.028413242 ubox
31 47 0.976930961 ubox
31 48 0.075865726 ubox
31 71 0.006400184 ubox
31 74 0.005479066 ubox
31 88 0.006140855 ubox
32 40 0.161453944 ubox
32 41 0.033619103 ubox
32 42 0.052422800 ubox
32 43 0.029763062 ubox
32 46 0.979876275 ubox
32 70 0.006408668 ubox
32 73 0.005491311 ubox
32 87 0.006130852 ubox
33 39 0.160982015 ubox
33 40 0.033549449 ubox
33 41 0.051934144 ubox
33 42 0.029564989 ubox
33 45 0.979146697 ubox
33 69 0.006407169 ubox
33 72 0.005489401 ubox
34 44 0.979872625 ubox
34 68 0.006397929 ubox
34 71 0.005485587 ubox
34 85 0.006113868 ubox
35 41 0.006045642 ubox
35 42 0.049142872 ubox
35 43 0.978195504 ubox
35 67 0.006173736 ubox
35 70 0.005355589 ubox
35 84 0.006149863 ubox
36 40 0.011011734 ubox
36 41 0.069043220 ubox
36 42 0.973561796 ubox
36 83 0.006143085 ubox
40 49 0.062106831 ubox
40 59 0.006433056 ubox
41 48 0.062180661 ubox
41 49 0.014689955 ubox
41 54 0.005294590 ubox
41 58 0.006438576 ubox
42 47 0.062114195 ubox
42 48 0.014711691 ubox
42 53 0.005310764 ubox
42 57 0.006437977 ubox
42 66 0.004898062 ubox
43 47 0.014485005 ubox
43 52 0.005318772 ubox
43 65 0.004962828 ubox
44 51 0.005315462 ubox
44 55 0.006514806 ubox
44 64 0.004977134 ubox
45 53 0.003262461 ubox
45 54 0.006216322 ubox
45 98 0.013081367 ubox
46 52 0.003946608 ubox
46 53 0.005776196 ubox
46 97 0.013228463 ubox
47 51 0.004488446 ubox
47 61 0.004774062 ubox
47 96 0.013229715 ubox
48 60 0.004766860 ubox
48 61 0.004653137 ubox
48 95 0.013242111 ubox
49 60 0.006705656 ubox
49 87 0.003343915 ubox
49 90 0.004669506 ubox
49 94 0.013333721 ubox
50 58 0.006702301 ubox
50 59 0.006359920 ubox
50 86 0.003435998 ubox
50 93 0.012514884 ubox
50 98 0.989067127 ubox
51 57 0.007142994 ubox
51 58 0.005909168 ubox
51 85 0.003463674 ubox
51 88 0.004982170 ubox
51 93 0.006661091 ubox
51 97 0.999024034 ubox
52 56 0.007436876 ubox
52 87 0.005024515 ubox
52 91 0.011700794 ubox
52 92 0.008178784 ubox
52 96 0.999086529 ubox
53 81 0.007170537 ubox
53 90 0.011725185 ubox
53 91 0.008188214 ubox
53 95 0.999302889 ubox
53 96 0.003194464 ubox
54 80 0.007181520 ubox
54 89 0.011706983 ubox
54 90 0.008186458 ubox
54 94 0.999279209 ubox
54 95 0.004058184 ubox
55 79 0.006987186 ubox
55 88 0.010188712 ubox
55 93 0.996847070 ubox
55 98 0.018356030 ubox
56 77 0.005922400 ubox
56 79 0.006457872 ubox
56 85 0.003712906 ubox
56 88 0.009079278 ubox
56 93 0.067368547 ubox
56 97 0.018497400 ubox
57 76 0.005444234 ubox
57 78 0.006705892 ubox
57 87 0.010001184 ubox
57 91 0.994695063 ubox
57 92 0.094735032 ubox
57 96 0.018498041 ubox
58 75 0.004895976 ubox
58 76 0.010994846 ubox
58 81 0.013234408 ubox
58 90 0.994820952 ubox
58 91 0.094488144 ubox
58 95 0.018497816 ubox
59 75 0.016318826 ubox
59 80 0.013265379 ubox
59 87 0.004208424 ubox
59 89 0.994504881 ubox
59 90 0.094140941 ubox
59 94 0.018494039 ubox
60 66 0.007848380 ubox
60 74 0.018387730 ubox
60 77 0.038221171 ubox
60 79 0.013328470 ubox
60 86 0.012181399 ubox
60 88 0.982098293 ubox
60 93 0.016607693 ubox
61 65 0.008165471 ubox
61 85 0.025160855 ubox
63 86 0.765093249 ubox
64 71 0.068494653 ubox
64 74 0.116890344 ubox
64 77 0.090870725 ubox
64 79 0.019408391 ubox
64 85 0.777207099 ubox
64 88 0.009430165 ubox
64 93 0.003834918 ubox
65 70 0.068356633 ubox
65 73 0.117037132 ubox
65 76 0.091083151 ubox
65 78 0.019418325 ubox
65 81 0.089474234 ubox
65 83 0.953517051 ubox
65 87 0.010182146 ubox
65 90 0.003849508 ubox
65 92 0.004194421 ubox
66 72 0.113502525 ubox
66 75 0.090172963 ubox
66 80 0.086795455 ubox
66 82 0.941632699 ubox
66 89 0.003738399 ubox
66 91 0.004122260 ubox
68 87 0.016573537 ubox
69 86 0.016611126 ubox
70 77 0.628566176 ubox
70 79 0.756942643 ubox
70 85 0.016509558 ubox
70 88 0.012769226 ubox
70 97 0.022692982 ubox
71 76 0.627666816 ubox
71 78 0.756596287 ubox
71 87 0.013764459 ubox
71 96 0.022723051 ubox
72 86 0.013805216 ubox
73 79 0.049953619 ubox
73 85 0.013737255 ubox
73 88 0.051180760 ubox
73 93 0.023911586 ubox
74 78 0.049621052 ubox
74 80 0.014881219 ubox
74 87 0.053871318 ubox
74 92 0.023991347 ubox
75 79 0.014060187 ubox
75 86 0.054362061 ubox
76 85 0.054394189 ubox
76 88 0.012135617 ubox
77 87 0.012574346 ubox
77 89 0.088112485 ubox
78 86 0.010380450 ubox
78 88 0.146175682 ubox
79 87 0.149739628 ubox
80 86 0.148737404 ubox
81 85 0.145571080 ubox
1 19 0.9500000 lbox
2 18 0.9500000 lbox
3 17 0.9500000 lbox
4 16 0.9500000 lbox
5 15 0.9500000 lbox
6 14 0.9500000 lbox
7 13 0.9500000 lbox
30 48 0.9500000 lbox
31 47 0.9500000 lbox
32 46 0.9500000 lbox
33 45 0.9500000 lbox
34 44 0.9500000 lbox
35 43 0.9500000 lbox
36 42 0.9500000 lbox
50 98 0.9500000 lbox
51 97 0.9500000 lbox
52 96 0.9500000 lbox
53 95 0.9500000 lbox
54 94 0.9500000 lbox
55 93 0.9500000 lbox
57 91 0.9500000 lbox
58 90 0.9500000 lbox
59 89 0.9500000 lbox
60 88 0.9500000 lbox
63 86 0.9500000 lbox
64 85 0.9500000 lbox
65 83 0.9500000 lbox
66 82 0.9500000 lbox
70 79 0.9500000 lbox
71 78 0.9500000 lbox
showpage
end
%%EOF
