%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:34:33 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (PYCARD)
} def

/sequence { (\
GUCCAGGUUCCGCCCCGGAGCCGACUUCCUCCUGGUCGGCGGCUGCAGCGGGGUGAGCGGCGGCAGCGGCCGGGGAUCCUGGAGCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 25 0.064699882 ubox
1 64 0.003444609 ubox
1 85 0.397216909 ubox
2 24 0.064819735 ubox
2 63 0.003378731 ubox
2 83 0.890371789 ubox
2 84 0.208189853 ubox
3 23 0.064394907 ubox
3 62 0.003344006 ubox
3 82 0.966249099 ubox
4 81 0.966516258 ubox
5 80 0.966238489 ubox
6 22 0.072158560 ubox
6 78 0.022225930 ubox
6 79 0.965899612 ubox
6 86 0.245327309 ubox
7 21 0.073979129 ubox
7 58 0.006260881 ubox
7 77 0.031298964 ubox
7 78 0.964694857 ubox
7 85 0.247440114 ubox
8 20 0.074275964 ubox
8 53 0.003404344 ubox
8 57 0.006931906 ubox
8 75 0.017349213 ubox
8 76 0.183907332 ubox
8 84 0.247330517 ubox
9 19 0.074552142 ubox
9 52 0.004904311 ubox
9 56 0.007397325 ubox
9 74 0.023419794 ubox
9 75 0.175105949 ubox
9 76 0.371066263 ubox
9 83 0.247316027 ubox
10 18 0.074632639 ubox
10 51 0.005702993 ubox
10 55 0.005308989 ubox
10 73 0.025048721 ubox
10 74 0.175054867 ubox
10 75 0.337475373 ubox
10 82 0.247453257 ubox
11 17 0.074628493 ubox
11 50 0.005781578 ubox
11 55 0.079617946 ubox
11 72 0.024307238 ubox
11 73 0.168973656 ubox
11 74 0.305194616 ubox
11 81 0.247352710 ubox
12 16 0.069860589 ubox
12 21 0.003739620 ubox
12 36 0.087235339 ubox
12 37 0.014541039 ubox
12 49 0.006798622 ubox
12 54 0.247036000 ubox
12 58 0.003310893 ubox
12 70 0.026159766 ubox
12 71 0.019340730 ubox
12 80 0.239826725 ubox
13 20 0.003801560 ubox
13 35 0.093055617 ubox
13 48 0.006799662 ubox
13 52 0.004462679 ubox
13 53 0.254961360 ubox
13 69 0.028184138 ubox
13 73 0.104004900 ubox
13 74 0.019160201 ubox
13 75 0.920799307 ubox
14 34 0.091244951 ubox
14 35 0.145410986 ubox
14 51 0.004515492 ubox
14 52 0.255050224 ubox
14 68 0.028081042 ubox
14 69 0.010661390 ubox
14 72 0.096627163 ubox
14 73 0.022177628 ubox
14 74 0.930041622 ubox
14 75 0.003502782 ubox
15 34 0.147302656 ubox
15 35 0.080082300 ubox
15 50 0.004550060 ubox
15 51 0.255051992 ubox
15 68 0.010522330 ubox
15 69 0.074950989 ubox
15 72 0.018280337 ubox
15 73 0.938802990 ubox
15 74 0.003494035 ubox
16 34 0.080562184 ubox
16 41 0.003441582 ubox
16 45 0.012679420 ubox
16 50 0.254852542 ubox
16 68 0.075335196 ubox
16 72 0.938916440 ubox
16 73 0.003443477 ubox
17 28 0.008390678 ubox
17 29 0.019710148 ubox
17 32 0.194250423 ubox
17 33 0.019404502 ubox
17 44 0.032709347 ubox
17 49 0.248535179 ubox
17 67 0.072242988 ubox
17 71 0.937101534 ubox
18 27 0.008588168 ubox
18 28 0.019738717 ubox
18 31 0.194885416 ubox
18 32 0.014268443 ubox
18 43 0.066122617 ubox
18 70 0.933809583 ubox
19 26 0.010370246 ubox
19 27 0.018850222 ubox
19 30 0.195264562 ubox
19 44 0.102626023 ubox
20 25 0.011751520 ubox
20 26 0.015420254 ubox
20 29 0.194830280 ubox
20 36 0.003200503 ubox
20 40 0.963364243 ubox
20 43 0.121688673 ubox
20 46 0.013880491 ubox
20 61 0.011405271 ubox
20 64 0.022084574 ubox
20 67 0.032147567 ubox
20 70 0.009882910 ubox
21 35 0.003683187 ubox
21 39 0.968541184 ubox
21 42 0.121767255 ubox
21 45 0.010345371 ubox
21 60 0.011461527 ubox
21 63 0.022085651 ubox
21 66 0.030806381 ubox
21 69 0.013303629 ubox
22 34 0.003686139 ubox
22 38 0.969535325 ubox
22 41 0.121825063 ubox
22 59 0.011469905 ubox
22 62 0.022070834 ubox
22 68 0.012895961 ubox
23 37 0.969648959 ubox
23 40 0.121519755 ubox
23 58 0.011475779 ubox
23 61 0.021888239 ubox
23 67 0.007418169 ubox
23 78 0.007583970 ubox
24 36 0.969504862 ubox
24 77 0.007387998 ubox
25 35 0.966431366 ubox
25 39 0.098909368 ubox
25 57 0.015617697 ubox
25 60 0.015649374 ubox
25 66 0.006885026 ubox
25 84 0.006983311 ubox
26 34 0.954769248 ubox
26 35 0.006211499 ubox
26 38 0.097543107 ubox
26 56 0.015346404 ubox
26 57 0.007502350 ubox
26 59 0.014506138 ubox
26 65 0.006692909 ubox
26 83 0.006632235 ubox
26 84 0.038516211 ubox
27 34 0.034676051 ubox
27 35 0.006398329 ubox
27 55 0.014200863 ubox
27 56 0.014590923 ubox
27 76 0.013222702 ubox
27 82 0.005600996 ubox
27 83 0.049032112 ubox
28 34 0.022254255 ubox
28 35 0.144037499 ubox
28 39 0.005279198 ubox
28 53 0.013170408 ubox
28 55 0.015167573 ubox
28 63 0.006006293 ubox
28 75 0.013881722 ubox
28 81 0.005571798 ubox
28 82 0.050127640 ubox
29 34 0.151664190 ubox
29 35 0.008393348 ubox
29 38 0.005299099 ubox
29 52 0.013180734 ubox
29 53 0.007426303 ubox
29 57 0.008908589 ubox
29 62 0.006006493 ubox
29 74 0.012791151 ubox
29 75 0.012603896 ubox
29 81 0.050110089 ubox
29 84 0.041706022 ubox
30 34 0.008255744 ubox
30 51 0.013137069 ubox
30 52 0.005701023 ubox
30 53 0.009857025 ubox
30 56 0.008583361 ubox
30 73 0.006605022 ubox
30 74 0.006093290 ubox
30 75 0.052936770 ubox
30 76 0.016245519 ubox
30 83 0.042196322 ubox
31 50 0.013139006 ubox
31 51 0.005760396 ubox
31 52 0.011450441 ubox
31 53 0.015231961 ubox
31 55 0.006323209 ubox
31 60 0.004713755 ubox
31 72 0.005856245 ubox
31 73 0.011819497 ubox
31 74 0.058346451 ubox
31 75 0.015068414 ubox
31 82 0.042251187 ubox
32 48 0.013180313 ubox
32 50 0.005710608 ubox
32 51 0.011478973 ubox
32 52 0.015796589 ubox
32 53 0.003359324 ubox
32 59 0.004650798 ubox
32 60 0.003602065 ubox
32 72 0.011682828 ubox
32 73 0.060440231 ubox
32 74 0.013550240 ubox
32 81 0.042140349 ubox
33 47 0.013102360 ubox
33 50 0.011406444 ubox
33 51 0.015805098 ubox
33 59 0.003682836 ubox
33 72 0.061146185 ubox
33 73 0.010554851 ubox
34 44 0.004719913 ubox
34 46 0.012293029 ubox
34 49 0.011371385 ubox
34 58 0.005792933 ubox
34 71 0.070708685 ubox
34 78 0.009690379 ubox
34 79 0.040738428 ubox
35 43 0.009703053 ubox
35 49 0.016638733 ubox
35 70 0.070737673 ubox
35 77 0.009740764 ubox
35 78 0.040815809 ubox
36 42 0.009729510 ubox
36 48 0.016716564 ubox
36 52 0.003474400 ubox
36 56 0.005802187 ubox
36 69 0.070707003 ubox
36 73 0.122680410 ubox
36 74 0.003572654 ubox
36 76 0.012297043 ubox
37 41 0.009404117 ubox
37 45 0.007165100 ubox
37 51 0.003682084 ubox
37 55 0.005808918 ubox
37 68 0.070230154 ubox
37 72 0.191781474 ubox
37 73 0.005905471 ubox
37 75 0.010503091 ubox
38 44 0.007318741 ubox
38 54 0.005434962 ubox
38 67 0.055798796 ubox
38 71 0.198100796 ubox
39 43 0.007188938 ubox
39 46 0.019962887 ubox
39 49 0.004129165 ubox
39 64 0.038054675 ubox
39 67 0.051977013 ubox
39 70 0.198350914 ubox
40 45 0.019968452 ubox
40 48 0.004288179 ubox
40 60 0.003305245 ubox
40 63 0.038267014 ubox
40 66 0.067946656 ubox
40 68 0.023021772 ubox
40 69 0.215261123 ubox
40 72 0.005533790 ubox
41 49 0.004460814 ubox
41 67 0.064653263 ubox
41 71 0.070598118 ubox
42 49 0.035955772 ubox
42 58 0.013083902 ubox
42 61 0.055464338 ubox
42 64 0.468286921 ubox
42 67 0.838435461 ubox
42 70 0.072589304 ubox
43 48 0.037178385 ubox
43 57 0.013170317 ubox
43 60 0.055655301 ubox
43 63 0.468928843 ubox
43 66 0.839932637 ubox
43 69 0.073952089 ubox
44 56 0.012930579 ubox
44 59 0.055632344 ubox
44 62 0.468611172 ubox
44 65 0.839731750 ubox
44 68 0.073894328 ubox
45 49 0.003302440 ubox
45 54 0.006514960 ubox
45 58 0.055660346 ubox
45 61 0.469040638 ubox
45 64 0.839877354 ubox
45 67 0.073935968 ubox
46 53 0.006724120 ubox
46 55 0.011258614 ubox
46 57 0.055556360 ubox
46 60 0.467298342 ubox
46 63 0.836770614 ubox
46 66 0.073821864 ubox
47 54 0.011804152 ubox
48 54 0.040758932 ubox
48 58 0.470902318 ubox
48 61 0.810782561 ubox
48 64 0.072396112 ubox
49 53 0.040652188 ubox
49 55 0.019036605 ubox
49 57 0.472662618 ubox
49 59 0.346850028 ubox
49 60 0.760700347 ubox
49 62 0.045690565 ubox
49 63 0.070420999 ubox
50 54 0.013698375 ubox
50 58 0.451130787 ubox
50 61 0.049247481 ubox
53 61 0.048902124 ubox
53 77 0.003250879 ubox
54 60 0.048865418 ubox
54 62 0.006016129 ubox
54 72 0.021502142 ubox
54 76 0.003316982 ubox
55 61 0.006932950 ubox
55 71 0.077401007 ubox
57 64 0.005202089 ubox
57 70 0.110616918 ubox
58 63 0.005216040 ubox
58 69 0.110743737 ubox
58 72 0.199525737 ubox
59 71 0.201937791 ubox
60 67 0.111401082 ubox
60 70 0.201925597 ubox
61 66 0.111420163 ubox
61 68 0.067833616 ubox
61 69 0.190261816 ubox
61 72 0.108457038 ubox
62 67 0.096195463 ubox
62 71 0.112533726 ubox
63 70 0.112692297 ubox
64 69 0.112674130 ubox
66 85 0.003429210 ubox
67 84 0.003436828 ubox
70 82 0.003588109 ubox
71 81 0.004523078 ubox
72 80 0.004803931 ubox
73 79 0.005078651 ubox
74 78 0.005009795 ubox
2 83 0.9500000 lbox
3 82 0.9500000 lbox
4 81 0.9500000 lbox
5 80 0.9500000 lbox
6 79 0.9500000 lbox
7 78 0.9500000 lbox
13 75 0.9500000 lbox
14 74 0.9500000 lbox
15 73 0.9500000 lbox
16 72 0.9500000 lbox
17 71 0.9500000 lbox
18 70 0.9500000 lbox
20 40 0.9500000 lbox
21 39 0.9500000 lbox
22 38 0.9500000 lbox
23 37 0.9500000 lbox
24 36 0.9500000 lbox
25 35 0.9500000 lbox
26 34 0.9500000 lbox
42 67 0.9500000 lbox
43 66 0.9500000 lbox
44 65 0.9500000 lbox
45 64 0.9500000 lbox
46 63 0.9500000 lbox
48 61 0.9500000 lbox
49 60 0.9500000 lbox
showpage
end
%%EOF
