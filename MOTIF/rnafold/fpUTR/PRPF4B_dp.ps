%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:59:53 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (PRPF4B)
} def

/sequence { (\
GCGGCAGCUCUUUUCCUUCUUCCUCCACUUCCCCUACCCUCCACCGUCCGGGAGCCGCCGCCACCGCCGCCGAGGAGUCAGGAAGUUCAAG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 8 0.916076430 ubox
1 61 0.028700448 ubox
1 86 0.009140445 ubox
2 7 0.917324571 ubox
2 60 0.028868294 ubox
2 85 0.009905728 ubox
3 9 0.024341503 ubox
3 10 0.058935988 ubox
3 11 0.027708761 ubox
3 12 0.007247479 ubox
3 14 0.003248764 ubox
3 15 0.010939514 ubox
3 16 0.088463995 ubox
3 17 0.009569198 ubox
3 19 0.021559727 ubox
3 20 0.032641917 ubox
3 22 0.009840026 ubox
3 23 0.091074265 ubox
3 24 0.005802720 ubox
3 25 0.005251519 ubox
3 26 0.074885299 ubox
3 32 0.003661884 ubox
3 59 0.028875954 ubox
3 87 0.024041488 ubox
3 88 0.050516767 ubox
4 8 0.026726015 ubox
4 9 0.041542983 ubox
4 10 0.029354823 ubox
4 11 0.007842477 ubox
4 12 0.003449019 ubox
4 13 0.004068382 ubox
4 14 0.009563659 ubox
4 15 0.088338397 ubox
4 16 0.010194158 ubox
4 18 0.020737739 ubox
4 19 0.034958607 ubox
4 21 0.009082803 ubox
4 22 0.091038462 ubox
4 23 0.006341439 ubox
4 24 0.004100297 ubox
4 25 0.074853657 ubox
4 31 0.003665442 ubox
4 58 0.028876455 ubox
4 86 0.030457903 ubox
4 87 0.038232494 ubox
5 57 0.028850801 ubox
5 85 0.031441439 ubox
6 12 0.012673813 ubox
6 13 0.061329565 ubox
6 14 0.041973029 ubox
6 17 0.045981636 ubox
6 18 0.007896146 ubox
6 20 0.082587336 ubox
6 21 0.019105064 ubox
6 24 0.069414772 ubox
6 29 0.003521119 ubox
6 87 0.117731362 ubox
7 11 0.009906533 ubox
7 12 0.047882712 ubox
7 13 0.036344249 ubox
7 16 0.047239774 ubox
7 17 0.006454969 ubox
7 19 0.083252434 ubox
7 20 0.015901561 ubox
7 23 0.069104642 ubox
7 28 0.003577301 ubox
7 55 0.028825828 ubox
7 86 0.145842762 ubox
8 54 0.028806180 ubox
8 85 0.147280146 ubox
8 91 0.052573533 ubox
9 53 0.026420658 ubox
9 83 0.007272985 ubox
9 84 0.127564024 ubox
9 90 0.062127737 ubox
10 52 0.024288502 ubox
10 82 0.008761229 ubox
10 85 0.100949316 ubox
10 91 0.149253460 ubox
11 51 0.021408740 ubox
11 81 0.008574001 ubox
11 83 0.004664884 ubox
11 84 0.087862874 ubox
11 85 0.061072918 ubox
11 90 0.153275271 ubox
11 91 0.015593299 ubox
12 50 0.017418736 ubox
12 80 0.007442665 ubox
12 83 0.036799184 ubox
12 84 0.062707519 ubox
12 85 0.634016234 ubox
12 89 0.124973082 ubox
12 90 0.022267454 ubox
12 91 0.014680003 ubox
13 77 0.006757455 ubox
13 82 0.012454477 ubox
13 83 0.049079776 ubox
13 84 0.838773605 ubox
13 85 0.021415119 ubox
13 89 0.019279903 ubox
13 90 0.021721304 ubox
13 91 0.007374898 ubox
14 76 0.007679682 ubox
14 81 0.008779474 ubox
14 82 0.018781525 ubox
14 83 0.891999071 ubox
14 84 0.019289670 ubox
14 89 0.021707127 ubox
14 90 0.009897222 ubox
15 51 0.005409463 ubox
15 75 0.007700947 ubox
15 81 0.018398466 ubox
15 82 0.898439092 ubox
16 50 0.005563706 ubox
16 74 0.007696727 ubox
16 77 0.004097908 ubox
16 81 0.898411195 ubox
16 82 0.007317791 ubox
16 85 0.106998037 ubox
16 91 0.031907471 ubox
17 73 0.007338372 ubox
17 76 0.003905197 ubox
17 77 0.009735767 ubox
17 80 0.872948216 ubox
17 81 0.007883460 ubox
17 83 0.011171697 ubox
17 84 0.107508009 ubox
17 90 0.032431599 ubox
18 72 0.006423574 ubox
18 75 0.003788371 ubox
18 76 0.022896384 ubox
18 80 0.024765035 ubox
18 82 0.012528339 ubox
18 83 0.107575138 ubox
18 89 0.031091740 ubox
18 90 0.003304066 ubox
19 74 0.003790924 ubox
19 75 0.022998115 ubox
19 77 0.336270112 ubox
19 81 0.014531917 ubox
19 82 0.107397090 ubox
19 85 0.071186914 ubox
19 91 0.060523477 ubox
20 73 0.003665258 ubox
20 74 0.022951342 ubox
20 76 0.238856692 ubox
20 77 0.747692652 ubox
20 80 0.015615135 ubox
20 81 0.103512076 ubox
20 84 0.071810611 ubox
20 90 0.062076375 ubox
20 91 0.008417562 ubox
21 72 0.003259225 ubox
21 73 0.022946323 ubox
21 75 0.034863697 ubox
21 76 0.864165048 ubox
21 80 0.079448106 ubox
21 83 0.071994592 ubox
21 89 0.058485077 ubox
21 90 0.012231866 ubox
22 72 0.022899662 ubox
22 74 0.026539271 ubox
22 75 0.899509851 ubox
22 82 0.072014918 ubox
23 74 0.899806928 ubox
23 77 0.092712769 ubox
23 81 0.071881187 ubox
23 91 0.096927109 ubox
24 73 0.899602284 ubox
24 76 0.093299803 ubox
24 80 0.069209565 ubox
24 90 0.095238150 ubox
25 72 0.896741045 ubox
25 75 0.093488861 ubox
26 74 0.093372235 ubox
27 47 0.005346317 ubox
27 78 0.062116800 ubox
27 86 0.390667989 ubox
28 46 0.005645883 ubox
28 54 0.300300536 ubox
28 75 0.007160551 ubox
28 77 0.063728829 ubox
28 85 0.416379331 ubox
29 53 0.239023873 ubox
29 54 0.572694819 ubox
29 74 0.007200643 ubox
29 76 0.061442185 ubox
29 77 0.007918496 ubox
29 84 0.416435281 ubox
30 52 0.149283552 ubox
30 53 0.820476152 ubox
30 73 0.008976097 ubox
30 75 0.034095145 ubox
30 76 0.017250445 ubox
30 83 0.415922504 ubox
30 84 0.003526139 ubox
31 51 0.148373421 ubox
31 52 0.860271784 ubox
31 72 0.009016869 ubox
31 74 0.032148795 ubox
31 75 0.022502485 ubox
31 82 0.409573568 ubox
32 50 0.147039747 ubox
32 51 0.860336806 ubox
32 52 0.096757775 ubox
32 74 0.022301695 ubox
32 75 0.003646574 ubox
32 81 0.403082235 ubox
32 82 0.064737210 ubox
33 50 0.859673015 ubox
33 51 0.099162535 ubox
33 52 0.018372312 ubox
33 74 0.003763262 ubox
33 75 0.009661819 ubox
33 81 0.090034914 ubox
33 82 0.048072357 ubox
34 50 0.101062401 ubox
34 51 0.018451604 ubox
34 54 0.058234426 ubox
34 74 0.009861725 ubox
34 77 0.082208748 ubox
34 81 0.055441613 ubox
35 50 0.017592056 ubox
35 53 0.058988704 ubox
35 73 0.009696564 ubox
35 76 0.076666170 ubox
35 80 0.072496468 ubox
36 47 0.841086280 ubox
36 78 0.359246978 ubox
37 46 0.851201497 ubox
37 51 0.006467219 ubox
37 52 0.081606615 ubox
37 75 0.024311047 ubox
37 77 0.371143097 ubox
38 50 0.006529754 ubox
38 51 0.081855503 ubox
38 52 0.013545247 ubox
38 74 0.017758987 ubox
38 75 0.416044619 ubox
39 50 0.081779984 ubox
39 51 0.013542615 ubox
39 52 0.013519728 ubox
39 54 0.197252103 ubox
39 74 0.416693176 ubox
39 75 0.003779235 ubox
39 77 0.058936357 ubox
40 50 0.011329719 ubox
40 51 0.012231882 ubox
40 52 0.013561964 ubox
40 53 0.200806443 ubox
40 73 0.416967548 ubox
40 74 0.003309689 ubox
40 76 0.059931574 ubox
41 50 0.013923847 ubox
41 51 0.018736679 ubox
41 52 0.201064526 ubox
41 72 0.415797252 ubox
41 75 0.060045865 ubox
42 50 0.019951641 ubox
42 51 0.199840417 ubox
42 74 0.059956153 ubox
44 51 0.027190245 ubox
44 52 0.022531288 ubox
45 50 0.034140169 ubox
45 51 0.022706498 ubox
45 66 0.010349232 ubox
45 69 0.381825713 ubox
45 72 0.030753236 ubox
46 64 0.005671534 ubox
46 65 0.009827177 ubox
46 67 0.059478664 ubox
46 68 0.382430119 ubox
46 70 0.099715237 ubox
46 71 0.031467158 ubox
47 63 0.006342139 ubox
47 66 0.036148050 ubox
47 69 0.099019294 ubox
47 73 0.004112635 ubox
48 72 0.003798057 ubox
49 60 0.013628786 ubox
49 66 0.417621165 ubox
49 69 0.004974049 ubox
49 72 0.004722514 ubox
50 56 0.005569589 ubox
50 59 0.014161747 ubox
50 65 0.421830475 ubox
50 68 0.004997538 ubox
50 71 0.006759919 ubox
51 55 0.005484738 ubox
51 58 0.014152598 ubox
51 62 0.006888803 ubox
51 64 0.421840207 ubox
51 65 0.007420230 ubox
51 67 0.004919991 ubox
51 70 0.006748209 ubox
52 61 0.007150712 ubox
52 64 0.007648637 ubox
54 61 0.423497049 ubox
54 67 0.023049374 ubox
54 70 0.353972861 ubox
55 60 0.422407926 ubox
55 66 0.021961920 ubox
55 69 0.352247662 ubox
55 75 0.006575686 ubox
56 66 0.021870399 ubox
56 69 0.112161097 ubox
56 72 0.069539825 ubox
56 74 0.006621713 ubox
57 65 0.023147575 ubox
57 67 0.351011215 ubox
57 68 0.125046669 ubox
57 70 0.810416190 ubox
57 71 0.084427689 ubox
58 66 0.334536447 ubox
58 69 0.813852798 ubox
59 66 0.164011715 ubox
59 69 0.062006242 ubox
59 72 0.004838202 ubox
60 65 0.187129091 ubox
60 67 0.818507725 ubox
60 68 0.053174117 ubox
60 70 0.056454270 ubox
60 71 0.005595780 ubox
61 66 0.817853822 ubox
61 69 0.056705762 ubox
63 78 0.003656880 ubox
63 86 0.008408237 ubox
64 75 0.010076988 ubox
64 77 0.003883411 ubox
64 82 0.006538128 ubox
64 85 0.008967484 ubox
65 72 0.006786438 ubox
65 74 0.010135976 ubox
65 81 0.006558499 ubox
66 71 0.009933404 ubox
66 86 0.016897423 ubox
67 75 0.011786826 ubox
67 82 0.010824248 ubox
67 85 0.017601029 ubox
68 74 0.011853464 ubox
68 81 0.010830756 ubox
69 78 0.005938712 ubox
70 77 0.006100880 ubox
70 82 0.020539811 ubox
71 81 0.020554119 ubox
72 79 0.019674462 ubox
73 78 0.019245971 ubox
81 88 0.003616224 ubox
82 88 0.003578347 ubox
83 87 0.003236191 ubox
1 8 0.9500000 lbox
2 7 0.9500000 lbox
12 85 0.9500000 lbox
13 84 0.9500000 lbox
14 83 0.9500000 lbox
15 82 0.9500000 lbox
16 81 0.9500000 lbox
17 80 0.9500000 lbox
20 77 0.9500000 lbox
21 76 0.9500000 lbox
22 75 0.9500000 lbox
23 74 0.9500000 lbox
24 73 0.9500000 lbox
25 72 0.9500000 lbox
29 54 0.9500000 lbox
30 53 0.9500000 lbox
31 52 0.9500000 lbox
32 51 0.9500000 lbox
33 50 0.9500000 lbox
36 47 0.9500000 lbox
37 46 0.9500000 lbox
57 70 0.9500000 lbox
58 69 0.9500000 lbox
60 67 0.9500000 lbox
61 66 0.9500000 lbox
showpage
end
%%EOF
