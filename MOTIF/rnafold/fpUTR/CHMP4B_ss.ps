%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:22:13 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
GGUGGCGCGGCCGGGCCCAGCUGCGGGGCGGAGGCGGAGGCGGAGGAGAGGCCUGCGGCGGCAGGGAGCGGCGGGACUGGGAGCGGGCGCCGGAGCCGACCCGAGCCGAGCCGAGCCGAGCCGAGCCGGAGCGGGCGGCGAAGGCCGGCGCGGCGAGCAGCAACC\
) } def
/len { sequence length } bind def

/coor [
[120.43582153 365.70584106]
[120.43582153 350.70584106]
[120.43582153 335.70584106]
[112.69851685 322.97857666]
[120.43582153 309.17837524]
[120.43582153 294.17837524]
[120.29388428 279.17907715]
[120.01001740 264.18176270]
[110.14618683 249.68994141]
[119.12533569 233.63673401]
[118.55770874 218.64747620]
[117.99008942 203.65821838]
[117.42247009 188.66896057]
[109.20909119 176.24359131]
[116.41863251 162.16050720]
[115.85100555 147.17126465]
[115.28338623 132.18200684]
[103.28960419 133.53131104]
[92.21113586 130.78791809]
[83.32413483 124.72556305]
[77.49541473 116.47243500]
[63.45474243 121.75064850]
[49.41407013 127.02886963]
[35.37339783 132.30708313]
[31.11870193 148.65583801]
[18.09728050 159.15577698]
[1.54972029 159.83477783]
[-12.01364517 150.62338257]
[-25.95191574 156.16636658]
[-35.68865204 169.36212158]
[-51.95239639 167.25910950]
[-58.01240158 152.02072144]
[-47.63465500 139.32292175]
[-31.49489403 142.22810364]
[-17.55662155 136.68511963]
[-15.46183586 123.47509766]
[-7.03694773 112.94773102]
[5.59421492 107.92852020]
[19.16155243 109.83228302]
[30.09518242 118.26641083]
[44.13585281 112.98819733]
[58.17652512 107.70998383]
[72.21719360 102.43176270]
[72.34316254 91.76704407]
[76.54917145 81.57456207]
[84.48218536 73.40560150]
[95.20505524 68.60619354]
[107.30342102 68.10029602]
[119.07147980 72.22502136]
[128.75253296 80.64609528]
[134.80020142 92.37049866]
[140.60595703 78.53961945]
[146.41171265 64.70874023]
[152.21746826 50.87786102]
[158.02322388 37.04698181]
[163.82896423 23.21610069]
[158.09263611 8.73396778]
[164.17752075 -5.20980549]
[178.01937866 -10.58927727]
[183.82513428 -24.42015648]
[189.63087463 -38.25103760]
[195.43663025 -52.08191299]
[189.70030212 -66.56404877]
[195.78518677 -80.50782013]
[209.62704468 -85.88729095]
[215.43278503 -99.71817017]
[209.69645691 -114.20030975]
[215.78134155 -128.14407349]
[229.62319946 -133.52354431]
[235.42895508 -147.35443115]
[241.23469543 -161.18530273]
[247.04045105 -175.01618958]
[244.28439331 -193.20230103]
[258.61676025 -203.29638672]
[264.15975952 -217.23466492]
[264.42898560 -226.41029358]
[269.94177246 -231.38262939]
[275.74752808 -245.21351624]
[273.95462036 -260.93280029]
[286.01498413 -269.67337036]
[291.82073975 -283.50424194]
[286.08438110 -297.98638916]
[292.16928101 -311.93014526]
[306.01113892 -317.30963135]
[311.81689453 -331.14050293]
[317.62265015 -344.97137451]
[323.42840576 -358.80227661]
[329.10302734 -372.68746948]
[334.64599609 -386.62573242]
[327.07043457 -400.30581665]
[330.11132812 -415.64489746]
[342.33285522 -425.40029907]
[357.96441650 -424.96585083]
[369.62521362 -414.54666138]
[371.80941772 -399.06237793]
[363.48571777 -385.82418823]
[348.58425903 -381.08276367]
[343.04129028 -367.14450073]
[343.49356079 -359.73434448]
[337.25927734 -352.99652100]
[331.45352173 -339.16561890]
[325.64776611 -325.33474731]
[319.84201050 -311.50387573]
[325.69692993 -297.85632324]
[320.00610352 -283.74716187]
[305.65161133 -277.69848633]
[299.84585571 -263.86761475]
[302.05401611 -249.13760376]
[289.57839966 -239.40776062]
[283.77264404 -225.57687378]
[278.09802246 -211.69168091]
[272.55505371 -197.75341797]
[277.05584717 -186.49560547]
[272.51718140 -174.82125854]
[260.87133789 -169.21043396]
[255.06558228 -155.37956238]
[249.25982666 -141.54867554]
[243.45407104 -127.71779633]
[249.30900574 -114.07025146]
[243.61816406 -99.96107483]
[229.26367188 -93.91241455]
[223.45791626 -80.08153534]
[229.31285095 -66.43399811]
[223.62200928 -52.32481384]
[209.26751709 -46.27616119]
[203.46176147 -32.44528198]
[197.65600586 -18.61440277]
[191.85025024 -4.78352308]
[197.70518494 8.86401844]
[192.01434326 22.97320175]
[177.65985107 29.02185631]
[171.85409546 42.85273361]
[166.04833984 56.68361282]
[160.24258423 70.51449585]
[154.43682861 84.34537506]
[148.63107300 98.17625427]
[152.55905151 112.65281677]
[164.55943298 121.65231323]
[176.55981445 130.65180969]
[192.89712524 132.07443237]
[199.58763123 147.04670715]
[189.74870300 160.16644287]
[173.50178528 157.93717957]
[167.56031799 142.65219116]
[155.55993652 133.65269470]
[143.55955505 124.65319824]
[130.27264404 131.61437988]
[130.84027100 146.60363770]
[131.40788269 161.59289551]
[139.66186523 175.09039307]
[132.41172791 188.10133362]
[132.97933960 203.09059143]
[133.54696655 218.07984924]
[134.11459351 233.06910706]
[143.04127502 242.41903687]
[143.18168640 254.94381714]
[135.00733948 263.89788818]
[135.29119873 278.89520264]
[138.59437561 287.45989990]
[135.43582153 294.17837524]
[135.43582153 309.17837524]
[143.17312622 322.97857666]
[135.43582153 335.70584106]
[135.43582153 350.70584106]
[135.43582153 365.70584106]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[1 165]
[2 164]
[3 163]
[5 161]
[6 160]
[7 158]
[8 157]
[10 154]
[11 153]
[12 152]
[13 151]
[15 149]
[16 148]
[17 147]
[21 43]
[22 42]
[23 41]
[24 40]
[28 35]
[29 34]
[51 136]
[52 135]
[53 134]
[54 133]
[55 132]
[56 131]
[59 128]
[60 127]
[61 126]
[62 125]
[65 122]
[66 121]
[69 118]
[70 117]
[71 116]
[72 115]
[74 112]
[75 111]
[77 110]
[78 109]
[80 107]
[81 106]
[84 103]
[85 102]
[86 101]
[87 100]
[88 98]
[89 97]
[137 146]
[138 145]
[139 144]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
