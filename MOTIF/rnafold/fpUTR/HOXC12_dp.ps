%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:46:34 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (HOXC12)
} def

/sequence { (\
AUUUAACUAUGUUUAAUGUCAGAUAGCAAUAAAGUAGAAGCUGCCGGUCGGGCCCCGCGGAA\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 10 0.010310261 ubox
1 12 0.005048666 ubox
1 17 0.019127825 ubox
1 24 0.035203333 ubox
1 30 0.015979913 ubox
1 35 0.027048607 ubox
2 9 0.010991364 ubox
2 11 0.006082322 ubox
2 16 0.020710609 ubox
2 18 0.003213746 ubox
2 23 0.038022969 ubox
2 29 0.016980504 ubox
2 32 0.010132574 ubox
2 33 0.060753508 ubox
2 34 0.027348051 ubox
2 37 0.006548191 ubox
2 38 0.085263617 ubox
2 39 0.131565728 ubox
2 40 0.109778427 ubox
2 60 0.003369561 ubox
2 61 0.017581377 ubox
2 62 0.019572515 ubox
3 15 0.019229235 ubox
3 16 0.020301890 ubox
3 22 0.038553019 ubox
3 23 0.003738285 ubox
3 26 0.007538886 ubox
3 28 0.016786933 ubox
3 29 0.007395143 ubox
3 31 0.011228970 ubox
3 32 0.070333395 ubox
3 33 0.026630210 ubox
3 34 0.003312411 ubox
3 36 0.008238817 ubox
3 37 0.090029374 ubox
3 38 0.150214947 ubox
3 39 0.147970941 ubox
3 40 0.065783208 ubox
3 59 0.004179140 ubox
3 60 0.017399949 ubox
3 61 0.024913543 ubox
3 62 0.012906025 ubox
4 11 0.004950767 ubox
4 15 0.023388568 ubox
4 21 0.035446300 ubox
4 22 0.003897791 ubox
4 25 0.010009015 ubox
4 28 0.007964183 ubox
4 31 0.072339606 ubox
4 32 0.024270033 ubox
4 33 0.003800569 ubox
4 36 0.091108404 ubox
4 37 0.136724949 ubox
4 38 0.134850468 ubox
4 39 0.078118303 ubox
4 43 0.006039962 ubox
4 59 0.015215566 ubox
4 60 0.022052098 ubox
4 61 0.016575406 ubox
5 10 0.004991053 ubox
5 13 0.022684934 ubox
5 14 0.023228086 ubox
5 24 0.010040442 ubox
5 30 0.070648576 ubox
5 35 0.067844643 ubox
5 42 0.006800381 ubox
6 12 0.026240535 ubox
6 13 0.020001573 ubox
6 19 0.040233852 ubox
6 35 0.186095911 ubox
7 11 0.026716957 ubox
7 18 0.040659346 ubox
7 22 0.013065693 ubox
7 26 0.083453145 ubox
7 34 0.200293577 ubox
7 37 0.950492036 ubox
7 40 0.057795515 ubox
7 60 0.007607192 ubox
8 15 0.011163030 ubox
8 18 0.015629194 ubox
8 21 0.012429318 ubox
8 25 0.083605054 ubox
8 31 0.036551944 ubox
8 33 0.190784652 ubox
8 36 0.956018901 ubox
8 39 0.055842175 ubox
8 59 0.007100057 ubox
9 14 0.011678641 ubox
9 17 0.029060279 ubox
9 19 0.011343809 ubox
9 24 0.082606735 ubox
9 30 0.046494306 ubox
9 35 0.953968644 ubox
10 16 0.029753495 ubox
10 18 0.011479280 ubox
10 21 0.031040821 ubox
10 23 0.078108121 ubox
10 25 0.072031896 ubox
10 28 0.079438654 ubox
10 29 0.035610522 ubox
10 31 0.160742188 ubox
10 34 0.887358414 ubox
10 36 0.052087644 ubox
10 57 0.003249185 ubox
10 59 0.008123035 ubox
11 17 0.011245469 ubox
11 20 0.036543433 ubox
11 24 0.076570087 ubox
11 27 0.091073422 ubox
11 30 0.164623680 ubox
11 35 0.051518727 ubox
11 41 0.005929278 ubox
11 56 0.003445890 ubox
11 58 0.011627075 ubox
12 16 0.010487637 ubox
12 18 0.006615685 ubox
12 22 0.010392469 ubox
12 23 0.077357215 ubox
12 26 0.089402176 ubox
12 29 0.163137251 ubox
12 32 0.107936411 ubox
12 33 0.754272609 ubox
12 34 0.020217940 ubox
12 38 0.005580819 ubox
12 40 0.006004335 ubox
12 57 0.011343172 ubox
13 21 0.010804187 ubox
13 22 0.077688311 ubox
13 23 0.009529830 ubox
13 25 0.082231584 ubox
13 26 0.029550518 ubox
13 28 0.121208460 ubox
13 29 0.029485155 ubox
13 31 0.117553430 ubox
13 32 0.918592038 ubox
13 33 0.031048190 ubox
13 34 0.003262218 ubox
13 37 0.005935767 ubox
13 38 0.003225556 ubox
13 39 0.005764771 ubox
14 21 0.069250622 ubox
14 22 0.011163744 ubox
14 25 0.045858635 ubox
14 28 0.029465773 ubox
14 31 0.939751496 ubox
14 32 0.028979294 ubox
14 33 0.004286293 ubox
14 36 0.005923380 ubox
14 38 0.005409832 ubox
15 24 0.047830516 ubox
15 30 0.929936095 ubox
15 35 0.005607256 ubox
16 24 0.059720419 ubox
16 30 0.048623859 ubox
16 35 0.003871914 ubox
17 23 0.064274262 ubox
17 25 0.094145635 ubox
17 28 0.963942937 ubox
17 29 0.045363022 ubox
17 31 0.006143906 ubox
17 34 0.003849647 ubox
18 24 0.094418156 ubox
18 27 0.975378035 ubox
18 30 0.006884266 ubox
18 53 0.024377520 ubox
19 23 0.087565355 ubox
19 26 0.945897859 ubox
19 29 0.006872010 ubox
19 38 0.006399823 ubox
19 52 0.024472065 ubox
20 37 0.006857313 ubox
20 43 0.008309408 ubox
20 51 0.024133676 ubox
21 42 0.008458236 ubox
22 41 0.008447488 ubox
22 49 0.024720929 ubox
23 30 0.005742494 ubox
23 35 0.003606429 ubox
23 48 0.024904811 ubox
24 29 0.005671398 ubox
24 31 0.007001874 ubox
24 34 0.003557307 ubox
24 36 0.004676930 ubox
24 43 0.027100828 ubox
24 47 0.024492204 ubox
25 30 0.007425670 ubox
25 35 0.004177339 ubox
25 42 0.035424719 ubox
26 35 0.035743776 ubox
26 41 0.036498395 ubox
26 44 0.024001897 ubox
26 58 0.007030599 ubox
27 34 0.037257118 ubox
27 40 0.036620154 ubox
27 43 0.024060720 ubox
27 57 0.007038113 ubox
28 42 0.020798880 ubox
29 35 0.005396895 ubox
30 34 0.005137480 ubox
30 36 0.011563651 ubox
31 35 0.010405349 ubox
33 42 0.034538125 ubox
34 41 0.037662379 ubox
34 44 0.012763258 ubox
34 58 0.003529987 ubox
35 40 0.036636405 ubox
35 43 0.013610775 ubox
35 57 0.003467959 ubox
36 42 0.014178334 ubox
37 41 0.013966328 ubox
40 48 0.004509015 ubox
40 53 0.023487557 ubox
40 58 0.402703337 ubox
41 47 0.004728514 ubox
41 51 0.005127637 ubox
41 52 0.023510815 ubox
41 57 0.403008070 ubox
41 60 0.885934559 ubox
42 46 0.004265218 ubox
42 50 0.005402673 ubox
42 51 0.022081213 ubox
42 57 0.005067730 ubox
42 59 0.889282118 ubox
43 49 0.005553499 ubox
43 53 0.421812653 ubox
43 56 0.009039422 ubox
43 58 0.891779469 ubox
44 51 0.018461112 ubox
44 52 0.422168206 ubox
44 57 0.864603782 ubox
44 60 0.154304951 ubox
45 50 0.021313011 ubox
45 51 0.422049433 ubox
45 57 0.216467039 ubox
45 59 0.154860547 ubox
46 54 0.404122559 ubox
46 55 0.733171654 ubox
46 56 0.304494038 ubox
46 58 0.144660801 ubox
47 53 0.412425747 ubox
47 54 0.726353400 ubox
47 55 0.302782522 ubox
47 58 0.047877577 ubox
48 52 0.393084470 ubox
48 57 0.015248562 ubox
48 60 0.005514283 ubox
48 61 0.003282648 ubox
49 57 0.149180872 ubox
49 59 0.007234053 ubox
49 60 0.003479640 ubox
50 56 0.153910503 ubox
50 58 0.007262672 ubox
51 55 0.151445676 ubox
52 58 0.006824480 ubox
53 57 0.006801233 ubox
53 60 0.013039895 ubox
54 59 0.016156314 ubox
54 60 0.067175425 ubox
55 59 0.066848234 ubox
7 37 0.9500000 lbox
8 36 0.9500000 lbox
9 35 0.9500000 lbox
10 34 0.9500000 lbox
12 33 0.9500000 lbox
13 32 0.9500000 lbox
14 31 0.9500000 lbox
15 30 0.9500000 lbox
17 28 0.9500000 lbox
18 27 0.9500000 lbox
19 26 0.9500000 lbox
41 60 0.9500000 lbox
42 59 0.9500000 lbox
43 58 0.9500000 lbox
44 57 0.9500000 lbox
46 55 0.9500000 lbox
47 54 0.9500000 lbox
showpage
end
%%EOF
