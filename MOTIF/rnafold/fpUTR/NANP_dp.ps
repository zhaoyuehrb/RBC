%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:27:00 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (NANP)
} def

/sequence { (\
AGUCCGCCUUGCGCAUGCGCAGGCGGCGGUGGCAAGGCUACGGUUCGCGCCAGCGGCCGGCGCU\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 9 0.005293854 ubox
1 39 0.016567905 ubox
1 45 0.019684699 ubox
1 64 0.068132979 ubox
2 8 0.006142041 ubox
2 14 0.007399067 ubox
2 16 0.016320571 ubox
2 18 0.003555782 ubox
2 27 0.502800223 ubox
2 30 0.026108056 ubox
2 33 0.163555053 ubox
2 38 0.017110551 ubox
2 41 0.059528653 ubox
2 44 0.026155230 ubox
2 57 0.003425508 ubox
2 61 0.067497087 ubox
2 63 0.079471717 ubox
3 13 0.005519325 ubox
3 15 0.017105530 ubox
3 17 0.003530249 ubox
3 26 0.079049670 ubox
3 29 0.012680362 ubox
3 32 0.157784916 ubox
3 37 0.016693716 ubox
3 40 0.058566286 ubox
3 43 0.022119399 ubox
3 60 0.063410001 ubox
3 62 0.076044793 ubox
4 25 0.059388916 ubox
4 26 0.808798575 ubox
4 28 0.007094530 ubox
4 29 0.164508559 ubox
4 31 0.052545713 ubox
4 32 0.031889033 ubox
4 36 0.015852179 ubox
4 37 0.003269590 ubox
4 42 0.028465497 ubox
4 43 0.074817815 ubox
4 59 0.041885943 ubox
4 60 0.049522171 ubox
5 11 0.004140871 ubox
5 13 0.030234762 ubox
5 25 0.922775378 ubox
5 28 0.170962627 ubox
5 31 0.032117277 ubox
5 36 0.003496922 ubox
5 42 0.075341875 ubox
5 59 0.047141171 ubox
5 62 0.041867378 ubox
6 12 0.031200869 ubox
6 14 0.012682248 ubox
6 24 0.933903407 ubox
6 27 0.171177005 ubox
6 30 0.032145932 ubox
6 33 0.028885635 ubox
6 38 0.296181635 ubox
6 41 0.030588799 ubox
6 57 0.008473665 ubox
6 58 0.004655977 ubox
6 61 0.043318044 ubox
6 63 0.004253483 ubox
7 11 0.030977305 ubox
7 13 0.012680282 ubox
7 23 0.931231971 ubox
7 26 0.171043727 ubox
7 29 0.032144958 ubox
7 32 0.028914567 ubox
7 37 0.298236985 ubox
7 56 0.009295523 ubox
7 60 0.043269075 ubox
7 62 0.004195389 ubox
8 22 0.928406354 ubox
8 23 0.100699361 ubox
8 25 0.156302282 ubox
8 28 0.030838016 ubox
8 31 0.028854025 ubox
8 36 0.298478127 ubox
8 55 0.009090316 ubox
8 59 0.041969910 ubox
9 21 0.670339026 ubox
9 22 0.174652684 ubox
9 23 0.023549831 ubox
9 26 0.019773587 ubox
9 29 0.005629292 ubox
9 35 0.298323173 ubox
10 19 0.201324229 ubox
10 21 0.669156296 ubox
10 22 0.011407381 ubox
10 25 0.020175961 ubox
10 28 0.005981868 ubox
10 34 0.298321638 ubox
11 18 0.206160414 ubox
11 20 0.927471919 ubox
11 24 0.021686341 ubox
11 27 0.010077913 ubox
11 30 0.003755245 ubox
11 33 0.298471562 ubox
11 54 0.003225333 ubox
11 57 0.013451429 ubox
11 58 0.005923828 ubox
11 63 0.051793644 ubox
12 17 0.205882864 ubox
12 19 0.927531555 ubox
12 23 0.021626388 ubox
12 25 0.014371051 ubox
12 26 0.008336096 ubox
12 28 0.034702960 ubox
12 31 0.039361418 ubox
12 32 0.295241858 ubox
12 53 0.003231282 ubox
12 55 0.034965096 ubox
12 56 0.010326801 ubox
12 62 0.051882019 ubox
13 18 0.903518210 ubox
13 20 0.031672516 ubox
13 24 0.015638662 ubox
13 27 0.051647485 ubox
13 30 0.055504849 ubox
13 54 0.036175196 ubox
13 57 0.006932183 ubox
13 61 0.051888001 ubox
14 19 0.031710785 ubox
14 23 0.015641851 ubox
14 26 0.051605425 ubox
14 29 0.057357222 ubox
14 31 0.279727297 ubox
14 53 0.036148714 ubox
14 56 0.006934106 ubox
14 60 0.051870341 ubox
15 30 0.279009358 ubox
16 25 0.053992203 ubox
16 28 0.095590496 ubox
16 29 0.251108973 ubox
16 52 0.021959280 ubox
16 55 0.004539485 ubox
16 59 0.007236084 ubox
17 24 0.063296632 ubox
17 27 0.114676365 ubox
17 30 0.004443195 ubox
17 50 0.029318564 ubox
17 51 0.021444717 ubox
17 54 0.005107621 ubox
17 57 0.036795093 ubox
17 58 0.007322734 ubox
17 63 0.034924303 ubox
18 23 0.063290429 ubox
18 25 0.022182912 ubox
18 26 0.113403591 ubox
18 28 0.265767438 ubox
18 29 0.003682412 ubox
18 49 0.029809807 ubox
18 53 0.005106029 ubox
18 55 0.045224268 ubox
18 56 0.026247436 ubox
18 62 0.034983600 ubox
19 24 0.027741764 ubox
19 27 0.270000423 ubox
19 48 0.029519647 ubox
19 50 0.020795030 ubox
19 54 0.052347192 ubox
19 61 0.034988280 ubox
20 26 0.269806473 ubox
20 47 0.029387479 ubox
20 49 0.020705193 ubox
20 53 0.052315245 ubox
20 60 0.034859930 ubox
21 45 0.003735858 ubox
22 45 0.005973160 ubox
22 46 0.023345894 ubox
22 51 0.052599675 ubox
22 58 0.036127196 ubox
22 64 0.027072321 ubox
23 44 0.004603139 ubox
23 45 0.017852405 ubox
23 48 0.024536561 ubox
23 50 0.052668599 ubox
23 57 0.036263129 ubox
23 63 0.036809756 ubox
24 43 0.004410597 ubox
24 47 0.024735700 ubox
24 49 0.052638742 ubox
24 56 0.036225077 ubox
24 59 0.013340776 ubox
24 62 0.038443754 ubox
25 45 0.056761922 ubox
25 46 0.034627540 ubox
25 48 0.050096417 ubox
25 51 0.004304180 ubox
25 58 0.027128176 ubox
25 61 0.049086194 ubox
25 64 0.091821140 ubox
26 33 0.126854961 ubox
26 44 0.279554235 ubox
26 45 0.027540830 ubox
26 48 0.012451764 ubox
26 50 0.004480391 ubox
26 54 0.033311670 ubox
26 57 0.027647669 ubox
26 61 0.039101705 ubox
26 63 0.325887236 ubox
27 32 0.133161185 ubox
27 37 0.003305940 ubox
27 42 0.090893542 ubox
27 43 0.549251108 ubox
27 47 0.017262693 ubox
27 49 0.004511462 ubox
27 53 0.033287341 ubox
27 55 0.041841142 ubox
27 56 0.022918026 ubox
27 59 0.208311441 ubox
27 60 0.030121724 ubox
27 62 0.354374028 ubox
28 39 0.033173969 ubox
28 41 0.069068362 ubox
28 45 0.006287851 ubox
28 46 0.027232119 ubox
28 48 0.004403044 ubox
28 51 0.039123052 ubox
28 54 0.048045335 ubox
28 58 0.217227268 ubox
28 61 0.357686180 ubox
28 64 0.038546699 ubox
29 38 0.035083323 ubox
29 41 0.704275715 ubox
29 45 0.006969926 ubox
29 50 0.039215161 ubox
29 54 0.016513804 ubox
29 57 0.217256711 ubox
29 61 0.010444539 ubox
29 63 0.042674192 ubox
30 37 0.034839328 ubox
30 40 0.709885542 ubox
30 49 0.038569024 ubox
30 52 0.054823496 ubox
30 53 0.009682083 ubox
30 56 0.216824667 ubox
30 59 0.352758038 ubox
30 60 0.008321365 ubox
30 62 0.041798510 ubox
31 39 0.710904173 ubox
31 48 0.033761630 ubox
31 51 0.058630241 ubox
31 58 0.354446639 ubox
31 61 0.034917486 ubox
31 64 0.050186178 ubox
32 38 0.711450622 ubox
32 48 0.019965174 ubox
32 50 0.058645103 ubox
32 54 0.217037076 ubox
32 57 0.354456414 ubox
32 61 0.026238973 ubox
32 63 0.056594571 ubox
33 37 0.706280051 ubox
33 47 0.027219667 ubox
33 49 0.058572149 ubox
33 53 0.216788017 ubox
33 56 0.353762546 ubox
33 60 0.033412019 ubox
33 62 0.056570307 ubox
34 45 0.012150246 ubox
35 44 0.010745991 ubox
35 45 0.011573383 ubox
35 64 0.045423683 ubox
36 44 0.009546528 ubox
36 45 0.116834602 ubox
36 46 0.042993591 ubox
36 51 0.258899392 ubox
36 58 0.038709139 ubox
36 63 0.045660085 ubox
36 64 0.418090339 ubox
37 44 0.142981110 ubox
37 45 0.030799328 ubox
37 48 0.043139208 ubox
37 50 0.259252860 ubox
37 54 0.292733136 ubox
37 57 0.038724304 ubox
37 61 0.076829505 ubox
37 63 0.464633574 ubox
38 43 0.147847887 ubox
38 47 0.043226354 ubox
38 49 0.257968292 ubox
38 53 0.293207872 ubox
38 56 0.038676519 ubox
38 60 0.076661049 ubox
38 62 0.465219955 ubox
39 52 0.273074850 ubox
39 55 0.035200854 ubox
39 59 0.035016391 ubox
41 47 0.170040292 ubox
41 49 0.104224070 ubox
41 59 0.539549870 ubox
41 62 0.004885349 ubox
42 46 0.161087648 ubox
42 48 0.116436047 ubox
42 51 0.277937294 ubox
42 58 0.562805146 ubox
42 61 0.005579713 ubox
42 64 0.026369699 ubox
43 50 0.278740282 ubox
43 54 0.003756593 ubox
43 57 0.562825083 ubox
43 61 0.019626125 ubox
43 63 0.029015419 ubox
44 49 0.263232069 ubox
44 53 0.003797422 ubox
44 56 0.400660968 ubox
44 60 0.014897951 ubox
44 62 0.028270481 ubox
45 52 0.003252816 ubox
45 55 0.077505460 ubox
45 56 0.392276515 ubox
45 59 0.005298162 ubox
45 60 0.035356412 ubox
46 55 0.572539020 ubox
46 59 0.042611239 ubox
46 62 0.018190816 ubox
47 54 0.579033936 ubox
47 58 0.042800732 ubox
47 61 0.019357421 ubox
47 63 0.703041708 ubox
48 53 0.578825629 ubox
48 55 0.004514228 ubox
48 59 0.004326124 ubox
48 60 0.018909506 ubox
48 62 0.703915216 ubox
49 54 0.004576959 ubox
49 57 0.048128270 ubox
49 58 0.004135888 ubox
49 61 0.703954779 ubox
50 56 0.048356764 ubox
50 60 0.703962315 ubox
51 55 0.048023353 ubox
51 59 0.703578188 ubox
52 64 0.042293703 ubox
53 61 0.006383008 ubox
53 63 0.048894775 ubox
54 60 0.006408560 ubox
54 62 0.048923659 ubox
55 61 0.048852292 ubox
55 64 0.014987475 ubox
56 63 0.030854616 ubox
57 62 0.030832835 ubox
5 25 0.9500000 lbox
6 24 0.9500000 lbox
7 23 0.9500000 lbox
8 22 0.9500000 lbox
9 21 0.9500000 lbox
11 20 0.9500000 lbox
12 19 0.9500000 lbox
13 18 0.9500000 lbox
26 44 0.9500000 lbox
27 43 0.9500000 lbox
29 41 0.9500000 lbox
30 40 0.9500000 lbox
31 39 0.9500000 lbox
32 38 0.9500000 lbox
33 37 0.9500000 lbox
47 63 0.9500000 lbox
48 62 0.9500000 lbox
49 61 0.9500000 lbox
50 60 0.9500000 lbox
51 59 0.9500000 lbox
showpage
end
%%EOF
