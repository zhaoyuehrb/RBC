%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:32:52 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (APOBEC3C)
} def

/sequence { (\
UUAAAGAGGGCUGCUCAACUGCAAGGACGCUGUAAGCAGGAAGAGAAGCCACAGCGCUUCAGAAAAGAGUGGGACAGGGACAAGCAUAUCUAAGAGGCUGAAC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 7 0.033809531 ubox
1 8 0.037877285 ubox
1 54 0.003359293 ubox
1 80 0.005516834 ubox
1 93 0.003394508 ubox
1 95 0.009163483 ubox
1 101 0.016203050 ubox
1 102 0.016976536 ubox
2 6 0.032924249 ubox
2 7 0.040693101 ubox
2 8 0.022138469 ubox
2 9 0.003952082 ubox
2 53 0.004064284 ubox
2 78 0.003215200 ubox
2 79 0.006130622 ubox
2 92 0.003682918 ubox
2 94 0.009778661 ubox
2 100 0.015728561 ubox
2 101 0.019765400 ubox
3 99 0.014530515 ubox
4 59 0.003479055 ubox
5 58 0.005220008 ubox
5 91 0.027781810 ubox
5 99 0.006445711 ubox
6 16 0.009379322 ubox
6 57 0.005748947 ubox
6 59 0.008821702 ubox
6 60 0.008058024 ubox
6 90 0.028785857 ubox
6 98 0.006049864 ubox
7 15 0.009387637 ubox
7 58 0.011632107 ubox
7 59 0.007855708 ubox
7 89 0.028497517 ubox
7 91 0.004598991 ubox
7 99 0.007323804 ubox
8 14 0.009373271 ubox
8 50 0.071103740 ubox
8 57 0.012640305 ubox
8 58 0.007663290 ubox
8 90 0.004726471 ubox
8 98 0.006917920 ubox
8 99 0.005446401 ubox
9 49 0.051332236 ubox
9 50 0.991893394 ubox
9 57 0.007567134 ubox
9 89 0.003698632 ubox
9 98 0.005622852 ubox
9 99 0.011977804 ubox
10 49 0.994340348 ubox
10 55 0.015878079 ubox
10 70 0.003333881 ubox
10 85 0.026776715 ubox
10 98 0.012589416 ubox
11 25 0.003466270 ubox
11 39 0.011311038 ubox
11 48 0.995510933 ubox
11 54 0.015883986 ubox
11 69 0.003436967 ubox
11 72 0.078183498 ubox
11 73 0.005511341 ubox
11 77 0.030068165 ubox
11 84 0.026692972 ubox
11 96 0.005264003 ubox
11 97 0.012396672 ubox
12 23 0.007987345 ubox
12 38 0.012208246 ubox
12 47 0.884078544 ubox
12 53 0.015858655 ubox
12 68 0.003417540 ubox
12 71 0.078376300 ubox
12 72 0.004198077 ubox
12 76 0.030314292 ubox
12 82 0.010507034 ubox
12 83 0.023790485 ubox
12 86 0.003527999 ubox
12 95 0.004978470 ubox
12 96 0.010190204 ubox
13 22 0.010767754 ubox
13 37 0.013015092 ubox
13 52 0.015701045 ubox
13 70 0.081380952 ubox
13 75 0.030426924 ubox
13 81 0.014831269 ubox
13 85 0.003835917 ubox
14 21 0.010770547 ubox
14 36 0.013016543 ubox
14 43 0.018322292 ubox
14 45 0.988141740 ubox
14 67 0.003411363 ubox
14 69 0.081737936 ubox
14 73 0.030288804 ubox
14 79 0.014356974 ubox
14 84 0.003832168 ubox
14 94 0.005644360 ubox
14 96 0.003921912 ubox
15 35 0.012640307 ubox
15 41 0.006359200 ubox
15 42 0.017620255 ubox
15 44 0.994592740 ubox
15 46 0.006217112 ubox
15 66 0.003325282 ubox
15 68 0.081718835 ubox
15 72 0.030259846 ubox
15 78 0.014323839 ubox
15 80 0.010556548 ubox
15 83 0.003530893 ubox
15 93 0.005356781 ubox
15 95 0.004340467 ubox
16 40 0.007584491 ubox
16 43 0.992863763 ubox
16 45 0.006522943 ubox
16 67 0.081561709 ubox
16 71 0.030201937 ubox
16 77 0.014151726 ubox
16 79 0.010725325 ubox
16 94 0.004370908 ubox
17 70 0.025885013 ubox
18 33 0.012973057 ubox
18 70 0.015042857 ubox
19 25 0.004072910 ubox
19 26 0.006508402 ubox
19 32 0.013258274 ubox
19 36 0.008538634 ubox
19 39 0.993185067 ubox
19 40 0.060137424 ubox
19 62 0.080573310 ubox
19 67 0.014668541 ubox
19 69 0.020880676 ubox
19 72 0.011479365 ubox
19 77 0.011301603 ubox
20 24 0.003685359 ubox
20 25 0.006383151 ubox
20 34 0.014729301 ubox
20 35 0.007146684 ubox
20 38 0.994754924 ubox
20 39 0.033108248 ubox
20 61 0.080857019 ubox
20 66 0.014646253 ubox
20 68 0.020613420 ubox
20 71 0.011440689 ubox
20 76 0.011334519 ubox
21 30 0.017259118 ubox
21 33 0.025327009 ubox
21 37 0.995247695 ubox
21 60 0.080587006 ubox
21 70 0.011451696 ubox
21 75 0.011284884 ubox
22 29 0.017665862 ubox
22 32 0.035875576 ubox
22 36 0.992186449 ubox
22 69 0.011467002 ubox
22 71 0.004087821 ubox
23 31 0.046295832 ubox
23 59 0.047919702 ubox
23 70 0.003992487 ubox
24 31 0.480572666 ubox
24 58 0.047014439 ubox
24 59 0.055754968 ubox
25 30 0.501522934 ubox
25 31 0.351694983 ubox
25 57 0.044446579 ubox
25 58 0.070834316 ubox
25 59 0.004064444 ubox
25 60 0.022247508 ubox
26 30 0.346082479 ubox
26 57 0.072795990 ubox
26 58 0.004209495 ubox
26 59 0.022664893 ubox
26 60 0.011725519 ubox
27 33 0.320352122 ubox
27 58 0.022666972 ubox
27 59 0.011029748 ubox
28 32 0.319466252 ubox
28 56 0.089561933 ubox
29 37 0.010641401 ubox
29 55 0.090252382 ubox
30 36 0.011303962 ubox
30 39 0.007920116 ubox
30 54 0.090256845 ubox
31 35 0.012152812 ubox
31 38 0.008370963 ubox
31 53 0.090234467 ubox
32 37 0.008422846 ubox
32 52 0.090236820 ubox
33 51 0.088248536 ubox
36 49 0.079363539 ubox
37 48 0.079403173 ubox
39 50 0.040653452 ubox
40 49 0.040643733 ubox
45 60 0.011558533 ubox
46 59 0.011586446 ubox
47 58 0.011610186 ubox
47 99 0.003978016 ubox
48 57 0.011624689 ubox
48 98 0.004103891 ubox
49 56 0.011604964 ubox
49 97 0.004104521 ubox
50 96 0.004099648 ubox
51 99 0.004242663 ubox
52 71 0.004998733 ubox
52 100 0.961630502 ubox
53 70 0.004115613 ubox
53 99 0.965369633 ubox
54 70 0.005662906 ubox
54 98 0.963831289 ubox
55 69 0.006919490 ubox
55 71 0.056608514 ubox
55 97 0.962809840 ubox
55 100 0.066234264 ubox
56 70 0.070615328 ubox
56 85 0.028275470 ubox
56 98 0.239201753 ubox
56 99 0.014021053 ubox
57 67 0.015730077 ubox
57 69 0.071576317 ubox
57 72 0.007083586 ubox
57 73 0.013023513 ubox
57 77 0.007773459 ubox
57 84 0.028293490 ubox
57 94 0.734009916 ubox
57 96 0.561499686 ubox
57 97 0.242325467 ubox
58 65 0.003242513 ubox
58 66 0.015740611 ubox
58 67 0.003187623 ubox
58 68 0.065029153 ubox
58 69 0.018920096 ubox
58 71 0.006377515 ubox
58 72 0.009771711 ubox
58 73 0.030830330 ubox
58 74 0.005990952 ubox
58 76 0.007251302 ubox
58 83 0.027392934 ubox
58 93 0.732956673 ubox
58 94 0.183699131 ubox
58 95 0.548703135 ubox
58 96 0.250714161 ubox
58 102 0.034321599 ubox
59 64 0.003734315 ubox
59 65 0.014898457 ubox
59 66 0.004444863 ubox
59 67 0.056197923 ubox
59 68 0.046039208 ubox
59 72 0.048932301 ubox
59 73 0.007078856 ubox
59 74 0.006802971 ubox
59 78 0.003234070 ubox
59 79 0.004316944 ubox
59 80 0.009031597 ubox
59 82 0.020834738 ubox
59 92 0.720698783 ubox
59 93 0.197501297 ubox
59 94 0.514805113 ubox
59 95 0.273704562 ubox
59 101 0.041131281 ubox
60 67 0.058254971 ubox
60 71 0.072149118 ubox
60 72 0.008413686 ubox
60 73 0.008125995 ubox
60 77 0.005267790 ubox
60 78 0.005279668 ubox
60 79 0.010051807 ubox
60 94 0.290087365 ubox
60 96 0.005747102 ubox
60 100 0.042341817 ubox
61 70 0.071970356 ubox
61 91 0.920990342 ubox
61 99 0.042331469 ubox
62 90 0.939773664 ubox
62 98 0.042289335 ubox
63 89 0.917841769 ubox
66 91 0.256550024 ubox
67 90 0.263365193 ubox
68 89 0.260273029 ubox
68 91 0.014808959 ubox
68 99 0.008317346 ubox
69 75 0.027268847 ubox
69 81 0.151479562 ubox
69 85 0.135503154 ubox
69 87 0.308118877 ubox
69 89 0.013895664 ubox
69 90 0.014692382 ubox
69 98 0.008570424 ubox
70 74 0.024617204 ubox
70 76 0.023670509 ubox
70 80 0.151142058 ubox
70 82 0.879472101 ubox
70 84 0.130375487 ubox
70 86 0.333633149 ubox
70 88 0.025224334 ubox
70 92 0.019934282 ubox
70 97 0.008547348 ubox
71 75 0.024868062 ubox
71 81 0.889364388 ubox
71 85 0.335112090 ubox
71 87 0.025765718 ubox
71 90 0.006810675 ubox
71 91 0.021748459 ubox
71 99 0.003459399 ubox
72 89 0.006440222 ubox
72 90 0.021838668 ubox
72 91 0.027818036 ubox
72 98 0.004829871 ubox
72 99 0.005911181 ubox
73 89 0.015391135 ubox
73 90 0.028637691 ubox
73 98 0.006721786 ubox
74 89 0.026570262 ubox
75 100 0.043195275 ubox
76 91 0.031715344 ubox
76 99 0.043332225 ubox
77 90 0.033137114 ubox
77 91 0.020087421 ubox
77 98 0.043257997 ubox
78 89 0.031043172 ubox
78 90 0.020505642 ubox
78 91 0.089816794 ubox
78 98 0.003624080 ubox
79 89 0.014305912 ubox
79 90 0.092279051 ubox
80 89 0.090626577 ubox
81 100 0.037154899 ubox
82 99 0.026353850 ubox
83 91 0.021828477 ubox
83 99 0.074151291 ubox
84 90 0.022396421 ubox
84 98 0.080672267 ubox
85 97 0.080567403 ubox
85 100 0.007530111 ubox
86 99 0.007299307 ubox
89 95 0.039581659 ubox
89 97 0.009100580 ubox
89 101 0.008366193 ubox
90 94 0.040482401 ubox
90 96 0.024905960 ubox
90 97 0.007369203 ubox
90 100 0.008934463 ubox
91 95 0.022498658 ubox
91 96 0.007818492 ubox
93 99 0.005753129 ubox
94 98 0.005840823 ubox
9 50 0.9500000 lbox
10 49 0.9500000 lbox
11 48 0.9500000 lbox
12 47 0.9500000 lbox
14 45 0.9500000 lbox
15 44 0.9500000 lbox
16 43 0.9500000 lbox
19 39 0.9500000 lbox
20 38 0.9500000 lbox
21 37 0.9500000 lbox
22 36 0.9500000 lbox
52 100 0.9500000 lbox
53 99 0.9500000 lbox
54 98 0.9500000 lbox
55 97 0.9500000 lbox
57 94 0.9500000 lbox
58 93 0.9500000 lbox
59 92 0.9500000 lbox
61 91 0.9500000 lbox
62 90 0.9500000 lbox
63 89 0.9500000 lbox
70 82 0.9500000 lbox
71 81 0.9500000 lbox
showpage
end
%%EOF
