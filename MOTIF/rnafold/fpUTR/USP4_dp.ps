%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 04:08:32 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (USP4)
} def

/sequence { (\
GUGCGUGCGUGGGCGCGGUCUAUAGCACGCCGCGCGCGGGGCGGAUGUCCGGGCCGGCUGGGCCGGGGCCGCGGAGGAG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 8 0.013914775 ubox
1 14 0.014891596 ubox
1 16 0.003373719 ubox
1 28 0.008508576 ubox
1 33 0.152318231 ubox
1 35 0.109100918 ubox
1 37 0.229610794 ubox
1 42 0.112011410 ubox
1 46 0.088563668 ubox
1 72 0.038014410 ubox
2 7 0.013363947 ubox
2 11 0.005241441 ubox
2 13 0.015265896 ubox
2 15 0.003424197 ubox
2 27 0.008517609 ubox
2 32 0.151668593 ubox
2 34 0.109178533 ubox
2 36 0.229811102 ubox
2 38 0.123117389 ubox
2 41 0.111269488 ubox
2 43 0.034248538 ubox
2 45 0.092229640 ubox
2 71 0.037747015 ubox
2 73 0.049915681 ubox
3 8 0.004101856 ubox
3 10 0.010337509 ubox
3 14 0.012684245 ubox
3 26 0.008518409 ubox
3 30 0.154130895 ubox
3 31 0.107395351 ubox
3 33 0.106600041 ubox
3 35 0.230014078 ubox
3 37 0.162386726 ubox
3 42 0.045656462 ubox
3 48 0.063651120 ubox
3 70 0.034182528 ubox
3 72 0.064860125 ubox
4 9 0.010708542 ubox
4 11 0.015558664 ubox
4 13 0.013199924 ubox
4 17 0.007169868 ubox
4 25 0.008026336 ubox
4 29 0.208747783 ubox
4 32 0.106353593 ubox
4 34 0.230001688 ubox
4 36 0.162516290 ubox
4 38 0.902588287 ubox
4 41 0.045222706 ubox
4 43 0.095924880 ubox
4 47 0.083736155 ubox
4 71 0.064694181 ubox
4 73 0.013930685 ubox
5 10 0.010090772 ubox
5 14 0.003589366 ubox
5 16 0.010548612 ubox
5 28 0.210450387 ubox
5 31 0.105015230 ubox
5 33 0.229887634 ubox
5 35 0.161833126 ubox
5 37 0.913692399 ubox
5 42 0.095967565 ubox
5 46 0.084767719 ubox
5 70 0.060661928 ubox
5 72 0.011640184 ubox
6 13 0.003614135 ubox
6 15 0.010587263 ubox
6 27 0.210900957 ubox
6 32 0.229151274 ubox
6 34 0.161629893 ubox
6 36 0.913393314 ubox
6 38 0.062684517 ubox
6 41 0.094576958 ubox
6 43 0.043534725 ubox
6 45 0.085155883 ubox
6 71 0.011296930 ubox
6 73 0.004770036 ubox
7 14 0.016450207 ubox
7 26 0.211071616 ubox
7 30 0.158122431 ubox
7 31 0.195884687 ubox
7 33 0.161580285 ubox
7 35 0.913891866 ubox
7 37 0.079632826 ubox
7 42 0.057931308 ubox
7 69 0.023559090 ubox
7 70 0.008439027 ubox
7 72 0.006246325 ubox
8 13 0.016807064 ubox
8 25 0.210946842 ubox
8 29 0.197194011 ubox
8 32 0.161500482 ubox
8 34 0.913927182 ubox
8 36 0.079706981 ubox
8 38 0.058151728 ubox
8 41 0.057965244 ubox
8 43 0.085728204 ubox
8 68 0.023560071 ubox
8 71 0.006247367 ubox
8 73 0.034817549 ubox
9 23 0.188121788 ubox
9 28 0.196967731 ubox
9 30 0.169556323 ubox
9 31 0.098978019 ubox
9 33 0.913843373 ubox
9 35 0.079582770 ubox
9 37 0.058312298 ubox
9 42 0.085755529 ubox
9 70 0.005185752 ubox
9 72 0.035285383 ubox
10 22 0.209946494 ubox
10 27 0.194882864 ubox
10 29 0.181622330 ubox
10 32 0.899358559 ubox
10 34 0.079518544 ubox
10 36 0.057737895 ubox
10 38 0.099263333 ubox
10 41 0.079715697 ubox
10 71 0.035099126 ubox
11 20 0.004439420 ubox
11 21 0.215719666 ubox
11 26 0.178345343 ubox
11 28 0.178682617 ubox
11 31 0.792654379 ubox
11 33 0.079184827 ubox
11 35 0.050869073 ubox
11 37 0.130488803 ubox
11 70 0.033870542 ubox
12 19 0.005707651 ubox
12 20 0.232361593 ubox
12 21 0.028889305 ubox
12 30 0.663864802 ubox
12 31 0.474381223 ubox
12 64 0.003847077 ubox
12 69 0.032559410 ubox
12 70 0.010512493 ubox
13 19 0.231648465 ubox
13 20 0.028826750 ubox
13 26 0.183834983 ubox
13 30 0.639579501 ubox
13 33 0.050334226 ubox
13 35 0.137614145 ubox
13 63 0.003848778 ubox
13 69 0.014031428 ubox
14 18 0.230644095 ubox
14 25 0.187447093 ubox
14 29 0.767523805 ubox
14 32 0.050342836 ubox
14 34 0.137903827 ubox
14 62 0.003849241 ubox
14 68 0.016765978 ubox
14 73 0.022727530 ubox
15 26 0.591558629 ubox
15 28 0.699862136 ubox
15 30 0.099155495 ubox
15 31 0.035943194 ubox
15 33 0.137988570 ubox
15 72 0.032104369 ubox
16 25 0.609861693 ubox
16 29 0.128520453 ubox
16 32 0.137995285 ubox
16 60 0.003208749 ubox
16 65 0.035235561 ubox
16 71 0.032134850 ubox
17 28 0.129605104 ubox
17 31 0.138010469 ubox
17 64 0.035307720 ubox
17 70 0.032614734 ubox
18 26 0.670587215 ubox
18 28 0.013160351 ubox
18 30 0.137979842 ubox
18 63 0.035309080 ubox
18 69 0.032629753 ubox
19 25 0.655905747 ubox
19 27 0.015391185 ubox
19 29 0.133789487 ubox
19 62 0.035275862 ubox
19 68 0.032553195 ubox
19 78 0.003657923 ubox
20 61 0.035279190 ubox
20 67 0.032519131 ubox
20 77 0.003911830 ubox
21 60 0.034300444 ubox
21 66 0.031907410 ubox
21 76 0.003785860 ubox
22 59 0.033535491 ubox
25 63 0.026899947 ubox
25 72 0.004456548 ubox
26 60 0.018690518 ubox
26 62 0.026692455 ubox
26 71 0.004452479 ubox
27 59 0.018979600 ubox
28 43 0.006557128 ubox
28 60 0.021112767 ubox
29 42 0.007106739 ubox
29 58 0.048113338 ubox
29 59 0.004517042 ubox
30 39 0.015026931 ubox
30 40 0.004442368 ubox
30 41 0.007127920 ubox
30 44 0.034789223 ubox
30 57 0.048493910 ubox
30 74 0.081462555 ubox
30 77 0.022414412 ubox
31 38 0.020243807 ubox
31 39 0.005909272 ubox
31 40 0.009223397 ubox
31 43 0.043129666 ubox
31 47 0.007298857 ubox
31 56 0.048664735 ubox
31 73 0.114020296 ubox
31 76 0.031350542 ubox
32 37 0.019836083 ubox
32 42 0.043286494 ubox
32 46 0.006753919 ubox
32 55 0.048642164 ubox
32 72 0.114586492 ubox
33 41 0.043281337 ubox
33 43 0.031386797 ubox
33 71 0.114414564 ubox
33 73 0.020249673 ubox
34 42 0.041001750 ubox
34 54 0.048988967 ubox
34 69 0.005554903 ubox
34 70 0.109327651 ubox
34 72 0.022168396 ubox
35 41 0.041171041 ubox
35 43 0.093310927 ubox
35 53 0.049401272 ubox
35 68 0.007766908 ubox
35 71 0.022148093 ubox
35 73 0.121465248 ubox
36 42 0.094596173 ubox
36 69 0.059046812 ubox
36 70 0.020681385 ubox
36 72 0.124310735 ubox
37 41 0.093913884 ubox
37 43 0.008436562 ubox
37 51 0.049584646 ubox
37 68 0.059055415 ubox
37 71 0.124293240 ubox
37 73 0.106860576 ubox
38 42 0.008285357 ubox
38 50 0.045959002 ubox
38 70 0.121598415 ubox
38 72 0.117042352 ubox
39 49 0.041523507 ubox
39 50 0.072510983 ubox
39 69 0.102478818 ubox
39 70 0.008005599 ubox
40 48 0.035518974 ubox
40 49 0.076873943 ubox
40 50 0.004907149 ubox
40 64 0.003323968 ubox
40 69 0.008560149 ubox
40 70 0.122310566 ubox
41 48 0.085571874 ubox
41 49 0.004903483 ubox
41 63 0.003317570 ubox
41 69 0.122637678 ubox
41 72 0.950417786 ubox
42 47 0.088884771 ubox
42 51 0.036033318 ubox
42 62 0.003302294 ubox
42 65 0.020420993 ubox
42 68 0.122688358 ubox
42 71 0.951261700 ubox
42 73 0.071605008 ubox
43 50 0.037568256 ubox
43 64 0.020434278 ubox
43 70 0.950619955 ubox
43 72 0.075775675 ubox
44 49 0.037466116 ubox
44 63 0.016417588 ubox
44 69 0.834625641 ubox
46 65 0.005494037 ubox
46 71 0.010100749 ubox
46 73 0.003392873 ubox
47 63 0.032605749 ubox
47 64 0.004152056 ubox
47 69 0.488928389 ubox
47 70 0.011277954 ubox
47 72 0.004042036 ubox
48 62 0.036361994 ubox
48 66 0.004680704 ubox
48 67 0.534891160 ubox
48 68 0.761362041 ubox
48 71 0.003470788 ubox
48 74 0.009499581 ubox
48 75 0.140555411 ubox
48 78 0.004300825 ubox
49 61 0.036684807 ubox
49 65 0.004492586 ubox
49 66 0.592605492 ubox
49 67 0.781341357 ubox
49 68 0.027134602 ubox
49 73 0.014608550 ubox
49 74 0.161236851 ubox
49 77 0.004793559 ubox
50 60 0.036689232 ubox
50 65 0.593005265 ubox
50 66 0.781185071 ubox
50 67 0.025759569 ubox
50 71 0.017799241 ubox
50 73 0.161306623 ubox
50 76 0.004535316 ubox
51 59 0.036649513 ubox
51 64 0.581298495 ubox
51 70 0.035913956 ubox
51 72 0.160731260 ubox
52 58 0.036646413 ubox
52 63 0.568931868 ubox
52 64 0.791958207 ubox
52 69 0.036333043 ubox
52 70 0.161536278 ubox
53 63 0.801211990 ubox
53 69 0.161579807 ubox
54 61 0.556646273 ubox
54 62 0.809769186 ubox
54 66 0.083758655 ubox
54 67 0.037248207 ubox
54 68 0.148371939 ubox
54 77 0.003242853 ubox
55 60 0.556248014 ubox
55 61 0.809432475 ubox
55 65 0.108276793 ubox
55 66 0.032351812 ubox
55 67 0.132393527 ubox
55 71 0.004965215 ubox
55 76 0.003389368 ubox
56 64 0.173134126 ubox
56 70 0.006011888 ubox
57 63 0.173673931 ubox
57 69 0.006018821 ubox
58 62 0.172412898 ubox
58 66 0.010238323 ubox
58 68 0.006001440 ubox
58 74 0.006470931 ubox
59 65 0.010323388 ubox
59 67 0.005938500 ubox
59 73 0.006660234 ubox
60 64 0.009883790 ubox
60 72 0.006730840 ubox
61 70 0.008395821 ubox
62 69 0.008410125 ubox
63 68 0.008387348 ubox
69 77 0.037762070 ubox
70 76 0.042392110 ubox
4 38 0.9500000 lbox
5 37 0.9500000 lbox
6 36 0.9500000 lbox
7 35 0.9500000 lbox
8 34 0.9500000 lbox
9 33 0.9500000 lbox
10 32 0.9500000 lbox
11 31 0.9500000 lbox
12 30 0.9500000 lbox
15 26 0.9500000 lbox
16 25 0.9500000 lbox
41 72 0.9500000 lbox
42 71 0.9500000 lbox
43 70 0.9500000 lbox
44 69 0.9500000 lbox
48 68 0.9500000 lbox
49 67 0.9500000 lbox
50 66 0.9500000 lbox
52 64 0.9500000 lbox
53 63 0.9500000 lbox
54 62 0.9500000 lbox
55 61 0.9500000 lbox
showpage
end
%%EOF
