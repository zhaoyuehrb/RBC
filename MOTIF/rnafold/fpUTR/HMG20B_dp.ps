%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:08:36 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (HMG20B)
} def

/sequence { (\
GUUGGUUGGAGCGUCGCGCAGUCGGGAGGUCCGGGAAAGUUUCUUUGGAGGUCCGGCCCGGAGCGGCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 12 0.864033367 ubox
1 17 0.009082627 ubox
1 64 0.029506908 ubox
1 67 0.102969379 ubox
2 9 0.013592238 ubox
2 10 0.047852752 ubox
2 11 0.863410181 ubox
2 16 0.008274459 ubox
2 21 0.006095175 ubox
2 38 0.005361718 ubox
2 61 0.005770120 ubox
2 62 0.003799973 ubox
2 63 0.029288406 ubox
2 66 0.103179237 ubox
3 8 0.016034515 ubox
3 9 0.053803299 ubox
3 10 0.847600803 ubox
3 13 0.016906502 ubox
3 16 0.015040781 ubox
3 20 0.008723245 ubox
3 24 0.016674211 ubox
3 33 0.003360656 ubox
3 36 0.003518374 ubox
3 37 0.005873836 ubox
3 38 0.003252018 ubox
3 60 0.008266254 ubox
3 61 0.003900511 ubox
3 62 0.027217843 ubox
3 65 0.102720627 ubox
4 12 0.065621877 ubox
4 15 0.023143656 ubox
4 19 0.009019929 ubox
4 23 0.021006347 ubox
4 32 0.004164543 ubox
4 54 0.004778374 ubox
4 58 0.035353915 ubox
4 59 0.008547390 ubox
4 64 0.102695745 ubox
4 68 0.160392593 ubox
5 12 0.149443929 ubox
5 14 0.020903680 ubox
5 17 0.008520254 ubox
5 19 0.007102639 ubox
5 22 0.020004409 ubox
5 31 0.004161169 ubox
5 53 0.004742306 ubox
5 57 0.035987350 ubox
5 58 0.006947680 ubox
5 64 0.011349806 ubox
5 67 0.162182229 ubox
6 11 0.142535373 ubox
6 13 0.007939102 ubox
6 16 0.006813495 ubox
6 18 0.006970033 ubox
6 21 0.019795376 ubox
6 34 0.014693335 ubox
6 56 0.036306630 ubox
6 61 0.046190459 ubox
6 62 0.088118232 ubox
6 63 0.012721417 ubox
6 66 0.161407145 ubox
7 13 0.006402076 ubox
7 16 0.023048799 ubox
7 20 0.021532377 ubox
7 24 0.015696048 ubox
7 33 0.039082686 ubox
7 55 0.036233570 ubox
7 60 0.075973359 ubox
7 61 0.063514046 ubox
7 62 0.010699078 ubox
7 65 0.150465148 ubox
8 12 0.018566485 ubox
8 15 0.033690914 ubox
8 17 0.007207096 ubox
8 19 0.021347646 ubox
8 23 0.019883516 ubox
8 32 0.048838638 ubox
8 54 0.037409620 ubox
8 58 0.004077039 ubox
8 59 0.096993985 ubox
8 64 0.131820720 ubox
8 68 0.080141845 ubox
9 14 0.024825922 ubox
9 15 0.029667390 ubox
9 22 0.019815148 ubox
9 23 0.013803584 ubox
9 31 0.048973214 ubox
9 53 0.037401779 ubox
9 57 0.003503910 ubox
9 58 0.096956858 ubox
9 67 0.080455117 ubox
10 14 0.025880675 ubox
10 22 0.013290156 ubox
10 30 0.041841572 ubox
10 52 0.034516114 ubox
11 17 0.028970125 ubox
11 19 0.133685552 ubox
11 22 0.008377021 ubox
11 30 0.088349053 ubox
11 52 0.007748420 ubox
11 57 0.010392804 ubox
11 64 0.093883325 ubox
11 67 0.058321335 ubox
12 16 0.028929306 ubox
12 18 0.133829640 ubox
12 21 0.009352876 ubox
12 29 0.116620780 ubox
12 51 0.014789012 ubox
12 56 0.010290867 ubox
12 60 0.015273000 ubox
12 63 0.096135632 ubox
12 65 0.076111115 ubox
12 66 0.056020085 ubox
13 17 0.125217041 ubox
13 19 0.009558311 ubox
13 57 0.003534666 ubox
13 59 0.014897096 ubox
13 64 0.078939522 ubox
13 67 0.937774237 ubox
14 18 0.008953374 ubox
14 27 0.117561954 ubox
14 49 0.014499492 ubox
14 56 0.003603756 ubox
14 61 0.072695549 ubox
14 62 0.063746122 ubox
14 63 0.076263681 ubox
14 66 0.938892189 ubox
15 24 0.007106565 ubox
15 26 0.117958469 ubox
15 48 0.014501798 ubox
15 55 0.004016117 ubox
15 60 0.074546545 ubox
15 61 0.066402505 ubox
15 65 0.937733017 ubox
16 23 0.006927580 ubox
16 40 0.009476029 ubox
16 54 0.003851042 ubox
16 57 0.003661735 ubox
16 59 0.074059818 ubox
16 64 0.936281430 ubox
16 67 0.154243702 ubox
17 21 0.004432310 ubox
17 24 0.117943578 ubox
17 39 0.009556579 ubox
17 47 0.008625432 ubox
17 56 0.003633885 ubox
17 60 0.103920415 ubox
17 63 0.933824168 ubox
17 65 0.235349940 ubox
17 66 0.113669552 ubox
18 23 0.110419851 ubox
18 46 0.007720616 ubox
18 52 0.003775427 ubox
18 57 0.043166874 ubox
18 59 0.113490610 ubox
18 64 0.265755215 ubox
18 67 0.024384771 ubox
19 29 0.003310040 ubox
19 51 0.003828203 ubox
19 56 0.042756803 ubox
19 63 0.266964452 ubox
19 66 0.024395455 ubox
20 44 0.007158690 ubox
21 43 0.007232667 ubox
21 57 0.554196449 ubox
21 64 0.016327053 ubox
21 67 0.016085600 ubox
22 29 0.013083616 ubox
22 34 0.013314839 ubox
22 35 0.004132772 ubox
22 49 0.004068820 ubox
22 56 0.555141263 ubox
22 61 0.583813901 ubox
22 62 0.101877421 ubox
22 63 0.014241422 ubox
22 66 0.016110480 ubox
23 28 0.017726965 ubox
23 33 0.015231310 ubox
23 34 0.004496483 ubox
23 48 0.004129697 ubox
23 55 0.556498780 ubox
23 60 0.812856449 ubox
23 61 0.075893143 ubox
23 65 0.016128016 ubox
24 32 0.015332047 ubox
24 54 0.541648550 ubox
24 58 0.021654032 ubox
24 59 0.818247239 ubox
24 64 0.016022893 ubox
24 68 0.010386749 ubox
25 31 0.015309223 ubox
25 32 0.005057459 ubox
25 46 0.004089083 ubox
25 52 0.003522689 ubox
25 53 0.526102513 ubox
25 54 0.140167333 ubox
25 57 0.023016926 ubox
25 58 0.818114142 ubox
25 59 0.029592895 ubox
25 67 0.010492450 ubox
25 68 0.011159654 ubox
26 30 0.009919830 ubox
26 31 0.005082845 ubox
26 45 0.004155936 ubox
26 52 0.439658037 ubox
26 53 0.189985059 ubox
26 57 0.817007874 ubox
26 58 0.024999701 ubox
26 67 0.011391922 ubox
27 44 0.004194398 ubox
27 52 0.226150978 ubox
28 43 0.004195149 ubox
28 53 0.032761505 ubox
28 54 0.792265068 ubox
28 58 0.024106770 ubox
28 59 0.016837911 ubox
29 42 0.003919904 ubox
29 52 0.030263692 ubox
29 53 0.791909398 ubox
29 57 0.031880152 ubox
29 58 0.016839295 ubox
29 64 0.010850568 ubox
30 48 0.069797644 ubox
30 49 0.626593823 ubox
30 51 0.026690656 ubox
30 56 0.006775964 ubox
30 62 0.067689196 ubox
30 63 0.005781823 ubox
31 47 0.071253023 ubox
31 48 0.639258346 ubox
31 50 0.016113139 ubox
31 51 0.728563650 ubox
31 55 0.005422387 ubox
31 56 0.198771348 ubox
31 61 0.107065620 ubox
32 47 0.639120149 ubox
32 50 0.728763037 ubox
32 55 0.198929043 ubox
32 60 0.107304535 ubox
33 42 0.003951418 ubox
33 43 0.025240166 ubox
33 44 0.145981632 ubox
33 45 0.377699198 ubox
33 46 0.518558653 ubox
33 54 0.197540865 ubox
33 59 0.107439005 ubox
34 40 0.003858641 ubox
34 41 0.005342803 ubox
34 42 0.026205264 ubox
34 43 0.165859255 ubox
34 44 0.516918842 ubox
34 45 0.391896562 ubox
34 46 0.022671903 ubox
34 53 0.195892969 ubox
34 54 0.049569200 ubox
34 58 0.107435611 ubox
35 40 0.005029226 ubox
35 41 0.026903079 ubox
35 42 0.162872866 ubox
35 43 0.616369405 ubox
35 44 0.211118850 ubox
35 45 0.028459282 ubox
35 46 0.145076894 ubox
35 52 0.185305298 ubox
35 53 0.055670487 ubox
35 57 0.107358671 ubox
36 40 0.023637265 ubox
36 41 0.152438544 ubox
36 42 0.609107766 ubox
36 44 0.030394100 ubox
36 45 0.145569507 ubox
36 46 0.661423319 ubox
36 52 0.060289152 ubox
37 41 0.464262880 ubox
37 44 0.132400273 ubox
37 45 0.670433605 ubox
37 46 0.078197970 ubox
38 44 0.671054406 ubox
38 45 0.076101827 ubox
38 46 0.029577886 ubox
39 43 0.657170536 ubox
39 44 0.058293152 ubox
39 45 0.029115767 ubox
39 52 0.043461722 ubox
39 64 0.005891063 ubox
39 67 0.009144896 ubox
40 48 0.034378858 ubox
40 49 0.051505278 ubox
40 50 0.044573618 ubox
40 51 0.182533643 ubox
40 63 0.005868738 ubox
40 66 0.009151751 ubox
41 47 0.034246618 ubox
41 48 0.050411231 ubox
41 49 0.052591703 ubox
41 50 0.192178279 ubox
41 51 0.008555237 ubox
41 62 0.005848649 ubox
41 65 0.008579833 ubox
42 47 0.037074848 ubox
42 48 0.052806234 ubox
42 49 0.198912301 ubox
42 50 0.004649190 ubox
42 51 0.038573992 ubox
42 61 0.005830686 ubox
43 47 0.051366424 ubox
43 48 0.199249966 ubox
43 50 0.039799220 ubox
43 51 0.017176597 ubox
43 56 0.005231570 ubox
43 60 0.005808657 ubox
43 63 0.009419424 ubox
44 49 0.036849704 ubox
44 50 0.016918461 ubox
44 55 0.004305906 ubox
44 62 0.009459021 ubox
45 49 0.013019443 ubox
45 56 0.030322992 ubox
45 61 0.009457804 ubox
46 55 0.032477321 ubox
46 60 0.009445064 ubox
47 54 0.038950164 ubox
47 59 0.009438822 ubox
47 68 0.004087746 ubox
48 53 0.038840619 ubox
48 58 0.008872707 ubox
48 67 0.004133884 ubox
50 58 0.003612165 ubox
50 68 0.006500278 ubox
51 57 0.004791660 ubox
51 64 0.003801601 ubox
51 67 0.006570765 ubox
52 56 0.004502495 ubox
52 62 0.007862869 ubox
53 61 0.008573904 ubox
53 66 0.006446257 ubox
54 60 0.008578431 ubox
54 65 0.006488475 ubox
55 59 0.008031894 ubox
55 64 0.006366848 ubox
55 68 0.059619414 ubox
56 67 0.060213380 ubox
57 66 0.059653648 ubox
58 65 0.058987575 ubox
58 66 0.012828834 ubox
59 65 0.016536430 ubox
60 64 0.017305704 ubox
60 68 0.010550594 ubox
61 67 0.010623776 ubox
1 12 0.9500000 lbox
2 11 0.9500000 lbox
3 10 0.9500000 lbox
13 67 0.9500000 lbox
14 66 0.9500000 lbox
15 65 0.9500000 lbox
16 64 0.9500000 lbox
17 63 0.9500000 lbox
23 60 0.9500000 lbox
24 59 0.9500000 lbox
25 58 0.9500000 lbox
26 57 0.9500000 lbox
28 54 0.9500000 lbox
29 53 0.9500000 lbox
31 51 0.9500000 lbox
32 50 0.9500000 lbox
36 46 0.9500000 lbox
37 45 0.9500000 lbox
38 44 0.9500000 lbox
39 43 0.9500000 lbox
showpage
end
%%EOF
