%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 04:01:16 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (TNN)
} def

/sequence { (\
AAGUACCAAGGUCUGCGGCAGGAGGAGACCGGCUCACAGGAGCAGCAGCAUUGGAAGAGGCACCCAGCAGCCUCCCAGGCAUCCUGGAGGGUCUGCUCCCUGUCUUUCCAAGG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 106 0.004049505 ubox
1 107 0.003845137 ubox
2 14 0.263599471 ubox
2 105 0.004604418 ubox
2 106 0.004302185 ubox
3 12 0.004055252 ubox
3 13 0.271898064 ubox
3 16 0.199461238 ubox
3 37 0.004922347 ubox
3 46 0.018985589 ubox
3 49 0.020531098 ubox
3 104 0.003214847 ubox
4 11 0.015294856 ubox
4 15 0.197937934 ubox
4 36 0.004817961 ubox
4 45 0.018579968 ubox
4 48 0.020075271 ubox
5 12 0.298305391 ubox
5 14 0.166599654 ubox
6 11 0.309906377 ubox
6 18 0.005478239 ubox
6 32 0.008326956 ubox
6 54 0.017580689 ubox
6 113 0.824479952 ubox
7 15 0.032885737 ubox
7 17 0.005750066 ubox
7 31 0.014315704 ubox
7 53 0.017731974 ubox
7 112 0.833746347 ubox
8 14 0.031713939 ubox
8 52 0.017839376 ubox
8 106 0.010273574 ubox
8 107 0.022247868 ubox
9 51 0.015919759 ubox
9 105 0.011321371 ubox
9 106 0.024243097 ubox
9 107 0.006520405 ubox
10 30 0.127896785 ubox
10 52 0.003789297 ubox
10 104 0.010997612 ubox
10 105 0.024904597 ubox
10 106 0.007529299 ubox
10 107 0.003491223 ubox
10 108 0.038332972 ubox
10 109 0.893153700 ubox
11 19 0.005098645 ubox
11 29 0.128060005 ubox
11 43 0.003277940 ubox
11 46 0.010769197 ubox
11 49 0.033621392 ubox
11 51 0.008698494 ubox
11 103 0.004473809 ubox
11 104 0.024097400 ubox
11 105 0.007774159 ubox
11 106 0.003837796 ubox
11 107 0.037852037 ubox
11 108 0.893198345 ubox
12 18 0.005122728 ubox
12 28 0.128027544 ubox
12 40 0.018170746 ubox
12 41 0.003419548 ubox
12 48 0.009948056 ubox
12 50 0.009764348 ubox
12 113 0.035188430 ubox
13 17 0.005272178 ubox
13 21 0.003357539 ubox
13 27 0.128005355 ubox
13 39 0.023066721 ubox
13 40 0.003175952 ubox
13 45 0.015970719 ubox
13 48 0.040054661 ubox
13 112 0.059832055 ubox
13 113 0.009202491 ubox
14 20 0.003908535 ubox
14 23 0.003941645 ubox
14 26 0.127277986 ubox
14 38 0.023174269 ubox
14 44 0.016147579 ubox
14 47 0.040505160 ubox
14 50 0.020424479 ubox
14 110 0.038725245 ubox
14 111 0.055553555 ubox
14 112 0.009269745 ubox
15 19 0.004299564 ubox
15 37 0.023192147 ubox
15 43 0.016175047 ubox
15 46 0.040587386 ubox
15 49 0.024772856 ubox
15 103 0.209794640 ubox
15 109 0.048173070 ubox
16 31 0.005405204 ubox
16 42 0.016169347 ubox
16 45 0.040371865 ubox
16 48 0.024686491 ubox
16 102 0.213376462 ubox
17 30 0.010503235 ubox
17 34 0.013965622 ubox
17 35 0.020564069 ubox
17 100 0.004271574 ubox
17 101 0.213077463 ubox
17 104 0.954827929 ubox
17 105 0.061405883 ubox
17 106 0.004972883 ubox
17 107 0.005122488 ubox
17 108 0.009937827 ubox
17 109 0.014560565 ubox
18 29 0.010476822 ubox
18 33 0.024897739 ubox
18 43 0.031993404 ubox
18 46 0.024599552 ubox
18 100 0.210757002 ubox
18 103 0.963873557 ubox
18 104 0.063099379 ubox
18 107 0.004010071 ubox
18 108 0.013752631 ubox
19 32 0.024917235 ubox
19 42 0.032062332 ubox
19 45 0.024665567 ubox
19 102 0.966764322 ubox
20 34 0.003597176 ubox
20 101 0.964630721 ubox
21 30 0.039392724 ubox
21 33 0.003696547 ubox
21 99 0.597237609 ubox
21 100 0.789365767 ubox
22 29 0.039331054 ubox
22 35 0.023473772 ubox
22 98 0.815498833 ubox
22 99 0.561511867 ubox
23 34 0.023488145 ubox
23 97 0.986176009 ubox
24 30 0.013371901 ubox
24 33 0.023479714 ubox
24 96 0.987186685 ubox
24 97 0.067554962 ubox
24 98 0.019088705 ubox
25 29 0.013175367 ubox
25 35 0.026112625 ubox
25 96 0.070565781 ubox
25 97 0.011004523 ubox
26 34 0.026125522 ubox
26 94 0.986949823 ubox
27 33 0.026059672 ubox
27 93 0.990164880 ubox
28 92 0.990051403 ubox
29 90 0.007775477 ubox
29 91 0.990085658 ubox
30 89 0.010406855 ubox
30 90 0.985031484 ubox
32 43 0.199752980 ubox
32 46 0.005355822 ubox
32 49 0.003848381 ubox
33 42 0.200184687 ubox
33 45 0.005298776 ubox
33 48 0.003841471 ubox
33 57 0.004434086 ubox
33 87 0.038161602 ubox
33 89 0.963416213 ubox
33 90 0.009764704 ubox
33 91 0.003444610 ubox
34 41 0.200163322 ubox
34 44 0.004812409 ubox
34 47 0.003613505 ubox
34 55 0.015804752 ubox
34 56 0.006154393 ubox
34 86 0.015437872 ubox
34 87 0.004187788 ubox
34 88 0.974570570 ubox
34 89 0.019153862 ubox
34 90 0.003786149 ubox
35 39 0.004030658 ubox
35 40 0.199775693 ubox
35 54 0.016639241 ubox
35 86 0.006667646 ubox
35 87 0.974533476 ubox
35 89 0.010879328 ubox
36 85 0.004664598 ubox
37 53 0.019599065 ubox
37 86 0.976662562 ubox
38 52 0.019525442 ubox
38 85 0.978214210 ubox
39 51 0.019011869 ubox
39 84 0.978492021 ubox
40 51 0.003967200 ubox
40 82 0.003776584 ubox
40 83 0.978460314 ubox
41 51 0.004412268 ubox
41 82 0.969046332 ubox
42 49 0.185959618 ubox
42 80 0.667870899 ubox
43 48 0.185979850 ubox
43 53 0.006401597 ubox
43 79 0.668161465 ubox
43 86 0.004225722 ubox
44 52 0.011382071 ubox
44 85 0.006763378 ubox
45 51 0.012547628 ubox
45 71 0.018003424 ubox
45 80 0.523507583 ubox
45 84 0.006945136 ubox
46 53 0.083561228 ubox
46 70 0.018071682 ubox
46 79 0.524206707 ubox
46 86 0.008526007 ubox
47 52 0.075648170 ubox
47 85 0.008530823 ubox
48 68 0.018714730 ubox
48 71 0.004964569 ubox
48 80 0.414902447 ubox
48 84 0.007704196 ubox
49 67 0.018622381 ubox
49 70 0.005006599 ubox
49 79 0.417855702 ubox
50 82 0.004300983 ubox
51 67 0.008027001 ubox
51 78 0.915114458 ubox
51 79 0.008869504 ubox
51 81 0.004954638 ubox
51 111 0.117774222 ubox
51 112 0.004311663 ubox
52 56 0.003548843 ubox
52 66 0.018611443 ubox
52 77 0.967788219 ubox
52 78 0.014666648 ubox
52 81 0.009585569 ubox
52 110 0.135593834 ubox
52 111 0.004325561 ubox
53 64 0.007872876 ubox
53 65 0.019769462 ubox
53 75 0.018874875 ubox
53 76 0.976744612 ubox
53 80 0.010407894 ubox
53 109 0.138593867 ubox
54 63 0.007997946 ubox
54 64 0.019691087 ubox
54 74 0.018125008 ubox
54 75 0.971690330 ubox
54 108 0.138602266 ubox
55 73 0.014804568 ubox
55 107 0.116295107 ubox
56 73 0.009203300 ubox
56 106 0.087746948 ubox
56 107 0.075702317 ubox
57 72 0.006788044 ubox
57 74 0.982481634 ubox
57 105 0.053825356 ubox
57 106 0.107029906 ubox
58 73 0.989451262 ubox
58 105 0.128281060 ubox
59 72 0.989894651 ubox
59 104 0.139645076 ubox
60 68 0.009073918 ubox
60 71 0.989899377 ubox
60 103 0.139652879 ubox
61 67 0.009908823 ubox
61 70 0.989690537 ubox
61 102 0.139696493 ubox
62 101 0.135427515 ubox
66 97 0.135455872 ubox
67 96 0.139726664 ubox
68 95 0.139738627 ubox
69 94 0.139642429 ubox
70 80 0.010609970 ubox
70 92 0.018702704 ubox
70 93 0.138352261 ubox
71 79 0.010622192 ubox
71 90 0.026162745 ubox
71 91 0.129240001 ubox
72 78 0.010648663 ubox
72 89 0.032738492 ubox
72 90 0.128960425 ubox
72 91 0.046156954 ubox
73 77 0.009593489 ubox
73 88 0.033784057 ubox
73 89 0.123186554 ubox
73 90 0.046229208 ubox
74 87 0.027835661 ubox
74 89 0.053972125 ubox
75 86 0.019756360 ubox
75 87 0.202512818 ubox
76 86 0.203807619 ubox
77 85 0.204706427 ubox
78 84 0.204753628 ubox
79 83 0.201446448 ubox
82 88 0.004716230 ubox
83 87 0.004998431 ubox
84 89 0.003994347 ubox
103 113 0.005121248 ubox
104 112 0.021971281 ubox
104 113 0.008350651 ubox
105 111 0.025331864 ubox
105 112 0.017532677 ubox
105 113 0.008412374 ubox
106 110 0.021739931 ubox
106 111 0.016248786 ubox
106 112 0.013571270 ubox
106 113 0.007727349 ubox
107 111 0.011617282 ubox
107 112 0.009830171 ubox
107 113 0.014149712 ubox
108 112 0.022160184 ubox
6 113 0.9500000 lbox
7 112 0.9500000 lbox
10 109 0.9500000 lbox
11 108 0.9500000 lbox
17 104 0.9500000 lbox
18 103 0.9500000 lbox
19 102 0.9500000 lbox
20 101 0.9500000 lbox
21 100 0.9500000 lbox
22 99 0.9500000 lbox
23 97 0.9500000 lbox
24 96 0.9500000 lbox
26 94 0.9500000 lbox
27 93 0.9500000 lbox
28 92 0.9500000 lbox
29 91 0.9500000 lbox
30 90 0.9500000 lbox
33 89 0.9500000 lbox
34 88 0.9500000 lbox
35 87 0.9500000 lbox
37 86 0.9500000 lbox
38 85 0.9500000 lbox
39 84 0.9500000 lbox
40 83 0.9500000 lbox
41 82 0.9500000 lbox
42 80 0.9500000 lbox
43 79 0.9500000 lbox
51 78 0.9500000 lbox
52 77 0.9500000 lbox
53 76 0.9500000 lbox
54 75 0.9500000 lbox
57 74 0.9500000 lbox
58 73 0.9500000 lbox
59 72 0.9500000 lbox
60 71 0.9500000 lbox
61 70 0.9500000 lbox
showpage
end
%%EOF
