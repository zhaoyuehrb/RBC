%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 04:01:50 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (HES3)
} def

/sequence { (\
UGGGCACGGAGCCUGCUGCCCGGGGCAGCCUCCCCGGCAACUUCCGAAAGAUUUCCAAGCCGCUG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 8 0.007749178 ubox
1 15 0.111227283 ubox
1 22 0.086989978 ubox
1 36 0.034308060 ubox
1 39 0.005549237 ubox
1 46 0.020200970 ubox
1 57 0.119859085 ubox
1 62 0.068631492 ubox
1 65 0.017689936 ubox
2 7 0.072548047 ubox
2 13 0.017892555 ubox
2 14 0.340858435 ubox
2 21 0.425715450 ubox
2 30 0.003299928 ubox
2 33 0.003992756 ubox
2 34 0.027952590 ubox
2 35 0.123850112 ubox
2 38 0.005978373 ubox
2 42 0.006191118 ubox
2 45 0.028784869 ubox
2 53 0.003447124 ubox
2 55 0.005511397 ubox
2 56 0.133005178 ubox
2 61 0.091996078 ubox
2 64 0.032721012 ubox
3 12 0.017023662 ubox
3 13 0.356692607 ubox
3 17 0.008451523 ubox
3 20 0.427224138 ubox
3 32 0.003263412 ubox
3 33 0.026775413 ubox
3 34 0.125072697 ubox
3 35 0.125017828 ubox
3 41 0.006644349 ubox
3 44 0.028552952 ubox
3 52 0.004300345 ubox
3 54 0.005073356 ubox
3 55 0.132486729 ubox
3 56 0.019131666 ubox
3 60 0.081493494 ubox
3 61 0.728612039 ubox
3 63 0.027047700 ubox
3 64 0.117917584 ubox
4 12 0.356984063 ubox
4 16 0.019229700 ubox
4 19 0.427568081 ubox
4 32 0.025420513 ubox
4 33 0.089329982 ubox
4 34 0.126422632 ubox
4 38 0.059995791 ubox
4 43 0.007117864 ubox
4 52 0.006136850 ubox
4 53 0.008363162 ubox
4 54 0.107047073 ubox
4 55 0.019183858 ubox
4 60 0.730537493 ubox
4 63 0.123968987 ubox
5 11 0.356805301 ubox
5 15 0.019297364 ubox
5 18 0.427533978 ubox
5 37 0.060187883 ubox
5 59 0.730919357 ubox
5 62 0.122940138 ubox
5 65 0.011230869 ubox
6 14 0.018002462 ubox
6 17 0.424403490 ubox
6 64 0.010704712 ubox
7 15 0.424644422 ubox
7 18 0.015202533 ubox
7 22 0.007664744 ubox
7 36 0.045163608 ubox
7 46 0.260916291 ubox
7 62 0.013625088 ubox
7 65 0.006106507 ubox
8 14 0.422183224 ubox
8 17 0.023916032 ubox
8 21 0.010141915 ubox
8 30 0.016165719 ubox
8 31 0.019969013 ubox
8 32 0.007885878 ubox
8 33 0.605621688 ubox
8 34 0.040194835 ubox
8 35 0.041655140 ubox
8 44 0.030690269 ubox
8 45 0.292072247 ubox
8 55 0.047514426 ubox
8 56 0.465376909 ubox
8 61 0.015175089 ubox
8 64 0.003592947 ubox
9 13 0.413197532 ubox
9 16 0.030693320 ubox
9 20 0.010166651 ubox
9 29 0.015522082 ubox
9 30 0.020285764 ubox
9 31 0.004913174 ubox
9 32 0.613893653 ubox
9 33 0.029723101 ubox
9 34 0.040289881 ubox
9 43 0.031325697 ubox
9 44 0.292110496 ubox
9 53 0.003535667 ubox
9 54 0.048043540 ubox
9 55 0.465776725 ubox
9 60 0.015013639 ubox
9 63 0.003531720 ubox
10 17 0.020392576 ubox
10 31 0.614725126 ubox
10 42 0.054546714 ubox
10 43 0.287396877 ubox
10 52 0.005513870 ubox
10 53 0.069107007 ubox
10 54 0.455871365 ubox
10 64 0.017085917 ubox
11 16 0.038837601 ubox
11 19 0.059015797 ubox
11 26 0.026860352 ubox
11 29 0.026496483 ubox
11 30 0.613330159 ubox
11 38 0.070966428 ubox
11 41 0.070322963 ubox
11 42 0.254273853 ubox
11 52 0.077843241 ubox
11 53 0.373353982 ubox
11 60 0.004092161 ubox
11 63 0.017554909 ubox
12 18 0.059227329 ubox
12 24 0.005604830 ubox
12 25 0.026825048 ubox
12 28 0.023769005 ubox
12 37 0.071261025 ubox
12 59 0.004350405 ubox
12 62 0.017531331 ubox
13 23 0.006096295 ubox
13 24 0.026720791 ubox
13 28 0.286625942 ubox
13 36 0.071110643 ubox
13 37 0.003439404 ubox
13 50 0.258436791 ubox
13 59 0.003339127 ubox
14 22 0.006527161 ubox
14 23 0.026501882 ubox
14 27 0.288244340 ubox
14 36 0.003733620 ubox
14 39 0.140149551 ubox
14 46 0.026118259 ubox
14 49 0.256077375 ubox
14 57 0.005181775 ubox
14 58 0.003241485 ubox
15 21 0.006892008 ubox
15 26 0.288340530 ubox
15 29 0.632885493 ubox
15 38 0.143083715 ubox
15 45 0.037580511 ubox
15 56 0.006079491 ubox
15 60 0.069303539 ubox
15 61 0.007227422 ubox
15 63 0.122987460 ubox
16 24 0.010341113 ubox
16 25 0.288147858 ubox
16 28 0.633893256 ubox
16 37 0.123079421 ubox
16 50 0.104378130 ubox
16 59 0.069761471 ubox
16 62 0.123156971 ubox
17 23 0.014480471 ubox
17 24 0.284572972 ubox
17 27 0.633827103 ubox
17 36 0.094149103 ubox
17 39 0.499781963 ubox
17 46 0.040045079 ubox
17 49 0.086280828 ubox
17 57 0.007043776 ubox
17 58 0.058335001 ubox
18 26 0.633995528 ubox
18 35 0.084155349 ubox
18 38 0.534728387 ubox
18 45 0.038825445 ubox
18 56 0.009305824 ubox
18 60 0.087418448 ubox
18 61 0.003518570 ubox
18 63 0.013074421 ubox
19 25 0.633987631 ubox
19 37 0.441539845 ubox
19 59 0.087211299 ubox
19 62 0.013071874 ubox
20 24 0.629377177 ubox
20 36 0.322076441 ubox
20 37 0.343823718 ubox
21 36 0.465571611 ubox
21 46 0.050721160 ubox
21 65 0.006376589 ubox
22 30 0.017564130 ubox
22 31 0.049095201 ubox
22 32 0.059870870 ubox
22 33 0.099445587 ubox
22 34 0.197099002 ubox
22 35 0.662613601 ubox
22 43 0.003258714 ubox
22 44 0.031216172 ubox
22 45 0.060859462 ubox
22 56 0.004406198 ubox
22 61 0.003945228 ubox
22 64 0.042080364 ubox
23 29 0.017584385 ubox
23 30 0.054835445 ubox
23 31 0.060231174 ubox
23 32 0.099854803 ubox
23 33 0.197706702 ubox
23 34 0.668478699 ubox
23 35 0.030389163 ubox
23 42 0.004946602 ubox
23 43 0.032021742 ubox
23 44 0.060789855 ubox
23 45 0.014397511 ubox
23 55 0.004359677 ubox
23 56 0.004186841 ubox
23 60 0.003889097 ubox
23 61 0.005329877 ubox
23 63 0.046775762 ubox
24 29 0.054858212 ubox
24 30 0.068903677 ubox
24 31 0.093859132 ubox
24 32 0.197548729 ubox
24 33 0.668483201 ubox
24 34 0.030679550 ubox
24 41 0.006038596 ubox
24 42 0.045977071 ubox
24 43 0.050178226 ubox
24 44 0.014386721 ubox
24 45 0.004542677 ubox
24 54 0.003764542 ubox
24 55 0.004184630 ubox
24 56 0.003398848 ubox
24 60 0.004796077 ubox
24 61 0.068628914 ubox
24 64 0.011404828 ubox
25 29 0.068096928 ubox
25 30 0.105608543 ubox
25 31 0.158814034 ubox
25 32 0.661761099 ubox
25 33 0.030518994 ubox
25 41 0.056766614 ubox
25 42 0.032661444 ubox
25 43 0.012860323 ubox
25 44 0.004544447 ubox
25 54 0.003656697 ubox
25 55 0.003396858 ubox
25 60 0.068731264 ubox
25 63 0.011989945 ubox
26 59 0.068639284 ubox
26 62 0.011979209 ubox
26 65 0.011437952 ubox
27 42 0.003472543 ubox
27 53 0.004578967 ubox
27 64 0.011660690 ubox
28 38 0.102657059 ubox
28 52 0.004324204 ubox
28 60 0.007443519 ubox
28 63 0.011683829 ubox
29 37 0.102839036 ubox
29 59 0.007313469 ubox
29 62 0.010981265 ubox
30 36 0.102848349 ubox
30 37 0.004767952 ubox
30 50 0.062141665 ubox
31 36 0.004437270 ubox
31 47 0.008550034 ubox
31 49 0.059783503 ubox
31 51 0.051053218 ubox
32 46 0.007929475 ubox
32 50 0.054397384 ubox
35 46 0.508773042 ubox
35 62 0.303121319 ubox
35 65 0.264743337 ubox
36 42 0.010483754 ubox
36 43 0.003801459 ubox
36 44 0.015378854 ubox
36 45 0.522453322 ubox
36 55 0.015544264 ubox
36 56 0.175003546 ubox
36 61 0.422402000 ubox
36 64 0.390117640 ubox
37 41 0.011222757 ubox
37 42 0.003857409 ubox
37 43 0.013360530 ubox
37 44 0.517241602 ubox
37 54 0.014732848 ubox
37 55 0.175039044 ubox
37 60 0.422656589 ubox
37 63 0.403117057 ubox
38 59 0.419512651 ubox
38 62 0.402838579 ubox
39 53 0.163265255 ubox
39 54 0.079634204 ubox
40 52 0.173112344 ubox
40 53 0.074952458 ubox
41 50 0.336776971 ubox
41 59 0.414676211 ubox
42 48 0.027249282 ubox
42 49 0.333859861 ubox
42 50 0.028274441 ubox
42 51 0.058942672 ubox
42 58 0.422728805 ubox
42 59 0.038802085 ubox
43 47 0.026357493 ubox
43 48 0.290911918 ubox
43 49 0.029641970 ubox
43 50 0.057876700 ubox
43 51 0.197653945 ubox
43 57 0.396369184 ubox
43 58 0.089180212 ubox
44 50 0.204825946 ubox
45 62 0.023527043 ubox
45 65 0.003902867 ubox
46 53 0.051541786 ubox
46 54 0.121637064 ubox
46 55 0.501016002 ubox
46 61 0.024462424 ubox
46 64 0.003280565 ubox
47 52 0.054357602 ubox
47 53 0.129571405 ubox
47 54 0.500083469 ubox
48 52 0.100855051 ubox
48 53 0.436071055 ubox
48 54 0.041194062 ubox
49 53 0.036302120 ubox
49 64 0.020790712 ubox
50 63 0.021375504 ubox
52 58 0.038238821 ubox
52 59 0.009451068 ubox
53 57 0.036477467 ubox
53 58 0.027971292 ubox
53 59 0.006975999 ubox
54 58 0.018788236 ubox
56 65 0.031747545 ubox
57 64 0.029939288 ubox
58 64 0.030806849 ubox
59 63 0.031443585 ubox
3 61 0.9500000 lbox
4 60 0.9500000 lbox
5 59 0.9500000 lbox
8 33 0.9500000 lbox
9 32 0.9500000 lbox
10 31 0.9500000 lbox
11 30 0.9500000 lbox
15 29 0.9500000 lbox
16 28 0.9500000 lbox
17 27 0.9500000 lbox
18 26 0.9500000 lbox
19 25 0.9500000 lbox
20 24 0.9500000 lbox
35 46 0.9500000 lbox
36 45 0.9500000 lbox
37 44 0.9500000 lbox
showpage
end
%%EOF
