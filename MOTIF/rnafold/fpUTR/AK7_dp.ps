%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:20:40 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (AK7)
} def

/sequence { (\
GGCCCGGGCCCCGCCUCCUUGGCAAGCGAGUGGCGCUUUCACCUUAGCAACCAGCGCGGCUCCCACC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 10 0.552701969 ubox
1 11 0.040889290 ubox
1 12 0.062740801 ubox
1 15 0.038882148 ubox
1 17 0.005177820 ubox
1 18 0.081586449 ubox
1 19 0.014406754 ubox
1 61 0.048215598 ubox
1 62 0.026743975 ubox
1 63 0.046112586 ubox
1 64 0.280912661 ubox
1 67 0.211198019 ubox
2 9 0.555167487 ubox
2 10 0.032308098 ubox
2 11 0.062076180 ubox
2 14 0.038926952 ubox
2 16 0.004168764 ubox
2 17 0.081665244 ubox
2 18 0.016553888 ubox
2 23 0.685888982 ubox
2 27 0.070364112 ubox
2 60 0.057701927 ubox
2 61 0.020702043 ubox
2 62 0.040413690 ubox
2 63 0.277134776 ubox
2 66 0.213135823 ubox
3 8 0.554016594 ubox
3 13 0.036505195 ubox
3 22 0.686199084 ubox
3 26 0.070320311 ubox
3 59 0.050336072 ubox
4 21 0.684692002 ubox
4 22 0.075163540 ubox
4 58 0.041367317 ubox
4 59 0.091279321 ubox
5 13 0.036625577 ubox
5 21 0.081891327 ubox
5 56 0.012800563 ubox
5 58 0.095729712 ubox
6 12 0.072713796 ubox
6 15 0.034205294 ubox
6 16 0.386935896 ubox
6 17 0.276635138 ubox
6 18 0.099548316 ubox
6 19 0.474695488 ubox
6 20 0.051599120 ubox
6 27 0.005657838 ubox
6 38 0.003684676 ubox
6 43 0.003387119 ubox
6 55 0.011526051 ubox
6 57 0.099722924 ubox
6 61 0.006313886 ubox
6 62 0.340707667 ubox
6 63 0.096199437 ubox
6 64 0.189964244 ubox
6 67 0.039201917 ubox
7 11 0.071647413 ubox
7 14 0.034024804 ubox
7 15 0.489773903 ubox
7 16 0.066846580 ubox
7 17 0.090423898 ubox
7 18 0.480422305 ubox
7 19 0.029316093 ubox
7 37 0.005575816 ubox
7 42 0.003393273 ubox
7 52 0.007284220 ubox
7 60 0.004645122 ubox
7 61 0.343471599 ubox
7 62 0.096260941 ubox
7 63 0.189798816 ubox
7 64 0.021434703 ubox
7 66 0.039389677 ubox
7 67 0.009162387 ubox
8 14 0.493019158 ubox
8 15 0.070142464 ubox
8 16 0.062552062 ubox
8 17 0.478463898 ubox
8 18 0.028785687 ubox
8 23 0.027311826 ubox
8 27 0.164898581 ubox
8 36 0.005775989 ubox
8 51 0.007279318 ubox
8 55 0.099697201 ubox
8 60 0.357240203 ubox
8 61 0.016480443 ubox
8 62 0.149650623 ubox
8 63 0.020584123 ubox
8 66 0.009066752 ubox
9 13 0.490904589 ubox
9 22 0.027267815 ubox
9 26 0.164793605 ubox
9 35 0.005728710 ubox
9 54 0.099472929 ubox
9 59 0.357482009 ubox
10 21 0.027141067 ubox
10 58 0.356409024 ubox
10 59 0.034043714 ubox
11 22 0.028338921 ubox
11 33 0.016733183 ubox
11 58 0.037637292 ubox
11 59 0.144210201 ubox
12 21 0.028550131 ubox
12 28 0.008367073 ubox
12 32 0.019769250 ubox
12 35 0.028636841 ubox
12 56 0.137969758 ubox
12 58 0.144312668 ubox
13 20 0.021940899 ubox
13 23 0.686193243 ubox
13 27 0.012673391 ubox
13 31 0.019720981 ubox
13 34 0.087752891 ubox
13 48 0.011491578 ubox
13 55 0.133381089 ubox
13 57 0.105577356 ubox
13 60 0.004767739 ubox
14 22 0.687009289 ubox
14 26 0.012018308 ubox
14 30 0.014112700 ubox
14 33 0.087927286 ubox
14 47 0.011342860 ubox
14 54 0.131845262 ubox
14 56 0.105457248 ubox
14 59 0.004774699 ubox
15 21 0.686876968 ubox
15 22 0.006484002 ubox
15 26 0.004036757 ubox
15 30 0.079036660 ubox
15 32 0.088073130 ubox
15 33 0.023089495 ubox
15 47 0.020884189 ubox
15 54 0.082263334 ubox
15 58 0.004766317 ubox
16 21 0.006297375 ubox
16 22 0.004130811 ubox
16 25 0.005117057 ubox
16 29 0.080939323 ubox
16 32 0.022522365 ubox
16 33 0.016208802 ubox
16 46 0.020374680 ubox
16 53 0.079546595 ubox
17 21 0.005019209 ubox
17 28 0.081016463 ubox
17 32 0.024922115 ubox
18 26 0.077016543 ubox
18 30 0.120502552 ubox
18 47 0.046923885 ubox
18 54 0.033934833 ubox
19 25 0.075942317 ubox
19 26 0.022940234 ubox
19 29 0.120976553 ubox
19 46 0.046502388 ubox
19 47 0.006430917 ubox
19 50 0.066063836 ubox
19 53 0.024890629 ubox
19 54 0.025601930 ubox
20 24 0.063234848 ubox
20 25 0.024231769 ubox
20 28 0.120967869 ubox
20 41 0.030931508 ubox
20 46 0.005980132 ubox
20 49 0.067685181 ubox
20 53 0.061889611 ubox
20 65 0.080354504 ubox
21 27 0.121579749 ubox
21 34 0.005195633 ubox
21 40 0.032871053 ubox
21 43 0.060172113 ubox
21 44 0.008137277 ubox
21 48 0.062155768 ubox
21 52 0.068148974 ubox
21 61 0.013427989 ubox
21 63 0.003452328 ubox
21 64 0.090670657 ubox
21 67 0.018877667 ubox
22 39 0.032408962 ubox
22 42 0.060545556 ubox
22 43 0.008941169 ubox
22 48 0.050899682 ubox
22 51 0.067869934 ubox
22 60 0.014865219 ubox
22 62 0.003259416 ubox
22 63 0.090645067 ubox
22 66 0.019066392 ubox
23 30 0.003358460 ubox
23 32 0.005739243 ubox
23 47 0.056622093 ubox
23 59 0.014916564 ubox
24 31 0.005435933 ubox
24 38 0.098237331 ubox
24 39 0.006498807 ubox
24 45 0.057414099 ubox
25 37 0.103939036 ubox
25 38 0.004937622 ubox
25 44 0.057780469 ubox
25 45 0.007883989 ubox
25 61 0.009397952 ubox
26 34 0.043734598 ubox
26 36 0.104738573 ubox
26 43 0.057574315 ubox
26 44 0.007747407 ubox
26 48 0.063352776 ubox
26 55 0.022469406 ubox
26 57 0.342382115 ubox
26 60 0.009887510 ubox
27 33 0.043790365 ubox
27 35 0.104765650 ubox
27 47 0.063431049 ubox
27 54 0.022492229 ubox
27 56 0.342794575 ubox
27 58 0.005429445 ubox
27 59 0.009044663 ubox
28 34 0.103879985 ubox
28 38 0.013488704 ubox
28 39 0.004680083 ubox
28 40 0.015528342 ubox
28 45 0.036446682 ubox
28 55 0.341607134 ubox
28 57 0.009052085 ubox
28 62 0.912814405 ubox
29 37 0.014414621 ubox
29 38 0.004343486 ubox
29 39 0.015349620 ubox
29 44 0.040722541 ubox
29 45 0.012461564 ubox
29 61 0.915129992 ubox
30 36 0.014821766 ubox
30 37 0.003244439 ubox
30 38 0.014531902 ubox
30 42 0.074068969 ubox
30 43 0.029193548 ubox
30 44 0.012229824 ubox
30 51 0.021771482 ubox
30 55 0.014997158 ubox
30 60 0.915551009 ubox
31 35 0.013871491 ubox
31 41 0.079580675 ubox
31 50 0.020931706 ubox
31 53 0.353835304 ubox
31 54 0.009447480 ubox
31 59 0.913999572 ubox
32 40 0.079626166 ubox
32 43 0.029427826 ubox
32 52 0.359223334 ubox
32 57 0.003336685 ubox
33 38 0.003454079 ubox
33 39 0.066200386 ubox
33 42 0.029445481 ubox
33 48 0.017451742 ubox
33 51 0.358734971 ubox
33 55 0.006196173 ubox
33 57 0.916048484 ubox
34 47 0.017677344 ubox
34 54 0.006309262 ubox
34 56 0.916117030 ubox
35 48 0.374872941 ubox
35 55 0.915959436 ubox
36 47 0.375643912 ubox
36 54 0.915733571 ubox
37 46 0.374333664 ubox
37 47 0.019808466 ubox
37 50 0.024496770 ubox
37 53 0.870905082 ubox
37 54 0.006600431 ubox
38 46 0.048158812 ubox
38 47 0.090158270 ubox
38 49 0.045430574 ubox
38 50 0.140784531 ubox
38 53 0.039592296 ubox
39 46 0.076701973 ubox
39 49 0.143755027 ubox
39 53 0.011767562 ubox
42 59 0.004112692 ubox
43 54 0.005526121 ubox
43 58 0.004178908 ubox
44 50 0.032648453 ubox
44 53 0.009614098 ubox
45 49 0.029394037 ubox
45 53 0.005817577 ubox
47 55 0.050166128 ubox
47 57 0.025145371 ubox
48 54 0.050236460 ubox
48 56 0.025166194 ubox
58 64 0.011747126 ubox
58 67 0.010671710 ubox
59 63 0.011569965 ubox
59 66 0.010711004 ubox
1 10 0.9500000 lbox
2 9 0.9500000 lbox
3 8 0.9500000 lbox
13 23 0.9500000 lbox
14 22 0.9500000 lbox
15 21 0.9500000 lbox
28 62 0.9500000 lbox
29 61 0.9500000 lbox
30 60 0.9500000 lbox
31 59 0.9500000 lbox
33 57 0.9500000 lbox
34 56 0.9500000 lbox
35 55 0.9500000 lbox
36 54 0.9500000 lbox
37 53 0.9500000 lbox
showpage
end
%%EOF
