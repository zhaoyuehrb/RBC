%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:15:35 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (ELL)
} def

/sequence { (\
GGCGGGGCGGGGCGUGGCCGGCGUGGCGGCGCUGGAGCCGGGAAGGGGGCGCGGGGGAGAGAUGGUCGCAAG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 19 0.031989135 ubox
1 33 0.010103533 ubox
1 39 0.160993122 ubox
1 67 0.044496994 ubox
2 8 0.135244280 ubox
2 13 0.088052875 ubox
2 15 0.073367685 ubox
2 18 0.033377507 ubox
2 22 0.048269715 ubox
2 24 0.011570796 ubox
2 27 0.012342847 ubox
2 32 0.010686362 ubox
2 38 0.161130726 ubox
2 50 0.506305218 ubox
2 52 0.071627103 ubox
2 66 0.044546785 ubox
2 69 0.271658588 ubox
3 7 0.134389200 ubox
3 9 0.054205237 ubox
3 12 0.088134319 ubox
3 14 0.075669749 ubox
3 16 0.007423099 ubox
3 17 0.034302196 ubox
3 20 0.003709966 ubox
3 21 0.048270696 ubox
3 23 0.011939820 ubox
3 26 0.012396402 ubox
3 31 0.010686682 ubox
3 34 0.019101837 ubox
3 37 0.161094950 ubox
3 40 0.235489643 ubox
3 49 0.506585296 ubox
3 51 0.071693134 ubox
3 53 0.007959973 ubox
3 64 0.003858469 ubox
3 65 0.044432396 ubox
3 68 0.271867221 ubox
4 8 0.051490761 ubox
4 13 0.075745259 ubox
4 15 0.007002550 ubox
4 19 0.004216084 ubox
4 22 0.011902615 ubox
4 30 0.010492471 ubox
4 33 0.018012672 ubox
4 39 0.229640637 ubox
4 50 0.067789258 ubox
4 52 0.007882289 ubox
4 63 0.004430533 ubox
4 67 0.235148837 ubox
5 18 0.004214710 ubox
5 19 0.046492757 ubox
5 32 0.017609618 ubox
5 38 0.226804587 ubox
5 39 0.085739710 ubox
5 66 0.170788310 ubox
5 67 0.058305177 ubox
6 18 0.046289659 ubox
6 19 0.029655934 ubox
6 33 0.012966773 ubox
6 38 0.081208365 ubox
6 39 0.877007532 ubox
6 66 0.079792808 ubox
6 67 0.040973932 ubox
7 13 0.040209538 ubox
7 15 0.028224542 ubox
7 18 0.030811435 ubox
7 22 0.015925449 ubox
7 24 0.006757713 ubox
7 27 0.008144026 ubox
7 30 0.017508436 ubox
7 32 0.012640234 ubox
7 38 0.879196424 ubox
7 50 0.019448997 ubox
7 52 0.039875732 ubox
7 66 0.062180618 ubox
7 69 0.142947216 ubox
8 12 0.039972485 ubox
8 14 0.029108551 ubox
8 16 0.046222134 ubox
8 17 0.031698009 ubox
8 20 0.003253016 ubox
8 21 0.015907722 ubox
8 23 0.006827937 ubox
8 26 0.008137159 ubox
8 28 0.004459639 ubox
8 29 0.017078311 ubox
8 31 0.012497210 ubox
8 34 0.101350306 ubox
8 37 0.880169685 ubox
8 40 0.055096157 ubox
8 49 0.019447421 ubox
8 51 0.039962543 ubox
8 53 0.036441188 ubox
8 64 0.117371276 ubox
8 65 0.067001345 ubox
8 68 0.143101489 ubox
9 13 0.027299603 ubox
9 15 0.043702108 ubox
9 19 0.003519587 ubox
9 22 0.006837202 ubox
9 27 0.005835178 ubox
9 30 0.011463109 ubox
9 33 0.056940215 ubox
9 39 0.055512724 ubox
9 50 0.023015893 ubox
9 52 0.036019229 ubox
9 63 0.089659393 ubox
9 67 0.139040712 ubox
10 18 0.003524539 ubox
10 19 0.015168988 ubox
10 32 0.035249251 ubox
10 33 0.040548158 ubox
10 38 0.055483620 ubox
10 66 0.107215544 ubox
10 67 0.026159395 ubox
11 18 0.015070590 ubox
11 19 0.010610977 ubox
11 32 0.030489508 ubox
11 33 0.966197219 ubox
11 39 0.011961678 ubox
11 66 0.035525840 ubox
11 67 0.004397018 ubox
12 18 0.010890048 ubox
12 22 0.005630675 ubox
12 24 0.018044991 ubox
12 30 0.026260594 ubox
12 32 0.983825288 ubox
12 38 0.011979828 ubox
12 50 0.003773688 ubox
12 52 0.027240650 ubox
12 66 0.006284038 ubox
12 69 0.006008220 ubox
13 17 0.011045016 ubox
13 21 0.005572563 ubox
13 23 0.018200444 ubox
13 28 0.015998203 ubox
13 29 0.023653543 ubox
13 31 0.985075868 ubox
13 37 0.011917467 ubox
13 40 0.004902701 ubox
13 49 0.003776518 ubox
13 51 0.027256175 ubox
13 53 0.044817658 ubox
13 64 0.052239019 ubox
13 65 0.006456031 ubox
13 68 0.006009350 ubox
14 22 0.018205831 ubox
14 27 0.019587933 ubox
14 30 0.985124333 ubox
14 32 0.003436277 ubox
14 39 0.004827800 ubox
14 50 0.025081107 ubox
14 52 0.045070625 ubox
14 63 0.051946019 ubox
14 67 0.005417800 ubox
14 69 0.050491762 ubox
15 21 0.018110225 ubox
15 26 0.019589587 ubox
15 28 0.007095207 ubox
15 29 0.983468168 ubox
15 31 0.003343663 ubox
15 37 0.003460930 ubox
15 40 0.008200010 ubox
15 49 0.024200745 ubox
15 51 0.044793666 ubox
15 62 0.051423278 ubox
15 68 0.050516707 ubox
16 27 0.005945105 ubox
16 39 0.012172373 ubox
16 50 0.041067475 ubox
16 52 0.003165947 ubox
16 67 0.050594346 ubox
17 24 0.019602785 ubox
17 27 0.985288227 ubox
17 30 0.012168771 ubox
17 38 0.012155865 ubox
17 50 0.009670419 ubox
17 66 0.050020603 ubox
18 23 0.019579006 ubox
18 26 0.985378874 ubox
18 29 0.012684090 ubox
18 35 0.123635451 ubox
18 37 0.009066362 ubox
18 41 0.010577185 ubox
18 47 0.003888962 ubox
18 48 0.038216234 ubox
18 49 0.011576580 ubox
18 54 0.010387267 ubox
18 55 0.059787483 ubox
18 56 0.011799524 ubox
18 57 0.006640122 ubox
18 65 0.049418031 ubox
19 25 0.984976418 ubox
19 28 0.012728161 ubox
19 34 0.125323324 ubox
19 40 0.010629990 ubox
19 46 0.004041274 ubox
19 47 0.037961995 ubox
19 48 0.011532167 ubox
19 53 0.010390466 ubox
19 54 0.059970209 ubox
19 55 0.011177076 ubox
19 56 0.006506842 ubox
19 64 0.048483354 ubox
20 24 0.607726288 ubox
20 27 0.012706245 ubox
20 33 0.132938550 ubox
20 39 0.010792248 ubox
20 52 0.008077065 ubox
20 63 0.038497104 ubox
21 27 0.006232681 ubox
21 30 0.009153419 ubox
21 32 0.134294474 ubox
21 38 0.010792509 ubox
21 50 0.005008784 ubox
21 52 0.066805362 ubox
22 26 0.006383690 ubox
22 28 0.003785972 ubox
22 29 0.009162388 ubox
22 31 0.134431251 ubox
22 37 0.010786853 ubox
22 49 0.005012256 ubox
22 51 0.067154640 ubox
23 27 0.003614568 ubox
23 30 0.134395062 ubox
23 32 0.007932970 ubox
23 50 0.067195601 ubox
23 69 0.036345984 ubox
24 29 0.132817493 ubox
24 31 0.007959929 ubox
24 34 0.007317297 ubox
24 40 0.003935072 ubox
24 49 0.066935968 ubox
24 68 0.036363490 ubox
24 70 0.004321915 ubox
25 30 0.007998702 ubox
25 33 0.010449780 ubox
25 39 0.004464272 ubox
25 67 0.036403256 ubox
25 69 0.003457705 ubox
26 32 0.010675547 ubox
26 38 0.004465613 ubox
26 66 0.036340175 ubox
26 69 0.031517571 ubox
27 31 0.010598993 ubox
27 37 0.004464597 ubox
27 40 0.078760034 ubox
27 53 0.008437655 ubox
27 64 0.005166164 ubox
27 65 0.035913765 ubox
27 68 0.031739279 ubox
28 39 0.079027382 ubox
28 52 0.006205492 ubox
28 63 0.006866913 ubox
28 67 0.031658246 ubox
29 38 0.079029689 ubox
29 52 0.033391962 ubox
29 66 0.031203264 ubox
29 69 0.004280387 ubox
30 37 0.079010897 ubox
30 51 0.034028215 ubox
30 53 0.023390301 ubox
30 64 0.007456131 ubox
30 65 0.030229800 ubox
30 68 0.004284856 ubox
31 50 0.034103064 ubox
31 52 0.023899738 ubox
31 63 0.009634502 ubox
31 67 0.004090765 ubox
32 49 0.034081189 ubox
32 51 0.023830699 ubox
32 54 0.040910078 ubox
32 55 0.020347829 ubox
32 56 0.014002700 ubox
32 57 0.009131591 ubox
32 59 0.010621253 ubox
32 61 0.016009000 ubox
33 48 0.032199952 ubox
33 51 0.004639659 ubox
33 53 0.053378581 ubox
33 54 0.025898790 ubox
33 55 0.016659658 ubox
33 56 0.010236235 ubox
33 58 0.010730061 ubox
33 60 0.015952950 ubox
34 50 0.021120099 ubox
34 52 0.095107062 ubox
37 50 0.354655121 ubox
37 52 0.004054293 ubox
37 66 0.004819094 ubox
38 46 0.041177095 ubox
38 47 0.053283617 ubox
38 48 0.030144032 ubox
38 49 0.355224819 ubox
38 51 0.003187190 ubox
38 54 0.035371780 ubox
38 55 0.005849587 ubox
38 56 0.005044338 ubox
38 57 0.004346235 ubox
38 65 0.005323307 ubox
39 45 0.042528765 ubox
39 46 0.055203302 ubox
39 47 0.033117408 ubox
39 48 0.355255105 ubox
39 51 0.006986518 ubox
39 53 0.036918162 ubox
39 54 0.005743934 ubox
39 55 0.005216983 ubox
39 56 0.004515385 ubox
39 64 0.005425461 ubox
40 50 0.081619084 ubox
40 52 0.050176555 ubox
40 63 0.005643658 ubox
40 67 0.003818329 ubox
41 66 0.003801733 ubox
42 67 0.005092564 ubox
43 66 0.004761689 ubox
45 67 0.005159892 ubox
46 66 0.004574792 ubox
46 67 0.007904495 ubox
47 66 0.006468284 ubox
47 67 0.044123788 ubox
48 66 0.046164195 ubox
48 67 0.185850397 ubox
49 66 0.200552951 ubox
49 69 0.341932531 ubox
50 64 0.051187650 ubox
50 65 0.203275588 ubox
50 68 0.342313126 ubox
51 63 0.039318151 ubox
51 66 0.102406721 ubox
51 67 0.333964888 ubox
51 69 0.861735241 ubox
52 64 0.174963777 ubox
52 65 0.335448963 ubox
52 68 0.862626565 ubox
53 63 0.164739608 ubox
53 67 0.860204262 ubox
54 66 0.811148106 ubox
54 67 0.045925939 ubox
55 66 0.060122253 ubox
55 67 0.022739914 ubox
56 66 0.030532024 ubox
56 67 0.021708967 ubox
57 66 0.026727082 ubox
57 67 0.049982122 ubox
58 66 0.052293511 ubox
59 67 0.051042793 ubox
60 66 0.052438171 ubox
61 67 0.019827010 ubox
62 66 0.017816379 ubox
63 70 0.035057638 ubox
64 69 0.038875511 ubox
6 39 0.9500000 lbox
7 38 0.9500000 lbox
8 37 0.9500000 lbox
11 33 0.9500000 lbox
12 32 0.9500000 lbox
13 31 0.9500000 lbox
14 30 0.9500000 lbox
15 29 0.9500000 lbox
17 27 0.9500000 lbox
18 26 0.9500000 lbox
19 25 0.9500000 lbox
51 69 0.9500000 lbox
52 68 0.9500000 lbox
53 67 0.9500000 lbox
54 66 0.9500000 lbox
showpage
end
%%EOF
