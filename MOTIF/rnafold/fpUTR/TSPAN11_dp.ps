%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:00:10 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (TSPAN11)
} def

/sequence { (\
AGACUGUCCCGAGCUUCCCCCGGGCGGGCAGAGGGAAGCCGGCUGGGGAUGAGGAGUGGAGGAGGCAGGAAUGCCUGGGACACUCGCGGGGCAUGUGAGCAGGCCCAGAAGCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 15 0.003305283 ubox
1 84 0.009826451 ubox
2 8 0.034526535 ubox
2 14 0.003951793 ubox
2 83 0.011554161 ubox
2 85 0.156396719 ubox
3 7 0.030122090 ubox
3 84 0.154105285 ubox
3 96 0.753959417 ubox
4 13 0.011246199 ubox
4 53 0.016158615 ubox
4 61 0.003823277 ubox
4 62 0.006436968 ubox
4 64 0.012145561 ubox
4 65 0.003562288 ubox
4 68 0.383782015 ubox
4 69 0.013529364 ubox
4 95 0.773605868 ubox
4 99 0.025011656 ubox
4 102 0.015211016 ubox
4 108 0.006806148 ubox
4 111 0.007243215 ubox
5 11 0.014000496 ubox
5 12 0.018286442 ubox
5 51 0.009503802 ubox
5 52 0.015250603 ubox
5 60 0.003635084 ubox
5 61 0.006064548 ubox
5 63 0.012095514 ubox
5 64 0.003775721 ubox
5 67 0.385144449 ubox
5 68 0.006726106 ubox
5 82 0.176461614 ubox
5 93 0.839589848 ubox
5 95 0.004754671 ubox
5 98 0.017738284 ubox
5 101 0.016127603 ubox
5 107 0.006541572 ubox
5 110 0.006925413 ubox
6 10 0.016499920 ubox
6 50 0.019820005 ubox
6 66 0.385507189 ubox
6 81 0.183188000 ubox
6 92 0.872992836 ubox
6 100 0.015987180 ubox
6 106 0.005163642 ubox
6 112 0.003436768 ubox
7 49 0.020758615 ubox
7 60 0.008304142 ubox
7 62 0.014165603 ubox
7 63 0.011252856 ubox
7 65 0.385263460 ubox
7 70 0.003754344 ubox
7 80 0.183188986 ubox
7 91 0.872656204 ubox
7 98 0.011868369 ubox
7 99 0.010631851 ubox
7 109 0.004386775 ubox
7 111 0.003238679 ubox
8 48 0.020814430 ubox
8 59 0.008513707 ubox
8 61 0.019278078 ubox
8 62 0.014758067 ubox
8 64 0.384906975 ubox
8 65 0.003362899 ubox
8 69 0.004031213 ubox
8 79 0.183209748 ubox
8 90 0.873089066 ubox
8 91 0.015035036 ubox
8 97 0.013858840 ubox
8 108 0.004638779 ubox
9 42 0.003199278 ubox
9 47 0.020790245 ubox
9 58 0.008146762 ubox
9 59 0.055677538 ubox
9 61 0.014494747 ubox
9 62 0.382167136 ubox
9 68 0.003999973 ubox
9 69 0.004292607 ubox
9 78 0.182899491 ubox
9 89 0.873113984 ubox
9 90 0.015080217 ubox
9 103 0.003724636 ubox
10 41 0.003366505 ubox
10 46 0.020763032 ubox
10 58 0.056695591 ubox
10 61 0.382142103 ubox
10 68 0.004328238 ubox
10 77 0.182416061 ubox
10 88 0.872993041 ubox
10 89 0.015091063 ubox
10 95 0.014694841 ubox
10 102 0.003725877 ubox
11 17 0.021712644 ubox
11 40 0.003930932 ubox
11 57 0.060597591 ubox
11 76 0.054956994 ubox
11 85 0.005358996 ubox
11 87 0.852590133 ubox
11 94 0.014631543 ubox
12 16 0.020179875 ubox
12 44 0.020273235 ubox
12 76 0.004775714 ubox
12 84 0.005603455 ubox
13 39 0.010273003 ubox
13 43 0.018505063 ubox
13 57 0.387508991 ubox
13 66 0.016882976 ubox
13 74 0.009121556 ubox
13 83 0.004977050 ubox
13 87 0.116787622 ubox
13 92 0.015033651 ubox
13 100 0.003711845 ubox
13 112 0.230686699 ubox
14 38 0.011218054 ubox
14 42 0.017967958 ubox
14 53 0.721846462 ubox
14 54 0.156208438 ubox
14 56 0.389722430 ubox
14 59 0.011274596 ubox
14 61 0.015096026 ubox
14 62 0.113440348 ubox
14 65 0.016908408 ubox
14 73 0.009134977 ubox
14 86 0.127447099 ubox
14 91 0.015028671 ubox
14 99 0.003712879 ubox
14 111 0.231401294 ubox
15 37 0.014030402 ubox
15 41 0.015570899 ubox
15 49 0.016263555 ubox
15 52 0.719569030 ubox
15 53 0.263819364 ubox
15 54 0.003263888 ubox
15 55 0.377998582 ubox
15 56 0.044079960 ubox
15 58 0.009961273 ubox
15 60 0.014588942 ubox
15 61 0.113837541 ubox
15 64 0.016894977 ubox
15 71 0.008645867 ubox
15 90 0.014630328 ubox
15 98 0.003608625 ubox
15 110 0.231249497 ubox
16 36 0.020529416 ubox
16 48 0.012013059 ubox
16 49 0.217019251 ubox
16 51 0.694089221 ubox
16 52 0.302625489 ubox
16 53 0.006969161 ubox
16 54 0.364576757 ubox
16 55 0.106727144 ubox
16 59 0.013307172 ubox
16 60 0.114080250 ubox
16 63 0.017005287 ubox
16 70 0.009077157 ubox
16 80 0.003338394 ubox
16 89 0.014146498 ubox
16 90 0.003252862 ubox
16 97 0.003192729 ubox
16 109 0.231089193 ubox
17 35 0.020605994 ubox
17 47 0.012401820 ubox
17 48 0.234734926 ubox
17 51 0.311728168 ubox
17 53 0.362695858 ubox
17 54 0.142011227 ubox
17 58 0.012930736 ubox
17 59 0.114208092 ubox
17 62 0.017098394 ubox
17 69 0.009086579 ubox
17 79 0.003362006 ubox
17 88 0.014012331 ubox
17 89 0.004619484 ubox
17 108 0.230499783 ubox
18 34 0.020598720 ubox
18 46 0.012365881 ubox
18 47 0.229910060 ubox
18 48 0.666209598 ubox
18 53 0.142139721 ubox
18 58 0.113463580 ubox
18 61 0.016987353 ubox
18 68 0.009009797 ubox
18 78 0.003343110 ubox
18 88 0.005019565 ubox
19 28 0.007789294 ubox
19 33 0.019434175 ubox
19 45 0.012321237 ubox
19 46 0.224794105 ubox
19 47 0.669243984 ubox
19 48 0.705241029 ubox
20 27 0.010336280 ubox
20 28 0.017972689 ubox
20 45 0.218903045 ubox
20 46 0.670734347 ubox
20 47 0.706114475 ubox
20 48 0.003936725 ubox
21 26 0.010333781 ubox
21 27 0.017977027 ubox
21 45 0.671887309 ubox
21 46 0.706296423 ubox
21 47 0.003296456 ubox
22 44 0.616806589 ubox
23 43 0.557466209 ubox
23 44 0.778435405 ubox
24 43 0.829847667 ubox
25 41 0.488524415 ubox
25 42 0.870792183 ubox
26 40 0.423163618 ubox
27 39 0.345419147 ubox
27 40 0.905369890 ubox
28 39 0.938158472 ubox
29 38 0.969254393 ubox
33 40 0.003411767 ubox
34 39 0.003534883 ubox
49 57 0.020204401 ubox
50 56 0.020421960 ubox
50 86 0.011953287 ubox
50 88 0.092040171 ubox
51 85 0.014525174 ubox
51 87 0.134404251 ubox
52 84 0.013934508 ubox
53 83 0.012924871 ubox
53 85 0.024849081 ubox
54 84 0.010962942 ubox
54 85 0.896148685 ubox
55 84 0.902644549 ubox
56 66 0.006500164 ubox
56 81 0.012044641 ubox
56 83 0.903640608 ubox
57 65 0.006477066 ubox
57 67 0.004300785 ubox
57 80 0.011997410 ubox
57 82 0.903451479 ubox
58 66 0.004813043 ubox
58 81 0.902958549 ubox
59 85 0.007446169 ubox
60 84 0.007511501 ubox
61 76 0.006364608 ubox
61 83 0.007508277 ubox
62 75 0.003185077 ubox
63 76 0.913184437 ubox
64 75 0.922168491 ubox
64 113 0.003882254 ubox
65 74 0.922346835 ubox
65 112 0.003963049 ubox
66 73 0.922288511 ubox
66 77 0.014826810 ubox
66 111 0.003955450 ubox
67 72 0.889721730 ubox
67 76 0.020336892 ubox
68 75 0.021816932 ubox
68 106 0.005254464 ubox
68 113 0.012914177 ubox
69 74 0.028971222 ubox
69 105 0.005971439 ubox
69 112 0.024522195 ubox
71 94 0.022967202 ubox
72 93 0.023827519 ubox
73 92 0.024102328 ubox
73 104 0.033195582 ubox
73 112 0.260397179 ubox
74 90 0.012787359 ubox
74 91 0.021070687 ubox
74 103 0.033314144 ubox
74 111 0.260097177 ubox
75 89 0.017355039 ubox
75 90 0.017519160 ubox
75 102 0.033315961 ubox
75 108 0.380762528 ubox
76 88 0.020956831 ubox
76 89 0.012728255 ubox
76 101 0.033306620 ubox
76 107 0.383605350 ubox
77 84 0.004589135 ubox
77 85 0.007719683 ubox
77 87 0.024259980 ubox
77 100 0.033283277 ubox
77 106 0.384318678 ubox
78 83 0.005204765 ubox
78 84 0.007526920 ubox
78 85 0.003728745 ubox
78 104 0.003562286 ubox
78 105 0.384318911 ubox
79 83 0.007385569 ubox
79 85 0.024292651 ubox
79 104 0.384168151 ubox
80 84 0.021141691 ubox
81 97 0.009367792 ubox
82 96 0.009436612 ubox
83 95 0.009435977 ubox
83 99 0.391922855 ubox
83 102 0.004275930 ubox
83 108 0.005919940 ubox
83 111 0.023340945 ubox
84 98 0.393193839 ubox
84 101 0.003442554 ubox
84 107 0.005897153 ubox
84 109 0.022162711 ubox
84 110 0.021363358 ubox
85 97 0.393306000 ubox
85 108 0.024620590 ubox
86 92 0.009831442 ubox
86 96 0.393154139 ubox
86 100 0.004618945 ubox
86 104 0.003247369 ubox
86 112 0.082025599 ubox
87 91 0.009772429 ubox
87 95 0.393274250 ubox
87 99 0.004621325 ubox
87 103 0.003256677 ubox
87 111 0.081698264 ubox
88 94 0.367916074 ubox
88 106 0.032591243 ubox
89 105 0.029621219 ubox
89 106 0.283396793 ubox
90 104 0.026258382 ubox
90 105 0.284298063 ubox
91 100 0.022346373 ubox
91 104 0.284644124 ubox
91 112 0.003666164 ubox
92 99 0.022374682 ubox
92 103 0.283673455 ubox
92 111 0.003668907 ubox
94 101 0.273287828 ubox
94 107 0.004345338 ubox
95 100 0.284435053 ubox
95 104 0.022848318 ubox
95 106 0.004656913 ubox
95 112 0.005885016 ubox
96 103 0.022776793 ubox
96 107 0.015635511 ubox
96 111 0.005797601 ubox
97 106 0.021497866 ubox
99 112 0.068776490 ubox
100 111 0.068886999 ubox
102 113 0.858969992 ubox
103 112 0.866433615 ubox
104 111 0.864736375 ubox
3 96 0.9500000 lbox
4 95 0.9500000 lbox
5 93 0.9500000 lbox
6 92 0.9500000 lbox
7 91 0.9500000 lbox
8 90 0.9500000 lbox
9 89 0.9500000 lbox
10 88 0.9500000 lbox
11 87 0.9500000 lbox
14 53 0.9500000 lbox
15 52 0.9500000 lbox
16 51 0.9500000 lbox
19 48 0.9500000 lbox
20 47 0.9500000 lbox
21 46 0.9500000 lbox
23 44 0.9500000 lbox
24 43 0.9500000 lbox
25 42 0.9500000 lbox
27 40 0.9500000 lbox
28 39 0.9500000 lbox
29 38 0.9500000 lbox
54 85 0.9500000 lbox
55 84 0.9500000 lbox
56 83 0.9500000 lbox
57 82 0.9500000 lbox
58 81 0.9500000 lbox
63 76 0.9500000 lbox
64 75 0.9500000 lbox
65 74 0.9500000 lbox
66 73 0.9500000 lbox
67 72 0.9500000 lbox
102 113 0.9500000 lbox
103 112 0.9500000 lbox
104 111 0.9500000 lbox
showpage
end
%%EOF
