%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 02:14:57 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (VPREB3)
} def

/sequence { (\
CUUCCCAGCCCUGUGCCCCAAAGCACCUGGAGCAUAUAGCCUUGCAGAACUUCUACUUGCCUGCCUCCCUGCCUCUGGCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 8 0.024279312 ubox
1 32 0.067978280 ubox
1 39 0.038048858 ubox
1 47 0.042475501 ubox
1 78 0.006086930 ubox
2 7 0.026437049 ubox
2 8 0.005298996 ubox
2 31 0.062382791 ubox
2 32 0.115334278 ubox
2 38 0.045041823 ubox
2 39 0.011367822 ubox
2 46 0.041234665 ubox
2 47 0.006898248 ubox
2 48 0.015521312 ubox
2 49 0.057630735 ubox
2 77 0.005744386 ubox
3 7 0.011184012 ubox
3 30 0.014512321 ubox
3 31 0.164261861 ubox
3 38 0.028582524 ubox
3 46 0.007326915 ubox
3 47 0.015976989 ubox
3 48 0.067586498 ubox
3 78 0.005344058 ubox
4 29 0.008692024 ubox
4 30 0.139174799 ubox
4 47 0.068411249 ubox
4 77 0.006852970 ubox
4 78 0.023426057 ubox
5 29 0.099405768 ubox
5 30 0.482817731 ubox
5 77 0.022280422 ubox
5 78 0.196484085 ubox
6 13 0.009695572 ubox
6 15 0.004211276 ubox
6 29 0.494060827 ubox
6 44 0.060636596 ubox
6 59 0.007542233 ubox
6 63 0.019709819 ubox
6 71 0.011351937 ubox
6 77 0.198314916 ubox
7 12 0.009109529 ubox
7 14 0.004340740 ubox
7 28 0.503520996 ubox
7 42 0.068926597 ubox
7 43 0.057385729 ubox
7 51 0.004237354 ubox
7 57 0.005100365 ubox
7 58 0.007214783 ubox
7 62 0.020279359 ubox
7 66 0.005769118 ubox
7 70 0.012956677 ubox
7 74 0.005210105 ubox
7 76 0.194195395 ubox
8 14 0.003586245 ubox
8 16 0.009248719 ubox
8 24 0.007403739 ubox
8 27 0.503031955 ubox
8 33 0.695212561 ubox
8 40 0.390066682 ubox
8 41 0.054750196 ubox
8 42 0.013132706 ubox
8 45 0.008295834 ubox
8 50 0.004480047 ubox
8 56 0.005557480 ubox
8 57 0.004653146 ubox
8 60 0.014768038 ubox
8 61 0.017796708 ubox
8 64 0.009171385 ubox
8 65 0.005128241 ubox
8 69 0.011201448 ubox
8 72 0.017593537 ubox
8 73 0.005388684 ubox
8 75 0.167367719 ubox
8 79 0.107666712 ubox
9 13 0.003980485 ubox
9 15 0.009268156 ubox
9 23 0.007544581 ubox
9 30 0.119259829 ubox
9 32 0.695996794 ubox
9 39 0.395132777 ubox
9 44 0.008273898 ubox
9 59 0.016179186 ubox
9 63 0.009235517 ubox
9 71 0.019487927 ubox
9 78 0.107686060 ubox
10 29 0.119908264 ubox
10 30 0.703653984 ubox
10 77 0.106792405 ubox
10 78 0.009870840 ubox
11 23 0.010787590 ubox
11 29 0.703651507 ubox
11 30 0.079134107 ubox
11 39 0.026914307 ubox
11 47 0.004055712 ubox
11 77 0.011934056 ubox
12 20 0.007653243 ubox
12 22 0.010651281 ubox
12 25 0.056896121 ubox
12 29 0.073463078 ubox
12 36 0.444042704 ubox
12 38 0.025386079 ubox
12 46 0.004005880 ubox
12 71 0.004171520 ubox
13 19 0.007824636 ubox
13 24 0.057618341 ubox
13 26 0.882153831 ubox
13 28 0.007338927 ubox
13 35 0.460928691 ubox
13 37 0.017466964 ubox
13 45 0.003816819 ubox
13 72 0.003256603 ubox
14 20 0.007995071 ubox
14 23 0.057468161 ubox
14 25 0.883204449 ubox
14 34 0.462418118 ubox
14 36 0.011080923 ubox
15 19 0.008275430 ubox
15 24 0.883533926 ubox
15 33 0.462974669 ubox
15 72 0.003500922 ubox
15 79 0.032616997 ubox
16 23 0.881773177 ubox
16 32 0.462638239 ubox
16 71 0.003497256 ubox
16 78 0.032593659 ubox
17 30 0.065951748 ubox
17 77 0.032397936 ubox
17 78 0.004966334 ubox
18 29 0.063375238 ubox
18 30 0.457893520 ubox
18 77 0.005582303 ubox
18 78 0.015285286 ubox
19 29 0.458545751 ubox
19 77 0.015516543 ubox
20 28 0.438754888 ubox
20 76 0.015353332 ubox
22 28 0.039363683 ubox
22 74 0.013088675 ubox
23 27 0.052307968 ubox
23 60 0.004282629 ubox
23 72 0.035752541 ubox
23 73 0.009593368 ubox
24 59 0.004431261 ubox
24 71 0.036994307 ubox
25 58 0.004380563 ubox
25 70 0.036545002 ubox
26 78 0.008441450 ubox
27 47 0.013237344 ubox
27 77 0.010330454 ubox
27 78 0.072504679 ubox
28 46 0.013277032 ubox
28 55 0.005692473 ubox
28 63 0.003658134 ubox
28 77 0.073206791 ubox
29 41 0.004982331 ubox
29 42 0.014807311 ubox
29 43 0.003196514 ubox
29 45 0.013121739 ubox
29 54 0.006027627 ubox
29 62 0.010601151 ubox
29 65 0.009398614 ubox
29 68 0.063713377 ubox
29 69 0.006231065 ubox
29 73 0.005434213 ubox
29 74 0.018120308 ubox
29 75 0.013107114 ubox
29 76 0.093896999 ubox
30 40 0.004866751 ubox
30 41 0.017556139 ubox
30 42 0.004123010 ubox
30 43 0.011568425 ubox
30 53 0.006199300 ubox
30 61 0.012942628 ubox
30 64 0.009438867 ubox
30 67 0.064447273 ubox
30 68 0.005226809 ubox
30 72 0.005267754 ubox
30 73 0.020786535 ubox
30 74 0.012054122 ubox
30 75 0.097317308 ubox
31 42 0.033274717 ubox
31 43 0.011944038 ubox
31 51 0.003488888 ubox
31 52 0.006293780 ubox
31 62 0.040367878 ubox
31 66 0.064998702 ubox
31 70 0.013877125 ubox
31 74 0.099389502 ubox
31 76 0.011471324 ubox
32 40 0.149484362 ubox
32 41 0.027977610 ubox
32 42 0.003589082 ubox
32 45 0.236855588 ubox
32 60 0.149729495 ubox
32 61 0.029543180 ubox
32 64 0.033805070 ubox
32 65 0.059726023 ubox
32 69 0.014088421 ubox
32 72 0.131045231 ubox
32 73 0.073157080 ubox
32 75 0.011469374 ubox
32 79 0.051308470 ubox
33 39 0.151342864 ubox
33 44 0.237188248 ubox
33 59 0.152944377 ubox
33 63 0.041207194 ubox
33 71 0.147665986 ubox
33 77 0.011018167 ubox
33 78 0.051181083 ubox
34 43 0.236129835 ubox
34 58 0.152506717 ubox
34 62 0.038691710 ubox
34 70 0.141523623 ubox
34 76 0.011770193 ubox
35 44 0.005458608 ubox
35 55 0.005379229 ubox
35 59 0.003615667 ubox
35 71 0.004561035 ubox
35 77 0.015732217 ubox
36 43 0.013261408 ubox
36 54 0.005511016 ubox
36 58 0.003820886 ubox
36 62 0.003322260 ubox
36 70 0.006348365 ubox
36 76 0.016261586 ubox
37 55 0.149254714 ubox
37 59 0.006122684 ubox
37 63 0.025245679 ubox
37 71 0.095759453 ubox
37 77 0.015628134 ubox
38 43 0.007109225 ubox
38 51 0.011287299 ubox
38 54 0.149988063 ubox
38 57 0.010326468 ubox
38 58 0.006126544 ubox
38 62 0.036482345 ubox
38 66 0.106937056 ubox
38 70 0.153885680 ubox
38 74 0.020119256 ubox
38 76 0.018816236 ubox
39 45 0.042437925 ubox
39 50 0.011787450 ubox
39 53 0.148376390 ubox
39 56 0.010516473 ubox
39 57 0.004766918 ubox
39 60 0.035789713 ubox
39 61 0.037823562 ubox
39 64 0.158242433 ubox
39 65 0.105886207 ubox
39 69 0.159286247 ubox
39 72 0.065181703 ubox
39 73 0.018663044 ubox
39 75 0.019101427 ubox
39 79 0.769948972 ubox
40 44 0.042460293 ubox
40 59 0.036300018 ubox
40 63 0.161772740 ubox
40 71 0.065942064 ubox
40 78 0.771834282 ubox
41 47 0.030720324 ubox
41 77 0.771445474 ubox
41 78 0.007291987 ubox
42 46 0.027768830 ubox
42 48 0.020192900 ubox
42 49 0.092383242 ubox
42 77 0.007611972 ubox
43 47 0.018922550 ubox
43 48 0.099217396 ubox
43 55 0.005302144 ubox
43 63 0.005172118 ubox
43 71 0.003423116 ubox
44 54 0.004212138 ubox
44 58 0.005187394 ubox
44 60 0.295108496 ubox
44 64 0.472645862 ubox
44 72 0.764269817 ubox
44 79 0.009726327 ubox
45 59 0.295906696 ubox
45 63 0.474100334 ubox
45 71 0.765228597 ubox
45 77 0.017571654 ubox
45 78 0.007144815 ubox
46 52 0.008852137 ubox
46 54 0.124252753 ubox
46 57 0.118735767 ubox
46 58 0.267679251 ubox
46 62 0.474084509 ubox
46 66 0.007888326 ubox
46 70 0.764546082 ubox
46 74 0.005623052 ubox
46 76 0.020709376 ubox
47 51 0.006826655 ubox
47 53 0.135686692 ubox
47 56 0.163594874 ubox
47 57 0.212275632 ubox
47 58 0.026875227 ubox
47 61 0.472725051 ubox
47 65 0.009989995 ubox
47 67 0.039439796 ubox
47 69 0.761632905 ubox
47 73 0.005805303 ubox
47 75 0.020864283 ubox
48 52 0.118453228 ubox
48 57 0.050688611 ubox
48 58 0.054524876 ubox
48 66 0.046652597 ubox
48 74 0.019998881 ubox
49 57 0.057511615 ubox
53 78 0.004989297 ubox
54 63 0.127487496 ubox
54 77 0.005053297 ubox
55 62 0.124612382 ubox
55 76 0.004811950 ubox
56 78 0.006564193 ubox
57 77 0.006495818 ubox
59 72 0.018046778 ubox
59 79 0.182073508 ubox
60 71 0.018057284 ubox
60 78 0.182664263 ubox
61 77 0.182486003 ubox
61 78 0.004190489 ubox
62 71 0.004064989 ubox
62 77 0.004535015 ubox
63 70 0.004736131 ubox
63 72 0.142008106 ubox
63 76 0.005221813 ubox
63 79 0.297419826 ubox
64 71 0.142214186 ubox
64 78 0.298465671 ubox
65 77 0.298450643 ubox
65 78 0.004305564 ubox
66 77 0.004100417 ubox
66 78 0.003290383 ubox
67 77 0.004507416 ubox
67 78 0.037094105 ubox
68 77 0.037425651 ubox
68 78 0.083140377 ubox
69 77 0.083979864 ubox
69 78 0.014397889 ubox
70 77 0.014147187 ubox
71 76 0.010299986 ubox
71 79 0.440081270 ubox
72 78 0.441855919 ubox
73 77 0.438674338 ubox
8 33 0.9500000 lbox
9 32 0.9500000 lbox
10 30 0.9500000 lbox
11 29 0.9500000 lbox
13 26 0.9500000 lbox
14 25 0.9500000 lbox
15 24 0.9500000 lbox
16 23 0.9500000 lbox
39 79 0.9500000 lbox
40 78 0.9500000 lbox
41 77 0.9500000 lbox
44 72 0.9500000 lbox
45 71 0.9500000 lbox
46 70 0.9500000 lbox
47 69 0.9500000 lbox
showpage
end
%%EOF
