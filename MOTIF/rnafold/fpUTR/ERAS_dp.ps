%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:00:55 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (ERAS)
} def

/sequence { (\
AGAGCGUCCCAGCGCGCCCGCCUCCCCACGGACACAGAGCCUGCUGCCCACGUCUCUUCCCUGAGCUGCCUGCUGGGGUC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 55 0.069676146 ubox
1 57 0.857025437 ubox
1 58 0.039348433 ubox
2 54 0.080056193 ubox
2 56 0.985858435 ubox
2 57 0.008300825 ubox
2 58 0.012625724 ubox
2 59 0.019097418 ubox
2 80 0.022637500 ubox
3 53 0.068482788 ubox
3 55 0.986132702 ubox
3 57 0.013380638 ubox
3 58 0.018780028 ubox
3 79 0.022350056 ubox
4 15 0.011287649 ubox
4 17 0.008102392 ubox
4 53 0.163442388 ubox
4 54 0.976251263 ubox
4 56 0.011561603 ubox
4 57 0.005610124 ubox
4 79 0.021463454 ubox
5 14 0.011309147 ubox
5 16 0.008134548 ubox
5 52 0.991984339 ubox
5 78 0.022319745 ubox
6 13 0.011297221 ubox
6 15 0.008134330 ubox
6 51 0.992000202 ubox
6 79 0.029916344 ubox
7 12 0.010756698 ubox
7 14 0.007847191 ubox
7 50 0.957106077 ubox
7 78 0.089036958 ubox
8 77 0.119155050 ubox
8 78 0.003295511 ubox
9 76 0.119312139 ubox
10 43 0.011647649 ubox
10 46 0.986809370 ubox
10 75 0.119329510 ubox
11 23 0.004425259 ubox
11 42 0.011701875 ubox
11 45 0.990935008 ubox
11 74 0.119317670 ubox
12 21 0.011073745 ubox
12 22 0.004720529 ubox
12 41 0.011688184 ubox
12 44 0.991438515 ubox
12 47 0.047198397 ubox
12 73 0.119344314 ubox
13 20 0.011196036 ubox
13 43 0.991252940 ubox
13 46 0.047249847 ubox
13 72 0.119310016 ubox
14 19 0.010885929 ubox
14 21 0.036144224 ubox
14 40 0.152209584 ubox
14 42 0.960016693 ubox
14 44 0.019649159 ubox
14 45 0.042432330 ubox
14 47 0.012130496 ubox
14 69 0.018614904 ubox
14 71 0.113920930 ubox
15 20 0.036253781 ubox
15 39 0.154121776 ubox
15 43 0.020084816 ubox
15 46 0.012171247 ubox
15 68 0.018839079 ubox
16 40 0.975967134 ubox
16 42 0.017529485 ubox
16 44 0.044856169 ubox
16 45 0.003177502 ubox
16 66 0.009717624 ubox
16 67 0.012867875 ubox
16 69 0.115264303 ubox
16 79 0.003458219 ubox
17 31 0.005078396 ubox
17 39 0.975150407 ubox
17 43 0.044897399 ubox
17 65 0.009831053 ubox
17 68 0.114875270 ubox
17 78 0.003602329 ubox
18 30 0.004916350 ubox
18 31 0.501317821 ubox
18 77 0.003591067 ubox
19 30 0.501655639 ubox
19 63 0.006120701 ubox
19 68 0.006485555 ubox
19 76 0.003572766 ubox
20 29 0.499781934 ubox
20 40 0.056805683 ubox
20 62 0.005294476 ubox
20 66 0.090712745 ubox
20 67 0.014525391 ubox
20 69 0.003574506 ubox
21 31 0.098788775 ubox
21 39 0.055364714 ubox
21 65 0.070839431 ubox
21 68 0.003575770 ubox
22 30 0.098768038 ubox
22 31 0.018184649 ubox
22 37 0.066669657 ubox
22 39 0.018626505 ubox
22 65 0.069574095 ubox
23 30 0.016916487 ubox
23 31 0.015475425 ubox
23 32 0.821600203 ubox
23 36 0.043654391 ubox
23 38 0.027743188 ubox
23 64 0.089680009 ubox
24 30 0.017510613 ubox
24 31 0.841058536 ubox
24 37 0.027668853 ubox
24 63 0.085727867 ubox
24 78 0.008472167 ubox
25 30 0.838609685 ubox
25 31 0.129318748 ubox
25 77 0.008551956 ubox
26 30 0.129953974 ubox
26 76 0.008555126 ubox
27 63 0.046143108 ubox
27 75 0.008546410 ubox
28 53 0.013281592 ubox
28 62 0.056719870 ubox
28 74 0.007830766 ubox
29 52 0.014025382 ubox
29 63 0.003932609 ubox
29 72 0.006831165 ubox
30 41 0.014043685 ubox
30 48 0.016834055 ubox
30 49 0.021347711 ubox
30 51 0.013503470 ubox
30 55 0.019913489 ubox
30 56 0.007448881 ubox
30 57 0.011150111 ubox
30 59 0.003665742 ubox
30 60 0.093790488 ubox
30 61 0.012492560 ubox
30 62 0.006039490 ubox
30 71 0.006329735 ubox
31 40 0.014061658 ubox
31 47 0.016977405 ubox
31 48 0.021405630 ubox
31 54 0.022013202 ubox
31 56 0.011540677 ubox
31 58 0.003621594 ubox
31 59 0.093955887 ubox
31 60 0.012152593 ubox
31 61 0.006041280 ubox
31 70 0.006313117 ubox
32 53 0.022199039 ubox
32 55 0.011352472 ubox
32 58 0.093336939 ubox
33 46 0.035978489 ubox
33 52 0.022156861 ubox
33 68 0.004011774 ubox
34 45 0.035893792 ubox
34 53 0.010936168 ubox
34 67 0.003584239 ubox
35 43 0.041029139 ubox
35 46 0.052255425 ubox
35 52 0.011090787 ubox
35 72 0.003839099 ubox
36 42 0.041755782 ubox
36 45 0.052501411 ubox
36 55 0.012486111 ubox
36 57 0.094134966 ubox
36 71 0.004819969 ubox
37 41 0.040969718 ubox
37 44 0.052344130 ubox
37 54 0.013070931 ubox
37 56 0.095336973 ubox
37 70 0.004971335 ubox
38 45 0.006950078 ubox
38 53 0.012177176 ubox
38 55 0.095305253 ubox
39 44 0.007041575 ubox
39 47 0.021761284 ubox
39 53 0.013447411 ubox
39 54 0.094435047 ubox
39 69 0.005331642 ubox
40 46 0.021794769 ubox
40 52 0.084644391 ubox
40 68 0.005340666 ubox
42 50 0.082649211 ubox
42 52 0.015714787 ubox
43 49 0.082928297 ubox
43 51 0.017630585 ubox
43 53 0.029067642 ubox
43 66 0.006143869 ubox
44 52 0.029301233 ubox
44 65 0.006148326 ubox
45 52 0.004752705 ubox
45 64 0.006038212 ubox
46 51 0.011722584 ubox
46 53 0.012252486 ubox
46 66 0.004641368 ubox
47 52 0.012983457 ubox
47 65 0.004636512 ubox
49 63 0.004277077 ubox
49 68 0.010203171 ubox
50 62 0.003916178 ubox
50 67 0.011778317 ubox
51 68 0.015122815 ubox
52 66 0.049678458 ubox
52 67 0.017620867 ubox
52 69 0.006644340 ubox
53 64 0.009999236 ubox
53 65 0.007443910 ubox
53 68 0.006397508 ubox
54 63 0.010753046 ubox
54 65 0.063073360 ubox
55 64 0.064482559 ubox
56 63 0.064595419 ubox
57 78 0.007110243 ubox
58 64 0.004699571 ubox
58 77 0.010832044 ubox
58 78 0.140842627 ubox
59 63 0.004871258 ubox
59 76 0.012404445 ubox
59 77 0.191605328 ubox
59 78 0.583181307 ubox
60 75 0.012381378 ubox
60 76 0.191763088 ubox
60 77 0.587546669 ubox
60 78 0.772097419 ubox
61 75 0.191093871 ubox
61 76 0.586872982 ubox
61 77 0.776678673 ubox
61 78 0.004471448 ubox
62 75 0.552924268 ubox
62 76 0.775071239 ubox
62 77 0.003726345 ubox
63 74 0.181593725 ubox
64 71 0.011568447 ubox
64 74 0.968422004 ubox
65 70 0.011662799 ubox
65 73 0.992530433 ubox
65 79 0.003849757 ubox
66 72 0.992321546 ubox
66 78 0.004084430 ubox
67 77 0.003671263 ubox
68 79 0.008826362 ubox
69 76 0.004493264 ubox
69 78 0.009275644 ubox
70 75 0.004531149 ubox
70 77 0.009277745 ubox
71 76 0.009101335 ubox
1 57 0.9500000 lbox
2 56 0.9500000 lbox
3 55 0.9500000 lbox
4 54 0.9500000 lbox
5 52 0.9500000 lbox
6 51 0.9500000 lbox
7 50 0.9500000 lbox
10 46 0.9500000 lbox
11 45 0.9500000 lbox
12 44 0.9500000 lbox
13 43 0.9500000 lbox
14 42 0.9500000 lbox
16 40 0.9500000 lbox
17 39 0.9500000 lbox
23 32 0.9500000 lbox
24 31 0.9500000 lbox
25 30 0.9500000 lbox
60 78 0.9500000 lbox
61 77 0.9500000 lbox
62 76 0.9500000 lbox
64 74 0.9500000 lbox
65 73 0.9500000 lbox
66 72 0.9500000 lbox
showpage
end
%%EOF
