%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 02:11:40 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (TCL1A)
} def

/sequence { (\
GUCCUCCCGCCCCGCCGCUUGGUGGCGGCCGCAUGCUGCCCGGAUAUAAAGGGUCGGCCCCACAUCCCAGGGACCAGCGAGCGGCCUUGAGAGGCUCUGGCUCUUGCUUCUUAGGCGGCCCGAGGACGCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 127 0.998708248 ubox
1 129 0.008415319 ubox
2 126 0.999644276 ubox
2 128 0.006082799 ubox
3 125 0.999990970 ubox
4 124 0.999987423 ubox
5 123 0.999732518 ubox
6 118 0.004348499 ubox
6 122 0.998535932 ubox
7 117 0.003810202 ubox
7 118 0.959677358 ubox
8 27 0.003699037 ubox
8 117 0.960520770 ubox
8 122 0.009891784 ubox
9 26 0.004466831 ubox
9 29 0.012192871 ubox
9 116 0.960492473 ubox
9 119 0.276463077 ubox
9 121 0.016783002 ubox
10 25 0.004421815 ubox
10 28 0.012410029 ubox
10 115 0.960000706 ubox
10 118 0.276645897 ubox
11 24 0.004378535 ubox
11 25 0.006078251 ubox
11 27 0.014192310 ubox
11 114 0.952139392 ubox
11 115 0.027486013 ubox
11 117 0.276317727 ubox
11 118 0.006309401 ubox
12 22 0.005028472 ubox
12 24 0.006315491 ubox
12 25 0.752445248 ubox
12 27 0.009374980 ubox
12 28 0.128294011 ubox
12 84 0.004152933 ubox
12 114 0.038016761 ubox
12 115 0.243344022 ubox
12 117 0.007339747 ubox
12 118 0.025071831 ubox
13 21 0.005040903 ubox
13 24 0.759015495 ubox
13 27 0.241027152 ubox
13 83 0.005395588 ubox
13 114 0.242286393 ubox
13 117 0.026590413 ubox
14 20 0.004085978 ubox
14 23 0.758884340 ubox
14 26 0.647401695 ubox
14 29 0.041719185 ubox
14 82 0.005415469 ubox
14 85 0.022832976 ubox
14 116 0.031847372 ubox
14 119 0.004499537 ubox
15 22 0.759185884 ubox
15 25 0.647985945 ubox
15 28 0.042071373 ubox
15 81 0.005415013 ubox
15 84 0.022881862 ubox
15 115 0.031882901 ubox
15 118 0.004512316 ubox
16 21 0.758090253 ubox
16 24 0.647968467 ubox
16 27 0.042558050 ubox
16 79 0.005412737 ubox
16 83 0.022896599 ubox
16 114 0.031734189 ubox
16 117 0.004517697 ubox
17 23 0.645293184 ubox
17 26 0.055710428 ubox
17 78 0.005415594 ubox
17 82 0.022897035 ubox
17 116 0.004540011 ubox
18 22 0.641547725 ubox
18 25 0.055728960 ubox
18 77 0.005393121 ubox
18 81 0.022897204 ubox
18 115 0.004537209 ubox
19 24 0.054278434 ubox
19 76 0.004217723 ubox
19 80 0.022887650 ubox
19 114 0.004500833 ubox
20 76 0.003265519 ubox
20 79 0.022856589 ubox
20 113 0.004250861 ubox
21 75 0.004585849 ubox
21 78 0.022769021 ubox
21 111 0.004006964 ubox
21 112 0.003416331 ubox
22 63 0.015990029 ubox
22 74 0.003580421 ubox
22 110 0.004719926 ubox
23 62 0.016160158 ubox
23 76 0.016771463 ubox
24 61 0.016358176 ubox
24 75 0.016761946 ubox
24 108 0.005232340 ubox
25 60 0.016362575 ubox
25 74 0.016539488 ubox
25 87 0.009501994 ubox
25 107 0.005436273 ubox
26 38 0.004258551 ubox
26 89 0.008742816 ubox
26 106 0.005442023 ubox
26 115 0.003306664 ubox
27 37 0.004343830 ubox
27 59 0.020516487 ubox
27 86 0.967756654 ubox
27 87 0.008196556 ubox
28 36 0.004358509 ubox
28 58 0.022159784 ubox
28 85 0.990263056 ubox
28 86 0.010756841 ubox
29 35 0.004350689 ubox
29 57 0.022172706 ubox
29 84 0.996511574 ubox
30 56 0.022172038 ubox
30 83 0.999614045 ubox
31 55 0.022121040 ubox
31 82 0.999688040 ubox
32 81 0.999595083 ubox
33 54 0.005188737 ubox
34 53 0.005034954 ubox
34 79 0.989597786 ubox
35 58 0.012500307 ubox
35 78 0.999611272 ubox
36 51 0.005059967 ubox
36 57 0.012595509 ubox
36 77 0.999644127 ubox
37 50 0.005031906 ubox
37 56 0.012719804 ubox
37 76 0.997494957 ubox
38 54 0.130381394 ubox
38 55 0.043273880 ubox
38 58 0.003349692 ubox
38 75 0.977202519 ubox
39 53 0.147190307 ubox
39 57 0.003750490 ubox
39 71 0.074957353 ubox
39 72 0.978655442 ubox
40 52 0.147279634 ubox
40 53 0.004369537 ubox
40 56 0.003539993 ubox
40 57 0.009555487 ubox
40 70 0.075053918 ubox
40 71 0.983706353 ubox
40 72 0.068558257 ubox
41 51 0.147250885 ubox
41 52 0.004416228 ubox
41 56 0.009722068 ubox
41 70 0.979358607 ubox
41 71 0.068470259 ubox
42 55 0.008989549 ubox
42 66 0.005075651 ubox
42 67 0.898535284 ubox
42 68 0.359403236 ubox
43 54 0.006733277 ubox
43 55 0.006148478 ubox
43 65 0.004228049 ubox
43 66 0.912177106 ubox
43 67 0.336698369 ubox
44 54 0.007264443 ubox
44 65 0.918235902 ubox
45 53 0.007191544 ubox
45 64 0.867913192 ubox
46 65 0.126403514 ubox
47 64 0.136874444 ubox
51 59 0.186961513 ubox
51 60 0.829716431 ubox
51 61 0.499096053 ubox
51 67 0.003655271 ubox
51 68 0.005979490 ubox
52 58 0.187252746 ubox
52 59 0.831537557 ubox
52 60 0.499115056 ubox
52 61 0.044692319 ubox
52 66 0.003806106 ubox
52 67 0.006032626 ubox
53 58 0.826834303 ubox
53 59 0.496787015 ubox
53 60 0.044527894 ubox
53 63 0.003514499 ubox
53 65 0.003715628 ubox
53 66 0.006026907 ubox
54 62 0.003398712 ubox
54 64 0.003640514 ubox
56 75 0.140508882 ubox
57 74 0.141172601 ubox
58 72 0.048198356 ubox
59 71 0.047737709 ubox
59 72 0.138030402 ubox
60 70 0.047180901 ubox
60 71 0.138668631 ubox
60 72 0.004293373 ubox
61 70 0.138807150 ubox
61 71 0.004281391 ubox
65 73 0.015874007 ubox
66 71 0.003300611 ubox
66 72 0.017448103 ubox
67 71 0.017328291 ubox
76 108 0.003633049 ubox
77 107 0.003884867 ubox
78 106 0.003885329 ubox
79 105 0.003798056 ubox
80 104 0.003796157 ubox
81 103 0.003788461 ubox
81 119 0.003276424 ubox
82 118 0.003282584 ubox
83 102 0.003741938 ubox
83 120 0.003967861 ubox
84 95 0.003765634 ubox
84 101 0.003854554 ubox
84 116 0.078747877 ubox
84 119 0.004349323 ubox
85 94 0.004225181 ubox
85 100 0.003872004 ubox
85 115 0.083871372 ubox
85 118 0.004379015 ubox
86 93 0.004245984 ubox
86 99 0.003881083 ubox
86 114 0.084730788 ubox
86 115 0.078691556 ubox
86 117 0.004007333 ubox
87 92 0.003931570 ubox
87 113 0.074919598 ubox
87 114 0.138695507 ubox
88 106 0.018338599 ubox
88 113 0.927135362 ubox
89 97 0.010030118 ubox
89 105 0.033026841 ubox
89 112 0.991566231 ubox
90 96 0.010033770 ubox
90 98 0.004645144 ubox
90 104 0.034242953 ubox
90 111 0.998204975 ubox
90 112 0.007190455 ubox
91 95 0.009815172 ubox
91 97 0.004769449 ubox
91 103 0.034403770 ubox
91 105 0.003238445 ubox
91 110 0.999269725 ubox
91 112 0.006228692 ubox
92 96 0.004150273 ubox
92 102 0.033949124 ubox
92 104 0.003957206 ubox
92 109 0.998712635 ubox
92 111 0.006459396 ubox
93 101 0.031988689 ubox
93 102 0.008830021 ubox
93 103 0.004334059 ubox
93 107 0.003174360 ubox
93 108 0.998217365 ubox
93 110 0.006483439 ubox
94 101 0.015402846 ubox
94 107 0.999092734 ubox
94 109 0.006321399 ubox
95 100 0.019135860 ubox
95 106 0.998808717 ubox
99 105 0.034091668 ubox
99 108 0.020389001 ubox
100 104 0.023384758 ubox
100 107 0.022169184 ubox
101 106 0.022469564 ubox
106 116 0.010344697 ubox
107 115 0.010343169 ubox
108 114 0.010159202 ubox
109 113 0.007799236 ubox
1 127 0.9500000 lbox
2 126 0.9500000 lbox
3 125 0.9500000 lbox
4 124 0.9500000 lbox
5 123 0.9500000 lbox
6 122 0.9500000 lbox
7 118 0.9500000 lbox
8 117 0.9500000 lbox
9 116 0.9500000 lbox
10 115 0.9500000 lbox
11 114 0.9500000 lbox
12 25 0.9500000 lbox
13 24 0.9500000 lbox
14 23 0.9500000 lbox
15 22 0.9500000 lbox
16 21 0.9500000 lbox
27 86 0.9500000 lbox
28 85 0.9500000 lbox
29 84 0.9500000 lbox
30 83 0.9500000 lbox
31 82 0.9500000 lbox
32 81 0.9500000 lbox
34 79 0.9500000 lbox
35 78 0.9500000 lbox
36 77 0.9500000 lbox
37 76 0.9500000 lbox
38 75 0.9500000 lbox
39 72 0.9500000 lbox
40 71 0.9500000 lbox
41 70 0.9500000 lbox
42 67 0.9500000 lbox
43 66 0.9500000 lbox
44 65 0.9500000 lbox
45 64 0.9500000 lbox
51 60 0.9500000 lbox
52 59 0.9500000 lbox
53 58 0.9500000 lbox
88 113 0.9500000 lbox
89 112 0.9500000 lbox
90 111 0.9500000 lbox
91 110 0.9500000 lbox
92 109 0.9500000 lbox
93 108 0.9500000 lbox
94 107 0.9500000 lbox
95 106 0.9500000 lbox
showpage
end
%%EOF
