%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 04:02:03 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (EHF)
} def

/sequence { (\
AACCCACUGCUUUAUUCUGCCCUGAGUGGAGAUUGGUUUUGGCUCAGGCUGCUUUGUGAAACUCAGAAGCAUUAUCCUCUCUGCCAACUCCACGUCCUAGUCAGAGUUUUCUGUGAAGGCAAGGGC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
3 124 0.091062311 ubox
3 125 0.955008257 ubox
4 29 0.004915155 ubox
4 123 0.091098355 ubox
4 124 0.959157458 ubox
4 125 0.260248782 ubox
5 24 0.004868655 ubox
5 28 0.004930112 ubox
5 123 0.957416597 ubox
5 124 0.262925781 ubox
6 23 0.004871050 ubox
6 27 0.004935074 ubox
7 26 0.004936684 ubox
7 119 0.021801067 ubox
7 123 0.121789992 ubox
7 124 0.007123083 ubox
7 125 0.003316301 ubox
8 25 0.004879284 ubox
8 118 0.011978051 ubox
8 121 0.887041915 ubox
8 122 0.092499187 ubox
8 123 0.004926822 ubox
9 20 0.042195092 ubox
9 120 0.917323758 ubox
9 126 0.006253809 ubox
10 19 0.042332915 ubox
10 31 0.013742347 ubox
10 118 0.578226802 ubox
10 119 0.813786112 ubox
10 125 0.006322493 ubox
11 30 0.013990858 ubox
11 116 0.010233049 ubox
11 117 0.716565045 ubox
11 118 0.690306203 ubox
11 124 0.006271700 ubox
12 29 0.014115721 ubox
12 115 0.015976098 ubox
12 116 0.792508598 ubox
12 117 0.597166447 ubox
12 118 0.005989307 ubox
12 123 0.006066134 ubox
13 28 0.014369956 ubox
13 113 0.048850786 ubox
13 115 0.862560506 ubox
13 116 0.484416068 ubox
13 117 0.005793204 ubox
13 122 0.005826598 ubox
14 27 0.015916970 ubox
14 107 0.065598423 ubox
14 112 0.062056071 ubox
14 114 0.915555664 ubox
15 26 0.016097595 ubox
15 106 0.066706623 ubox
15 113 0.907756802 ubox
15 116 0.009229226 ubox
15 117 0.022176456 ubox
16 25 0.018085668 ubox
16 30 0.003310331 ubox
16 105 0.069293221 ubox
16 115 0.010621413 ubox
16 116 0.028502230 ubox
17 24 0.018291715 ubox
17 29 0.003471975 ubox
17 104 0.069331938 ubox
17 106 0.014838151 ubox
17 115 0.029499949 ubox
17 123 0.003218334 ubox
18 28 0.003459638 ubox
18 103 0.069143108 ubox
18 105 0.014690012 ubox
18 113 0.018503589 ubox
18 115 0.007454376 ubox
18 121 0.006978743 ubox
19 27 0.003497401 ubox
19 49 0.006132931 ubox
19 101 0.011406161 ubox
19 102 0.068094999 ubox
19 107 0.981287853 ubox
19 112 0.004556736 ubox
19 114 0.011580286 ubox
19 120 0.007483588 ubox
19 126 0.025128607 ubox
20 26 0.003504591 ubox
20 48 0.005021451 ubox
20 100 0.054609884 ubox
20 106 0.988228355 ubox
20 113 0.011822452 ubox
20 119 0.007475108 ubox
20 125 0.025427300 ubox
21 47 0.003560910 ubox
21 48 0.005499298 ubox
21 118 0.007428153 ubox
21 124 0.025438043 ubox
22 47 0.006565183 ubox
22 100 0.025991288 ubox
22 104 0.995413993 ubox
22 106 0.006414842 ubox
22 123 0.025241774 ubox
23 46 0.007459284 ubox
23 99 0.024680018 ubox
23 103 0.996688874 ubox
23 105 0.004421199 ubox
23 121 0.005119066 ubox
23 122 0.023733810 ubox
24 45 0.007472461 ubox
24 96 0.062013902 ubox
24 98 0.011098789 ubox
24 102 0.996998245 ubox
24 120 0.007162369 ubox
25 44 0.007471506 ubox
25 95 0.060730368 ubox
25 101 0.994258821 ubox
26 43 0.007472516 ubox
26 93 0.077508040 ubox
27 42 0.007463944 ubox
27 92 0.077694811 ubox
27 99 0.989547582 ubox
27 100 0.004282630 ubox
28 91 0.077751525 ubox
28 97 0.140704867 ubox
28 98 0.986229648 ubox
29 40 0.007424785 ubox
29 90 0.077752276 ubox
29 96 0.142233877 ubox
29 97 0.986228802 ubox
30 39 0.007434874 ubox
30 89 0.077736101 ubox
30 95 0.142499255 ubox
30 98 0.003528331 ubox
31 38 0.007158464 ubox
31 88 0.077692507 ubox
31 96 0.983057715 ubox
32 37 0.006239099 ubox
32 95 0.982234626 ubox
33 87 0.074875728 ubox
33 94 0.960259237 ubox
34 86 0.075711451 ubox
34 92 0.973327926 ubox
34 94 0.008716553 ubox
35 85 0.075801226 ubox
35 89 0.005956784 ubox
35 90 0.007253903 ubox
35 91 0.996751875 ubox
35 93 0.006384341 ubox
36 84 0.075795494 ubox
36 88 0.007728680 ubox
36 89 0.005919739 ubox
36 90 0.996691386 ubox
37 83 0.074804507 ubox
37 87 0.007845812 ubox
38 86 0.003859929 ubox
38 87 0.022378164 ubox
39 86 0.016217912 ubox
39 87 0.979681208 ubox
40 83 0.003921759 ubox
40 86 0.995402646 ubox
41 50 0.014321858 ubox
41 77 0.027443560 ubox
41 78 0.009415504 ubox
41 79 0.035636948 ubox
41 80 0.029529163 ubox
41 81 0.030568999 ubox
41 82 0.025398918 ubox
41 85 0.997078233 ubox
42 49 0.020991919 ubox
42 76 0.027255019 ubox
42 77 0.011192594 ubox
42 78 0.025086404 ubox
42 79 0.032086251 ubox
42 80 0.028990573 ubox
42 81 0.025543713 ubox
42 84 0.997086005 ubox
43 48 0.021084707 ubox
43 83 0.996429297 ubox
45 83 0.020700876 ubox
46 73 0.010804595 ubox
46 78 0.917653001 ubox
46 80 0.296165610 ubox
46 82 0.044008923 ubox
47 72 0.010401644 ubox
47 73 0.022393834 ubox
47 76 0.064383437 ubox
47 77 0.948244105 ubox
47 78 0.059391114 ubox
47 79 0.291389328 ubox
47 80 0.023614168 ubox
47 81 0.046070484 ubox
47 82 0.011338376 ubox
48 70 0.023465232 ubox
48 72 0.044638178 ubox
48 75 0.073027802 ubox
48 76 0.946958701 ubox
48 77 0.153075405 ubox
48 78 0.229361801 ubox
48 79 0.029462191 ubox
48 80 0.039039083 ubox
48 81 0.011466703 ubox
49 66 0.005045211 ubox
49 69 0.023814722 ubox
50 65 0.005063557 ubox
50 68 0.021824619 ubox
50 71 0.951521572 ubox
50 74 0.125795952 ubox
51 64 0.005067387 ubox
51 70 0.998546886 ubox
51 73 0.036323261 ubox
52 66 0.017414515 ubox
52 69 0.998110028 ubox
53 65 0.017124782 ubox
53 67 0.136464612 ubox
53 68 0.952594672 ubox
53 69 0.051319327 ubox
54 61 0.006346318 ubox
54 66 0.193063452 ubox
54 67 0.901512721 ubox
54 68 0.261826123 ubox
55 60 0.007422865 ubox
55 65 0.231609286 ubox
55 66 0.806557676 ubox
55 67 0.363937421 ubox
55 71 0.013654246 ubox
56 62 0.070817373 ubox
56 64 0.252125156 ubox
56 70 0.013842823 ubox
56 72 0.003374591 ubox
57 61 0.064086405 ubox
57 65 0.858563508 ubox
57 69 0.013521858 ubox
57 71 0.003425848 ubox
58 64 0.927886019 ubox
58 70 0.003423384 ubox
59 63 0.807524301 ubox
79 106 0.004859617 ubox
80 105 0.004929854 ubox
81 104 0.004941217 ubox
82 103 0.004939311 ubox
83 102 0.004904682 ubox
86 108 0.004308125 ubox
87 107 0.004769822 ubox
88 106 0.004826158 ubox
89 105 0.004825564 ubox
90 104 0.004816441 ubox
92 101 0.005446746 ubox
93 100 0.005736070 ubox
94 120 0.022810209 ubox
94 126 0.009099414 ubox
95 119 0.007702685 ubox
95 125 0.009152882 ubox
96 118 0.007204424 ubox
96 119 0.026311896 ubox
96 124 0.009205793 ubox
97 118 0.026681196 ubox
97 123 0.009206475 ubox
98 117 0.025666529 ubox
98 122 0.008999086 ubox
100 114 0.005365647 ubox
100 120 0.007669095 ubox
101 116 0.022637356 ubox
101 119 0.006719327 ubox
102 113 0.021639465 ubox
102 115 0.025341016 ubox
102 118 0.004063003 ubox
103 112 0.021981351 ubox
103 114 0.025453867 ubox
104 111 0.022111736 ubox
105 110 0.020755350 ubox
105 112 0.043265250 ubox
106 111 0.043960528 ubox
106 120 0.042513083 ubox
107 116 0.003317214 ubox
107 117 0.003312078 ubox
107 119 0.042519310 ubox
108 115 0.006955821 ubox
108 116 0.006382485 ubox
108 117 0.004004415 ubox
108 118 0.042671408 ubox
109 115 0.007940220 ubox
109 116 0.005032725 ubox
109 117 0.043805232 ubox
110 115 0.005173926 ubox
110 116 0.044588174 ubox
110 119 0.003988980 ubox
111 115 0.044728162 ubox
111 118 0.008858835 ubox
112 117 0.008973660 ubox
112 121 0.007098875 ubox
113 120 0.007978106 ubox
114 119 0.007886294 ubox
119 126 0.003649806 ubox
120 125 0.003688484 ubox
3 125 0.9500000 lbox
4 124 0.9500000 lbox
5 123 0.9500000 lbox
8 121 0.9500000 lbox
9 120 0.9500000 lbox
10 119 0.9500000 lbox
11 117 0.9500000 lbox
12 116 0.9500000 lbox
13 115 0.9500000 lbox
14 114 0.9500000 lbox
15 113 0.9500000 lbox
19 107 0.9500000 lbox
20 106 0.9500000 lbox
22 104 0.9500000 lbox
23 103 0.9500000 lbox
24 102 0.9500000 lbox
25 101 0.9500000 lbox
27 99 0.9500000 lbox
28 98 0.9500000 lbox
29 97 0.9500000 lbox
31 96 0.9500000 lbox
32 95 0.9500000 lbox
33 94 0.9500000 lbox
34 92 0.9500000 lbox
35 91 0.9500000 lbox
36 90 0.9500000 lbox
39 87 0.9500000 lbox
40 86 0.9500000 lbox
41 85 0.9500000 lbox
42 84 0.9500000 lbox
43 83 0.9500000 lbox
46 78 0.9500000 lbox
47 77 0.9500000 lbox
48 76 0.9500000 lbox
50 71 0.9500000 lbox
51 70 0.9500000 lbox
52 69 0.9500000 lbox
53 68 0.9500000 lbox
54 67 0.9500000 lbox
55 66 0.9500000 lbox
57 65 0.9500000 lbox
58 64 0.9500000 lbox
59 63 0.9500000 lbox
showpage
end
%%EOF
