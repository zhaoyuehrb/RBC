%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:36:35 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
CCCUGUCCCUGGCUCACGUGAUCGCGCCUAGGGAGAAAACGUCUGACUCCAGCCACCGGCCUUCAAGGCACGGCUUUUUAUUCCUUCGGCUGGUCGGCCUCUCGCCCUUCAGCUACCUGUGCGUCCCUCCGUCCCGUCCCGUCCCGGGGUCACCCCGGAGCCUGUCCGCU\
) } def
/len { sequence length } bind def

/coor [
[120.15838623 728.47534180]
[105.30429077 725.67401123]
[91.93659973 718.61737061]
[81.24394989 707.93286133]
[74.17713165 694.57055664]
[71.36451721 679.71856689]
[73.05621338 664.69763184]
[79.10177612 650.84326172]
[88.96365356 639.38751221]
[101.76493073 631.34893799]
[116.36732483 627.44232178]
[116.91835785 612.45245361]
[117.46939087 597.46258545]
[118.02042389 582.47271729]
[118.57145691 567.48284912]
[105.32879639 554.88366699]
[105.46452332 536.28717041]
[119.35718536 523.45037842]
[119.35718536 508.45037842]
[119.35718536 493.45037842]
[119.35718536 478.45037842]
[119.35718536 463.45037842]
[119.35718536 448.45037842]
[111.61988831 435.72311401]
[119.35718536 421.92294312]
[119.35718536 406.92294312]
[106.38986969 399.59393311]
[98.78147125 386.67230225]
[98.66163635 371.57754517]
[106.16268158 358.36273193]
[119.35718536 350.62631226]
[119.35718536 335.62631226]
[119.35718536 320.62631226]
[119.35718536 305.62631226]
[106.38986969 298.29733276]
[98.78147125 285.37570190]
[98.66163635 270.28094482]
[106.16268158 257.06613159]
[119.35718536 249.32971191]
[119.35718536 234.32971191]
[119.35718536 219.32971191]
[105.78413391 210.12767029]
[100.30263519 194.49662781]
[105.25390625 178.51582336]
[118.88034821 168.52572632]
[118.60478973 153.52825928]
[118.32922363 138.53079224]
[72.61013031 131.89196777]
[60.34766388 88.06243134]
[52.72865295 75.14148712]
[45.10964203 62.22055054]
[37.49063110 49.29961014]
[29.87162209 36.37866974]
[22.25261116 23.45773125]
[12.86634254 17.87607193]
[10.76570892 8.41631317]
[0.30625731 -2.33542418]
[-10.15319443 -13.08716202]
[-20.71096802 -23.74236679]
[-31.36617470 -34.30014038]
[-42.02138138 -44.85791397]
[-52.67658615 -55.41569138]
[-68.18359375 -62.26908875]
[-65.89079285 -79.06728363]
[-49.11436462 -81.51429749]
[-42.11881256 -66.07089233]
[-31.46360588 -55.51312256]
[-20.80840111 -44.95534515]
[-10.15319443 -34.39757156]
[-3.16192365 -31.91381264]
[0.59854299 -23.54661369]
[11.05799484 -12.79487610]
[21.51744652 -2.04313850]
[18.91596031 -16.81582451]
[21.98726845 -31.49802780]
[30.29198456 -43.98929214]
[42.64202499 -52.50260544]
[57.27058029 -55.82003784]
[72.08486938 -53.46699905]
[84.96554565 -45.78011322]
[94.06988525 -33.85907745]
[98.09539795 -19.40933037]
[96.46620941 -4.49806881]
[89.41537476 8.74148369]
[77.95159912 18.41526222]
[63.71491623 23.13932037]
[48.74203110 22.23783302]
[35.17354965 15.83872032]
[42.79256058 28.75965881]
[50.41157150 41.68059921]
[58.03058243 54.60153961]
[65.64958954 67.52247620]
[73.26860046 80.44342041]
[80.76734161 80.58119965]
[95.76480865 80.85675812]
[103.26354218 80.99454498]
[111.35206604 68.36221313]
[119.44058990 55.72988129]
[117.42254639 39.81425858]
[128.71049500 28.41418076]
[144.64527893 30.27480888]
[153.00311279 43.96883011]
[147.37257385 58.99136734]
[132.07292175 63.81840897]
[123.98439789 76.45073700]
[115.89587402 89.08306885]
[120.76934814 94.78387451]
[132.17095947 85.03691864]
[146.91847229 82.29630280]
[141.91792297 96.43852997]
[130.51631165 106.18548584]
[135.38978577 111.88629913]
[149.12638855 105.86086273]
[153.34553528 90.80321503]
[166.28555298 82.02313232]
[181.83656311 83.66629791]
[192.65585327 94.95686340]
[193.63488770 110.56377411]
[184.31140137 123.11791229]
[169.08764648 126.69160461]
[155.15182495 119.59746552]
[141.41522217 125.62289429]
[133.32669067 138.25521851]
[133.60224915 153.25270081]
[133.87782288 168.25016785]
[145.74876404 175.29751587]
[152.52494812 187.20075989]
[152.52481079 200.78924561]
[145.85557556 212.50398254]
[134.35719299 219.32971191]
[134.35719299 234.32971191]
[134.35719299 249.32971191]
[147.55169678 257.06613159]
[155.05274963 270.28094482]
[154.93290710 285.37570190]
[147.32450867 298.29733276]
[134.35719299 305.62631226]
[134.35719299 320.62631226]
[134.35719299 335.62631226]
[134.35719299 350.62631226]
[147.55169678 358.36273193]
[155.05274963 371.57754517]
[154.93290710 386.67230225]
[147.32450867 399.59393311]
[134.35719299 406.92294312]
[134.35719299 421.92294312]
[142.09448242 435.72311401]
[134.35719299 448.45037842]
[134.35719299 463.45037842]
[134.35719299 478.45037842]
[134.35719299 493.45037842]
[134.35719299 508.45037842]
[134.35719299 523.45037842]
[144.27427673 530.08874512]
[149.68417358 540.59100342]
[149.33831787 552.27954102]
[143.43931580 562.23681641]
[133.56132507 568.03387451]
[133.01029968 583.02374268]
[132.45927429 598.01361084]
[131.90823364 613.00347900]
[131.35720825 627.99334717]
[145.63336182 632.96154785]
[157.80987549 641.91833496]
[166.80404663 654.06726074]
[171.81608582 668.32806396]
[172.40034485 683.43267822]
[168.50488281 698.03808594]
[160.47604370 710.84545898]
[149.02778625 720.71606445]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[11 162]
[12 161]
[13 160]
[14 159]
[15 158]
[18 153]
[19 152]
[20 151]
[21 150]
[22 149]
[23 148]
[25 146]
[26 145]
[31 140]
[32 139]
[33 138]
[34 137]
[39 132]
[40 131]
[41 130]
[45 125]
[46 124]
[47 123]
[49 93]
[50 92]
[51 91]
[52 90]
[53 89]
[54 88]
[56 73]
[57 72]
[58 71]
[59 69]
[60 68]
[61 67]
[62 66]
[96 106]
[97 105]
[98 104]
[112 122]
[113 121]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
