%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:16:14 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (CT45A7)
} def

/sequence { (\
GCCAUUUUGUGAGGUGCCGCCGUCUCUCCUCCAGCAAGGUCAGGACUUCAGGACUGAAACA\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 10 0.021243382 ubox
1 15 0.064733319 ubox
1 17 0.021181564 ubox
1 20 0.027989568 ubox
1 35 0.033603346 ubox
1 40 0.132569209 ubox
2 9 0.023017371 ubox
2 14 0.067148555 ubox
2 16 0.016115795 ubox
2 19 0.027980282 ubox
2 34 0.033469334 ubox
2 39 0.198043301 ubox
2 44 0.138038451 ubox
2 52 0.077909013 ubox
3 9 0.020278321 ubox
3 11 0.037311262 ubox
3 13 0.067057859 ubox
3 16 0.038967858 ubox
3 38 0.198132076 ubox
3 43 0.138029201 ubox
3 51 0.078117692 ubox
3 56 0.546996130 ubox
4 8 0.016883355 ubox
4 10 0.037351412 ubox
4 15 0.041682110 ubox
4 40 0.159466164 ubox
4 55 0.533132024 ubox
5 9 0.034667129 ubox
5 12 0.044420730 ubox
5 13 0.004312712 ubox
5 14 0.041554939 ubox
5 34 0.004459752 ubox
5 37 0.093121318 ubox
5 38 0.007041121 ubox
5 39 0.184313813 ubox
5 51 0.003223875 ubox
5 52 0.006846157 ubox
5 53 0.070425744 ubox
5 57 0.096788894 ubox
5 58 0.076688716 ubox
5 59 0.049437415 ubox
6 11 0.043656238 ubox
6 12 0.007483007 ubox
6 13 0.038986217 ubox
6 34 0.006795992 ubox
6 36 0.092356815 ubox
6 37 0.013793137 ubox
6 38 0.198631065 ubox
6 39 0.004433499 ubox
6 51 0.009128640 ubox
6 52 0.068819456 ubox
6 53 0.225219495 ubox
6 56 0.098829013 ubox
6 57 0.087220047 ubox
6 58 0.058871855 ubox
6 59 0.014984779 ubox
7 11 0.007194393 ubox
7 12 0.031778345 ubox
7 33 0.006373189 ubox
7 34 0.172030400 ubox
7 36 0.012445818 ubox
7 37 0.216172970 ubox
7 38 0.004133540 ubox
7 50 0.004396678 ubox
7 51 0.060594236 ubox
7 52 0.206741022 ubox
7 53 0.751591861 ubox
7 56 0.071103157 ubox
7 57 0.050825998 ubox
7 58 0.012769100 ubox
7 59 0.015511751 ubox
8 33 0.190928388 ubox
8 36 0.218646885 ubox
8 37 0.003395163 ubox
8 50 0.034910282 ubox
8 51 0.149789090 ubox
8 52 0.807163762 ubox
8 56 0.043544879 ubox
8 57 0.008039130 ubox
8 58 0.017671905 ubox
8 61 0.299591299 ubox
9 17 0.003174644 ubox
9 20 0.025069197 ubox
9 32 0.192488927 ubox
9 35 0.219170456 ubox
9 49 0.027630322 ubox
9 54 0.040110456 ubox
9 55 0.031268649 ubox
9 60 0.380669395 ubox
10 16 0.003162727 ubox
10 19 0.025237653 ubox
10 33 0.038409735 ubox
10 34 0.207836385 ubox
10 50 0.860396939 ubox
10 53 0.029685010 ubox
10 56 0.004358524 ubox
10 59 0.378761283 ubox
10 61 0.007186616 ubox
11 18 0.025207222 ubox
11 24 0.019954274 ubox
11 26 0.040727778 ubox
11 28 0.060835209 ubox
11 31 0.282592984 ubox
11 32 0.033312458 ubox
11 48 0.010670038 ubox
11 49 0.867336879 ubox
11 60 0.009060733 ubox
12 23 0.019489757 ubox
12 25 0.040808132 ubox
12 27 0.060963940 ubox
12 30 0.285234506 ubox
12 47 0.011739692 ubox
12 48 0.866974263 ubox
12 55 0.014604642 ubox
13 21 0.063625777 ubox
13 24 0.040621923 ubox
13 26 0.060971494 ubox
13 29 0.285325954 ubox
13 31 0.004320321 ubox
13 32 0.012866389 ubox
13 46 0.010730697 ubox
13 47 0.866207497 ubox
13 54 0.013591795 ubox
13 55 0.380763135 ubox
14 20 0.063816171 ubox
14 23 0.037975520 ubox
14 24 0.011963093 ubox
14 25 0.056878669 ubox
14 26 0.005883135 ubox
14 27 0.003243570 ubox
14 28 0.284758853 ubox
14 30 0.003423302 ubox
14 31 0.012862108 ubox
14 46 0.866910151 ubox
14 54 0.383905000 ubox
14 60 0.011187890 ubox
15 19 0.059744276 ubox
15 22 0.044163434 ubox
15 42 0.013499397 ubox
15 45 0.863352259 ubox
15 53 0.382717062 ubox
15 59 0.011165219 ubox
16 21 0.045143000 ubox
16 23 0.112167552 ubox
16 40 0.056992678 ubox
16 41 0.019515662 ubox
16 60 0.004744467 ubox
17 22 0.116937418 ubox
17 39 0.059305441 ubox
17 44 0.834207152 ubox
17 52 0.386054769 ubox
18 38 0.059221145 ubox
18 43 0.832050198 ubox
18 51 0.386364167 ubox
18 56 0.014067797 ubox
19 35 0.031135694 ubox
19 40 0.803936358 ubox
19 55 0.011486930 ubox
20 34 0.031188720 ubox
20 39 0.836976413 ubox
20 44 0.059653642 ubox
20 52 0.035103621 ubox
21 38 0.836736351 ubox
21 43 0.059481206 ubox
21 51 0.035210488 ubox
21 56 0.011163476 ubox
22 35 0.167915153 ubox
22 40 0.034532603 ubox
22 46 0.389639948 ubox
22 54 0.041287615 ubox
22 60 0.007855304 ubox
23 34 0.132840238 ubox
23 39 0.069878660 ubox
23 44 0.098125840 ubox
23 45 0.388621591 ubox
23 53 0.041397214 ubox
23 57 0.009430198 ubox
23 59 0.007502543 ubox
24 34 0.392664013 ubox
24 38 0.075360287 ubox
24 39 0.031730324 ubox
24 43 0.121160089 ubox
24 44 0.382894877 ubox
24 51 0.004428868 ubox
24 52 0.041278799 ubox
24 56 0.010184602 ubox
25 33 0.380364160 ubox
25 37 0.071984472 ubox
25 38 0.024569368 ubox
25 39 0.021663552 ubox
25 42 0.139661895 ubox
25 43 0.306787929 ubox
25 44 0.025624736 ubox
25 45 0.021026100 ubox
25 50 0.005071109 ubox
25 51 0.036491908 ubox
25 57 0.007559317 ubox
26 34 0.418321211 ubox
26 38 0.030443712 ubox
26 39 0.011398095 ubox
26 43 0.190115586 ubox
26 44 0.022607916 ubox
26 51 0.016596153 ubox
26 56 0.007736160 ubox
27 33 0.402552985 ubox
27 37 0.029641399 ubox
27 38 0.010293709 ubox
27 39 0.006949916 ubox
27 42 0.177646238 ubox
27 43 0.022254817 ubox
27 45 0.072572594 ubox
27 50 0.011392118 ubox
27 53 0.012864329 ubox
28 38 0.007545806 ubox
28 39 0.417859054 ubox
28 43 0.003953792 ubox
28 44 0.080194229 ubox
28 52 0.013252801 ubox
28 56 0.003265687 ubox
29 38 0.418445191 ubox
29 39 0.020060632 ubox
29 43 0.080391715 ubox
29 51 0.013254365 ubox
30 37 0.398465324 ubox
30 38 0.018269924 ubox
30 39 0.018304473 ubox
30 42 0.074599279 ubox
30 45 0.015111502 ubox
30 50 0.010980320 ubox
30 53 0.007620258 ubox
31 38 0.021046502 ubox
31 39 0.146804022 ubox
31 44 0.016568579 ubox
31 52 0.008068383 ubox
32 38 0.146967802 ubox
32 43 0.016558133 ubox
32 51 0.008057901 ubox
33 47 0.005125899 ubox
34 40 0.013281652 ubox
34 46 0.005200677 ubox
35 39 0.013403810 ubox
35 56 0.005580379 ubox
36 48 0.008545978 ubox
36 55 0.003837398 ubox
37 47 0.009518303 ubox
37 48 0.006961501 ubox
37 55 0.004052504 ubox
38 46 0.009741709 ubox
38 47 0.008769600 ubox
38 54 0.003908543 ubox
38 55 0.030957771 ubox
39 46 0.009615247 ubox
39 54 0.036028029 ubox
39 60 0.021660655 ubox
40 45 0.008934289 ubox
40 53 0.036172468 ubox
40 57 0.180219970 ubox
40 59 0.014052375 ubox
41 51 0.005330932 ubox
41 52 0.036213731 ubox
41 56 0.239423539 ubox
42 55 0.239566627 ubox
43 49 0.027826335 ubox
43 54 0.239420777 ubox
43 55 0.007510641 ubox
44 48 0.018116758 ubox
44 54 0.010849256 ubox
46 52 0.113567656 ubox
47 51 0.102645669 ubox
47 53 0.007527031 ubox
47 57 0.004113172 ubox
47 58 0.148916169 ubox
47 59 0.007632220 ubox
48 52 0.006946638 ubox
48 57 0.165381004 ubox
48 58 0.006380688 ubox
49 56 0.167156847 ubox
50 55 0.150603410 ubox
55 61 0.033494003 ubox
56 60 0.043374020 ubox
7 53 0.9500000 lbox
8 52 0.9500000 lbox
10 50 0.9500000 lbox
11 49 0.9500000 lbox
12 48 0.9500000 lbox
13 47 0.9500000 lbox
14 46 0.9500000 lbox
15 45 0.9500000 lbox
17 44 0.9500000 lbox
18 43 0.9500000 lbox
19 40 0.9500000 lbox
20 39 0.9500000 lbox
21 38 0.9500000 lbox
showpage
end
%%EOF
