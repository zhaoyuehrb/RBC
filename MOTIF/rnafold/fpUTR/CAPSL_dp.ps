%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:00:58 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (CAPSL)
} def

/sequence { (\
GAGAAAAGGCAGAACCAGAGUAGAGAUUGACAGUGAGCUGAGCCAAUCAGGCUGUGAAUCUGCAGCAGUGAUCCCAGGUCCUCCAAUUAAUACUAAGAGAGUGGACCAGGGCCCCUGAGGAAGACAG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 73 0.009154895 ubox
2 72 0.010131746 ubox
2 116 0.013997420 ubox
3 115 0.014325398 ubox
7 116 0.034393703 ubox
8 16 0.196155199 ubox
8 44 0.006275109 ubox
8 75 0.006452547 ubox
8 113 0.062875999 ubox
8 114 0.012722765 ubox
8 115 0.035381921 ubox
9 15 0.195884525 ubox
9 21 0.021562819 ubox
9 43 0.006280403 ubox
9 63 0.955003420 ubox
9 66 0.033243234 ubox
9 74 0.006433866 ubox
9 112 0.063075633 ubox
9 113 0.012120735 ubox
9 114 0.033996745 ubox
10 20 0.021993435 ubox
10 42 0.006084669 ubox
10 62 0.956218265 ubox
10 65 0.032980064 ubox
10 70 0.004527391 ubox
10 111 0.060642118 ubox
10 117 0.041543479 ubox
11 39 0.003600649 ubox
11 61 0.955586647 ubox
11 69 0.004349603 ubox
11 116 0.041645710 ubox
12 38 0.003775599 ubox
12 60 0.955411794 ubox
12 73 0.022344475 ubox
12 115 0.041533181 ubox
13 59 0.948181716 ubox
13 72 0.022125839 ubox
14 21 0.034612231 ubox
14 55 0.005331470 ubox
14 69 0.015178929 ubox
15 20 0.035721769 ubox
15 54 0.005072692 ubox
15 68 0.015658804 ubox
15 110 0.003413412 ubox
15 120 0.034606303 ubox
16 29 0.006847136 ubox
16 35 0.007957015 ubox
16 40 0.004321505 ubox
16 54 0.008435335 ubox
16 56 0.952239986 ubox
16 62 0.005057548 ubox
16 70 0.119140164 ubox
16 109 0.003393817 ubox
16 117 0.019886523 ubox
16 119 0.034689789 ubox
17 28 0.006745675 ubox
17 34 0.007997089 ubox
17 39 0.004330694 ubox
17 53 0.008529498 ubox
17 55 0.952052091 ubox
17 61 0.004624478 ubox
17 69 0.119522608 ubox
17 116 0.020151150 ubox
18 27 0.006006054 ubox
18 38 0.004325995 ubox
18 52 0.008441757 ubox
18 60 0.004089021 ubox
18 115 0.020128609 ubox
19 28 0.003970323 ubox
19 53 0.950556781 ubox
19 59 0.003691099 ubox
19 116 0.013081838 ubox
20 27 0.004578443 ubox
20 31 0.008290194 ubox
20 52 0.954130174 ubox
20 63 0.170209592 ubox
20 66 0.178084448 ubox
20 115 0.012906705 ubox
20 125 0.013159951 ubox
21 26 0.004557867 ubox
21 30 0.008148099 ubox
21 35 0.003764736 ubox
21 51 0.944679363 ubox
21 54 0.008271191 ubox
21 62 0.168651021 ubox
21 65 0.172005214 ubox
21 117 0.003678853 ubox
21 124 0.012775210 ubox
22 34 0.003810789 ubox
22 53 0.008466080 ubox
22 61 0.136048938 ubox
22 116 0.004032280 ubox
23 48 0.079901279 ubox
23 52 0.008687787 ubox
23 60 0.123016876 ubox
23 115 0.004057913 ubox
24 47 0.076710096 ubox
24 59 0.111598031 ubox
24 61 0.253793736 ubox
25 48 0.945831818 ubox
25 60 0.267642480 ubox
26 34 0.005224702 ubox
26 47 0.949988002 ubox
26 59 0.272296883 ubox
27 33 0.005265793 ubox
27 36 0.003967873 ubox
27 42 0.003678545 ubox
27 46 0.950520098 ubox
27 50 0.017732687 ubox
27 57 0.021813268 ubox
27 58 0.289075774 ubox
28 32 0.004068763 ubox
28 35 0.004153331 ubox
28 36 0.003218259 ubox
28 41 0.003386065 ubox
28 45 0.950943436 ubox
28 49 0.018052086 ubox
28 56 0.021209651 ubox
28 57 0.290130716 ubox
29 44 0.950316152 ubox
29 48 0.018133859 ubox
29 55 0.008983658 ubox
30 47 0.017680225 ubox
30 55 0.297193444 ubox
31 40 0.944519151 ubox
31 54 0.298196399 ubox
32 39 0.944332056 ubox
32 53 0.298054748 ubox
33 38 0.936564965 ubox
33 43 0.070183619 ubox
33 52 0.297957705 ubox
34 40 0.013219593 ubox
34 42 0.069818136 ubox
34 45 0.017814239 ubox
34 49 0.007235384 ubox
34 51 0.295666998 ubox
35 39 0.007137797 ubox
35 44 0.018614480 ubox
35 48 0.012558337 ubox
36 47 0.012484921 ubox
36 53 0.006575762 ubox
37 43 0.041512822 ubox
37 52 0.008800027 ubox
38 42 0.041232241 ubox
38 50 0.297634358 ubox
38 51 0.007090836 ubox
39 45 0.007365893 ubox
39 49 0.298067121 ubox
39 50 0.003769414 ubox
40 44 0.007494261 ubox
40 48 0.298339020 ubox
41 47 0.295353201 ubox
41 53 0.010172734 ubox
42 52 0.011027547 ubox
43 51 0.011202466 ubox
44 50 0.011231758 ubox
46 72 0.004514619 ubox
47 71 0.005091593 ubox
48 70 0.005203578 ubox
49 69 0.005155990 ubox
51 66 0.013715681 ubox
52 65 0.013742489 ubox
53 64 0.013740020 ubox
54 63 0.013744361 ubox
55 62 0.013510754 ubox
56 61 0.008352696 ubox
59 124 0.003843420 ubox
60 123 0.004802525 ubox
61 67 0.003460047 ubox
61 70 0.003987999 ubox
61 122 0.005383268 ubox
62 66 0.006867783 ubox
62 69 0.019461326 ubox
63 68 0.020092151 ubox
63 70 0.023864568 ubox
63 117 0.017738197 ubox
64 69 0.023968954 ubox
64 116 0.019711510 ubox
65 112 0.006372948 ubox
65 115 0.019863062 ubox
66 111 0.004882815 ubox
66 117 0.375123242 ubox
67 116 0.376202622 ubox
68 112 0.019031253 ubox
68 115 0.375197736 ubox
68 125 0.888989570 ubox
69 76 0.004007237 ubox
69 111 0.006843942 ubox
69 124 0.889140682 ubox
69 126 0.072724519 ubox
70 75 0.004485393 ubox
70 125 0.080689437 ubox
72 111 0.029727946 ubox
72 118 0.007644758 ubox
72 120 0.007828459 ubox
72 121 0.904470868 ubox
72 124 0.005044074 ubox
73 109 0.003228944 ubox
73 110 0.036982944 ubox
73 111 0.405134393 ubox
73 117 0.007773185 ubox
73 119 0.010573252 ubox
73 120 0.910544415 ubox
73 123 0.004396957 ubox
74 109 0.036595635 ubox
74 110 0.410534348 ubox
74 111 0.016355904 ubox
74 119 0.910430900 ubox
74 120 0.007397984 ubox
75 109 0.409908329 ubox
75 110 0.017006155 ubox
75 117 0.905693640 ubox
75 119 0.007965757 ubox
76 116 0.878839923 ubox
77 107 0.413077118 ubox
77 113 0.583046175 ubox
77 114 0.135195310 ubox
77 115 0.684177847 ubox
77 116 0.007138308 ubox
78 106 0.413989115 ubox
78 112 0.664547597 ubox
78 113 0.141630065 ubox
78 114 0.604401639 ubox
78 115 0.005713220 ubox
78 125 0.005025202 ubox
79 104 0.016978964 ubox
79 105 0.413905222 ubox
79 110 0.026109634 ubox
79 111 0.778891322 ubox
79 124 0.005032402 ubox
80 103 0.029469317 ubox
80 104 0.413110412 ubox
80 109 0.027189962 ubox
80 110 0.820439029 ubox
80 111 0.217649365 ubox
80 123 0.005019929 ubox
81 99 0.023152707 ubox
81 101 0.086531564 ubox
81 103 0.403891706 ubox
81 109 0.820257930 ubox
81 110 0.217321869 ubox
81 111 0.262925611 ubox
82 98 0.046112179 ubox
82 100 0.166934031 ubox
82 103 0.003397606 ubox
82 104 0.004714131 ubox
82 105 0.637867506 ubox
82 108 0.528409037 ubox
82 109 0.152262428 ubox
82 110 0.198983240 ubox
82 111 0.134358815 ubox
82 121 0.004958600 ubox
83 97 0.046285889 ubox
83 99 0.172737466 ubox
83 103 0.008793628 ubox
83 104 0.814320103 ubox
83 109 0.199474769 ubox
83 110 0.226703460 ubox
83 111 0.122105788 ubox
83 120 0.005037336 ubox
84 103 0.814110737 ubox
84 109 0.227069706 ubox
84 110 0.122332779 ubox
84 119 0.005032032 ubox
85 102 0.734337380 ubox
86 102 0.182145473 ubox
87 96 0.300409868 ubox
87 97 0.050798707 ubox
87 98 0.289308173 ubox
87 99 0.073992777 ubox
87 100 0.496602466 ubox
87 101 0.253169679 ubox
87 104 0.034059046 ubox
87 105 0.097975742 ubox
87 109 0.004797736 ubox
88 95 0.310546839 ubox
88 96 0.060071669 ubox
88 97 0.298264464 ubox
88 98 0.077840552 ubox
88 99 0.491713705 ubox
88 100 0.236641818 ubox
88 103 0.027485736 ubox
88 104 0.095837883 ubox
88 108 0.012147313 ubox
89 94 0.296072490 ubox
89 102 0.020542935 ubox
90 102 0.050400543 ubox
91 101 0.056341429 ubox
91 103 0.390238800 ubox
92 102 0.430990446 ubox
93 99 0.110841247 ubox
93 101 0.450489006 ubox
93 104 0.020439162 ubox
94 98 0.100648236 ubox
94 100 0.440574571 ubox
94 103 0.020532332 ubox
95 102 0.019485067 ubox
102 108 0.003429739 ubox
103 107 0.004629440 ubox
103 113 0.005689952 ubox
104 112 0.005712905 ubox
107 117 0.011325600 ubox
108 116 0.023178354 ubox
109 115 0.026479248 ubox
110 114 0.026070109 ubox
110 115 0.003990889 ubox
112 120 0.061521793 ubox
113 119 0.061560544 ubox
113 120 0.078933157 ubox
114 119 0.078972541 ubox
114 120 0.048785207 ubox
115 119 0.048583953 ubox
115 123 0.048918681 ubox
115 127 0.056731644 ubox
116 122 0.048862972 ubox
116 126 0.058032304 ubox
117 125 0.058211234 ubox
9 63 0.9500000 lbox
10 62 0.9500000 lbox
11 61 0.9500000 lbox
12 60 0.9500000 lbox
13 59 0.9500000 lbox
16 56 0.9500000 lbox
17 55 0.9500000 lbox
19 53 0.9500000 lbox
20 52 0.9500000 lbox
21 51 0.9500000 lbox
25 48 0.9500000 lbox
26 47 0.9500000 lbox
27 46 0.9500000 lbox
28 45 0.9500000 lbox
29 44 0.9500000 lbox
31 40 0.9500000 lbox
32 39 0.9500000 lbox
33 38 0.9500000 lbox
68 125 0.9500000 lbox
69 124 0.9500000 lbox
72 121 0.9500000 lbox
73 120 0.9500000 lbox
74 119 0.9500000 lbox
75 117 0.9500000 lbox
76 116 0.9500000 lbox
77 113 0.9500000 lbox
78 112 0.9500000 lbox
79 111 0.9500000 lbox
80 110 0.9500000 lbox
81 109 0.9500000 lbox
82 105 0.9500000 lbox
83 104 0.9500000 lbox
84 103 0.9500000 lbox
85 102 0.9500000 lbox
87 100 0.9500000 lbox
88 99 0.9500000 lbox
showpage
end
%%EOF
