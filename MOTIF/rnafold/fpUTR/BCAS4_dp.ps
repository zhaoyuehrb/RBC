%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 02:03:42 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (BCAS4)
} def

/sequence { (\
CACUGGGUGGCGCUGCCCGCUCGGCCCGGCGCUCCUGGAGCUGCGAGCCGCGACCGCCGGGAGCGCACCUGCCCCGCCUCCGCCAGGCGGUCCGCGGGGC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 9 0.012775988 ubox
1 71 0.009703449 ubox
2 8 0.012837233 ubox
2 70 0.010818571 ubox
3 7 0.012726462 ubox
3 24 0.475678828 ubox
3 29 0.137733691 ubox
3 38 0.009017185 ubox
3 60 0.006609272 ubox
3 61 0.051972184 ubox
3 99 0.003752528 ubox
4 19 0.010295898 ubox
4 23 0.478337173 ubox
4 28 0.330850184 ubox
4 37 0.009037422 ubox
4 59 0.006369711 ubox
4 60 0.052131505 ubox
4 71 0.080989102 ubox
5 18 0.014539057 ubox
5 22 0.480975434 ubox
5 26 0.024808391 ubox
5 27 0.397136471 ubox
5 36 0.009121578 ubox
5 58 0.005361554 ubox
5 69 0.029252696 ubox
5 70 0.740780229 ubox
6 17 0.014551474 ubox
6 20 0.004796384 ubox
6 21 0.480769087 ubox
6 25 0.025141467 ubox
6 26 0.397254984 ubox
6 35 0.009166180 ubox
6 57 0.003917490 ubox
6 58 0.054925367 ubox
6 68 0.026321937 ubox
6 69 0.777690906 ubox
6 70 0.013716347 ubox
7 16 0.014551046 ubox
7 20 0.481086241 ubox
7 25 0.397201829 ubox
7 34 0.009159686 ubox
7 57 0.055057065 ubox
7 68 0.777954245 ubox
7 69 0.014179476 ubox
8 15 0.014303437 ubox
8 19 0.480383470 ubox
8 23 0.129013768 ubox
8 24 0.367328272 ubox
8 28 0.022415160 ubox
8 56 0.055156960 ubox
8 67 0.763690334 ubox
9 14 0.008845240 ubox
9 17 0.166091935 ubox
9 18 0.452889727 ubox
9 21 0.325541555 ubox
9 22 0.180676506 ubox
9 26 0.005691087 ubox
9 27 0.051505974 ubox
9 33 0.008664870 ubox
9 55 0.055194136 ubox
9 66 0.540108233 ubox
10 16 0.231201293 ubox
10 17 0.420791294 ubox
10 20 0.384057395 ubox
10 21 0.058035729 ubox
10 25 0.005748223 ubox
10 26 0.051561282 ubox
10 30 0.004729991 ubox
10 32 0.009379611 ubox
10 54 0.055190122 ubox
10 64 0.003258568 ubox
10 66 0.558650061 ubox
11 15 0.279519586 ubox
11 19 0.384618334 ubox
11 23 0.003777151 ubox
11 24 0.005749861 ubox
11 28 0.006233571 ubox
11 29 0.004810226 ubox
11 31 0.009467747 ubox
11 52 0.055166974 ubox
11 63 0.003163875 ubox
11 65 0.775863196 ubox
12 18 0.376105210 ubox
12 20 0.095836843 ubox
12 25 0.051579901 ubox
12 27 0.006266463 ubox
12 30 0.011934108 ubox
12 51 0.055191677 ubox
12 64 0.777057576 ubox
13 19 0.095859521 ubox
13 24 0.051599339 ubox
13 29 0.011990680 ubox
13 50 0.055152605 ubox
13 63 0.777060951 ubox
14 23 0.051538491 ubox
14 28 0.011408823 ubox
14 62 0.774264269 ubox
15 22 0.050032224 ubox
15 25 0.021103497 ubox
15 27 0.006950640 ubox
15 48 0.055051034 ubox
15 57 0.006327249 ubox
16 24 0.026576382 ubox
16 47 0.055058726 ubox
16 56 0.006399673 ubox
16 60 0.515008558 ubox
16 61 0.580322343 ubox
17 23 0.026529066 ubox
17 24 0.018400520 ubox
17 59 0.514395606 ubox
17 60 0.580923498 ubox
18 23 0.018808848 ubox
18 45 0.055045707 ubox
18 50 0.003592560 ubox
18 52 0.080363680 ubox
18 56 0.104927453 ubox
18 59 0.580951508 ubox
19 25 0.004934242 ubox
19 44 0.055041145 ubox
19 48 0.034341611 ubox
19 49 0.003291152 ubox
19 51 0.081678643 ubox
19 55 0.107923856 ubox
19 57 0.611898065 ubox
19 58 0.453574057 ubox
20 24 0.004951204 ubox
20 43 0.052951144 ubox
20 47 0.035490787 ubox
20 50 0.074672529 ubox
20 56 0.708590984 ubox
20 61 0.006818891 ubox
21 46 0.035406798 ubox
21 53 0.237190808 ubox
21 60 0.006843306 ubox
22 28 0.004577900 ubox
22 43 0.017059334 ubox
22 45 0.034727621 ubox
22 50 0.715590832 ubox
22 52 0.212885454 ubox
22 56 0.146051549 ubox
22 59 0.007995278 ubox
23 27 0.004624208 ubox
23 42 0.054503713 ubox
23 44 0.030502504 ubox
23 49 0.754605379 ubox
23 51 0.097027879 ubox
23 55 0.147896477 ubox
23 58 0.011444400 ubox
23 69 0.026269904 ubox
23 70 0.012750772 ubox
24 41 0.065336731 ubox
24 48 0.760389136 ubox
24 51 0.011039851 ubox
24 54 0.147507117 ubox
24 57 0.011985654 ubox
24 68 0.026168329 ubox
24 69 0.014358074 ubox
24 72 0.003210786 ubox
24 100 0.005602717 ubox
25 38 0.003511233 ubox
25 40 0.065417940 ubox
25 43 0.003291261 ubox
25 47 0.759857290 ubox
25 50 0.012025860 ubox
25 56 0.011853819 ubox
25 61 0.027058398 ubox
25 71 0.012363400 ubox
25 98 0.009563881 ubox
25 99 0.008307372 ubox
26 37 0.003518533 ubox
26 38 0.065623988 ubox
26 60 0.031511764 ubox
26 97 0.009599625 ubox
26 98 0.007740937 ubox
27 37 0.065629270 ubox
27 43 0.031088222 ubox
27 45 0.753219687 ubox
27 50 0.143411851 ubox
27 52 0.031712823 ubox
27 59 0.031546931 ubox
27 71 0.007489828 ubox
27 96 0.009606720 ubox
27 97 0.007137615 ubox
28 35 0.016495310 ubox
28 36 0.063443718 ubox
28 42 0.031414669 ubox
28 44 0.746436355 ubox
28 49 0.144904595 ubox
28 51 0.030526084 ubox
28 55 0.004319266 ubox
28 58 0.031584243 ubox
28 69 0.073115248 ubox
28 70 0.013760121 ubox
28 95 0.008890816 ubox
29 34 0.016453835 ubox
29 35 0.062973915 ubox
29 41 0.032012994 ubox
29 44 0.142251031 ubox
29 48 0.144830954 ubox
29 51 0.031390241 ubox
29 54 0.004324343 ubox
29 57 0.031586757 ubox
29 66 0.608524316 ubox
29 68 0.050135027 ubox
29 69 0.006704132 ubox
30 40 0.031934797 ubox
30 43 0.178547759 ubox
30 45 0.010279782 ubox
30 47 0.144350880 ubox
30 50 0.032605181 ubox
30 52 0.004044903 ubox
30 56 0.031579298 ubox
30 65 0.625827861 ubox
31 41 0.772361662 ubox
31 42 0.037572428 ubox
31 44 0.024427670 ubox
31 48 0.037182297 ubox
31 49 0.023077341 ubox
31 51 0.003900461 ubox
31 55 0.028189326 ubox
31 64 0.626822746 ubox
32 38 0.026689210 ubox
32 40 0.773406327 ubox
32 43 0.024432080 ubox
32 47 0.043784321 ubox
32 50 0.003893529 ubox
32 63 0.626831804 ubox
33 37 0.024102675 ubox
33 39 0.772825789 ubox
33 46 0.043927208 ubox
33 53 0.027125220 ubox
33 62 0.626748239 ubox
34 38 0.766337550 ubox
34 45 0.043652949 ubox
34 52 0.027453713 ubox
34 61 0.626839030 ubox
35 47 0.003815231 ubox
35 60 0.626835726 ubox
36 43 0.019964403 ubox
36 45 0.004896859 ubox
36 46 0.003544333 ubox
36 50 0.024961492 ubox
36 52 0.004797867 ubox
36 56 0.004368499 ubox
36 59 0.626348781 ubox
37 42 0.014174703 ubox
37 44 0.020973681 ubox
37 49 0.025378358 ubox
37 51 0.010725668 ubox
37 55 0.008961244 ubox
37 58 0.626705228 ubox
38 48 0.023984416 ubox
38 54 0.009299334 ubox
38 57 0.625828742 ubox
39 70 0.008329088 ubox
40 48 0.018985206 ubox
40 51 0.017227218 ubox
40 57 0.028373093 ubox
40 69 0.008530523 ubox
41 47 0.020453046 ubox
41 50 0.017283302 ubox
41 56 0.038022372 ubox
42 46 0.018575508 ubox
42 52 0.569396106 ubox
42 56 0.004627178 ubox
42 67 0.008933039 ubox
43 49 0.003504787 ubox
43 51 0.623025302 ubox
43 55 0.003986415 ubox
43 57 0.006002124 ubox
43 66 0.009132865 ubox
44 50 0.623131175 ubox
44 52 0.065292606 ubox
44 56 0.007992860 ubox
44 65 0.009133102 ubox
45 49 0.582940102 ubox
45 51 0.064871898 ubox
45 55 0.007948721 ubox
45 64 0.009129405 ubox
48 61 0.009067932 ubox
49 56 0.008826674 ubox
49 60 0.009032266 ubox
50 55 0.014500643 ubox
50 57 0.101772815 ubox
50 58 0.003347505 ubox
51 56 0.103670823 ubox
51 59 0.008657009 ubox
52 58 0.012334226 ubox
54 61 0.005265452 ubox
55 60 0.005290836 ubox
59 69 0.009759339 ubox
59 70 0.011520710 ubox
60 68 0.009766605 ubox
60 69 0.012105631 ubox
61 68 0.012074409 ubox
62 70 0.007335086 ubox
63 69 0.007475376 ubox
65 100 0.034218523 ubox
66 99 0.036147487 ubox
68 98 0.117642529 ubox
68 99 0.006002291 ubox
69 97 0.117973896 ubox
69 98 0.004945305 ubox
70 94 0.004587782 ubox
70 96 0.118059786 ubox
70 97 0.003477755 ubox
71 93 0.006151829 ubox
71 95 0.118342246 ubox
71 100 0.978026978 ubox
72 94 0.118295262 ubox
72 99 0.992780133 ubox
73 90 0.003718539 ubox
73 98 0.992916020 ubox
74 90 0.118491865 ubox
74 97 0.992918151 ubox
75 89 0.118586432 ubox
75 96 0.992901853 ubox
76 88 0.118621987 ubox
76 91 0.012046546 ubox
76 95 0.992804958 ubox
77 87 0.118621575 ubox
77 90 0.019820586 ubox
77 94 0.989960913 ubox
78 86 0.118606551 ubox
78 89 0.026097367 ubox
78 90 0.020724532 ubox
79 85 0.113725646 ubox
79 89 0.020116695 ubox
79 90 0.009062612 ubox
80 87 0.033856554 ubox
80 89 0.006834904 ubox
80 90 0.989605676 ubox
81 86 0.033878690 ubox
81 89 0.990825710 ubox
82 88 0.990693808 ubox
82 91 0.052939895 ubox
83 87 0.983500077 ubox
83 90 0.053819365 ubox
84 89 0.053744962 ubox
3 24 0.9500000 lbox
4 23 0.9500000 lbox
5 22 0.9500000 lbox
6 21 0.9500000 lbox
7 20 0.9500000 lbox
8 19 0.9500000 lbox
9 18 0.9500000 lbox
10 17 0.9500000 lbox
29 66 0.9500000 lbox
30 65 0.9500000 lbox
31 64 0.9500000 lbox
32 63 0.9500000 lbox
33 62 0.9500000 lbox
34 61 0.9500000 lbox
35 60 0.9500000 lbox
36 59 0.9500000 lbox
37 58 0.9500000 lbox
38 57 0.9500000 lbox
42 52 0.9500000 lbox
43 51 0.9500000 lbox
44 50 0.9500000 lbox
45 49 0.9500000 lbox
71 100 0.9500000 lbox
72 99 0.9500000 lbox
73 98 0.9500000 lbox
74 97 0.9500000 lbox
75 96 0.9500000 lbox
76 95 0.9500000 lbox
77 94 0.9500000 lbox
80 90 0.9500000 lbox
81 89 0.9500000 lbox
82 88 0.9500000 lbox
83 87 0.9500000 lbox
showpage
end
%%EOF
