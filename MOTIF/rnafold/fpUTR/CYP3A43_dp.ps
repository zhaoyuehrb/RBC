%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:34:11 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (CYP3A43)
} def

/sequence { (\
ACCUCUGGGCAGAGAAACAAAGCUCUAUAUGCACAGCCCAGCAAAGAGCAGCACACAGCUGAAAGAAAAACUCAGAAGACAGAGCUGAAAAAGAAAACUGGUG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 102 0.826924804 ubox
2 8 0.012390661 ubox
2 9 0.014699979 ubox
2 101 0.875599145 ubox
3 7 0.012331887 ubox
3 8 0.014724896 ubox
3 14 0.117484051 ubox
3 41 0.007669738 ubox
3 46 0.201579209 ubox
3 48 0.111257334 ubox
3 51 0.006894765 ubox
3 65 0.030789890 ubox
3 75 0.018893622 ubox
3 78 0.101700945 ubox
3 82 0.008284071 ubox
3 84 0.069973426 ubox
3 93 0.054999456 ubox
3 100 0.872764695 ubox
3 101 0.042161542 ubox
4 13 0.120410124 ubox
4 15 0.077526020 ubox
4 40 0.005885602 ubox
4 45 0.203726245 ubox
4 47 0.120755670 ubox
4 50 0.006960698 ubox
4 62 0.006034119 ubox
4 64 0.029340944 ubox
4 66 0.027701713 ubox
4 74 0.017722788 ubox
4 76 0.149550980 ubox
4 77 0.073163935 ubox
4 79 0.007384787 ubox
4 81 0.007405871 ubox
4 83 0.071438642 ubox
4 88 0.011223807 ubox
4 92 0.052274781 ubox
4 94 0.069258008 ubox
4 100 0.038453257 ubox
4 101 0.009391072 ubox
5 12 0.120693881 ubox
5 14 0.081450576 ubox
5 36 0.053452337 ubox
5 41 0.938180740 ubox
5 46 0.106757625 ubox
5 48 0.003700037 ubox
5 61 0.004661393 ubox
5 65 0.028792239 ubox
5 75 0.170758261 ubox
5 78 0.007828829 ubox
5 82 0.071467431 ubox
5 87 0.010890730 ubox
5 93 0.069470172 ubox
5 100 0.010273751 ubox
5 101 0.014268698 ubox
6 11 0.112910977 ubox
6 13 0.080971911 ubox
6 19 0.010554487 ubox
6 35 0.054500697 ubox
6 40 0.960505225 ubox
6 43 0.003188422 ubox
6 45 0.075870928 ubox
6 64 0.026043887 ubox
6 74 0.170674630 ubox
6 77 0.006681681 ubox
6 81 0.070562369 ubox
6 92 0.063672128 ubox
6 100 0.014042252 ubox
7 18 0.011650312 ubox
7 25 0.010731305 ubox
7 34 0.054332895 ubox
7 39 0.968090787 ubox
7 73 0.170565422 ubox
7 80 0.069229757 ubox
7 99 0.016852100 ubox
8 24 0.011558140 ubox
8 38 0.968181597 ubox
8 71 0.008706265 ubox
8 72 0.169725189 ubox
8 86 0.004179249 ubox
8 98 0.016961243 ubox
8 99 0.005156293 ubox
9 23 0.012119554 ubox
9 32 0.056211213 ubox
9 37 0.968115476 ubox
9 42 0.012553958 ubox
9 52 0.004853150 ubox
9 71 0.168884785 ubox
9 85 0.004430121 ubox
9 98 0.005247372 ubox
9 102 0.003941838 ubox
10 22 0.013250231 ubox
10 31 0.057966049 ubox
10 36 0.967644491 ubox
10 41 0.012546289 ubox
10 51 0.004878086 ubox
10 61 0.078686337 ubox
10 84 0.004372946 ubox
10 87 0.048131765 ubox
10 100 0.016901700 ubox
10 101 0.003584163 ubox
11 24 0.009415743 ubox
11 26 0.953450632 ubox
11 30 0.047544908 ubox
11 60 0.078710463 ubox
11 86 0.048094723 ubox
11 99 0.017082081 ubox
12 23 0.009500457 ubox
12 25 0.964096181 ubox
12 59 0.078612692 ubox
12 73 0.051850138 ubox
12 85 0.047867923 ubox
12 98 0.016997994 ubox
13 24 0.963951687 ubox
13 26 0.083086061 ubox
13 60 0.003539586 ubox
13 72 0.051939273 ubox
13 86 0.004018621 ubox
14 23 0.963242534 ubox
14 25 0.084398571 ubox
14 59 0.003591518 ubox
14 71 0.051634935 ubox
14 73 0.013731519 ubox
14 85 0.004085047 ubox
15 24 0.083564947 ubox
15 72 0.013041152 ubox
17 102 0.019618203 ubox
18 31 0.010932621 ubox
18 61 0.010587550 ubox
18 87 0.008207416 ubox
18 100 0.016199229 ubox
18 101 0.020095544 ubox
18 103 0.007571073 ubox
19 30 0.010155520 ubox
19 60 0.006447018 ubox
19 86 0.006202811 ubox
19 99 0.014889736 ubox
19 102 0.006934920 ubox
21 60 0.004108218 ubox
21 86 0.048070526 ubox
21 99 0.007226362 ubox
22 32 0.056168935 ubox
22 37 0.003364393 ubox
22 49 0.209853495 ubox
22 52 0.011564035 ubox
22 59 0.003928985 ubox
22 85 0.049689679 ubox
22 98 0.007055786 ubox
23 31 0.056252479 ubox
23 36 0.003384530 ubox
23 48 0.225849559 ubox
23 51 0.011572308 ubox
23 58 0.003917581 ubox
23 84 0.049655166 ubox
24 35 0.003268464 ubox
24 47 0.226029517 ubox
24 50 0.011487467 ubox
24 57 0.003750993 ubox
24 83 0.049636785 ubox
25 46 0.226084451 ubox
25 48 0.012272545 ubox
25 82 0.049619095 ubox
26 35 0.010372482 ubox
26 45 0.223321573 ubox
26 47 0.012676707 ubox
26 81 0.047205522 ubox
30 40 0.008840030 ubox
30 43 0.236599113 ubox
30 50 0.003481638 ubox
31 37 0.012783373 ubox
31 39 0.008808950 ubox
31 42 0.242148419 ubox
31 49 0.003819164 ubox
31 52 0.003252232 ubox
32 36 0.012933874 ubox
32 41 0.242113087 ubox
32 48 0.003881562 ubox
32 51 0.003251069 ubox
34 61 0.008556426 ubox
35 60 0.008595064 ubox
36 42 0.014781983 ubox
36 49 0.003230761 ubox
36 52 0.004796088 ubox
36 59 0.008602523 ubox
36 102 0.004329160 ubox
37 41 0.014711584 ubox
37 48 0.003345940 ubox
37 51 0.004819678 ubox
37 58 0.008590382 ubox
37 101 0.005850493 ubox
38 100 0.004846901 ubox
38 101 0.049901452 ubox
39 61 0.008201485 ubox
39 87 0.018456692 ubox
39 100 0.050290828 ubox
39 103 0.003848848 ubox
40 60 0.008524461 ubox
40 86 0.019837531 ubox
40 99 0.050414993 ubox
40 102 0.005254155 ubox
41 49 0.079186665 ubox
41 52 0.065801581 ubox
41 59 0.008695832 ubox
41 71 0.006930771 ubox
41 85 0.020593637 ubox
41 98 0.050121308 ubox
41 102 0.010206187 ubox
42 48 0.163642505 ubox
42 51 0.067611087 ubox
42 58 0.008748370 ubox
42 61 0.010127031 ubox
42 84 0.020226009 ubox
42 87 0.029081644 ubox
42 100 0.038005524 ubox
42 101 0.019693993 ubox
42 103 0.023480537 ubox
43 60 0.007218744 ubox
43 86 0.026622218 ubox
43 99 0.034897976 ubox
43 102 0.022424691 ubox
45 72 0.011168202 ubox
45 86 0.028871524 ubox
45 99 0.053417669 ubox
46 71 0.015002192 ubox
46 73 0.139385262 ubox
46 85 0.029862728 ubox
46 98 0.054761207 ubox
47 60 0.116226828 ubox
47 72 0.139812933 ubox
47 86 0.049739056 ubox
47 99 0.056165337 ubox
48 59 0.119570235 ubox
48 71 0.139998438 ubox
48 85 0.051042748 ubox
48 98 0.057387312 ubox
48 102 0.006144825 ubox
49 58 0.119599611 ubox
49 61 0.914548565 ubox
49 84 0.042437167 ubox
49 87 0.268000569 ubox
49 100 0.019258573 ubox
49 101 0.005713897 ubox
49 103 0.015819850 ubox
50 60 0.929959906 ubox
50 86 0.269887509 ubox
50 99 0.019550316 ubox
50 102 0.016412486 ubox
51 59 0.931828478 ubox
51 85 0.270148538 ubox
51 98 0.019466626 ubox
51 102 0.013199757 ubox
52 58 0.931266054 ubox
52 61 0.012213149 ubox
52 84 0.269677316 ubox
52 100 0.016626810 ubox
52 101 0.013994450 ubox
52 103 0.090563303 ubox
53 60 0.011053854 ubox
53 99 0.015262808 ubox
53 102 0.092364454 ubox
54 61 0.011016558 ubox
54 87 0.003646412 ubox
54 100 0.016005912 ubox
54 101 0.092338859 ubox
54 103 0.022919201 ubox
55 60 0.009430467 ubox
55 99 0.016227978 ubox
55 102 0.023064167 ubox
56 87 0.156092535 ubox
56 100 0.090819543 ubox
56 101 0.021454423 ubox
57 86 0.156829267 ubox
57 99 0.091208189 ubox
58 85 0.156965993 ubox
58 98 0.090795960 ubox
58 102 0.006092311 ubox
59 65 0.017065110 ubox
59 75 0.278952313 ubox
59 78 0.036694908 ubox
59 82 0.013200815 ubox
59 84 0.156635025 ubox
59 93 0.019609626 ubox
59 101 0.006640657 ubox
60 64 0.015522878 ubox
60 74 0.279808722 ubox
60 77 0.036180899 ubox
60 81 0.016799042 ubox
60 83 0.154385077 ubox
60 92 0.019481311 ubox
60 100 0.006480677 ubox
61 73 0.280501960 ubox
61 80 0.020113390 ubox
61 99 0.004597329 ubox
62 72 0.267622881 ubox
64 72 0.087442181 ubox
64 86 0.068827105 ubox
64 99 0.052435987 ubox
65 71 0.124300752 ubox
65 73 0.100051651 ubox
65 85 0.070875076 ubox
65 98 0.053837938 ubox
66 72 0.097420336 ubox
70 102 0.066877199 ubox
71 78 0.047630947 ubox
71 82 0.034534916 ubox
71 84 0.603786543 ubox
71 93 0.047517089 ubox
71 101 0.068509825 ubox
72 77 0.044344430 ubox
72 79 0.080746233 ubox
72 81 0.033185234 ubox
72 83 0.607683671 ubox
72 88 0.608936959 ubox
72 92 0.033212851 ubox
72 94 0.017127719 ubox
72 100 0.018891553 ubox
72 101 0.041539599 ubox
73 78 0.087068629 ubox
73 82 0.608123056 ubox
73 87 0.642931948 ubox
73 93 0.017969793 ubox
73 100 0.082436415 ubox
73 103 0.010899634 ubox
74 86 0.642728168 ubox
74 99 0.083354582 ubox
74 102 0.011027922 ubox
75 85 0.640695847 ubox
75 98 0.082951019 ubox
77 86 0.075396797 ubox
77 99 0.032034471 ubox
78 85 0.078311486 ubox
78 98 0.032868305 ubox
79 102 0.048349192 ubox
80 87 0.056165364 ubox
80 100 0.239405956 ubox
80 101 0.038815387 ubox
80 103 0.008656234 ubox
81 86 0.050827010 ubox
81 99 0.244273645 ubox
81 102 0.008347784 ubox
82 98 0.243977912 ubox
83 99 0.030979529 ubox
84 98 0.031762983 ubox
84 102 0.027002234 ubox
85 93 0.483588796 ubox
85 101 0.033682487 ubox
86 92 0.483205044 ubox
86 100 0.033095536 ubox
87 99 0.024402027 ubox
87 102 0.004240031 ubox
92 99 0.344307848 ubox
93 98 0.352085011 ubox
1 102 0.9500000 lbox
2 101 0.9500000 lbox
3 100 0.9500000 lbox
5 41 0.9500000 lbox
6 40 0.9500000 lbox
7 39 0.9500000 lbox
8 38 0.9500000 lbox
9 37 0.9500000 lbox
10 36 0.9500000 lbox
11 26 0.9500000 lbox
12 25 0.9500000 lbox
13 24 0.9500000 lbox
14 23 0.9500000 lbox
49 61 0.9500000 lbox
50 60 0.9500000 lbox
51 59 0.9500000 lbox
52 58 0.9500000 lbox
72 88 0.9500000 lbox
73 87 0.9500000 lbox
74 86 0.9500000 lbox
75 85 0.9500000 lbox
showpage
end
%%EOF
