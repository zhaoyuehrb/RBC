%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:46:51 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (CLMN)
} def

/sequence { (\
GCGACUCCAGCUCCGCGGCGCCCUCGCCGGGUGCGUGCCGCUCGCGCGCCCGCCAGCCAGGCUCUCCGCGCCCGCCGCCCGCGCCGCGCUGGCCCGGGCUCUCCCGCCCGCGCUUC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 11 0.216754866 ubox
1 16 0.012385380 ubox
1 89 0.007295000 ubox
1 93 0.014820172 ubox
1 111 0.071061332 ubox
1 113 0.829406035 ubox
2 10 0.217093076 ubox
2 15 0.012410572 ubox
2 88 0.006866699 ubox
2 92 0.010993079 ubox
2 96 0.004422001 ubox
2 110 0.070482116 ubox
2 112 0.830764594 ubox
3 13 0.017225930 ubox
3 14 0.012304785 ubox
3 95 0.023161321 ubox
3 109 0.042158764 ubox
3 111 0.819244562 ubox
3 115 0.009351673 ubox
3 116 0.027202380 ubox
4 12 0.016683211 ubox
4 114 0.009159365 ubox
4 115 0.025370655 ubox
5 92 0.011470990 ubox
6 91 0.005005489 ubox
6 92 0.010199789 ubox
7 91 0.021220885 ubox
7 92 0.858738056 ubox
8 91 0.958719252 ubox
9 90 0.961559591 ubox
9 114 0.005805392 ubox
10 89 0.961760037 ubox
10 93 0.124194275 ubox
10 113 0.006183365 ubox
11 88 0.878481682 ubox
11 92 0.124471497 ubox
11 112 0.006168852 ubox
12 91 0.119698742 ubox
12 92 0.004300482 ubox
13 91 0.025332864 ubox
14 88 0.471725920 ubox
15 82 0.003180166 ubox
15 87 0.999262448 ubox
16 29 0.006910596 ubox
16 81 0.003180374 ubox
16 86 0.999843645 ubox
17 28 0.007965349 ubox
17 85 0.999934135 ubox
18 27 0.007971575 ubox
18 84 0.999952285 ubox
19 26 0.007970711 ubox
19 83 0.999938218 ubox
20 25 0.007456848 ubox
20 32 0.003623324 ubox
20 82 0.999912109 ubox
21 31 0.003741960 ubox
21 81 0.998688493 ubox
22 30 0.003749130 ubox
22 61 0.017805296 ubox
23 29 0.003751561 ubox
23 56 0.004868965 ubox
23 60 0.018068616 ubox
24 55 0.004998194 ubox
24 59 0.017896133 ubox
25 77 0.973527817 ubox
26 53 0.007948202 ubox
26 57 0.018455315 ubox
26 75 0.116040088 ubox
26 76 0.975249270 ubox
26 78 0.130646476 ubox
27 52 0.005633658 ubox
27 56 0.018454605 ubox
27 74 0.095345603 ubox
27 77 0.130242652 ubox
28 52 0.020583127 ubox
28 74 0.992731741 ubox
29 51 0.023068042 ubox
29 73 0.999664548 ubox
30 50 0.023081211 ubox
30 72 0.999690395 ubox
30 85 0.007392562 ubox
31 49 0.023082902 ubox
31 71 0.999688309 ubox
31 84 0.007408923 ubox
32 48 0.023074111 ubox
32 70 0.999293077 ubox
32 83 0.007409098 ubox
33 47 0.023101338 ubox
33 49 0.010203875 ubox
33 69 0.999608321 ubox
33 82 0.008283419 ubox
34 46 0.023102784 ubox
34 48 0.011262832 ubox
34 68 0.999555370 ubox
34 81 0.008288077 ubox
35 45 0.023117650 ubox
35 47 0.024673578 ubox
35 49 0.013567535 ubox
35 51 0.005969189 ubox
35 62 0.009545837 ubox
35 67 0.977095985 ubox
35 80 0.008275029 ubox
36 44 0.023092865 ubox
36 46 0.025052065 ubox
36 48 0.014072136 ubox
36 59 0.008394853 ubox
36 61 0.011131159 ubox
37 43 0.022591222 ubox
37 45 0.025470039 ubox
37 47 0.014646557 ubox
37 49 0.026491138 ubox
37 51 0.006366558 ubox
37 58 0.008411695 ubox
37 62 0.996535588 ubox
37 78 0.008281837 ubox
38 44 0.025440979 ubox
38 46 0.013508990 ubox
38 48 0.020733230 ubox
38 61 0.998174402 ubox
38 77 0.008281372 ubox
39 46 0.013587576 ubox
39 48 0.027244043 ubox
39 60 0.992965033 ubox
40 45 0.014348667 ubox
40 47 0.032731150 ubox
40 49 0.005127259 ubox
40 57 0.992800786 ubox
40 62 0.024469638 ubox
40 75 0.008297679 ubox
41 46 0.032681598 ubox
41 48 0.005131679 ubox
41 56 0.997211652 ubox
41 60 0.006210129 ubox
41 61 0.024259572 ubox
41 74 0.008299027 ubox
42 55 0.985528724 ubox
42 59 0.007902722 ubox
42 60 0.021011146 ubox
43 52 0.014191071 ubox
43 60 0.010313376 ubox
44 51 0.013961115 ubox
44 53 0.995238202 ubox
44 57 0.029739334 ubox
44 71 0.008483105 ubox
45 52 0.995782961 ubox
45 56 0.029671859 ubox
45 70 0.008498109 ubox
46 51 0.948105147 ubox
46 53 0.068152660 ubox
46 57 0.018905356 ubox
46 69 0.008537629 ubox
47 52 0.068152175 ubox
47 56 0.018939649 ubox
47 68 0.008538471 ubox
48 57 0.005036514 ubox
48 62 0.008907425 ubox
48 67 0.008830942 ubox
49 56 0.005036503 ubox
49 61 0.008635115 ubox
50 60 0.008317255 ubox
50 61 0.004208316 ubox
51 60 0.004823803 ubox
52 62 0.045952114 ubox
52 93 0.003165224 ubox
53 61 0.046029879 ubox
53 92 0.003176838 ubox
54 60 0.046003184 ubox
54 91 0.003178115 ubox
55 63 0.003930332 ubox
55 90 0.003177361 ubox
56 62 0.004199816 ubox
56 75 0.007352260 ubox
56 78 0.003293337 ubox
56 89 0.003177916 ubox
57 61 0.004171429 ubox
57 74 0.007372483 ubox
57 77 0.003304163 ubox
57 88 0.003168781 ubox
60 67 0.005199560 ubox
60 72 0.009181034 ubox
60 76 0.004100618 ubox
60 79 0.003551733 ubox
61 66 0.005201818 ubox
61 71 0.009223754 ubox
61 75 0.004116998 ubox
61 78 0.003584799 ubox
62 70 0.009238998 ubox
62 74 0.004114058 ubox
62 77 0.003590753 ubox
68 75 0.006589250 ubox
68 78 0.018010259 ubox
68 80 0.003535316 ubox
69 74 0.006714987 ubox
69 77 0.018047050 ubox
70 76 0.017649799 ubox
70 78 0.005346798 ubox
71 77 0.005354323 ubox
86 113 0.013355185 ubox
87 112 0.013401396 ubox
88 111 0.014206121 ubox
88 113 0.003441899 ubox
89 110 0.014237595 ubox
89 112 0.003486098 ubox
91 108 0.014110583 ubox
91 109 0.005406328 ubox
91 114 0.233535240 ubox
91 115 0.010805186 ubox
91 116 0.004556094 ubox
92 107 0.014288439 ubox
92 108 0.005540574 ubox
92 111 0.020486242 ubox
92 113 0.477420613 ubox
92 114 0.005220289 ubox
93 106 0.013141245 ubox
93 110 0.025566558 ubox
93 112 0.510502104 ubox
95 106 0.044255452 ubox
95 110 0.970431284 ubox
95 112 0.003336780 ubox
96 104 0.003905212 ubox
96 105 0.047547885 ubox
96 109 0.998605978 ubox
97 103 0.003928114 ubox
97 104 0.047565405 ubox
97 108 0.998846850 ubox
98 103 0.046796315 ubox
98 107 0.998848520 ubox
99 106 0.997806438 ubox
1 113 0.9500000 lbox
2 112 0.9500000 lbox
3 111 0.9500000 lbox
7 92 0.9500000 lbox
8 91 0.9500000 lbox
9 90 0.9500000 lbox
10 89 0.9500000 lbox
11 88 0.9500000 lbox
15 87 0.9500000 lbox
16 86 0.9500000 lbox
17 85 0.9500000 lbox
18 84 0.9500000 lbox
19 83 0.9500000 lbox
20 82 0.9500000 lbox
21 81 0.9500000 lbox
25 77 0.9500000 lbox
26 76 0.9500000 lbox
28 74 0.9500000 lbox
29 73 0.9500000 lbox
30 72 0.9500000 lbox
31 71 0.9500000 lbox
32 70 0.9500000 lbox
33 69 0.9500000 lbox
34 68 0.9500000 lbox
35 67 0.9500000 lbox
37 62 0.9500000 lbox
38 61 0.9500000 lbox
39 60 0.9500000 lbox
40 57 0.9500000 lbox
41 56 0.9500000 lbox
42 55 0.9500000 lbox
44 53 0.9500000 lbox
45 52 0.9500000 lbox
46 51 0.9500000 lbox
95 110 0.9500000 lbox
96 109 0.9500000 lbox
97 108 0.9500000 lbox
98 107 0.9500000 lbox
99 106 0.9500000 lbox
showpage
end
%%EOF
