%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 02:12:04 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (EBF3)
} def

/sequence { (\
GCGCCGCUGCUCGAGGAAACGCUUUCGGCCGGGAGCUGCGGCCGCCGCCAGCAGUUUUC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 7 0.085244017 ubox
1 10 0.103014443 ubox
1 22 0.055584240 ubox
1 29 0.014887298 ubox
1 36 0.024756500 ubox
1 39 0.007638573 ubox
1 45 0.554469025 ubox
1 48 0.071192222 ubox
1 52 0.055508234 ubox
1 55 0.010796660 ubox
2 6 0.084838749 ubox
2 9 0.103156813 ubox
2 13 0.009174206 ubox
2 21 0.055678872 ubox
2 28 0.014673925 ubox
2 31 0.100938014 ubox
2 35 0.027436994 ubox
2 38 0.007641452 ubox
2 40 0.003668295 ubox
2 44 0.556164776 ubox
2 47 0.071347454 ubox
2 51 0.055489864 ubox
2 54 0.011794057 ubox
3 8 0.069977881 ubox
3 10 0.044878449 ubox
3 12 0.008897547 ubox
3 20 0.055373191 ubox
3 22 0.003897072 ubox
3 29 0.452723737 ubox
3 30 0.089883562 ubox
3 36 0.016731728 ubox
3 39 0.006233674 ubox
3 42 0.430457933 ubox
3 43 0.393354341 ubox
3 45 0.004353862 ubox
3 46 0.029153744 ubox
3 55 0.015663634 ubox
4 9 0.044752075 ubox
4 16 0.027984908 ubox
4 21 0.003755528 ubox
4 28 0.458351673 ubox
4 32 0.566085225 ubox
4 33 0.060086947 ubox
4 35 0.017862093 ubox
4 38 0.006232790 ubox
4 41 0.584019995 ubox
4 44 0.005348520 ubox
4 54 0.016298653 ubox
5 13 0.009143438 ubox
5 15 0.028002914 ubox
5 27 0.458296776 ubox
5 31 0.570754624 ubox
5 32 0.060313284 ubox
5 40 0.584050050 ubox
6 12 0.009480204 ubox
6 22 0.020816167 ubox
6 26 0.451793457 ubox
6 29 0.264058543 ubox
6 30 0.528196705 ubox
6 36 0.007917065 ubox
6 39 0.584052117 ubox
6 42 0.004798173 ubox
6 48 0.005553965 ubox
6 52 0.018995290 ubox
6 55 0.148518985 ubox
7 15 0.047658846 ubox
7 16 0.046255362 ubox
7 21 0.022638217 ubox
7 28 0.326762994 ubox
7 32 0.105204193 ubox
7 33 0.007353521 ubox
7 35 0.008131829 ubox
7 38 0.582687443 ubox
7 41 0.004995038 ubox
7 47 0.005557254 ubox
7 51 0.019013294 ubox
7 54 0.154902092 ubox
8 14 0.047669749 ubox
8 15 0.045506329 ubox
8 21 0.011568473 ubox
8 27 0.325395356 ubox
8 31 0.106602037 ubox
8 32 0.006949528 ubox
8 34 0.008213080 ubox
8 40 0.004984562 ubox
8 50 0.018973996 ubox
8 53 0.154972967 ubox
9 20 0.014259345 ubox
9 22 0.383034330 ubox
9 26 0.323928393 ubox
9 29 0.532424890 ubox
9 30 0.106689663 ubox
9 36 0.582574987 ubox
9 39 0.004740531 ubox
9 45 0.005460303 ubox
9 48 0.008297683 ubox
9 49 0.016931618 ubox
9 52 0.155024996 ubox
10 16 0.014188028 ubox
10 21 0.381693352 ubox
10 28 0.533497181 ubox
10 32 0.005612869 ubox
10 33 0.015026419 ubox
10 35 0.583933059 ubox
10 38 0.004700536 ubox
10 44 0.005437951 ubox
10 47 0.011676690 ubox
10 51 0.155008510 ubox
11 15 0.013718153 ubox
11 17 0.100941308 ubox
11 27 0.246626542 ubox
11 28 0.135051886 ubox
11 31 0.004549808 ubox
11 32 0.017120837 ubox
11 33 0.007495428 ubox
11 34 0.583663393 ubox
11 50 0.149806038 ubox
12 16 0.101002834 ubox
12 21 0.184892857 ubox
12 27 0.496526169 ubox
12 31 0.021761094 ubox
12 32 0.016898037 ubox
12 33 0.582922388 ubox
12 47 0.024322357 ubox
13 20 0.196879131 ubox
13 24 0.327568468 ubox
13 25 0.270720305 ubox
13 26 0.503645837 ubox
13 30 0.027527241 ubox
13 46 0.023490885 ubox
13 59 0.005442798 ubox
14 23 0.336025482 ubox
14 24 0.293672961 ubox
14 25 0.491272227 ubox
14 58 0.005237702 ubox
15 22 0.340062159 ubox
15 23 0.310177109 ubox
15 24 0.471988348 ubox
15 25 0.017201824 ubox
15 26 0.081179620 ubox
15 30 0.565273019 ubox
15 43 0.008243279 ubox
15 46 0.134721555 ubox
15 49 0.047342903 ubox
15 57 0.004430446 ubox
15 59 0.065686012 ubox
16 22 0.325782875 ubox
16 23 0.393968672 ubox
16 24 0.033458175 ubox
16 25 0.083577574 ubox
16 26 0.113070176 ubox
16 29 0.559996784 ubox
16 42 0.008236128 ubox
16 45 0.134584720 ubox
16 48 0.046868632 ubox
16 56 0.003817160 ubox
16 58 0.068572115 ubox
16 59 0.004565626 ubox
17 23 0.043670370 ubox
17 24 0.090789421 ubox
17 25 0.127839413 ubox
17 55 0.003365297 ubox
17 57 0.069091969 ubox
17 58 0.004211965 ubox
18 23 0.080388112 ubox
18 24 0.125136487 ubox
18 25 0.069228132 ubox
18 56 0.069224856 ubox
18 57 0.003704938 ubox
19 23 0.096043929 ubox
19 24 0.061488692 ubox
19 55 0.069347042 ubox
20 27 0.455357413 ubox
20 31 0.009797238 ubox
20 38 0.004754772 ubox
20 40 0.010634360 ubox
20 44 0.003817531 ubox
20 47 0.031594713 ubox
20 54 0.069355143 ubox
21 26 0.429613783 ubox
21 29 0.064392325 ubox
21 30 0.007680437 ubox
21 36 0.013865129 ubox
21 39 0.010550175 ubox
21 42 0.006301857 ubox
21 45 0.024685915 ubox
21 46 0.031192381 ubox
21 48 0.026191669 ubox
21 52 0.068828276 ubox
22 28 0.080871058 ubox
22 35 0.013964279 ubox
22 38 0.010474685 ubox
22 41 0.006463993 ubox
22 44 0.022968088 ubox
22 47 0.026884032 ubox
22 51 0.069043958 ubox
23 27 0.072882241 ubox
23 34 0.014108658 ubox
23 35 0.003728577 ubox
23 40 0.006155724 ubox
23 50 0.067416041 ubox
24 33 0.014118013 ubox
24 34 0.005269164 ubox
24 35 0.008178645 ubox
24 50 0.003349209 ubox
25 32 0.016232854 ubox
25 33 0.005625611 ubox
25 34 0.008861848 ubox
25 50 0.004024826 ubox
26 31 0.017314900 ubox
26 32 0.012823347 ubox
26 33 0.009008079 ubox
26 38 0.006624779 ubox
26 44 0.153449696 ubox
26 47 0.022581959 ubox
27 37 0.007549742 ubox
27 43 0.157245043 ubox
27 46 0.022209819 ubox
27 49 0.060451868 ubox
28 36 0.007677687 ubox
28 42 0.157299765 ubox
28 45 0.022104023 ubox
28 48 0.060866851 ubox
29 35 0.007667892 ubox
29 41 0.157312618 ubox
29 44 0.016303922 ubox
29 47 0.043073158 ubox
30 40 0.157322422 ubox
30 44 0.014856227 ubox
30 47 0.043486536 ubox
31 39 0.157037444 ubox
31 43 0.020931285 ubox
31 46 0.061193562 ubox
31 58 0.009808501 ubox
31 59 0.499286097 ubox
32 36 0.005230100 ubox
32 42 0.020302457 ubox
32 43 0.005054601 ubox
32 45 0.061207058 ubox
32 57 0.010501087 ubox
32 58 0.525739589 ubox
32 59 0.030524160 ubox
33 42 0.004911563 ubox
33 56 0.016136784 ubox
33 57 0.754296118 ubox
33 58 0.050795028 ubox
33 59 0.037616169 ubox
34 55 0.014139455 ubox
34 56 0.779278671 ubox
34 57 0.043224331 ubox
34 58 0.035174468 ubox
35 42 0.061580656 ubox
35 52 0.031682380 ubox
35 55 0.790158672 ubox
35 56 0.030992420 ubox
35 57 0.010569532 ubox
36 41 0.061772516 ubox
36 51 0.031722953 ubox
36 54 0.792157552 ubox
37 50 0.031651862 ubox
37 53 0.792454369 ubox
38 48 0.024502442 ubox
38 49 0.022377865 ubox
38 52 0.792709797 ubox
39 47 0.033240296 ubox
39 51 0.792347933 ubox
40 46 0.033495169 ubox
40 49 0.789644989 ubox
41 45 0.032955058 ubox
41 48 0.792655545 ubox
42 47 0.790470830 ubox
42 54 0.004734664 ubox
44 52 0.115066855 ubox
44 55 0.020823257 ubox
45 51 0.115045587 ubox
45 54 0.021887104 ubox
47 55 0.101044245 ubox
48 54 0.105252694 ubox
50 56 0.012140718 ubox
50 57 0.016799067 ubox
50 58 0.013377350 ubox
51 55 0.009900615 ubox
51 56 0.014849341 ubox
51 57 0.013682289 ubox
3 29 0.9500000 lbox
4 28 0.9500000 lbox
5 27 0.9500000 lbox
6 26 0.9500000 lbox
9 22 0.9500000 lbox
10 21 0.9500000 lbox
31 59 0.9500000 lbox
32 58 0.9500000 lbox
33 57 0.9500000 lbox
34 56 0.9500000 lbox
35 55 0.9500000 lbox
36 54 0.9500000 lbox
37 53 0.9500000 lbox
38 52 0.9500000 lbox
39 51 0.9500000 lbox
40 49 0.9500000 lbox
41 48 0.9500000 lbox
42 47 0.9500000 lbox
showpage
end
%%EOF
