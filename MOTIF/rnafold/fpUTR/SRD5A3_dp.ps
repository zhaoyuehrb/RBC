%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:18:10 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (SRD5A3)
} def

/sequence { (\
CCGCGUCACCGACGUCCCGCUAGGCUGAGACCGGUGCGCCGCGCGCUAGUGGCCGCUCUUCCGCGGGCUAGCGGGCGGUGGGGGCGCCAGCAGCGCGGAAGGCGGGCACGCGGGCC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 113 0.992209397 ubox
1 114 0.031065842 ubox
2 112 0.995668328 ubox
2 113 0.022318874 ubox
3 15 0.006150359 ubox
3 39 0.088262882 ubox
3 40 0.005904047 ubox
3 87 0.003815591 ubox
3 111 0.995984300 ubox
4 14 0.006417108 ubox
4 38 0.088628028 ubox
4 86 0.003932207 ubox
4 110 0.995985616 ubox
5 13 0.006608582 ubox
5 37 0.088605506 ubox
5 85 0.004869804 ubox
5 109 0.995850268 ubox
6 12 0.006608526 ubox
6 36 0.017319995 ubox
6 84 0.004882340 ubox
6 108 0.987350900 ubox
7 11 0.006559258 ubox
7 36 0.087048280 ubox
7 83 0.005534585 ubox
8 35 0.088739434 ubox
9 34 0.088793567 ubox
9 82 0.006743102 ubox
9 105 0.995256289 ubox
9 106 0.033502311 ubox
9 113 0.006352270 ubox
10 33 0.088790546 ubox
10 81 0.006754006 ubox
10 104 0.995309588 ubox
10 105 0.032633365 ubox
10 112 0.006398612 ubox
11 32 0.087130315 ubox
11 103 0.993477201 ubox
11 111 0.006399624 ubox
12 79 0.006797177 ubox
13 27 0.004985493 ubox
13 78 0.006752373 ubox
13 104 0.031680634 ubox
13 110 0.006471753 ubox
14 25 0.004036787 ubox
14 26 0.004288449 ubox
14 31 0.078786694 ubox
14 76 0.003235263 ubox
14 103 0.037356817 ubox
14 107 0.003378946 ubox
14 109 0.006597646 ubox
15 24 0.003813840 ubox
15 28 0.037751925 ubox
15 30 0.079533074 ubox
15 98 0.018405855 ubox
15 99 0.983931941 ubox
15 102 0.038939956 ubox
15 108 0.006580015 ubox
16 23 0.003772969 ubox
16 24 0.004390159 ubox
16 27 0.037644190 ubox
16 29 0.079421392 ubox
16 75 0.007974763 ubox
16 83 0.003224660 ubox
16 97 0.018955181 ubox
16 98 0.985520529 ubox
16 101 0.037806799 ubox
16 102 0.007444688 ubox
16 106 0.007640606 ubox
16 114 0.006333897 ubox
17 23 0.004445550 ubox
17 24 0.059556635 ubox
17 74 0.007988904 ubox
17 82 0.003227699 ubox
17 97 0.981775818 ubox
17 98 0.141927502 ubox
17 101 0.006945617 ubox
17 105 0.007652091 ubox
17 113 0.006409168 ubox
18 23 0.059725740 ubox
18 27 0.060257219 ubox
18 36 0.010258606 ubox
18 73 0.008000273 ubox
18 81 0.003214255 ubox
18 95 0.977789177 ubox
18 97 0.165431791 ubox
18 104 0.007661072 ubox
18 112 0.006409930 ubox
19 25 0.049353350 ubox
19 26 0.032560495 ubox
19 35 0.010647880 ubox
19 72 0.008008416 ubox
19 91 0.004494391 ubox
19 94 0.978292901 ubox
19 96 0.185820969 ubox
19 103 0.007668553 ubox
19 111 0.006409930 ubox
20 24 0.049893979 ubox
20 34 0.010673248 ubox
20 71 0.008008491 ubox
20 90 0.004819403 ubox
20 93 0.978065981 ubox
20 95 0.185651388 ubox
20 98 0.006695787 ubox
20 102 0.007627735 ubox
20 110 0.006401764 ubox
21 33 0.009469721 ubox
21 70 0.008006206 ubox
21 89 0.005806799 ubox
21 92 0.906562981 ubox
21 97 0.006729666 ubox
21 101 0.007262613 ubox
22 69 0.008004684 ubox
23 32 0.048565516 ubox
23 68 0.008002586 ubox
23 88 0.126439103 ubox
24 31 0.048438732 ubox
24 35 0.027655093 ubox
24 87 0.126505135 ubox
24 91 0.975139099 ubox
24 94 0.128190103 ubox
25 34 0.028580836 ubox
25 66 0.007996657 ubox
25 86 0.125193848 ubox
25 90 0.977871072 ubox
25 93 0.128297916 ubox
26 33 0.028993708 ubox
26 65 0.007975408 ubox
26 86 0.017148462 ubox
26 89 0.977064934 ubox
26 92 0.128304863 ubox
27 32 0.039616884 ubox
27 64 0.007871610 ubox
27 85 0.080598152 ubox
27 88 0.954727140 ubox
27 91 0.128262974 ubox
29 61 0.006277795 ubox
30 60 0.006227358 ubox
31 81 0.024179600 ubox
31 82 0.108935734 ubox
31 83 0.158204414 ubox
31 84 0.923324996 ubox
32 80 0.023204255 ubox
32 81 0.109202688 ubox
32 82 0.156766509 ubox
32 83 0.924382501 ubox
32 86 0.157308758 ubox
33 47 0.004346241 ubox
33 57 0.007126380 ubox
33 79 0.008844129 ubox
33 85 0.158350858 ubox
33 88 0.236718022 ubox
34 46 0.004568061 ubox
34 56 0.007454248 ubox
34 79 0.009602517 ubox
34 85 0.032249264 ubox
34 87 0.260702752 ubox
35 45 0.004568215 ubox
35 55 0.007453571 ubox
35 80 0.012886973 ubox
35 84 0.032501047 ubox
35 86 0.260615271 ubox
36 44 0.004587930 ubox
36 46 0.004622188 ubox
36 54 0.007450508 ubox
36 79 0.003750158 ubox
36 85 0.260634697 ubox
36 87 0.006964033 ubox
37 43 0.004587780 ubox
37 45 0.004654676 ubox
37 80 0.959920050 ubox
37 84 0.250269715 ubox
37 86 0.006949763 ubox
38 42 0.004291884 ubox
38 44 0.004657119 ubox
38 53 0.007776154 ubox
38 79 0.993959721 ubox
38 85 0.006702516 ubox
39 43 0.004623315 ubox
39 52 0.008072370 ubox
39 78 0.994872927 ubox
39 81 0.005545334 ubox
39 82 0.046049731 ubox
39 83 0.004764449 ubox
39 84 0.006210621 ubox
40 51 0.008072704 ubox
40 77 0.995069299 ubox
40 80 0.006267509 ubox
40 81 0.041419808 ubox
40 82 0.004506211 ubox
40 83 0.005581690 ubox
41 50 0.008068190 ubox
41 76 0.995952641 ubox
41 79 0.004706289 ubox
41 115 0.088431585 ubox
42 49 0.008069508 ubox
42 75 0.995864094 ubox
42 78 0.004449438 ubox
42 80 0.004227269 ubox
42 114 0.088618969 ubox
43 76 0.003313655 ubox
43 79 0.004103093 ubox
44 73 0.995732620 ubox
44 77 0.005678405 ubox
44 112 0.088629068 ubox
45 72 0.995962007 ubox
45 76 0.006326009 ubox
45 111 0.088640789 ubox
46 71 0.995970386 ubox
46 75 0.006288210 ubox
46 110 0.088251409 ubox
47 70 0.995540660 ubox
47 74 0.005892592 ubox
48 69 0.995146177 ubox
49 68 0.994715107 ubox
49 72 0.004906462 ubox
49 109 0.088019695 ubox
50 67 0.954011130 ubox
50 70 0.017180307 ubox
50 108 0.088889360 ubox
51 69 0.031810418 ubox
51 107 0.088911533 ubox
52 64 0.012751907 ubox
52 68 0.038200346 ubox
53 63 0.011503563 ubox
53 66 0.991716769 ubox
53 67 0.032519290 ubox
53 105 0.088922735 ubox
54 63 0.010450371 ubox
54 65 0.995495186 ubox
54 66 0.023290332 ubox
54 104 0.088938077 ubox
55 62 0.011504769 ubox
55 64 0.995837639 ubox
55 103 0.088940936 ubox
56 63 0.994813493 ubox
56 102 0.088389380 ubox
57 101 0.010344159 ubox
57 102 0.009833018 ubox
58 101 0.088312880 ubox
59 100 0.088831790 ubox
60 99 0.088909401 ubox
61 98 0.088944627 ubox
62 97 0.088922426 ubox
63 96 0.088829661 ubox
64 95 0.088560292 ubox
65 94 0.049936550 ubox
65 96 0.004382517 ubox
67 91 0.030947618 ubox
67 94 0.073238300 ubox
68 90 0.030960390 ubox
68 93 0.080354609 ubox
69 89 0.030596519 ubox
69 92 0.080007321 ubox
71 87 0.013165453 ubox
71 91 0.083196736 ubox
72 86 0.013163971 ubox
72 90 0.082909228 ubox
73 85 0.012027697 ubox
73 88 0.006944895 ubox
74 87 0.006478914 ubox
74 88 0.087253617 ubox
75 85 0.007986275 ubox
75 87 0.087592844 ubox
76 84 0.008336557 ubox
76 86 0.087617657 ubox
77 85 0.085837718 ubox
77 88 0.004729927 ubox
78 85 0.016886746 ubox
78 87 0.004773609 ubox
79 84 0.023564370 ubox
79 86 0.004785348 ubox
80 85 0.005159402 ubox
80 88 0.003345490 ubox
81 87 0.006551903 ubox
81 88 0.020566090 ubox
82 87 0.021459590 ubox
82 88 0.004162285 ubox
83 87 0.004418066 ubox
84 91 0.021820426 ubox
84 96 0.012326480 ubox
85 90 0.021854688 ubox
85 95 0.012339734 ubox
86 94 0.012356883 ubox
87 93 0.012339608 ubox
90 107 0.003306094 ubox
90 111 0.003586694 ubox
91 106 0.003307754 ubox
91 110 0.003592627 ubox
93 107 0.006936140 ubox
94 104 0.004117020 ubox
94 106 0.006941559 ubox
95 103 0.004196025 ubox
96 102 0.004201897 ubox
96 104 0.006937439 ubox
97 103 0.006935414 ubox
1 113 0.9500000 lbox
2 112 0.9500000 lbox
3 111 0.9500000 lbox
4 110 0.9500000 lbox
5 109 0.9500000 lbox
6 108 0.9500000 lbox
9 105 0.9500000 lbox
10 104 0.9500000 lbox
11 103 0.9500000 lbox
15 99 0.9500000 lbox
16 98 0.9500000 lbox
17 97 0.9500000 lbox
18 95 0.9500000 lbox
19 94 0.9500000 lbox
20 93 0.9500000 lbox
21 92 0.9500000 lbox
24 91 0.9500000 lbox
25 90 0.9500000 lbox
26 89 0.9500000 lbox
27 88 0.9500000 lbox
31 84 0.9500000 lbox
32 83 0.9500000 lbox
37 80 0.9500000 lbox
38 79 0.9500000 lbox
39 78 0.9500000 lbox
40 77 0.9500000 lbox
41 76 0.9500000 lbox
42 75 0.9500000 lbox
44 73 0.9500000 lbox
45 72 0.9500000 lbox
46 71 0.9500000 lbox
47 70 0.9500000 lbox
48 69 0.9500000 lbox
49 68 0.9500000 lbox
50 67 0.9500000 lbox
53 66 0.9500000 lbox
54 65 0.9500000 lbox
55 64 0.9500000 lbox
56 63 0.9500000 lbox
showpage
end
%%EOF
