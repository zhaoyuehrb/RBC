%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:30:55 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (HIST2H2BF)
} def

/sequence { (\
GGUAGUUCGGAUUACUUCUUUAAGUCUCUUUUCUCUUUUUUCGCGCAAAA\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 7 0.005255529 ubox
1 8 0.131151990 ubox
1 13 0.008650966 ubox
1 16 0.476821219 ubox
1 17 0.022186851 ubox
1 18 0.076938340 ubox
1 19 0.085612852 ubox
1 20 0.007526094 ubox
1 21 0.007902294 ubox
1 26 0.029287121 ubox
1 27 0.041147005 ubox
1 28 0.034203861 ubox
1 29 0.043667139 ubox
1 30 0.007879938 ubox
1 31 0.009445745 ubox
1 32 0.017236276 ubox
1 33 0.084285692 ubox
1 34 0.083767975 ubox
1 35 0.118835312 ubox
1 36 0.242513829 ubox
1 37 0.046058048 ubox
1 38 0.022281520 ubox
1 39 0.023636796 ubox
1 40 0.009144060 ubox
1 41 0.007101293 ubox
1 42 0.070773761 ubox
2 6 0.005368112 ubox
2 7 0.116712629 ubox
2 12 0.010313937 ubox
2 15 0.549786772 ubox
2 16 0.004995582 ubox
2 17 0.065775668 ubox
2 18 0.098200085 ubox
2 19 0.007686080 ubox
2 20 0.007398291 ubox
2 25 0.026338017 ubox
2 26 0.050628044 ubox
2 27 0.024854769 ubox
2 28 0.050233097 ubox
2 29 0.010189023 ubox
2 30 0.012914902 ubox
2 31 0.024331854 ubox
2 32 0.079487498 ubox
2 33 0.103091094 ubox
2 34 0.099559178 ubox
2 35 0.279283923 ubox
2 36 0.062919228 ubox
2 37 0.030931013 ubox
2 38 0.032579855 ubox
2 39 0.012234859 ubox
2 40 0.009943529 ubox
2 41 0.064861704 ubox
2 44 0.066003864 ubox
2 46 0.069303807 ubox
3 11 0.010324221 ubox
3 14 0.550238836 ubox
3 22 0.026799197 ubox
3 24 0.011931192 ubox
3 43 0.065026815 ubox
3 45 0.067163595 ubox
4 13 0.549660808 ubox
4 16 0.126375992 ubox
4 17 0.005135440 ubox
4 19 0.012259359 ubox
4 20 0.003568600 ubox
4 21 0.028249862 ubox
4 27 0.052059332 ubox
4 29 0.075879483 ubox
4 30 0.049664053 ubox
4 31 0.052154606 ubox
4 32 0.102939876 ubox
4 34 0.333812948 ubox
4 36 0.079858243 ubox
4 37 0.010841688 ubox
4 38 0.016544419 ubox
4 39 0.043389606 ubox
4 40 0.016494964 ubox
4 41 0.015978805 ubox
5 12 0.532468996 ubox
5 15 0.133785171 ubox
5 18 0.013145229 ubox
5 20 0.027574763 ubox
5 25 0.009190270 ubox
5 26 0.053903650 ubox
5 28 0.079655863 ubox
5 29 0.047684241 ubox
5 30 0.056325120 ubox
5 31 0.105098170 ubox
5 33 0.345481414 ubox
5 35 0.084679133 ubox
5 36 0.010194850 ubox
5 37 0.017258507 ubox
5 38 0.042505150 ubox
5 39 0.017575025 ubox
5 40 0.016116551 ubox
5 44 0.050543253 ubox
5 46 0.572947854 ubox
6 11 0.503311930 ubox
6 14 0.132469780 ubox
6 23 0.028362256 ubox
6 24 0.033866275 ubox
6 43 0.040643190 ubox
6 45 0.566541169 ubox
6 48 0.032505562 ubox
6 49 0.010110580 ubox
6 50 0.004190164 ubox
7 22 0.028558136 ubox
7 23 0.034648749 ubox
7 47 0.037006018 ubox
7 48 0.010345771 ubox
7 49 0.005483659 ubox
8 43 0.580250416 ubox
8 45 0.067725815 ubox
9 16 0.021928457 ubox
9 17 0.003424830 ubox
9 18 0.054280598 ubox
9 19 0.144578745 ubox
9 20 0.010024149 ubox
9 21 0.011077815 ubox
9 26 0.036902573 ubox
9 27 0.290461557 ubox
9 28 0.105282951 ubox
9 29 0.379701605 ubox
9 30 0.019996917 ubox
9 31 0.030551323 ubox
9 32 0.022368987 ubox
9 33 0.079004089 ubox
9 34 0.084662277 ubox
9 35 0.024352735 ubox
9 36 0.029664909 ubox
9 38 0.003652807 ubox
9 39 0.007091462 ubox
9 40 0.013131068 ubox
9 41 0.009482514 ubox
9 42 0.581107104 ubox
9 44 0.070619403 ubox
10 15 0.023161979 ubox
10 16 0.003791663 ubox
10 17 0.052761429 ubox
10 18 0.154565710 ubox
10 19 0.005821014 ubox
10 20 0.012034079 ubox
10 21 0.030950983 ubox
10 25 0.027338580 ubox
10 26 0.318812311 ubox
10 27 0.057156171 ubox
10 28 0.396537007 ubox
10 29 0.016967004 ubox
10 30 0.035682855 ubox
10 31 0.028644628 ubox
10 32 0.078912016 ubox
10 33 0.092687858 ubox
10 34 0.006811457 ubox
10 35 0.031916355 ubox
10 37 0.004967897 ubox
10 38 0.010780983 ubox
10 39 0.017333881 ubox
10 40 0.025987310 ubox
10 41 0.574654991 ubox
10 42 0.080462174 ubox
11 16 0.047779937 ubox
11 17 0.153093066 ubox
11 19 0.011734704 ubox
11 20 0.031638920 ubox
11 25 0.315853354 ubox
11 27 0.388939444 ubox
11 29 0.035121412 ubox
11 30 0.030130836 ubox
11 31 0.078108464 ubox
11 32 0.091521138 ubox
11 34 0.030631297 ubox
11 36 0.005267296 ubox
11 37 0.012017085 ubox
11 38 0.019274160 ubox
11 39 0.034857187 ubox
11 40 0.564156293 ubox
11 41 0.082885346 ubox
12 23 0.089172222 ubox
12 24 0.303658864 ubox
13 22 0.112746151 ubox
13 23 0.274806533 ubox
14 21 0.124323055 ubox
14 25 0.471780786 ubox
15 24 0.488574009 ubox
16 23 0.481289434 ubox
16 24 0.010588877 ubox
17 22 0.400983753 ubox
17 23 0.017436266 ubox
17 47 0.003502815 ubox
17 48 0.003306357 ubox
18 24 0.070704404 ubox
19 23 0.064147949 ubox
19 48 0.009358578 ubox
19 49 0.043116311 ubox
19 50 0.011021069 ubox
20 47 0.009562977 ubox
20 48 0.047840360 ubox
20 49 0.015590502 ubox
20 50 0.006058803 ubox
21 47 0.047036241 ubox
21 48 0.015425680 ubox
21 49 0.007862610 ubox
22 30 0.365269644 ubox
22 31 0.108460774 ubox
22 32 0.064855289 ubox
22 37 0.159332045 ubox
22 38 0.017301959 ubox
22 39 0.026793699 ubox
22 40 0.018740752 ubox
22 41 0.016521203 ubox
23 29 0.379470739 ubox
23 30 0.108117526 ubox
23 31 0.071884578 ubox
23 32 0.036242790 ubox
23 34 0.158795150 ubox
23 36 0.174262314 ubox
23 37 0.017627556 ubox
23 38 0.028190936 ubox
23 39 0.022001453 ubox
23 40 0.018616284 ubox
23 41 0.008978662 ubox
24 28 0.372820701 ubox
24 29 0.083253424 ubox
24 30 0.070973403 ubox
24 31 0.039530097 ubox
24 33 0.167939422 ubox
24 35 0.175768417 ubox
24 36 0.014355044 ubox
24 37 0.027338032 ubox
24 38 0.021353885 ubox
24 39 0.018481534 ubox
24 40 0.009988141 ubox
24 44 0.065141388 ubox
24 46 0.044928597 ubox
25 43 0.062879128 ubox
25 45 0.043382555 ubox
29 48 0.007518891 ubox
29 49 0.016987057 ubox
29 50 0.017342858 ubox
30 47 0.007595275 ubox
30 48 0.018710728 ubox
30 49 0.025074774 ubox
30 50 0.010085278 ubox
31 47 0.017515982 ubox
31 48 0.026091510 ubox
31 49 0.013531667 ubox
31 50 0.004675528 ubox
32 47 0.023845711 ubox
32 48 0.013162719 ubox
32 49 0.005737019 ubox
36 48 0.014809215 ubox
36 49 0.059890349 ubox
36 50 0.042324084 ubox
37 47 0.015150843 ubox
37 48 0.066872854 ubox
37 49 0.061321185 ubox
37 50 0.081119821 ubox
38 47 0.066786853 ubox
38 48 0.064156348 ubox
38 49 0.110729583 ubox
38 50 0.063009931 ubox
39 47 0.060748033 ubox
39 48 0.116065644 ubox
39 49 0.085498273 ubox
39 50 0.042235651 ubox
40 47 0.105949155 ubox
40 48 0.089197159 ubox
40 49 0.057208424 ubox
40 50 0.012078825 ubox
41 47 0.083691477 ubox
41 48 0.055090465 ubox
41 49 0.015488802 ubox
1 16 0.9500000 lbox
2 15 0.9500000 lbox
3 14 0.9500000 lbox
4 13 0.9500000 lbox
5 12 0.9500000 lbox
6 11 0.9500000 lbox
showpage
end
%%EOF
