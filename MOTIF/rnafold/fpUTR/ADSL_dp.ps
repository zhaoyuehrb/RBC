%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:41:42 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (ADSL)
} def

/sequence { (\
AGGUUUCCGCUUCCGCUCUUCCCUGGUCCAGUCCACCCUGGCGGGGUCGCAGGGUUGGG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 11 0.068667145 ubox
1 12 0.188793844 ubox
1 17 0.006856822 ubox
1 19 0.014557628 ubox
1 20 0.010244978 ubox
1 24 0.288213243 ubox
1 56 0.006244603 ubox
2 8 0.237625635 ubox
2 10 0.078589480 ubox
2 11 0.292980372 ubox
2 12 0.010665729 ubox
2 13 0.036270387 ubox
2 14 0.164576961 ubox
2 16 0.008032894 ubox
2 17 0.019481977 ubox
2 18 0.016701330 ubox
2 19 0.014410811 ubox
2 21 0.015882791 ubox
2 22 0.144806651 ubox
2 23 0.305025390 ubox
2 24 0.009658688 ubox
2 28 0.006345413 ubox
2 29 0.102982186 ubox
2 34 0.010574025 ubox
2 55 0.007225576 ubox
3 7 0.234093378 ubox
3 10 0.303478925 ubox
3 11 0.006979246 ubox
3 12 0.036723211 ubox
3 13 0.164485166 ubox
3 16 0.022519538 ubox
3 17 0.013926250 ubox
3 18 0.014834599 ubox
3 20 0.015514382 ubox
3 21 0.145895729 ubox
3 22 0.304225584 ubox
3 23 0.010388337 ubox
3 27 0.006029010 ubox
3 28 0.102928060 ubox
3 33 0.010591034 ubox
4 9 0.286756363 ubox
4 15 0.021576732 ubox
4 26 0.009131647 ubox
4 31 0.003544526 ubox
4 53 0.007393650 ubox
4 58 0.003663238 ubox
4 59 0.009397066 ubox
5 25 0.008880195 ubox
5 26 0.005312460 ubox
5 30 0.003795783 ubox
5 31 0.004246768 ubox
5 52 0.007538013 ubox
5 54 0.003564196 ubox
5 57 0.004116445 ubox
5 58 0.005116431 ubox
5 59 0.034180822 ubox
6 25 0.005174993 ubox
6 26 0.010822002 ubox
6 30 0.005219196 ubox
6 51 0.007203513 ubox
6 53 0.004716754 ubox
6 54 0.016140730 ubox
6 57 0.004255356 ubox
6 58 0.045509271 ubox
6 59 0.420886418 ubox
7 25 0.011126813 ubox
7 26 0.098065620 ubox
7 52 0.005161628 ubox
7 53 0.021863395 ubox
7 54 0.010299047 ubox
7 57 0.051144138 ubox
7 58 0.682469997 ubox
7 59 0.211987276 ubox
8 15 0.065548199 ubox
8 25 0.098201541 ubox
8 49 0.008518761 ubox
8 52 0.021865115 ubox
8 53 0.010335638 ubox
8 57 0.683313018 ubox
8 58 0.216538688 ubox
9 14 0.064128187 ubox
9 16 0.369320578 ubox
9 24 0.062978367 ubox
9 27 0.027171969 ubox
9 32 0.106103361 ubox
9 47 0.003560675 ubox
9 48 0.008684016 ubox
9 50 0.021934226 ubox
9 55 0.164659447 ubox
9 56 0.634839450 ubox
10 15 0.369562362 ubox
10 26 0.027722774 ubox
10 31 0.113317311 ubox
10 46 0.005039640 ubox
10 49 0.021954822 ubox
10 52 0.010837129 ubox
10 53 0.028928677 ubox
10 54 0.226068806 ubox
10 58 0.050021948 ubox
10 59 0.027549859 ubox
11 25 0.027181022 ubox
11 30 0.109739853 ubox
11 31 0.006438149 ubox
11 45 0.003572693 ubox
11 46 0.017683953 ubox
11 51 0.010689218 ubox
11 52 0.029844543 ubox
11 53 0.178189920 ubox
11 54 0.259461548 ubox
11 57 0.048777096 ubox
11 58 0.023497766 ubox
11 59 0.041545638 ubox
12 30 0.009263472 ubox
12 45 0.022663191 ubox
12 51 0.025915614 ubox
12 52 0.129072804 ubox
12 53 0.276822554 ubox
12 54 0.583542136 ubox
12 57 0.016861245 ubox
12 58 0.075670761 ubox
12 59 0.258169577 ubox
13 25 0.003500420 ubox
13 26 0.131473028 ubox
13 44 0.023362092 ubox
13 52 0.296042593 ubox
13 53 0.613071187 ubox
13 54 0.165449270 ubox
13 57 0.089537108 ubox
13 58 0.444300070 ubox
13 59 0.045041022 ubox
14 25 0.131903130 ubox
14 43 0.023399705 ubox
14 49 0.027902697 ubox
14 52 0.613446159 ubox
14 53 0.165234405 ubox
14 57 0.444857649 ubox
14 58 0.045566464 ubox
15 24 0.122087966 ubox
15 27 0.053918535 ubox
15 32 0.021512686 ubox
15 42 0.023438547 ubox
15 47 0.011776003 ubox
15 48 0.027692370 ubox
15 50 0.652092343 ubox
15 55 0.339050903 ubox
15 56 0.316699575 ubox
16 26 0.055733917 ubox
16 31 0.023004764 ubox
16 41 0.023364968 ubox
16 46 0.021420162 ubox
16 49 0.653021980 ubox
16 52 0.111896765 ubox
16 53 0.008519375 ubox
16 54 0.461156631 ubox
16 58 0.028699180 ubox
16 59 0.272436490 ubox
17 25 0.037057388 ubox
17 26 0.035743949 ubox
17 30 0.022008088 ubox
17 40 0.019337412 ubox
17 45 0.021308932 ubox
17 46 0.004974452 ubox
17 51 0.108864868 ubox
17 52 0.008006173 ubox
17 53 0.459889028 ubox
17 54 0.064894258 ubox
17 57 0.011695131 ubox
17 58 0.287474277 ubox
17 59 0.025731806 ubox
18 25 0.060778435 ubox
18 26 0.028787505 ubox
18 31 0.006173205 ubox
18 40 0.011922540 ubox
18 44 0.021315224 ubox
18 45 0.005558253 ubox
18 46 0.024051590 ubox
18 52 0.459602330 ubox
18 53 0.073806837 ubox
18 54 0.010878419 ubox
18 57 0.295731400 ubox
18 58 0.044316158 ubox
18 59 0.009375849 ubox
19 25 0.028709636 ubox
19 26 0.004410746 ubox
19 30 0.005948899 ubox
19 43 0.020958810 ubox
19 44 0.005414880 ubox
19 45 0.021658439 ubox
19 46 0.011547330 ubox
19 51 0.424114588 ubox
19 52 0.073364074 ubox
19 53 0.010718327 ubox
19 57 0.043800167 ubox
19 58 0.009467500 ubox
20 25 0.003912387 ubox
20 26 0.008560891 ubox
20 43 0.005096765 ubox
20 44 0.021298870 ubox
20 45 0.010903408 ubox
20 46 0.101636085 ubox
20 51 0.073640832 ubox
20 52 0.010454682 ubox
20 57 0.007380622 ubox
20 59 0.005661800 ubox
21 25 0.009955091 ubox
21 41 0.018195232 ubox
21 43 0.021358088 ubox
21 44 0.011435155 ubox
21 45 0.106986329 ubox
21 46 0.801106457 ubox
21 54 0.301780589 ubox
21 58 0.009140798 ubox
21 59 0.045056910 ubox
22 40 0.018181335 ubox
22 41 0.024114273 ubox
22 43 0.011397992 ubox
22 44 0.106810534 ubox
22 45 0.801664173 ubox
22 46 0.279033083 ubox
22 53 0.301838898 ubox
22 57 0.009099145 ubox
22 58 0.046077655 ubox
22 59 0.019102657 ubox
23 31 0.128612226 ubox
23 40 0.024123208 ubox
23 41 0.004698737 ubox
23 43 0.106194125 ubox
23 44 0.801515940 ubox
23 45 0.279923955 ubox
23 46 0.003707256 ubox
23 52 0.301830616 ubox
23 57 0.045979137 ubox
23 58 0.019675295 ubox
24 30 0.129766742 ubox
24 35 0.041858805 ubox
24 40 0.004403646 ubox
24 43 0.790954889 ubox
24 44 0.279482733 ubox
24 45 0.003477504 ubox
24 49 0.022370808 ubox
24 51 0.300397641 ubox
24 57 0.019336431 ubox
25 29 0.128405110 ubox
25 34 0.072744631 ubox
25 37 0.025462928 ubox
25 38 0.011384413 ubox
25 42 0.730256728 ubox
25 48 0.046919523 ubox
25 50 0.296123696 ubox
25 56 0.018480415 ubox
26 32 0.004172653 ubox
26 33 0.073291578 ubox
26 36 0.025612966 ubox
26 37 0.011155289 ubox
26 42 0.395792729 ubox
26 47 0.074090297 ubox
26 50 0.023426991 ubox
26 55 0.017761313 ubox
27 31 0.005690872 ubox
27 35 0.024806262 ubox
27 41 0.073243796 ubox
27 45 0.031419988 ubox
27 46 0.211843417 ubox
27 49 0.030751665 ubox
27 54 0.018834279 ubox
27 59 0.083868635 ubox
28 40 0.053377246 ubox
28 41 0.849884585 ubox
28 44 0.046235848 ubox
28 45 0.241736924 ubox
28 46 0.148428170 ubox
28 53 0.020091614 ubox
28 54 0.007209823 ubox
28 58 0.136566104 ubox
28 59 0.014462691 ubox
29 40 0.854743546 ubox
29 43 0.046469271 ubox
29 44 0.241024053 ubox
29 45 0.148289054 ubox
29 52 0.020063076 ubox
29 53 0.007203356 ubox
29 57 0.136769197 ubox
29 58 0.013925483 ubox
30 39 0.855986974 ubox
30 56 0.135924279 ubox
31 38 0.850909867 ubox
31 42 0.262687059 ubox
31 47 0.006245792 ubox
31 50 0.021628351 ubox
31 55 0.060284743 ubox
32 41 0.191207101 ubox
32 45 0.022076682 ubox
32 46 0.003616257 ubox
32 49 0.021969416 ubox
32 54 0.034166625 ubox
32 58 0.027433090 ubox
32 59 0.228040879 ubox
33 40 0.187636564 ubox
33 41 0.214988911 ubox
33 44 0.026105275 ubox
33 45 0.003645035 ubox
33 46 0.020533954 ubox
33 53 0.035899748 ubox
33 54 0.008167259 ubox
33 57 0.036449138 ubox
33 58 0.384767716 ubox
33 59 0.021255557 ubox
34 40 0.216027234 ubox
34 43 0.026123458 ubox
34 44 0.003568485 ubox
34 45 0.020093065 ubox
34 52 0.035884283 ubox
34 53 0.007729513 ubox
34 57 0.385382356 ubox
34 58 0.021166882 ubox
35 39 0.175845474 ubox
35 47 0.081579694 ubox
35 55 0.305730319 ubox
35 56 0.272614562 ubox
36 44 0.019890764 ubox
36 45 0.027466697 ubox
36 46 0.083952995 ubox
36 54 0.414646025 ubox
37 43 0.019852465 ubox
37 44 0.028154497 ubox
37 45 0.083925490 ubox
37 46 0.003858510 ubox
37 53 0.414720085 ubox
37 54 0.029433832 ubox
38 43 0.028256110 ubox
38 44 0.083863129 ubox
38 45 0.003941195 ubox
38 52 0.414717929 ubox
38 53 0.029481444 ubox
39 43 0.075551194 ubox
39 44 0.003939202 ubox
39 49 0.003760588 ubox
39 51 0.406017677 ubox
39 52 0.027318144 ubox
40 48 0.007762857 ubox
40 50 0.289888156 ubox
41 47 0.012827437 ubox
41 50 0.297910916 ubox
42 46 0.013112071 ubox
42 49 0.412046129 ubox
43 48 0.407034227 ubox
48 53 0.003809195 ubox
7 58 0.9500000 lbox
8 57 0.9500000 lbox
9 56 0.9500000 lbox
12 54 0.9500000 lbox
13 53 0.9500000 lbox
14 52 0.9500000 lbox
15 50 0.9500000 lbox
16 49 0.9500000 lbox
21 46 0.9500000 lbox
22 45 0.9500000 lbox
23 44 0.9500000 lbox
24 43 0.9500000 lbox
25 42 0.9500000 lbox
28 41 0.9500000 lbox
29 40 0.9500000 lbox
30 39 0.9500000 lbox
31 38 0.9500000 lbox
showpage
end
%%EOF
