%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:00:09 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (ZNF157)
} def

/sequence { (\
GAGGCUGCAGGACCCUCUACACACAGACAGCUGUCCAGCACGGAAGGUGGGCUGAGGCCCAGGGUGAAC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 17 0.352648604 ubox
1 35 0.050678358 ubox
2 16 0.353281344 ubox
2 18 0.004832434 ubox
2 32 0.007323067 ubox
2 34 0.047809035 ubox
3 14 0.074850935 ubox
3 15 0.347450871 ubox
3 17 0.004833061 ubox
3 31 0.005350575 ubox
3 32 0.078437799 ubox
3 35 0.010588779 ubox
3 36 0.060384417 ubox
3 59 0.616886403 ubox
3 60 0.059401108 ubox
4 13 0.098941128 ubox
4 14 0.339355117 ubox
4 16 0.003736967 ubox
4 31 0.085961293 ubox
4 34 0.010487937 ubox
4 35 0.060212763 ubox
4 39 0.143042103 ubox
4 48 0.016899307 ubox
4 58 0.619744208 ubox
4 59 0.042372580 ubox
4 65 0.061761091 ubox
5 11 0.199999988 ubox
5 26 0.009106590 ubox
5 30 0.086227769 ubox
5 33 0.012201800 ubox
5 38 0.145328514 ubox
5 43 0.046085582 ubox
5 46 0.017220954 ubox
5 47 0.019484026 ubox
5 56 0.018145129 ubox
5 57 0.620890794 ubox
5 62 0.029069135 ubox
5 63 0.015477595 ubox
5 64 0.063613143 ubox
6 10 0.181716493 ubox
6 21 0.017192266 ubox
6 23 0.003458081 ubox
6 25 0.009156495 ubox
6 29 0.086139455 ubox
6 37 0.143510663 ubox
6 40 0.205274942 ubox
6 42 0.033584668 ubox
6 45 0.012296206 ubox
6 46 0.013819732 ubox
6 55 0.024857398 ubox
6 56 0.578125902 ubox
6 61 0.028283954 ubox
6 62 0.013690880 ubox
6 63 0.058847276 ubox
6 66 0.012022589 ubox
7 20 0.021637619 ubox
7 22 0.005037136 ubox
7 24 0.009138853 ubox
7 28 0.085911947 ubox
7 31 0.012146381 ubox
7 34 0.087354676 ubox
7 36 0.115773777 ubox
7 39 0.239719778 ubox
7 41 0.015842278 ubox
7 52 0.021389623 ubox
7 58 0.004278427 ubox
7 60 0.026948197 ubox
7 65 0.011914037 ubox
8 30 0.012166147 ubox
8 33 0.131796789 ubox
8 38 0.240269147 ubox
8 51 0.021373694 ubox
8 54 0.550573919 ubox
8 57 0.004299841 ubox
8 64 0.011831087 ubox
8 66 0.066501917 ubox
9 16 0.014214225 ubox
9 18 0.034883504 ubox
9 32 0.132508610 ubox
9 53 0.547845443 ubox
9 65 0.045222371 ubox
10 15 0.015799178 ubox
10 16 0.005073204 ubox
10 17 0.036087822 ubox
10 18 0.030152313 ubox
10 31 0.132177363 ubox
10 32 0.040471173 ubox
10 35 0.006730699 ubox
10 36 0.253807621 ubox
10 52 0.523102838 ubox
10 53 0.287573303 ubox
10 59 0.046952025 ubox
10 60 0.029212807 ubox
11 15 0.007558901 ubox
11 16 0.028227037 ubox
11 17 0.032626595 ubox
11 31 0.041639438 ubox
11 34 0.005366170 ubox
11 35 0.256446514 ubox
11 52 0.324099806 ubox
11 58 0.046912273 ubox
11 59 0.029284926 ubox
12 16 0.028436097 ubox
12 34 0.255628234 ubox
12 48 0.183365700 ubox
12 65 0.605173642 ubox
13 33 0.253889729 ubox
13 43 0.003593899 ubox
13 47 0.192436704 ubox
13 50 0.134214359 ubox
13 51 0.560148463 ubox
13 57 0.027387092 ubox
13 63 0.010068134 ubox
13 64 0.622803691 ubox
14 42 0.003592274 ubox
14 43 0.007484360 ubox
14 46 0.192012489 ubox
14 47 0.094872205 ubox
14 49 0.132696803 ubox
14 50 0.562056950 ubox
14 51 0.049099563 ubox
14 56 0.023661814 ubox
14 57 0.048449128 ubox
14 62 0.010095945 ubox
14 63 0.622941322 ubox
14 64 0.015537962 ubox
15 26 0.061913409 ubox
15 30 0.126499245 ubox
15 42 0.008674068 ubox
15 43 0.012928387 ubox
15 46 0.096863182 ubox
15 47 0.060281157 ubox
15 49 0.559027523 ubox
15 50 0.049142147 ubox
15 51 0.018582775 ubox
15 56 0.050569430 ubox
15 62 0.622341510 ubox
15 63 0.016086925 ubox
15 64 0.019683278 ubox
16 25 0.061790765 ubox
16 27 0.403863813 ubox
16 29 0.086231690 ubox
16 42 0.012591564 ubox
16 43 0.012051892 ubox
16 44 0.207437504 ubox
16 45 0.076031112 ubox
16 46 0.044065650 ubox
16 47 0.303905842 ubox
16 49 0.034341341 ubox
16 50 0.012834082 ubox
16 51 0.032654452 ubox
16 55 0.052288397 ubox
16 57 0.013849317 ubox
16 61 0.491450545 ubox
16 62 0.013849526 ubox
16 63 0.019787037 ubox
16 64 0.003650244 ubox
16 67 0.005910855 ubox
17 26 0.479225846 ubox
17 30 0.060493157 ubox
17 38 0.024523506 ubox
17 42 0.015144175 ubox
17 43 0.219039742 ubox
17 46 0.323783088 ubox
17 47 0.357010506 ubox
17 49 0.014809417 ubox
17 50 0.036176594 ubox
17 51 0.006555497 ubox
17 54 0.049859118 ubox
17 56 0.026529926 ubox
17 57 0.021567585 ubox
17 62 0.021193410 ubox
17 63 0.005102672 ubox
17 66 0.006185446 ubox
18 25 0.460021709 ubox
18 29 0.059074935 ubox
18 37 0.024738193 ubox
18 42 0.210557994 ubox
18 45 0.312830405 ubox
18 46 0.343750303 ubox
18 49 0.037056911 ubox
18 50 0.006042148 ubox
18 55 0.026389322 ubox
18 56 0.020853773 ubox
18 61 0.019859745 ubox
18 62 0.005380259 ubox
18 66 0.057691114 ubox
19 34 0.019564698 ubox
19 48 0.058661205 ubox
19 53 0.003737023 ubox
19 65 0.061825007 ubox
20 33 0.025877571 ubox
20 47 0.059394624 ubox
20 49 0.040505645 ubox
20 54 0.007459882 ubox
20 64 0.062138203 ubox
20 66 0.228682555 ubox
21 32 0.023463153 ubox
21 34 0.039513802 ubox
21 48 0.054738789 ubox
21 53 0.006705559 ubox
21 65 0.229533025 ubox
22 33 0.053462507 ubox
22 47 0.055606522 ubox
22 49 0.036818970 ubox
22 54 0.009547220 ubox
22 64 0.229287864 ubox
22 66 0.141034523 ubox
23 32 0.051620211 ubox
23 34 0.490478151 ubox
23 48 0.040772134 ubox
23 53 0.008990512 ubox
23 65 0.141434755 ubox
24 33 0.667083600 ubox
24 47 0.041170404 ubox
24 49 0.005044864 ubox
24 54 0.151032083 ubox
24 64 0.141099190 ubox
24 66 0.012227122 ubox
25 32 0.668428564 ubox
25 48 0.005927601 ubox
25 53 0.152663440 ubox
25 65 0.011221652 ubox
26 31 0.664692479 ubox
26 35 0.219257031 ubox
26 52 0.152541479 ubox
27 34 0.220671044 ubox
27 48 0.053318534 ubox
27 65 0.021110635 ubox
28 33 0.221384499 ubox
28 47 0.056922855 ubox
28 49 0.139000081 ubox
28 54 0.026815784 ubox
28 64 0.021753793 ubox
28 66 0.059677481 ubox
29 48 0.175509163 ubox
29 53 0.027721145 ubox
29 65 0.059616600 ubox
30 39 0.127274444 ubox
30 48 0.507313909 ubox
30 52 0.027769392 ubox
30 58 0.055683417 ubox
30 65 0.009756208 ubox
31 38 0.127481082 ubox
31 43 0.089999147 ubox
31 46 0.214930664 ubox
31 47 0.557000268 ubox
31 51 0.027722019 ubox
31 56 0.004788592 ubox
31 57 0.055717729 ubox
31 62 0.015809418 ubox
31 63 0.058754821 ubox
31 64 0.011117681 ubox
32 37 0.119260446 ubox
32 40 0.012906797 ubox
32 42 0.090272796 ubox
32 45 0.212905726 ubox
32 46 0.540884119 ubox
32 50 0.026957718 ubox
32 55 0.004945375 ubox
32 56 0.054194562 ubox
32 61 0.015763106 ubox
32 62 0.056915608 ubox
32 63 0.010776092 ubox
33 39 0.015332903 ubox
33 41 0.090529880 ubox
33 48 0.003675673 ubox
33 52 0.027176254 ubox
33 58 0.063265471 ubox
33 60 0.010718867 ubox
33 69 0.003975521 ubox
34 38 0.014428180 ubox
34 40 0.086815835 ubox
34 43 0.021518453 ubox
34 44 0.704957270 ubox
34 47 0.003661399 ubox
34 51 0.027409914 ubox
34 55 0.019426818 ubox
34 57 0.064179729 ubox
34 64 0.009122322 ubox
34 68 0.003714982 ubox
35 42 0.037242763 ubox
35 43 0.865671603 ubox
35 46 0.008015669 ubox
35 47 0.089428179 ubox
35 50 0.029450137 ubox
35 51 0.013549814 ubox
35 54 0.015253263 ubox
35 56 0.067095833 ubox
35 57 0.003446090 ubox
35 63 0.027108685 ubox
35 64 0.005992808 ubox
35 66 0.003287677 ubox
36 42 0.865865748 ubox
36 46 0.090384344 ubox
36 49 0.029293159 ubox
36 50 0.013675752 ubox
36 54 0.089628776 ubox
36 62 0.027175405 ubox
36 63 0.006124771 ubox
36 66 0.010150036 ubox
37 48 0.026791990 ubox
37 53 0.091218547 ubox
37 65 0.009424377 ubox
38 48 0.029359728 ubox
38 52 0.091285162 ubox
38 58 0.003477117 ubox
38 65 0.007911626 ubox
39 47 0.034147247 ubox
39 49 0.064320221 ubox
39 51 0.087904320 ubox
39 57 0.003480836 ubox
39 64 0.009305995 ubox
39 66 0.190534475 ubox
40 48 0.133056522 ubox
40 65 0.197935610 ubox
41 47 0.147801625 ubox
41 49 0.074376782 ubox
41 54 0.005233316 ubox
41 64 0.199534587 ubox
41 66 0.123360658 ubox
42 48 0.072108704 ubox
42 53 0.005281126 ubox
42 65 0.122316440 ubox
43 52 0.005286439 ubox
46 59 0.011356629 ubox
47 58 0.011405360 ubox
47 65 0.007847199 ubox
47 69 0.004424098 ubox
48 57 0.011403002 ubox
48 61 0.487787103 ubox
48 68 0.003317915 ubox
49 60 0.755088591 ubox
50 59 0.760430131 ubox
50 60 0.009198761 ubox
51 58 0.760465128 ubox
51 59 0.007223388 ubox
52 57 0.758016067 ubox
52 62 0.008619851 ubox
53 61 0.008767104 ubox
54 60 0.008873150 ubox
57 65 0.030270254 ubox
58 64 0.031293007 ubox
59 63 0.031168742 ubox
60 66 0.116134029 ubox
61 65 0.094355550 ubox
12 65 0.9500000 lbox
13 64 0.9500000 lbox
14 63 0.9500000 lbox
15 62 0.9500000 lbox
16 61 0.9500000 lbox
30 48 0.9500000 lbox
31 47 0.9500000 lbox
32 46 0.9500000 lbox
34 44 0.9500000 lbox
35 43 0.9500000 lbox
36 42 0.9500000 lbox
49 60 0.9500000 lbox
50 59 0.9500000 lbox
51 58 0.9500000 lbox
52 57 0.9500000 lbox
showpage
end
%%EOF
