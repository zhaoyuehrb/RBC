%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:19:55 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (TAS2R16)
} def

/sequence { (\
UCUCUACCUGGAAAUUGGUACAGAGAUUCAGAGUCUUUGUCCAGGAAGACACUUUGGAGUAGAAGA\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 12 0.009148086 ubox
1 24 0.085733594 ubox
1 26 0.256721486 ubox
1 49 0.095661724 ubox
1 57 0.013692173 ubox
1 58 0.032978797 ubox
1 63 0.093220382 ubox
1 66 0.478247634 ubox
2 11 0.009766772 ubox
2 23 0.091663141 ubox
2 25 0.284165503 ubox
2 48 0.106319598 ubox
2 56 0.017396320 ubox
2 57 0.035203349 ubox
2 59 0.230602807 ubox
2 62 0.099162239 ubox
2 65 0.589986165 ubox
3 10 0.008211401 ubox
3 11 0.003498357 ubox
3 12 0.010665249 ubox
3 22 0.089683623 ubox
3 24 0.284285588 ubox
3 26 0.004405857 ubox
3 46 0.006300178 ubox
3 47 0.104865872 ubox
3 49 0.485178681 ubox
3 56 0.023012812 ubox
3 57 0.004326241 ubox
3 58 0.233554285 ubox
3 61 0.094449873 ubox
3 63 0.598399728 ubox
3 64 0.417004695 ubox
3 66 0.008085153 ubox
4 10 0.006089675 ubox
4 11 0.011290661 ubox
4 23 0.283825631 ubox
4 25 0.004782603 ubox
4 45 0.006815933 ubox
4 48 0.525929228 ubox
4 56 0.007661120 ubox
4 57 0.233997956 ubox
4 59 0.090996443 ubox
4 62 0.742925618 ubox
4 65 0.009502891 ubox
5 10 0.010567828 ubox
5 20 0.189982236 ubox
5 22 0.219705072 ubox
5 24 0.003913904 ubox
5 44 0.005502841 ubox
5 47 0.518983222 ubox
5 56 0.232934267 ubox
5 58 0.090267607 ubox
5 61 0.742834833 ubox
5 64 0.008556153 ubox
6 19 0.292889444 ubox
6 55 0.220010548 ubox
6 60 0.742213721 ubox
7 18 0.300929405 ubox
7 45 0.559226764 ubox
7 57 0.110045769 ubox
7 59 0.738624977 ubox
8 17 0.301115408 ubox
8 18 0.013182616 ubox
8 23 0.033091378 ubox
8 31 0.016492559 ubox
8 44 0.560870698 ubox
8 45 0.005690508 ubox
8 48 0.046573731 ubox
8 56 0.115617419 ubox
8 57 0.723327037 ubox
8 59 0.027400983 ubox
9 17 0.013215000 ubox
9 20 0.003981386 ubox
9 22 0.033225136 ubox
9 30 0.016577881 ubox
9 43 0.560272442 ubox
9 44 0.005112663 ubox
9 47 0.046558394 ubox
9 51 0.246390361 ubox
9 56 0.703290221 ubox
9 58 0.037017349 ubox
10 16 0.017426240 ubox
10 19 0.004438931 ubox
10 21 0.033270478 ubox
10 29 0.016639577 ubox
10 42 0.559933796 ubox
10 50 0.287641784 ubox
10 53 0.148319750 ubox
10 54 0.020292615 ubox
10 55 0.644733143 ubox
11 15 0.013494812 ubox
11 28 0.016433447 ubox
11 41 0.559654642 ubox
11 52 0.157481011 ubox
11 53 0.021070560 ubox
11 54 0.643284187 ubox
11 55 0.068551811 ubox
12 27 0.016033634 ubox
12 40 0.425317477 ubox
12 53 0.616048873 ubox
12 54 0.073963117 ubox
12 55 0.060281140 ubox
13 28 0.003817006 ubox
13 38 0.004163729 ubox
13 53 0.059197960 ubox
13 54 0.066124275 ubox
13 55 0.017910929 ubox
14 27 0.004743980 ubox
14 40 0.005742609 ubox
14 53 0.066586450 ubox
14 54 0.018517410 ubox
15 23 0.003559715 ubox
15 24 0.015406272 ubox
15 26 0.005432685 ubox
15 39 0.003905402 ubox
15 44 0.730111264 ubox
15 45 0.021774855 ubox
15 46 0.023231389 ubox
15 47 0.059012273 ubox
15 48 0.031702056 ubox
15 49 0.041955122 ubox
16 22 0.005197206 ubox
16 23 0.015154742 ubox
16 25 0.005483438 ubox
16 30 0.003847664 ubox
16 39 0.003547062 ubox
16 43 0.763470245 ubox
16 44 0.012199748 ubox
16 45 0.014983803 ubox
16 46 0.029658954 ubox
16 47 0.014389230 ubox
16 48 0.027110661 ubox
16 51 0.010631200 ubox
17 21 0.005697698 ubox
17 29 0.004005349 ubox
17 35 0.004564094 ubox
17 36 0.012996409 ubox
17 41 0.004187641 ubox
17 42 0.770196811 ubox
17 50 0.008400923 ubox
17 53 0.003415164 ubox
18 28 0.003683782 ubox
18 34 0.003903366 ubox
18 35 0.013148272 ubox
18 40 0.005746014 ubox
18 41 0.770203195 ubox
18 50 0.005484917 ubox
18 52 0.004168145 ubox
19 39 0.006478485 ubox
19 49 0.005630305 ubox
19 51 0.004132202 ubox
20 34 0.012173599 ubox
20 38 0.005228889 ubox
20 40 0.842897620 ubox
21 33 0.012332065 ubox
21 39 0.952813551 ubox
22 38 0.952204025 ubox
23 29 0.008833638 ubox
23 37 0.952258952 ubox
24 28 0.007699133 ubox
24 36 0.953048328 ubox
25 35 0.953349759 ubox
26 34 0.952128437 ubox
26 60 0.053888059 ubox
27 33 0.941205680 ubox
27 58 0.256356840 ubox
27 59 0.055452291 ubox
27 64 0.006701437 ubox
28 32 0.717720082 ubox
28 57 0.277050710 ubox
28 58 0.056823345 ubox
28 63 0.007580423 ubox
29 56 0.287551643 ubox
29 57 0.048087107 ubox
29 62 0.007578894 ubox
30 53 0.037165344 ubox
30 54 0.005467923 ubox
30 55 0.288389931 ubox
31 52 0.041954875 ubox
31 53 0.005358346 ubox
31 54 0.287612099 ubox
31 55 0.011891610 ubox
32 53 0.279463485 ubox
32 54 0.013496051 ubox
33 50 0.185699320 ubox
33 52 0.231540250 ubox
34 46 0.005816636 ubox
34 49 0.235403783 ubox
34 51 0.161064579 ubox
34 63 0.016083612 ubox
34 66 0.037025882 ubox
35 45 0.007637666 ubox
35 48 0.269073277 ubox
35 62 0.017177500 ubox
35 65 0.043477284 ubox
36 44 0.007568543 ubox
36 46 0.006614392 ubox
36 47 0.269299739 ubox
36 48 0.008003661 ubox
36 49 0.071811026 ubox
36 61 0.016301670 ubox
36 63 0.012605145 ubox
36 64 0.042479238 ubox
37 43 0.006726733 ubox
37 45 0.009058343 ubox
37 46 0.269025992 ubox
37 47 0.009748740 ubox
37 48 0.072263598 ubox
37 49 0.006365148 ubox
37 61 0.004418877 ubox
37 62 0.015869672 ubox
37 63 0.041087537 ubox
38 44 0.012018368 ubox
38 45 0.265910164 ubox
38 46 0.010668324 ubox
38 47 0.071955787 ubox
38 48 0.006399844 ubox
38 51 0.068478334 ubox
38 61 0.018060266 ubox
38 62 0.037809443 ubox
39 50 0.101336972 ubox
39 60 0.017506234 ubox
40 46 0.019452229 ubox
40 49 0.101381939 ubox
40 58 0.058507707 ubox
41 45 0.020174003 ubox
41 48 0.101175083 ubox
41 57 0.066295524 ubox
42 56 0.066339357 ubox
43 53 0.034920813 ubox
43 54 0.029206998 ubox
43 55 0.061764238 ubox
44 52 0.083025563 ubox
44 53 0.062463442 ubox
44 54 0.055113624 ubox
44 55 0.013576350 ubox
45 52 0.087477678 ubox
45 53 0.045665362 ubox
45 54 0.024229477 ubox
45 55 0.118443918 ubox
46 53 0.025545860 ubox
46 54 0.131119548 ubox
46 55 0.029106348 ubox
47 53 0.135640113 ubox
47 54 0.030591974 ubox
47 55 0.018244889 ubox
48 52 0.135074166 ubox
48 53 0.025987561 ubox
48 54 0.020659796 ubox
48 55 0.009641297 ubox
49 53 0.018153943 ubox
49 54 0.009945010 ubox
49 60 0.035521889 ubox
50 56 0.055787533 ubox
50 59 0.041489847 ubox
51 55 0.045375767 ubox
51 60 0.126009863 ubox
52 59 0.132528499 ubox
52 62 0.047765038 ubox
52 65 0.463795915 ubox
53 58 0.122711459 ubox
53 59 0.005263073 ubox
53 61 0.047441955 ubox
53 62 0.014771729 ubox
53 63 0.038905454 ubox
53 64 0.466107294 ubox
53 65 0.029313473 ubox
53 66 0.029046482 ubox
54 58 0.006713500 ubox
54 61 0.017313350 ubox
54 62 0.043364084 ubox
54 63 0.466094186 ubox
54 64 0.035006517 ubox
54 65 0.035807807 ubox
54 66 0.005833566 ubox
55 61 0.044899927 ubox
55 62 0.458759496 ubox
55 63 0.036552161 ubox
55 64 0.037948095 ubox
55 65 0.006870047 ubox
56 60 0.037996281 ubox
3 63 0.9500000 lbox
4 62 0.9500000 lbox
5 61 0.9500000 lbox
6 60 0.9500000 lbox
7 59 0.9500000 lbox
8 57 0.9500000 lbox
9 56 0.9500000 lbox
10 55 0.9500000 lbox
11 54 0.9500000 lbox
12 53 0.9500000 lbox
15 44 0.9500000 lbox
16 43 0.9500000 lbox
17 42 0.9500000 lbox
18 41 0.9500000 lbox
20 40 0.9500000 lbox
21 39 0.9500000 lbox
22 38 0.9500000 lbox
23 37 0.9500000 lbox
24 36 0.9500000 lbox
25 35 0.9500000 lbox
26 34 0.9500000 lbox
27 33 0.9500000 lbox
28 32 0.9500000 lbox
showpage
end
%%EOF
