%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:09:06 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (OR52J3)
} def

/sequence { (\
AUGUUUUAUCACAACAAGAGCAUAUUUCACCCAGUCACAUUUUUCCUCAUUGGAAUCCCAGGUCUGGAAGACUUCCACAUGUGGAUCUCCGGGCCUUUCU\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 9 0.005550286 ubox
1 23 0.895996593 ubox
1 25 0.021288823 ubox
1 40 0.017831582 ubox
2 8 0.006469632 ubox
2 11 0.037418603 ubox
2 13 0.081814391 ubox
2 16 0.105457001 ubox
2 22 0.957474369 ubox
2 24 0.021456657 ubox
2 29 0.011410336 ubox
2 33 0.003998961 ubox
2 37 0.005137839 ubox
2 39 0.020878100 ubox
3 7 0.005589696 ubox
3 9 0.003895589 ubox
3 10 0.042999791 ubox
3 12 0.090820630 ubox
3 15 0.117141639 ubox
3 21 0.976836937 ubox
3 23 0.020538557 ubox
3 25 0.011332368 ubox
3 28 0.013045373 ubox
3 30 0.004963468 ubox
3 32 0.004323806 ubox
3 36 0.005860985 ubox
3 38 0.021753071 ubox
3 56 0.003910480 ubox
3 59 0.004041930 ubox
4 8 0.004409200 ubox
4 11 0.085794786 ubox
4 14 0.116125701 ubox
4 18 0.004394891 ubox
4 19 0.076430456 ubox
4 20 0.973186180 ubox
4 22 0.019855881 ubox
4 24 0.011911980 ubox
4 29 0.004779537 ubox
4 37 0.020793553 ubox
4 55 0.004119989 ubox
5 13 0.108393025 ubox
5 14 0.012849693 ubox
5 16 0.003978544 ubox
5 17 0.010486032 ubox
5 18 0.091398160 ubox
5 19 0.966855781 ubox
5 20 0.025923295 ubox
5 54 0.004094202 ubox
6 13 0.015448121 ubox
6 14 0.016313401 ubox
6 16 0.012234578 ubox
6 17 0.115177549 ubox
6 18 0.957916349 ubox
6 19 0.035066598 ubox
6 20 0.006011144 ubox
6 34 0.003932136 ubox
6 53 0.003936663 ubox
7 13 0.025534415 ubox
7 16 0.135132146 ubox
7 17 0.884802811 ubox
7 18 0.041456667 ubox
7 19 0.006939153 ubox
7 24 0.010552272 ubox
7 33 0.003542316 ubox
7 52 0.003743162 ubox
8 23 0.010743802 ubox
8 35 0.006186896 ubox
8 51 0.003641991 ubox
8 56 0.004074451 ubox
9 19 0.069848797 ubox
9 22 0.009210081 ubox
9 34 0.006019551 ubox
9 54 0.007641329 ubox
9 55 0.004354707 ubox
10 18 0.073909542 ubox
10 53 0.008182399 ubox
11 35 0.015930313 ubox
12 34 0.016966182 ubox
12 52 0.010742854 ubox
13 51 0.010755436 ubox
14 35 0.011115678 ubox
14 50 0.010476269 ubox
15 34 0.011740613 ubox
15 52 0.016123590 ubox
16 26 0.007845318 ubox
16 27 0.008786636 ubox
16 41 0.003333644 ubox
16 43 0.009610932 ubox
16 44 0.003308070 ubox
16 51 0.016258077 ubox
16 98 0.004279788 ubox
17 25 0.008833947 ubox
17 26 0.009939012 ubox
17 27 0.024096483 ubox
17 40 0.003801281 ubox
17 42 0.014291470 ubox
17 43 0.005305149 ubox
17 47 0.005668163 ubox
17 50 0.016095911 ubox
17 97 0.004550815 ubox
17 98 0.004207625 ubox
17 100 0.064829242 ubox
18 25 0.007321951 ubox
18 26 0.028165298 ubox
18 27 0.015183910 ubox
18 28 0.086425706 ubox
18 36 0.037049378 ubox
18 41 0.015652062 ubox
18 42 0.007071905 ubox
18 45 0.004158453 ubox
18 46 0.005515820 ubox
18 48 0.023823698 ubox
18 57 0.008068450 ubox
18 97 0.004199314 ubox
18 98 0.004744158 ubox
18 99 0.071947943 ubox
19 25 0.028368789 ubox
19 26 0.016386531 ubox
19 27 0.085739718 ubox
19 35 0.035561982 ubox
19 40 0.015665874 ubox
19 41 0.007158880 ubox
19 42 0.003267869 ubox
19 44 0.004367198 ubox
19 47 0.023839537 ubox
19 56 0.007927759 ubox
19 96 0.003233076 ubox
19 97 0.005277869 ubox
19 98 0.070489442 ubox
19 100 0.006124573 ubox
20 25 0.012375349 ubox
20 26 0.073079259 ubox
20 35 0.025322986 ubox
20 40 0.005952093 ubox
20 43 0.003599201 ubox
20 46 0.023581887 ubox
20 97 0.054856665 ubox
20 99 0.006609338 ubox
21 34 0.030098059 ubox
22 35 0.007547509 ubox
22 40 0.004816847 ubox
23 34 0.008231342 ubox
23 39 0.005338224 ubox
24 35 0.075878333 ubox
24 40 0.016520569 ubox
24 56 0.079197228 ubox
25 34 0.080030008 ubox
25 39 0.016966146 ubox
25 54 0.003847637 ubox
25 55 0.086491832 ubox
26 33 0.070790086 ubox
26 34 0.020055552 ubox
26 54 0.089369919 ubox
26 55 0.019660357 ubox
27 33 0.023280672 ubox
27 53 0.087235961 ubox
27 54 0.022160111 ubox
28 52 0.087396805 ubox
28 53 0.016139617 ubox
29 35 0.077261670 ubox
29 51 0.082189184 ubox
30 34 0.081669498 ubox
30 53 0.019752628 ubox
30 93 0.011434162 ubox
31 52 0.016248747 ubox
31 53 0.340900106 ubox
31 92 0.011486436 ubox
32 52 0.342481886 ubox
32 91 0.011464678 ubox
33 41 0.047431344 ubox
33 42 0.049292155 ubox
33 43 0.016115437 ubox
33 44 0.012980720 ubox
33 47 0.064358830 ubox
33 51 0.341372865 ubox
33 88 0.005080774 ubox
33 97 0.007899505 ubox
33 98 0.010865153 ubox
33 100 0.036002847 ubox
34 40 0.055374490 ubox
34 41 0.055536004 ubox
34 42 0.024502340 ubox
34 43 0.020579365 ubox
34 46 0.066317144 ubox
34 50 0.334303798 ubox
34 56 0.022269458 ubox
34 87 0.005439582 ubox
34 96 0.004252729 ubox
34 97 0.009922116 ubox
34 99 0.039490218 ubox
35 39 0.052057677 ubox
35 49 0.320795904 ubox
35 53 0.007716730 ubox
35 54 0.023810326 ubox
35 55 0.021719227 ubox
35 84 0.005030854 ubox
36 52 0.010774125 ubox
36 53 0.025607657 ubox
36 61 0.003818061 ubox
36 83 0.005974954 ubox
37 51 0.010041342 ubox
37 82 0.006257308 ubox
38 52 0.035165299 ubox
38 81 0.006279068 ubox
39 50 0.013281985 ubox
39 51 0.034408368 ubox
39 56 0.048075316 ubox
39 80 0.006261781 ubox
40 49 0.014883665 ubox
40 54 0.004175822 ubox
40 55 0.045717415 ubox
40 79 0.006156022 ubox
41 53 0.003960597 ubox
41 54 0.037026545 ubox
41 55 0.020681197 ubox
41 60 0.005332053 ubox
41 71 0.006334105 ubox
42 52 0.003939242 ubox
42 53 0.034745896 ubox
42 54 0.011421512 ubox
42 55 0.061311259 ubox
42 60 0.008014420 ubox
42 70 0.006440005 ubox
43 52 0.034268983 ubox
43 53 0.006896816 ubox
43 54 0.056906837 ubox
43 55 0.786272878 ubox
43 69 0.006821009 ubox
44 52 0.005662820 ubox
44 53 0.039605142 ubox
44 54 0.905081588 ubox
44 68 0.006899959 ubox
45 52 0.039359503 ubox
45 53 0.917721135 ubox
45 67 0.006912487 ubox
46 52 0.917592365 ubox
46 53 0.012546558 ubox
46 66 0.006908882 ubox
47 52 0.011696350 ubox
47 53 0.003606855 ubox
47 54 0.018936429 ubox
48 52 0.005023198 ubox
48 53 0.019855374 ubox
50 61 0.009434826 ubox
51 60 0.083985384 ubox
52 58 0.019375715 ubox
52 59 0.128036949 ubox
52 90 0.004023499 ubox
52 99 0.024274587 ubox
52 100 0.072107513 ubox
53 57 0.019256432 ubox
53 58 0.127710694 ubox
53 89 0.004028024 ubox
53 98 0.024436833 ubox
53 99 0.084606885 ubox
54 88 0.003978181 ubox
54 97 0.025507079 ubox
54 98 0.086711122 ubox
55 86 0.003898788 ubox
55 96 0.012877704 ubox
55 97 0.086453657 ubox
56 85 0.004298036 ubox
57 84 0.003757295 ubox
58 84 0.008911085 ubox
59 83 0.009216651 ubox
60 82 0.009473315 ubox
60 96 0.931211425 ubox
60 97 0.042975651 ubox
60 98 0.011693621 ubox
60 100 0.005476367 ubox
61 95 0.999523586 ubox
61 96 0.008191296 ubox
62 80 0.009419206 ubox
62 94 0.999891424 ubox
62 95 0.005954465 ubox
63 79 0.009368772 ubox
63 93 0.999576539 ubox
64 92 0.999846834 ubox
65 77 0.009642518 ubox
65 91 0.999155075 ubox
66 76 0.009799817 ubox
66 90 0.999880187 ubox
67 75 0.009800172 ubox
67 89 0.999746261 ubox
68 74 0.009668616 ubox
68 88 0.716202118 ubox
69 73 0.007411136 ubox
69 88 0.693904179 ubox
70 87 0.982910732 ubox
70 89 0.012443393 ubox
71 82 0.013007237 ubox
71 86 0.950634313 ubox
71 88 0.020802596 ubox
72 81 0.014318455 ubox
72 84 0.045880048 ubox
73 83 0.045042152 ubox
73 84 0.010621215 ubox
73 85 0.111627874 ubox
74 83 0.010279341 ubox
74 84 0.043993890 ubox
74 85 0.960002972 ubox
75 83 0.042668765 ubox
75 84 0.997615206 ubox
76 83 0.997439265 ubox
77 82 0.830014826 ubox
1 23 0.9500000 lbox
2 22 0.9500000 lbox
3 21 0.9500000 lbox
4 20 0.9500000 lbox
5 19 0.9500000 lbox
6 18 0.9500000 lbox
7 17 0.9500000 lbox
43 55 0.9500000 lbox
44 54 0.9500000 lbox
45 53 0.9500000 lbox
46 52 0.9500000 lbox
60 96 0.9500000 lbox
61 95 0.9500000 lbox
62 94 0.9500000 lbox
63 93 0.9500000 lbox
64 92 0.9500000 lbox
65 91 0.9500000 lbox
66 90 0.9500000 lbox
67 89 0.9500000 lbox
68 88 0.9500000 lbox
70 87 0.9500000 lbox
71 86 0.9500000 lbox
74 85 0.9500000 lbox
75 84 0.9500000 lbox
76 83 0.9500000 lbox
77 82 0.9500000 lbox
showpage
end
%%EOF
