%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:30:00 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
UCACGUGACCCGGGCGCGCUGCGGCCGCCCGCGCGGACCCGGCGAGAGGCGGCGGCGGGAGCGGCGGUGAUGGACGGGUCCGGGGAGCAGCCCAGAGGCGGGGGGCCCACCAGCUCUGAGCAGAUCAUGAAGACAGGGGCCCUUUUGCUUCAGGGUUUCAUCCAGGAUC\
) } def
/len { sequence length } bind def

/coor [
[106.70925903 146.36808777]
[104.76465607 131.49465942]
[110.21419525 117.51959991]
[121.71303558 107.88937378]
[106.71559143 107.61219025]
[99.20580292 110.63339233]
[91.44426727 107.18875885]
[76.45451355 106.63449097]
[61.46475601 106.08021545]
[46.47500229 105.52594757]
[31.48524475 104.97167206]
[16.49548912 104.41739655]
[4.96739721 114.89312744]
[-10.22645092 114.11747742]
[-20.14241219 103.06265259]
[-35.13216782 102.50837708]
[-50.12640381 102.09262848]
[-65.12384033 101.81544495]
[-80.12128448 101.53826141]
[-95.11872101 101.26107788]
[-110.11615753 100.98389435]
[-125.11360168 100.70671082]
[-139.05439758 108.18768311]
[-151.63652039 100.21651459]
[-166.63395691 99.93933105]
[-176.46878052 108.32389069]
[-188.97862244 107.76173401]
[-197.45938110 99.10157013]
[-212.44914246 98.54729462]
[-227.43888855 97.99302673]
[-242.42864990 97.43875122]
[-257.41839600 96.88448334]
[-266.14932251 99.70306396]
[-272.67929077 96.17892456]
[-287.65625000 95.34775543]
[-292.38189697 97.74391174]
[-297.08001709 98.03182983]
[-300.94342041 96.58162689]
[-303.43304443 94.03273010]
[-318.34091187 92.37294006]
[-333.24880981 90.71315002]
[-343.60269165 102.27069855]
[-358.77954102 105.50217438]
[-372.94357300 99.16500854]
[-380.64843750 85.69597626]
[-378.93142700 70.27419281]
[-368.45278931 58.82964325]
[-353.24176025 55.76299667]
[-339.14730835 62.25343704]
[-331.58901978 75.80525970]
[-316.68112183 77.46504974]
[-301.77325439 79.12483978]
[-286.82507324 80.37080383]
[-271.84811401 81.20197296]
[-256.86413574 81.89472198]
[-241.87437439 82.44899750]
[-226.88461304 83.00327301]
[-211.89486694 83.55754089]
[-196.90510559 84.11181641]
[-181.88200378 75.07372284]
[-166.35676575 84.94189453]
[-151.35932922 85.21907806]
[-138.49125671 77.71828461]
[-124.83641815 85.70927429]
[-109.83897400 85.98645782]
[-94.84153748 86.26364136]
[-79.84410095 86.54082489]
[-64.84665680 86.81800842]
[-49.84922028 87.09519196]
[-43.07680893 84.06293488]
[-34.57789612 87.51862335]
[-19.58814049 88.07289124]
[-8.88282967 77.78057098]
[6.32680988 78.12914276]
[17.04976082 89.42764282]
[32.03951645 89.98191833]
[47.02927399 90.53618622]
[62.01902771 91.09046173]
[77.00878143 91.64473724]
[91.99854279 92.19900513]
[106.99277496 92.61475372]
[121.99021912 92.89193726]
[132.38922119 87.59443665]
[141.95646667 91.59871674]
[156.79283142 89.38919067]
[171.62921143 87.17966461]
[181.76289368 72.94338989]
[198.72082520 70.46985626]
[211.96682739 80.80365753]
[226.75984192 78.32035065]
[241.55284119 75.83704376]
[256.34585571 73.35373688]
[271.13888550 70.87042236]
[283.46768188 60.95522308]
[297.30026245 66.47870636]
[312.09326172 63.99539566]
[326.88629150 61.51208878]
[341.67929077 59.02877808]
[356.47229004 56.54547119]
[371.26531982 54.06216431]
[386.05831909 51.57885361]
[400.85134888 49.09554672]
[415.62075806 46.47565842]
[430.36535645 43.71941757]
[445.10995483 40.96317291]
[459.85455322 38.20693207]
[474.59915161 35.45068741]
[489.34375000 32.69444656]
[492.54049683 17.86014557]
[501.14996338 5.41344690]
[513.83453369 -2.76668596]
[528.64447021 -5.45990038]
[543.31738281 -2.28643084]
[555.62390137 6.23969936]
[563.70648193 18.79364395]
[578.45104980 16.03740120]
[593.16955566 13.14503765]
[607.86071777 10.11680126]
[622.55187988 7.08856535]
[632.53778076 -5.46772718]
[648.58038330 -5.34503412]
[658.37310791 7.36252499]
[654.40386963 22.90679741]
[639.71746826 29.36355019]
[625.58007812 21.77971268]
[610.88897705 24.80794716]
[596.19781494 27.83618355]
[590.25817871 32.28375626]
[581.20733643 30.78199768]
[566.46270752 33.53823853]
[563.46093750 48.16419983]
[555.06549072 60.56021118]
[542.52978516 68.81984711]
[527.74700928 71.65846252]
[512.96398926 68.61292267]
[500.43963623 60.11681366]
[492.10000610 47.43904114]
[477.35540771 50.19528580]
[462.61080933 52.95152664]
[447.86621094 55.70777130]
[433.12161255 58.46401215]
[418.37701416 61.22025681]
[412.35620117 65.55731201]
[403.33465576 63.88855743]
[388.54162598 66.37186432]
[373.74862671 68.85517120]
[358.95559692 71.33848572]
[344.16259766 73.82179260]
[329.36959839 76.30509949]
[314.57656860 78.78840637]
[299.78356934 81.27171326]
[288.51284790 91.00929260]
[273.62219238 85.66343689]
[258.82916260 88.14674377]
[244.03616333 90.63005066]
[229.24314880 93.11335754]
[214.45013428 95.59667206]
[208.49951172 107.05121613]
[196.85870361 113.06585693]
[183.68717957 111.23860931]
[173.83872986 102.01604462]
[159.00236511 104.22557068]
[144.16598511 106.43508911]
[156.81187439 114.50240326]
[164.01812744 127.65801239]
[164.00782776 142.65800476]
[156.78350830 155.80369568]
[144.12654114 163.85363770]
[129.15789795 164.82284546]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[4 82]
[5 81]
[7 80]
[8 79]
[9 78]
[10 77]
[11 76]
[12 75]
[15 72]
[16 71]
[17 69]
[18 68]
[19 67]
[20 66]
[21 65]
[22 64]
[24 62]
[25 61]
[28 59]
[29 58]
[30 57]
[31 56]
[32 55]
[34 54]
[35 53]
[39 52]
[40 51]
[41 50]
[84 163]
[85 162]
[86 161]
[89 157]
[90 156]
[91 155]
[92 154]
[93 153]
[95 151]
[96 150]
[97 149]
[98 148]
[99 147]
[100 146]
[101 145]
[102 144]
[103 142]
[104 141]
[105 140]
[106 139]
[107 138]
[108 137]
[115 130]
[116 129]
[117 127]
[118 126]
[119 125]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
