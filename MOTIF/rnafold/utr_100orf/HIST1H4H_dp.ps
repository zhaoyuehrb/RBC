%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:16:51 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (HIST1H4H)
} def

/sequence { (\
AUGUCUGGCCGUGGUAAAGGUGGAAAAGGUUUGGGUAAGGGAGGAGCUAAGCGUCAUCGCAAGGUUUUGCGCGAUAACAUCCAGGGCAUCACUAAGCCAG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
3 90 0.003586721 ubox
3 92 0.007521169 ubox
4 24 0.017959569 ubox
4 91 0.007343036 ubox
5 23 0.019192911 ubox
5 84 0.006790362 ubox
5 100 0.964591453 ubox
6 22 0.015347590 ubox
6 83 0.006875452 ubox
6 99 0.994455853 ubox
7 21 0.010640940 ubox
7 82 0.006856247 ubox
7 98 0.999635123 ubox
8 21 0.018802502 ubox
8 81 0.006345699 ubox
8 87 0.010965494 ubox
8 97 0.999650596 ubox
9 20 0.022708670 ubox
9 86 0.011108122 ubox
9 96 0.999180518 ubox
10 19 0.022837088 ubox
10 85 0.011190656 ubox
11 80 0.003746165 ubox
11 92 0.995939295 ubox
12 79 0.004042059 ubox
12 83 0.011208456 ubox
12 91 0.996769814 ubox
12 94 0.066144054 ubox
13 78 0.004012460 ubox
13 82 0.011221235 ubox
13 90 0.996860164 ubox
13 93 0.070001816 ubox
14 81 0.011034479 ubox
14 87 0.067518685 ubox
14 89 0.987331643 ubox
14 92 0.070338516 ubox
15 86 0.068885208 ubox
15 88 0.953052925 ubox
15 91 0.068423735 ubox
19 58 0.004662902 ubox
19 81 0.020827073 ubox
19 82 0.016650728 ubox
19 90 0.027420094 ubox
20 57 0.004749176 ubox
20 72 0.005788785 ubox
20 78 0.004551667 ubox
20 80 0.021736243 ubox
20 81 0.016569180 ubox
20 87 0.053361515 ubox
20 89 0.027573143 ubox
20 92 0.003230434 ubox
21 56 0.004759333 ubox
21 71 0.005787065 ubox
21 77 0.004491507 ubox
21 79 0.025780723 ubox
21 83 0.990535562 ubox
21 86 0.044144473 ubox
21 88 0.027035052 ubox
21 91 0.003250125 ubox
22 55 0.004734532 ubox
22 70 0.005768659 ubox
22 78 0.025863588 ubox
22 81 0.003973344 ubox
22 82 0.998684166 ubox
22 87 0.026591610 ubox
22 90 0.003221283 ubox
23 54 0.003904391 ubox
23 80 0.003666561 ubox
23 81 0.998616215 ubox
24 68 0.005266050 ubox
24 80 0.971819506 ubox
25 30 0.003518304 ubox
25 31 0.003341888 ubox
25 32 0.004045973 ubox
25 67 0.005019760 ubox
26 30 0.003180656 ubox
26 31 0.003964517 ubox
26 66 0.004675493 ubox
27 48 0.009041903 ubox
27 65 0.003966763 ubox
28 47 0.009308782 ubox
28 48 0.024061234 ubox
28 55 0.005531426 ubox
28 65 0.003324633 ubox
28 81 0.016444086 ubox
28 82 0.014804507 ubox
28 98 0.020247119 ubox
29 47 0.024982347 ubox
29 52 0.187584500 ubox
29 72 0.005540046 ubox
29 75 0.489638358 ubox
29 78 0.223871578 ubox
29 80 0.017268698 ubox
29 81 0.014724986 ubox
29 87 0.007390605 ubox
29 97 0.020269295 ubox
30 45 0.009144795 ubox
30 46 0.024971816 ubox
30 51 0.187632107 ubox
30 63 0.004189002 ubox
30 71 0.005443489 ubox
30 74 0.404849867 ubox
30 77 0.218592945 ubox
30 79 0.019526122 ubox
30 85 0.009154937 ubox
30 86 0.006271608 ubox
30 96 0.020257782 ubox
31 42 0.004155445 ubox
31 44 0.009060715 ubox
31 45 0.024827625 ubox
31 50 0.187430985 ubox
31 62 0.004277484 ubox
31 73 0.284706296 ubox
31 74 0.863530947 ubox
31 76 0.138885528 ubox
31 77 0.006031648 ubox
31 84 0.011133649 ubox
31 85 0.004585183 ubox
31 95 0.020213718 ubox
32 38 0.003475309 ubox
32 41 0.004411821 ubox
32 43 0.008637308 ubox
32 44 0.024561784 ubox
32 49 0.187266174 ubox
32 56 0.006089485 ubox
32 61 0.004298221 ubox
32 71 0.004187910 ubox
32 73 0.928679970 ubox
32 76 0.006598181 ubox
32 79 0.026284206 ubox
32 83 0.012298658 ubox
32 94 0.020117164 ubox
33 48 0.186144689 ubox
33 55 0.007320307 ubox
33 60 0.004247351 ubox
33 70 0.004065978 ubox
33 72 0.978090053 ubox
33 75 0.006286591 ubox
33 78 0.026524519 ubox
33 82 0.012566505 ubox
33 93 0.020048318 ubox
34 47 0.184913548 ubox
34 48 0.024740258 ubox
34 54 0.006649524 ubox
34 58 0.003960175 ubox
34 81 0.012564624 ubox
34 92 0.019971896 ubox
35 47 0.032594200 ubox
35 52 0.015779210 ubox
35 57 0.003928811 ubox
35 70 0.979744389 ubox
35 72 0.037124949 ubox
35 75 0.011454278 ubox
35 80 0.012062526 ubox
35 87 0.016275746 ubox
36 46 0.038095902 ubox
36 51 0.015726581 ubox
36 56 0.003880265 ubox
36 69 0.978745028 ubox
36 71 0.036489305 ubox
36 74 0.011635516 ubox
36 76 0.004607462 ubox
36 79 0.011451137 ubox
36 86 0.016216412 ubox
37 67 0.014370856 ubox
37 68 0.884477042 ubox
37 75 0.005015715 ubox
38 48 0.009939106 ubox
38 66 0.016137421 ubox
38 67 0.647426783 ubox
38 68 0.050942596 ubox
39 47 0.011315281 ubox
39 48 0.034316089 ubox
39 58 0.004543785 ubox
39 65 0.007130919 ubox
39 66 0.456651220 ubox
39 67 0.045221148 ubox
39 68 0.033522994 ubox
40 47 0.037353700 ubox
40 48 0.021928853 ubox
40 57 0.004636020 ubox
40 58 0.021238659 ubox
40 65 0.145157777 ubox
40 66 0.043028860 ubox
40 67 0.037188410 ubox
40 68 0.036290580 ubox
40 82 0.017284635 ubox
41 47 0.023294449 ubox
41 55 0.004047494 ubox
41 57 0.021574598 ubox
41 58 0.040806080 ubox
41 65 0.015976227 ubox
41 66 0.040806357 ubox
41 67 0.048982835 ubox
41 68 0.047652443 ubox
41 81 0.017291920 ubox
42 48 0.014316725 ubox
42 54 0.003910722 ubox
42 57 0.039940177 ubox
42 65 0.023469358 ubox
42 66 0.049965640 ubox
42 67 0.051373653 ubox
42 68 0.086733142 ubox
42 80 0.017153215 ubox
43 47 0.014447866 ubox
43 55 0.043006973 ubox
43 58 0.004714911 ubox
43 65 0.020600989 ubox
43 66 0.044929068 ubox
43 67 0.139996794 ubox
43 68 0.392610976 ubox
43 82 0.009526840 ubox
44 54 0.042166742 ubox
44 55 0.028580404 ubox
44 58 0.013035127 ubox
44 65 0.020584060 ubox
44 66 0.198780466 ubox
44 67 0.710501317 ubox
44 68 0.017886279 ubox
44 81 0.009545686 ubox
45 54 0.028151061 ubox
45 57 0.012794294 ubox
45 65 0.213555653 ubox
45 66 0.831901433 ubox
45 67 0.018520402 ubox
45 80 0.009489381 ubox
46 52 0.051916215 ubox
46 54 0.009584896 ubox
46 60 0.027958617 ubox
46 65 0.942302135 ubox
46 66 0.016698781 ubox
47 51 0.051560453 ubox
47 53 0.010635744 ubox
47 59 0.027944543 ubox
47 63 0.210188100 ubox
47 64 0.954024188 ubox
48 62 0.204414320 ubox
48 63 0.945804815 ubox
48 76 0.004281448 ubox
49 75 0.004418167 ubox
51 60 0.979057664 ubox
51 65 0.003370741 ubox
51 72 0.021304574 ubox
52 59 0.979412376 ubox
52 64 0.003408761 ubox
52 71 0.021315254 ubox
52 73 0.006581732 ubox
53 58 0.967922503 ubox
53 60 0.004211184 ubox
53 70 0.021311172 ubox
53 72 0.008183555 ubox
53 75 0.092941208 ubox
53 78 0.152849727 ubox
54 59 0.003987348 ubox
54 69 0.019568658 ubox
54 71 0.004862302 ubox
54 74 0.096392523 ubox
54 77 0.151027138 ubox
55 69 0.008170011 ubox
55 73 0.096925548 ubox
56 65 0.024437384 ubox
56 68 0.008059120 ubox
56 75 0.150222970 ubox
57 64 0.025668556 ubox
57 74 0.158658015 ubox
58 63 0.026462585 ubox
58 71 0.105243858 ubox
58 73 0.157923280 ubox
59 65 0.009401494 ubox
59 70 0.110022391 ubox
59 72 0.155774011 ubox
60 64 0.009660039 ubox
60 69 0.110655711 ubox
60 71 0.155223017 ubox
61 67 0.009851550 ubox
61 68 0.110816680 ubox
62 66 0.008115900 ubox
62 67 0.097121482 ubox
62 68 0.035500334 ubox
63 67 0.024601075 ubox
64 70 0.041732883 ubox
65 69 0.039081360 ubox
68 88 0.003189295 ubox
69 78 0.003207913 ubox
69 87 0.004112590 ubox
70 86 0.004113638 ubox
71 87 0.005139108 ubox
72 86 0.005147601 ubox
73 81 0.004471632 ubox
74 80 0.004574357 ubox
75 79 0.004492492 ubox
84 93 0.004066349 ubox
85 92 0.004218595 ubox
85 98 0.011078452 ubox
86 97 0.011118472 ubox
87 96 0.011127287 ubox
5 100 0.9500000 lbox
6 99 0.9500000 lbox
7 98 0.9500000 lbox
8 97 0.9500000 lbox
9 96 0.9500000 lbox
11 92 0.9500000 lbox
12 91 0.9500000 lbox
13 90 0.9500000 lbox
14 89 0.9500000 lbox
15 88 0.9500000 lbox
21 83 0.9500000 lbox
22 82 0.9500000 lbox
23 81 0.9500000 lbox
24 80 0.9500000 lbox
31 74 0.9500000 lbox
32 73 0.9500000 lbox
33 72 0.9500000 lbox
35 70 0.9500000 lbox
36 69 0.9500000 lbox
37 68 0.9500000 lbox
44 67 0.9500000 lbox
45 66 0.9500000 lbox
46 65 0.9500000 lbox
47 64 0.9500000 lbox
48 63 0.9500000 lbox
51 60 0.9500000 lbox
52 59 0.9500000 lbox
53 58 0.9500000 lbox
showpage
end
%%EOF
