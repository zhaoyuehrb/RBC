%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:15:54 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AUGACCUUGGCUGCUUUCAUCUCUGAAGCGCCACUUCUCAGAAACACAGAGCUUUAGCUCCGCCAAAAUGAAACACUCAUUAAACGCACUUCUCAUUUUCCUCAUCAUAACAUCUGCGUGGGGUGGGAGCAAAGGCCCGCUGGAUCAGCUAGAGAAAGGAGGGGAAA\
) } def
/len { sequence length } bind def

/coor [
[84.55869293 224.84614563]
[76.65938568 211.67434692]
[76.42032623 196.31730652]
[83.90582275 182.90602112]
[97.10232544 175.04803467]
[96.82184601 160.05064392]
[96.54135895 145.05326843]
[96.26087952 130.05589294]
[82.29776764 124.57578278]
[71.89135742 135.37886047]
[61.48493958 146.18193054]
[57.76385880 154.57073975]
[50.78149414 157.08743286]
[40.17489243 167.69403076]
[29.56829071 178.30062866]
[18.96168900 188.90724182]
[15.08439732 197.22499084]
[8.05619431 199.61068726]
[-2.74688411 210.01710510]
[-6.76434040 225.91653442]
[-22.61399841 230.12609863]
[-33.99108887 218.31533813]
[-29.19183540 202.63417053]
[-13.15330029 199.21401978]
[-2.35022116 188.80760193]
[8.35508728 178.30062866]
[18.96168900 167.69403076]
[29.56829071 157.08743286]
[40.17489243 146.48083496]
[50.68186188 135.77552795]
[61.08827591 124.97244263]
[71.49468994 114.16936493]
[71.82636261 92.75671387]
[84.98886108 78.34757996]
[102.51499176 76.53031921]
[108.76940155 62.89645386]
[115.02381134 49.26258469]
[121.27822876 35.62871933]
[127.53263855 21.99485207]
[133.65930176 8.30310249]
[139.65768433 -5.44533157]
[128.95457458 -17.67399597]
[124.66139984 -33.28745651]
[127.58650208 -49.15493774]
[137.09611511 -62.11753845]
[151.25073242 -69.61710358]
[167.20059204 -70.20099640]
[172.94084167 -84.05918884]
[178.68109131 -97.91738129]
[175.11416626 -117.72998810]
[190.87219238 -128.89407349]
[196.09025574 -142.95719910]
[201.30831909 -157.02033997]
[206.52638245 -171.08348083]
[211.74444580 -185.14662170]
[209.29107666 -200.77644348]
[220.97256470 -210.01722717]
[226.19062805 -224.08035278]
[231.40869141 -238.14349365]
[236.62675476 -252.20663452]
[241.84481812 -266.26977539]
[246.93116760 -280.38107300]
[251.88536072 -294.53933716]
[256.83953857 -308.69757080]
[247.70899963 -321.57934570]
[247.66433716 -337.14920044]
[256.46905518 -349.72338867]
[250.98893738 -363.68649292]
[245.50881958 -377.64959717]
[240.02871704 -391.61270142]
[234.54859924 -405.57580566]
[220.47830200 -413.28335571]
[217.87371826 -429.11358643]
[228.73284912 -440.92285156]
[244.72549438 -439.65213013]
[253.58348083 -426.27618408]
[248.51170349 -411.05590820]
[253.99182129 -397.09280396]
[259.47192383 -383.12969971]
[264.95205688 -369.16659546]
[270.43215942 -355.20349121]
[274.00292969 -355.20843506]
[277.53863525 -354.70925903]
[280.96847534 -353.71600342]
[290.09988403 -365.61630249]
[299.23132324 -377.51660156]
[308.36273193 -389.41690063]
[317.49417114 -401.31719971]
[307.87759399 -412.91333008]
[301.08300781 -426.35879517]
[297.45117188 -440.97924805]
[297.16424561 -456.04129028]
[300.23666382 -470.78945923]
[306.51431274 -484.48394775]
[315.68225098 -496.43786621]
[327.28070068 -506.05160522]
[340.72784424 -512.84295654]
[355.34915161 -516.47125244]
[370.41128540 -516.75451660]
[385.15869141 -513.67852783]
[398.85165405 -507.39758301]
[410.80334473 -498.22671509]
[420.41427612 -486.62594604]
[427.20236206 -473.17718506]
[430.82711792 -458.55496216]
[431.10675049 -443.49276733]
[428.02716064 -428.74612427]
[421.74291992 -415.05465698]
[412.56915283 -403.10519409]
[400.96606445 -393.49707031]
[387.51562500 -386.71224976]
[372.89254761 -383.09103394]
[357.83029175 -382.81506348]
[343.08438110 -385.89819336]
[329.39447021 -392.18579102]
[320.26303101 -380.28549194]
[311.13162231 -368.38519287]
[302.00018311 -356.48489380]
[292.86877441 -344.58459473]
[297.63302612 -326.72320557]
[288.90942383 -310.12582397]
[270.99780273 -303.74337769]
[266.04360962 -289.58514404]
[261.08941650 -275.42687988]
[261.85150146 -268.04403687]
[255.90795898 -261.05169678]
[250.68989563 -246.98857117]
[245.47183228 -232.92543030]
[240.25376892 -218.86228943]
[235.03570557 -204.79916382]
[237.86230469 -190.17521667]
[225.80758667 -179.92855835]
[220.58952332 -165.86541748]
[215.37145996 -151.80227661]
[210.15339661 -137.73913574]
[204.93533325 -123.67600250]
[210.03320312 -114.76161957]
[209.34606934 -104.29495239]
[202.86018372 -95.77308655]
[192.53927612 -92.17713165]
[186.79902649 -78.31893921]
[181.05877686 -64.46074677]
[190.81347656 -54.56554794]
[196.06939697 -41.65619659]
[196.00012207 -27.67470360]
[190.58303833 -14.73805904]
[180.60777283 -4.81767845]
[167.56124878 0.56100541]
[153.40611267 0.55304867]
[147.40773010 14.30148220]
[147.61596680 21.72063065]
[141.16650391 28.24926376]
[134.91209412 41.88312912]
[128.65768433 55.51699829]
[122.40326691 69.15086365]
[116.14885712 82.78472900]
[126.08251190 96.27655792]
[125.04354858 114.79999542]
[111.25825500 129.77540588]
[111.53873444 144.77279663]
[111.81922150 159.77017212]
[112.09970093 174.76754761]
[125.58079529 182.12660217]
[133.56253052 195.24862671]
[133.89785767 210.60386658]
[126.49657440 224.06181335]
[113.34959412 232.00238037]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[5 162]
[6 161]
[7 160]
[8 159]
[9 32]
[10 31]
[11 30]
[13 29]
[14 28]
[15 27]
[16 26]
[18 25]
[19 24]
[35 156]
[36 155]
[37 154]
[38 153]
[39 152]
[40 150]
[41 149]
[47 142]
[48 141]
[49 140]
[51 136]
[52 135]
[53 134]
[54 133]
[55 132]
[57 130]
[58 129]
[59 128]
[60 127]
[61 126]
[62 124]
[63 123]
[64 122]
[67 81]
[68 80]
[69 79]
[70 78]
[71 77]
[84 119]
[85 118]
[86 117]
[87 116]
[88 115]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
