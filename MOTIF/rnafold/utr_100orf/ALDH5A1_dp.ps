%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 02:41:04 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (ALDH5A1)
} def

/sequence { (\
GUUUCCUGUCGCCGUCGUUGCCCGGGCCAUGGCGACCUGCAUUUGGCUGCGGAGCUGUGGGGCCCGGCGCCUCGGGUCGACGUUUCCAGGCUGCCGCCUCCGCCCCCGCGCCGGCGGCCUGGUCCCUG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 12 0.004317231 ubox
1 40 0.004427502 ubox
1 81 0.021608986 ubox
1 83 0.007663034 ubox
1 123 0.003707100 ubox
2 11 0.004293026 ubox
2 39 0.004403032 ubox
2 80 0.021477402 ubox
2 82 0.005546437 ubox
3 79 0.021004444 ubox
5 76 0.021243299 ubox
5 122 0.005825647 ubox
6 75 0.021245517 ubox
6 121 0.005326481 ubox
6 122 0.003254245 ubox
7 74 0.021132769 ubox
7 79 0.003633836 ubox
7 82 0.759692426 ubox
8 36 0.012617515 ubox
8 73 0.021009679 ubox
8 78 0.004743005 ubox
8 81 0.998429227 ubox
8 118 0.004102034 ubox
9 35 0.012705409 ubox
9 80 0.999003808 ubox
9 117 0.004104545 ubox
10 34 0.012731035 ubox
10 69 0.004362880 ubox
10 79 0.999168408 ubox
10 82 0.008844671 ubox
10 116 0.004107086 ubox
11 33 0.013039289 ubox
11 68 0.004388777 ubox
11 70 0.019984531 ubox
11 77 0.188497730 ubox
11 78 0.977446255 ubox
11 81 0.009124963 ubox
11 83 0.005361432 ubox
11 115 0.004107579 ubox
12 32 0.013042016 ubox
12 67 0.004360736 ubox
12 69 0.016820497 ubox
12 75 0.308919131 ubox
12 76 0.893423903 ubox
12 82 0.004018956 ubox
12 114 0.004107619 ubox
13 31 0.013041013 ubox
13 66 0.004320073 ubox
13 69 0.010930559 ubox
13 74 0.325819728 ubox
13 75 0.874488477 ubox
13 79 0.009811711 ubox
13 82 0.022872932 ubox
13 113 0.004105683 ubox
14 30 0.012866108 ubox
14 65 0.004000174 ubox
14 68 0.015233647 ubox
14 70 0.003562022 ubox
14 73 0.340082359 ubox
14 77 0.007315274 ubox
14 78 0.010017798 ubox
14 81 0.023703292 ubox
14 112 0.003917483 ubox
15 29 0.012774704 ubox
15 67 0.014599185 ubox
15 75 0.335918127 ubox
15 76 0.018121522 ubox
15 80 0.023692292 ubox
16 66 0.014522297 ubox
16 69 0.010691874 ubox
16 74 0.902472152 ubox
16 75 0.015283052 ubox
16 79 0.023659543 ubox
16 82 0.003707841 ubox
16 110 0.003679225 ubox
17 27 0.012772394 ubox
17 65 0.014392765 ubox
17 68 0.010529821 ubox
17 70 0.324813091 ubox
17 73 0.919486038 ubox
17 78 0.023286858 ubox
17 81 0.003842703 ubox
17 109 0.003623570 ubox
18 26 0.012749946 ubox
18 67 0.003637850 ubox
18 69 0.240192828 ubox
18 76 0.008002698 ubox
18 80 0.003842068 ubox
18 108 0.003380834 ubox
19 25 0.012368359 ubox
19 69 0.241993265 ubox
19 74 0.003506857 ubox
19 75 0.008015332 ubox
19 79 0.003832974 ubox
20 55 0.004358433 ubox
20 63 0.014755268 ubox
20 68 0.330055631 ubox
20 70 0.936830345 ubox
20 77 0.019212446 ubox
20 78 0.003804225 ubox
21 54 0.004364915 ubox
21 62 0.014758782 ubox
21 67 0.271510185 ubox
21 69 0.937070176 ubox
21 76 0.020369572 ubox
22 52 0.004428506 ubox
22 61 0.014738698 ubox
22 66 0.195909712 ubox
22 67 0.961857890 ubox
22 75 0.020365867 ubox
23 51 0.004429763 ubox
23 60 0.010489993 ubox
23 66 0.980146925 ubox
23 74 0.020355004 ubox
24 50 0.004362052 ubox
24 64 0.055565510 ubox
24 65 0.997990586 ubox
24 71 0.003467479 ubox
24 73 0.019790533 ubox
25 48 0.004122565 ubox
25 63 0.055936309 ubox
25 64 0.998001127 ubox
25 70 0.003857884 ubox
25 71 0.017717552 ubox
25 72 0.008411421 ubox
26 47 0.004573140 ubox
26 63 0.997305070 ubox
26 68 0.005948016 ubox
26 70 0.017702574 ubox
26 71 0.005145837 ubox
27 46 0.004582579 ubox
27 60 0.360400292 ubox
27 61 0.171023939 ubox
27 62 0.915872038 ubox
27 67 0.006506626 ubox
27 69 0.017555506 ubox
28 45 0.004594215 ubox
28 59 0.542638610 ubox
28 60 0.172720461 ubox
28 61 0.819327426 ubox
28 66 0.006714092 ubox
29 42 0.004875292 ubox
29 44 0.004375606 ubox
29 58 0.888344707 ubox
30 41 0.005324497 ubox
30 57 0.928677178 ubox
30 59 0.077446383 ubox
30 66 0.010955743 ubox
31 37 0.004203294 ubox
31 40 0.005058541 ubox
31 56 0.986767843 ubox
31 58 0.037226414 ubox
31 64 0.013682806 ubox
31 65 0.011589316 ubox
31 68 0.005487400 ubox
32 36 0.004178912 ubox
32 40 0.010082057 ubox
32 50 0.004728422 ubox
32 55 0.994339689 ubox
32 58 0.087755759 ubox
32 63 0.013933744 ubox
32 64 0.011296933 ubox
33 39 0.010319066 ubox
33 49 0.004752771 ubox
33 54 0.993985387 ubox
33 57 0.089558470 ubox
33 62 0.014093806 ubox
33 66 0.005588367 ubox
34 38 0.006371198 ubox
34 48 0.004770810 ubox
34 56 0.080123604 ubox
34 65 0.005581881 ubox
35 58 0.005580156 ubox
36 46 0.006426435 ubox
36 52 0.558950617 ubox
36 57 0.005687635 ubox
36 60 0.004692156 ubox
36 61 0.018842034 ubox
37 45 0.006448154 ubox
37 51 0.551928684 ubox
37 52 0.821609308 ubox
37 59 0.004664978 ubox
37 60 0.020117702 ubox
37 62 0.004929676 ubox
38 49 0.020091593 ubox
38 51 0.831112923 ubox
38 59 0.020027732 ubox
38 61 0.004978202 ubox
39 47 0.090200178 ubox
39 48 0.004254728 ubox
39 50 0.995218349 ubox
39 55 0.006870532 ubox
39 58 0.020430495 ubox
39 123 0.003166909 ubox
40 46 0.090226452 ubox
40 49 0.995338722 ubox
40 54 0.006865101 ubox
40 57 0.020472513 ubox
40 59 0.007168684 ubox
40 122 0.003319366 ubox
41 48 0.909611944 ubox
41 56 0.014942299 ubox
41 58 0.007275312 ubox
41 123 0.005115098 ubox
42 53 0.008885199 ubox
42 57 0.006744397 ubox
42 122 0.005353829 ubox
43 52 0.009115695 ubox
43 121 0.004760739 ubox
44 51 0.009176664 ubox
44 57 0.006161583 ubox
45 50 0.009387873 ubox
45 56 0.018740474 ubox
45 71 0.004828099 ubox
45 119 0.008854254 ubox
46 55 0.023653223 ubox
46 70 0.004844878 ubox
46 118 0.008864028 ubox
47 54 0.023658760 ubox
47 69 0.004842266 ubox
47 117 0.008864424 ubox
48 53 0.023424129 ubox
48 116 0.008857158 ubox
49 115 0.008844169 ubox
50 66 0.004877239 ubox
50 113 0.006211384 ubox
50 114 0.006321435 ubox
51 65 0.005021361 ubox
51 112 0.008766083 ubox
52 64 0.005022343 ubox
52 111 0.008765592 ubox
53 84 0.003840078 ubox
54 63 0.005075617 ubox
54 83 0.004448584 ubox
54 109 0.008755877 ubox
55 62 0.005075778 ubox
55 82 0.004496715 ubox
55 108 0.008643234 ubox
56 61 0.004979645 ubox
56 82 0.003621555 ubox
57 81 0.006399204 ubox
57 107 0.007488775 ubox
58 80 0.006348198 ubox
59 106 0.009236114 ubox
60 78 0.004371274 ubox
60 105 0.009270348 ubox
61 71 0.006002384 ubox
61 78 0.006911574 ubox
61 104 0.009309849 ubox
62 70 0.006383937 ubox
62 77 0.007828357 ubox
62 103 0.009340011 ubox
63 69 0.006379627 ubox
63 76 0.008482082 ubox
63 102 0.009358432 ubox
64 75 0.008484973 ubox
65 74 0.008485380 ubox
65 96 0.009594234 ubox
66 73 0.008461992 ubox
66 95 0.009864243 ubox
67 72 0.005927000 ubox
67 94 0.009867119 ubox
68 93 0.009864066 ubox
69 91 0.009916244 ubox
70 90 0.010142049 ubox
71 89 0.010141855 ubox
72 88 0.010075085 ubox
74 87 0.010044953 ubox
75 86 0.010046488 ubox
76 85 0.009851961 ubox
79 124 0.003732473 ubox
80 123 0.003759928 ubox
81 128 0.011858399 ubox
82 123 0.019624765 ubox
82 127 0.049085928 ubox
85 122 0.009197150 ubox
86 121 0.008872820 ubox
86 122 0.991013441 ubox
87 121 0.999565775 ubox
87 128 0.017898418 ubox
88 120 0.999416300 ubox
88 127 0.018139511 ubox
89 119 0.999649732 ubox
89 124 0.014080672 ubox
89 125 0.007313287 ubox
89 126 0.017325577 ubox
90 118 0.999085783 ubox
90 123 0.015082051 ubox
90 124 0.008571565 ubox
90 125 0.015932268 ubox
91 117 0.998593951 ubox
91 122 0.022292052 ubox
92 116 0.997270286 ubox
92 121 0.020737587 ubox
93 115 0.997841771 ubox
93 118 0.041341543 ubox
94 114 0.997854315 ubox
94 117 0.051812368 ubox
95 110 0.007216115 ubox
95 113 0.997755124 ubox
95 116 0.061869027 ubox
96 103 0.008497440 ubox
96 109 0.016622217 ubox
96 111 0.174638653 ubox
96 112 0.974225903 ubox
96 115 0.064403656 ubox
97 102 0.009279865 ubox
97 108 0.017877912 ubox
97 110 0.236306923 ubox
97 114 0.064618491 ubox
98 113 0.064824533 ubox
101 108 0.190198709 ubox
101 110 0.946486572 ubox
102 107 0.181759519 ubox
102 109 0.967855687 ubox
102 111 0.133557133 ubox
103 108 0.965227306 ubox
103 110 0.133376425 ubox
122 126 0.003823570 ubox
7 82 0.9500000 lbox
8 81 0.9500000 lbox
9 80 0.9500000 lbox
10 79 0.9500000 lbox
11 78 0.9500000 lbox
12 76 0.9500000 lbox
13 75 0.9500000 lbox
16 74 0.9500000 lbox
17 73 0.9500000 lbox
20 70 0.9500000 lbox
21 69 0.9500000 lbox
22 67 0.9500000 lbox
23 66 0.9500000 lbox
24 65 0.9500000 lbox
25 64 0.9500000 lbox
26 63 0.9500000 lbox
27 62 0.9500000 lbox
28 61 0.9500000 lbox
29 58 0.9500000 lbox
30 57 0.9500000 lbox
31 56 0.9500000 lbox
32 55 0.9500000 lbox
33 54 0.9500000 lbox
37 52 0.9500000 lbox
38 51 0.9500000 lbox
39 50 0.9500000 lbox
40 49 0.9500000 lbox
41 48 0.9500000 lbox
86 122 0.9500000 lbox
87 121 0.9500000 lbox
88 120 0.9500000 lbox
89 119 0.9500000 lbox
90 118 0.9500000 lbox
91 117 0.9500000 lbox
92 116 0.9500000 lbox
93 115 0.9500000 lbox
94 114 0.9500000 lbox
95 113 0.9500000 lbox
96 112 0.9500000 lbox
101 110 0.9500000 lbox
102 109 0.9500000 lbox
103 108 0.9500000 lbox
showpage
end
%%EOF
