%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:43:15 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (PRSS1)
} def

/sequence { (\
AGGCACACUCUACCACCAUGAAUCCACUCCUGAUCCUUACCUUUGUGGCAGCUGCUCUUGCUGCCCCCUUUGAUGAUGAUGACAAGAUCGUUGGGGGCUACAACUGUGAGGAGAAUU\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 9 0.197712816 ubox
1 11 0.214500014 ubox
1 28 0.049014679 ubox
1 31 0.270845320 ubox
1 117 0.005808230 ubox
2 8 0.229452812 ubox
2 9 0.113269698 ubox
2 10 0.226790182 ubox
2 11 0.104184643 ubox
2 14 0.436734415 ubox
2 17 0.263036882 ubox
2 24 0.025138520 ubox
2 25 0.180454194 ubox
2 27 0.056704760 ubox
2 28 0.049794830 ubox
2 29 0.026030217 ubox
2 30 0.286749127 ubox
2 31 0.014275423 ubox
2 116 0.004552080 ubox
2 117 0.004858963 ubox
3 8 0.143079627 ubox
3 9 0.177249173 ubox
3 10 0.106618474 ubox
3 13 0.435772602 ubox
3 16 0.262639604 ubox
3 23 0.022023334 ubox
3 24 0.179926982 ubox
3 27 0.054265656 ubox
3 28 0.020945337 ubox
3 29 0.285472942 ubox
3 30 0.015316343 ubox
3 49 0.005371910 ubox
3 116 0.004880205 ubox
4 20 0.063866514 ubox
4 32 0.022887501 ubox
4 48 0.005300291 ubox
5 19 0.056738225 ubox
5 31 0.020734840 ubox
6 20 0.094896228 ubox
6 32 0.019956470 ubox
6 47 0.005246653 ubox
7 19 0.085872059 ubox
7 31 0.018234986 ubox
7 46 0.005253494 ubox
8 45 0.005248748 ubox
8 113 0.025079339 ubox
9 21 0.300560065 ubox
9 33 0.060791757 ubox
9 112 0.020847588 ubox
9 114 0.100916237 ubox
10 20 0.309767615 ubox
10 32 0.065341181 ubox
10 51 0.004971152 ubox
10 111 0.015553480 ubox
10 113 0.106457259 ubox
11 20 0.055883063 ubox
11 32 0.008635087 ubox
11 50 0.004941311 ubox
11 110 0.008380201 ubox
11 112 0.086668420 ubox
12 19 0.064029599 ubox
12 31 0.010093390 ubox
13 48 0.006952066 ubox
13 111 0.007946442 ubox
14 20 0.129545024 ubox
14 32 0.088680091 ubox
14 47 0.006975365 ubox
14 108 0.005891279 ubox
14 110 0.007452949 ubox
15 19 0.105404892 ubox
15 31 0.084838711 ubox
15 46 0.006968672 ubox
15 107 0.005899172 ubox
16 45 0.006764048 ubox
16 48 0.007925851 ubox
16 106 0.005784228 ubox
17 32 0.558546611 ubox
17 47 0.008024367 ubox
18 31 0.555554907 ubox
18 34 0.009416462 ubox
18 46 0.008022774 ubox
18 116 0.016780297 ubox
19 26 0.167345610 ubox
19 32 0.006553811 ubox
19 33 0.013780848 ubox
19 45 0.007979205 ubox
19 115 0.017818920 ubox
20 25 0.185637151 ubox
20 29 0.577625961 ubox
20 31 0.006964500 ubox
20 35 0.005980903 ubox
20 44 0.007912399 ubox
20 117 0.023000828 ubox
21 28 0.555265099 ubox
21 34 0.006230507 ubox
21 43 0.007860446 ubox
21 116 0.025684687 ubox
21 117 0.027230132 ubox
22 34 0.074672283 ubox
22 42 0.006755819 ubox
22 116 0.031920599 ubox
23 33 0.106238926 ubox
23 114 0.064950050 ubox
23 115 0.029498026 ubox
24 32 0.108007987 ubox
24 48 0.010037221 ubox
24 113 0.069673148 ubox
25 32 0.177394836 ubox
25 47 0.010281277 ubox
26 31 0.153192509 ubox
26 46 0.010285033 ubox
27 45 0.010282072 ubox
27 113 0.062260022 ubox
28 112 0.058203380 ubox
28 114 0.188827238 ubox
29 111 0.055343470 ubox
29 113 0.197598941 ubox
30 110 0.053754156 ubox
30 113 0.110212808 ubox
31 109 0.048019099 ubox
31 112 0.068592481 ubox
32 117 0.047140030 ubox
33 107 0.033376865 ubox
33 116 0.055994101 ubox
34 106 0.031051355 ubox
34 109 0.003788579 ubox
34 112 0.928135835 ubox
34 114 0.011440680 ubox
34 115 0.026402193 ubox
35 48 0.006789751 ubox
35 108 0.004729230 ubox
35 111 0.997848879 ubox
35 113 0.007688722 ubox
36 47 0.007043565 ubox
36 51 0.003849022 ubox
36 110 0.998359527 ubox
36 111 0.003334928 ubox
37 48 0.004423035 ubox
37 50 0.003709137 ubox
37 51 0.003189932 ubox
37 103 0.008036353 ubox
37 109 0.998361079 ubox
38 45 0.003253685 ubox
38 47 0.008484024 ubox
38 50 0.003988818 ubox
38 102 0.006870631 ubox
38 106 0.004920807 ubox
38 108 0.998494714 ubox
39 46 0.011053119 ubox
39 105 0.007322839 ubox
39 107 0.998518293 ubox
40 45 0.011226731 ubox
40 48 0.018957021 ubox
40 106 0.997630053 ubox
41 47 0.019822312 ubox
41 48 0.003592013 ubox
42 47 0.003657133 ubox
42 103 0.026158743 ubox
43 102 0.019754038 ubox
43 103 0.966220322 ubox
44 102 0.996115232 ubox
45 52 0.003962545 ubox
45 55 0.006036844 ubox
45 98 0.003802406 ubox
45 101 0.998653250 ubox
45 104 0.007463713 ubox
46 51 0.003922412 ubox
46 54 0.006033756 ubox
46 63 0.003214068 ubox
46 97 0.003623136 ubox
46 100 0.994345893 ubox
46 102 0.007774143 ubox
46 103 0.007079372 ubox
47 53 0.007532010 ubox
47 56 0.035237069 ubox
47 57 0.011435887 ubox
47 62 0.182163603 ubox
47 65 0.194154540 ubox
47 66 0.006506343 ubox
47 99 0.955078749 ubox
47 101 0.007937105 ubox
48 52 0.008353847 ubox
48 55 0.051002372 ubox
48 61 0.240969240 ubox
48 64 0.288957035 ubox
48 65 0.005001536 ubox
48 98 0.909368706 ubox
49 54 0.051037789 ubox
49 60 0.241271301 ubox
49 63 0.715369610 ubox
49 97 0.628992513 ubox
49 106 0.004297957 ubox
50 56 0.006394472 ubox
50 58 0.030131014 ubox
50 59 0.237876564 ubox
50 62 0.740422892 ubox
50 105 0.004384743 ubox
51 55 0.008130781 ubox
51 57 0.042173660 ubox
51 58 0.191413062 ubox
51 61 0.743079202 ubox
51 64 0.610305272 ubox
51 104 0.004382225 ubox
52 60 0.742892362 ubox
52 63 0.610961365 ubox
52 113 0.013210139 ubox
53 60 0.007420730 ubox
53 63 0.005530556 ubox
53 108 0.006161202 ubox
53 112 0.013228432 ubox
54 59 0.031658976 ubox
54 61 0.618696396 ubox
54 62 0.003214556 ubox
54 64 0.032707687 ubox
54 107 0.009432732 ubox
55 60 0.619826385 ubox
55 63 0.032856898 ubox
55 106 0.009782006 ubox
55 110 0.013317166 ubox
56 109 0.013323888 ubox
57 108 0.013321078 ubox
58 103 0.024235158 ubox
59 102 0.026903412 ubox
60 101 0.027349770 ubox
62 100 0.003951497 ubox
63 98 0.288004343 ubox
64 95 0.003886978 ubox
64 96 0.070712199 ubox
64 97 0.707917475 ubox
65 94 0.004053429 ubox
65 95 0.073489987 ubox
65 96 0.941795648 ubox
65 97 0.214909821 ubox
66 93 0.004044683 ubox
66 94 0.073207656 ubox
66 95 0.943337829 ubox
66 96 0.278349142 ubox
66 97 0.124855401 ubox
67 93 0.072739837 ubox
67 94 0.943322222 ubox
67 95 0.278761076 ubox
67 96 0.127381811 ubox
67 97 0.101181784 ubox
68 93 0.942194850 ubox
68 94 0.278846417 ubox
68 95 0.127281052 ubox
68 96 0.103411789 ubox
69 76 0.004158907 ubox
69 86 0.004397962 ubox
69 93 0.266013745 ubox
69 94 0.117621520 ubox
69 95 0.103404097 ubox
70 75 0.005300384 ubox
70 85 0.004611333 ubox
70 93 0.092429240 ubox
70 94 0.112571544 ubox
71 84 0.004696816 ubox
71 90 0.761022396 ubox
71 93 0.127542368 ubox
72 83 0.004707805 ubox
72 89 0.805733640 ubox
72 92 0.447425114 ubox
73 88 0.805614197 ubox
73 91 0.459299442 ubox
74 79 0.003892940 ubox
74 84 0.020163174 ubox
74 87 0.803374284 ubox
74 90 0.460513081 ubox
74 93 0.050504999 ubox
75 83 0.024269437 ubox
75 89 0.460881893 ubox
75 92 0.364984478 ubox
76 88 0.460309377 ubox
76 91 0.368479849 ubox
77 84 0.773435805 ubox
77 87 0.454938417 ubox
77 90 0.369110288 ubox
78 83 0.775011061 ubox
78 89 0.369918528 ubox
78 92 0.027423169 ubox
79 88 0.369821153 ubox
79 91 0.027752708 ubox
80 87 0.367497597 ubox
80 90 0.027808150 ubox
81 89 0.027856468 ubox
81 92 0.007341130 ubox
82 88 0.026310983 ubox
82 91 0.007450181 ubox
83 90 0.007462616 ubox
99 108 0.011186427 ubox
100 107 0.012033448 ubox
101 106 0.012187030 ubox
101 108 0.003258809 ubox
112 116 0.003445008 ubox
34 112 0.9500000 lbox
35 111 0.9500000 lbox
36 110 0.9500000 lbox
37 109 0.9500000 lbox
38 108 0.9500000 lbox
39 107 0.9500000 lbox
40 106 0.9500000 lbox
43 103 0.9500000 lbox
44 102 0.9500000 lbox
45 101 0.9500000 lbox
46 100 0.9500000 lbox
47 99 0.9500000 lbox
48 98 0.9500000 lbox
49 63 0.9500000 lbox
50 62 0.9500000 lbox
51 61 0.9500000 lbox
52 60 0.9500000 lbox
64 97 0.9500000 lbox
65 96 0.9500000 lbox
66 95 0.9500000 lbox
67 94 0.9500000 lbox
68 93 0.9500000 lbox
71 90 0.9500000 lbox
72 89 0.9500000 lbox
73 88 0.9500000 lbox
74 87 0.9500000 lbox
77 84 0.9500000 lbox
78 83 0.9500000 lbox
showpage
end
%%EOF
