%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 02:27:15 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (RBM24)
} def

/sequence { (\
GAAGAUGCACACGACCCAGAAGGACACGACGUACACCAAGAUCUUCGUCGGGGGGCUGCCCUACCACACCACCGACGCCAGCCUGCGCAAGUACUUCGAGGUCU\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 46 0.022402751 ubox
1 97 0.014890199 ubox
2 45 0.022597562 ubox
2 96 0.014897674 ubox
3 44 0.022640022 ubox
3 95 0.014893681 ubox
3 104 0.009304913 ubox
4 43 0.022658310 ubox
4 94 0.014879842 ubox
4 103 0.009491076 ubox
5 42 0.022606538 ubox
5 92 0.003495651 ubox
5 102 0.008796224 ubox
6 13 0.013342377 ubox
6 18 0.012480311 ubox
6 33 0.007579280 ubox
6 35 0.007619174 ubox
6 38 0.003892799 ubox
6 41 0.019754977 ubox
6 89 0.004986297 ubox
6 93 0.013318984 ubox
6 101 0.007482743 ubox
7 12 0.088329441 ubox
7 17 0.013769933 ubox
7 32 0.010726444 ubox
7 34 0.009118580 ubox
7 37 0.004665129 ubox
7 88 0.005627400 ubox
7 92 0.013441467 ubox
8 31 0.010745122 ubox
8 87 0.005621686 ubox
8 91 0.013434596 ubox
9 32 0.010169787 ubox
10 31 0.010384626 ubox
10 85 0.004815218 ubox
11 32 0.009753576 ubox
11 84 0.003766044 ubox
12 28 0.015196777 ubox
12 31 0.010045681 ubox
12 87 0.004545592 ubox
13 27 0.015250433 ubox
13 30 0.009938935 ubox
13 86 0.004494523 ubox
13 103 0.981009649 ubox
14 32 0.008312722 ubox
14 102 0.982319275 ubox
15 23 0.014087037 ubox
15 31 0.008361363 ubox
15 101 0.982370576 ubox
16 22 0.015240619 ubox
16 23 0.029858457 ubox
16 100 0.981426364 ubox
16 101 0.023427136 ubox
17 22 0.033739472 ubox
17 100 0.031973186 ubox
19 46 0.006618947 ubox
19 97 0.981380328 ubox
20 45 0.006670150 ubox
20 96 0.980870229 ubox
21 44 0.006723392 ubox
21 95 0.980036849 ubox
21 96 0.025115259 ubox
21 104 0.013550973 ubox
22 37 0.018062860 ubox
22 43 0.006722451 ubox
22 44 0.004503472 ubox
22 65 0.005388400 ubox
22 70 0.005476714 ubox
22 73 0.004418768 ubox
22 79 0.004119894 ubox
22 83 0.003188322 ubox
22 94 0.975751097 ubox
22 95 0.035313216 ubox
22 97 0.004677613 ubox
22 103 0.012538993 ubox
22 104 0.163232458 ubox
23 36 0.020397390 ubox
23 42 0.005057180 ubox
23 43 0.014972424 ubox
23 45 0.003632294 ubox
23 46 0.014960033 ubox
23 49 0.007836455 ubox
23 64 0.006085254 ubox
23 69 0.006186362 ubox
23 72 0.005090523 ubox
23 78 0.004579606 ubox
23 82 0.003640379 ubox
23 94 0.047180627 ubox
23 96 0.004666236 ubox
23 102 0.009248242 ubox
23 103 0.181691614 ubox
24 32 0.089997890 ubox
24 42 0.013855421 ubox
24 44 0.003598189 ubox
24 45 0.014394625 ubox
24 48 0.007653636 ubox
24 92 0.651605885 ubox
24 95 0.004635335 ubox
24 102 0.182310867 ubox
25 31 0.092794060 ubox
25 47 0.007389139 ubox
25 91 0.850021473 ubox
25 101 0.182394555 ubox
26 32 0.055186560 ubox
26 48 0.032156313 ubox
26 92 0.267869304 ubox
27 31 0.057390525 ubox
27 47 0.041048355 ubox
27 50 0.630936137 ubox
27 85 0.003494708 ubox
27 87 0.134221742 ubox
27 91 0.281360604 ubox
27 98 0.188061499 ubox
28 43 0.059925888 ubox
28 45 0.021122777 ubox
28 46 0.055689797 ubox
28 49 0.645778928 ubox
28 86 0.133368318 ubox
28 97 0.188514597 ubox
29 42 0.055895185 ubox
29 44 0.023064316 ubox
29 45 0.052945637 ubox
29 48 0.645838112 ubox
29 92 0.012324583 ubox
29 95 0.007016602 ubox
29 96 0.186228164 ubox
30 47 0.645948851 ubox
30 50 0.005348568 ubox
30 85 0.091153171 ubox
30 87 0.649550161 ubox
30 91 0.014021238 ubox
31 42 0.050630504 ubox
31 46 0.641240406 ubox
31 49 0.005460114 ubox
31 78 0.006527583 ubox
31 82 0.030763629 ubox
31 84 0.064819566 ubox
31 86 0.653786714 ubox
31 88 0.085355677 ubox
31 94 0.191464911 ubox
32 41 0.060749480 ubox
32 77 0.004084857 ubox
32 81 0.029574240 ubox
32 85 0.647070213 ubox
32 87 0.084211539 ubox
32 93 0.194484596 ubox
33 48 0.005296293 ubox
33 84 0.487428072 ubox
33 92 0.194579954 ubox
34 47 0.005635182 ubox
34 85 0.077280038 ubox
34 91 0.194082584 ubox
35 48 0.003225030 ubox
35 84 0.067727675 ubox
35 92 0.004469758 ubox
36 47 0.004017770 ubox
36 51 0.010513415 ubox
36 52 0.028417564 ubox
36 53 0.064477208 ubox
36 91 0.004985985 ubox
37 50 0.010543686 ubox
37 51 0.028460536 ubox
37 52 0.064906358 ubox
37 85 0.103176276 ubox
38 45 0.054440526 ubox
38 84 0.091649180 ubox
39 44 0.051537538 ubox
39 45 0.028599220 ubox
39 84 0.427720039 ubox
39 104 0.006822098 ubox
40 44 0.022088786 ubox
40 46 0.089174985 ubox
40 49 0.071922862 ubox
40 83 0.497430442 ubox
40 103 0.007572637 ubox
41 45 0.078426426 ubox
41 48 0.071201339 ubox
41 102 0.007570904 ubox
42 47 0.066621774 ubox
42 101 0.007481633 ubox
43 53 0.003234939 ubox
43 81 0.379988315 ubox
43 91 0.011851844 ubox
43 100 0.007482956 ubox
44 52 0.003216309 ubox
44 80 0.370139431 ubox
44 81 0.061060906 ubox
44 90 0.012184700 ubox
44 99 0.007328268 ubox
45 75 0.004087084 ubox
45 80 0.056820997 ubox
45 89 0.011631684 ubox
45 98 0.006786480 ubox
46 51 0.003258762 ubox
46 74 0.004367161 ubox
46 77 0.728493698 ubox
46 87 0.007732603 ubox
47 64 0.004104583 ubox
47 67 0.007343652 ubox
47 73 0.004177459 ubox
47 76 0.758069339 ubox
47 86 0.007580741 ubox
47 88 0.003683759 ubox
48 63 0.004068804 ubox
48 66 0.007283846 ubox
48 75 0.758738080 ubox
48 85 0.004341960 ubox
49 74 0.759482559 ubox
49 85 0.006723958 ubox
49 87 0.007667044 ubox
50 61 0.028820353 ubox
50 62 0.051083871 ubox
50 65 0.087093401 ubox
50 70 0.015161246 ubox
50 73 0.759370009 ubox
50 83 0.007062986 ubox
50 84 0.007903632 ubox
50 86 0.017028555 ubox
51 60 0.030705694 ubox
51 61 0.131888768 ubox
51 62 0.522824911 ubox
51 64 0.091047633 ubox
51 65 0.080194807 ubox
51 69 0.015757712 ubox
51 70 0.024251427 ubox
51 72 0.755040990 ubox
51 73 0.219575627 ubox
51 82 0.007398211 ubox
51 83 0.015123956 ubox
51 84 0.008043979 ubox
52 59 0.030690694 ubox
52 60 0.132422288 ubox
52 61 0.569156416 ubox
52 62 0.189495357 ubox
52 64 0.077866930 ubox
52 65 0.019448351 ubox
52 69 0.024986692 ubox
52 70 0.339076316 ubox
52 72 0.221477324 ubox
52 73 0.099572540 ubox
52 82 0.015137528 ubox
52 83 0.008528940 ubox
52 84 0.017208000 ubox
53 59 0.132217653 ubox
53 60 0.569562863 ubox
53 61 0.205783802 ubox
53 62 0.053484620 ubox
53 64 0.018637663 ubox
53 65 0.022161845 ubox
53 69 0.336263875 ubox
53 70 0.629611502 ubox
53 72 0.099682435 ubox
53 73 0.008996765 ubox
53 82 0.008412342 ubox
53 83 0.014784127 ubox
53 84 0.144948839 ubox
54 59 0.569063517 ubox
54 60 0.207875304 ubox
54 61 0.075892354 ubox
54 62 0.015315324 ubox
54 64 0.027096918 ubox
54 65 0.216303728 ubox
54 69 0.639120988 ubox
54 70 0.235695868 ubox
54 72 0.008943046 ubox
54 73 0.005011402 ubox
54 79 0.020167033 ubox
54 82 0.010653099 ubox
54 83 0.171077885 ubox
55 59 0.204606003 ubox
55 60 0.075079122 ubox
55 61 0.016945319 ubox
55 64 0.216608077 ubox
55 69 0.237019120 ubox
55 72 0.005016513 ubox
55 78 0.020208682 ubox
55 82 0.171513101 ubox
56 77 0.020163590 ubox
56 81 0.171822453 ubox
57 63 0.048561201 ubox
57 66 0.616616117 ubox
57 68 0.242309639 ubox
57 71 0.004144955 ubox
57 80 0.171383024 ubox
58 62 0.041052075 ubox
58 65 0.617649943 ubox
58 67 0.245437785 ubox
58 70 0.004171334 ubox
58 73 0.003537686 ubox
58 76 0.005304845 ubox
58 78 0.102066089 ubox
58 79 0.137712829 ubox
59 77 0.143657064 ubox
62 93 0.004227489 ubox
63 92 0.006453481 ubox
64 91 0.006608249 ubox
66 92 0.007428004 ubox
67 85 0.004968644 ubox
67 91 0.007761363 ubox
68 84 0.004565501 ubox
68 92 0.022343183 ubox
69 91 0.023391709 ubox
70 85 0.004370953 ubox
71 84 0.004034666 ubox
71 92 0.108272767 ubox
72 91 0.113479999 ubox
73 85 0.004295130 ubox
73 87 0.046270730 ubox
73 98 0.003899079 ubox
74 84 0.003794800 ubox
74 86 0.047839093 ubox
74 97 0.003945626 ubox
75 92 0.030799680 ubox
75 96 0.003907826 ubox
76 85 0.047219077 ubox
76 87 0.561349513 ubox
76 91 0.031259330 ubox
77 84 0.036148918 ubox
77 86 0.576662921 ubox
77 88 0.253922286 ubox
77 92 0.058428131 ubox
77 102 0.003686365 ubox
78 85 0.571977067 ubox
78 87 0.254768931 ubox
78 91 0.064785580 ubox
78 101 0.003849883 ubox
79 85 0.214622193 ubox
79 100 0.003845510 ubox
80 84 0.181082823 ubox
80 95 0.003674678 ubox
80 104 0.007538190 ubox
81 88 0.267172220 ubox
81 92 0.022168659 ubox
81 94 0.004220930 ubox
81 102 0.019710422 ubox
81 103 0.008282515 ubox
82 87 0.266749540 ubox
82 91 0.021753413 ubox
82 101 0.022038458 ubox
83 91 0.031339673 ubox
83 100 0.022045079 ubox
84 90 0.033794851 ubox
84 93 0.112808363 ubox
84 99 0.021815149 ubox
85 92 0.143532109 ubox
86 91 0.145358367 ubox
86 98 0.020121203 ubox
87 97 0.019969907 ubox
89 96 0.016409929 ubox
90 95 0.014413577 ubox
13 103 0.9500000 lbox
14 102 0.9500000 lbox
15 101 0.9500000 lbox
16 100 0.9500000 lbox
19 97 0.9500000 lbox
20 96 0.9500000 lbox
21 95 0.9500000 lbox
22 94 0.9500000 lbox
24 92 0.9500000 lbox
25 91 0.9500000 lbox
27 50 0.9500000 lbox
28 49 0.9500000 lbox
29 48 0.9500000 lbox
30 47 0.9500000 lbox
31 46 0.9500000 lbox
51 62 0.9500000 lbox
52 61 0.9500000 lbox
53 60 0.9500000 lbox
54 59 0.9500000 lbox
76 87 0.9500000 lbox
77 86 0.9500000 lbox
78 85 0.9500000 lbox
showpage
end
%%EOF
