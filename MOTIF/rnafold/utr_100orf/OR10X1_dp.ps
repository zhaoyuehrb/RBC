%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 04:04:08 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (OR10X1)
} def

/sequence { (\
AUGGUGUUGAAUGUUUAUUGUUGUUUCUUUCAAAUUUCAGACAUUCAAACGAUGAAGAUCAACCAGACAAUCCUGAAGGAAUUCAUUCUUGUUGGCUUUU\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 53 0.787897856 ubox
2 51 0.038418237 ubox
2 52 0.837150692 ubox
2 54 0.018002614 ubox
2 61 0.020863867 ubox
2 65 0.073560585 ubox
2 69 0.010082470 ubox
3 50 0.061320217 ubox
3 53 0.063161298 ubox
3 60 0.023281345 ubox
3 64 0.082278158 ubox
3 68 0.011499155 ubox
3 97 0.023905176 ubox
3 98 0.003371851 ubox
3 99 0.003586287 ubox
3 100 0.003654058 ubox
4 44 0.003231180 ubox
4 50 0.904811276 ubox
4 53 0.068963491 ubox
4 59 0.023041431 ubox
4 63 0.081283075 ubox
4 68 0.008584669 ubox
4 96 0.025745489 ubox
5 43 0.003667242 ubox
5 49 0.896547270 ubox
5 51 0.253300722 ubox
5 52 0.070660686 ubox
5 54 0.003856304 ubox
5 58 0.021282689 ubox
5 61 0.006663556 ubox
5 62 0.075539954 ubox
5 65 0.008685424 ubox
5 67 0.008514158 ubox
5 95 0.020986835 ubox
6 42 0.003699682 ubox
6 50 0.346622333 ubox
6 53 0.009661516 ubox
6 60 0.008686574 ubox
6 63 0.046733103 ubox
6 64 0.006829863 ubox
6 96 0.006308280 ubox
7 48 0.816637581 ubox
7 49 0.282819554 ubox
7 52 0.008869850 ubox
7 56 0.015442762 ubox
7 62 0.056019329 ubox
7 95 0.004307416 ubox
8 47 0.967958558 ubox
8 48 0.199190250 ubox
8 51 0.005810571 ubox
8 55 0.007982473 ubox
8 61 0.071117770 ubox
9 38 0.003496559 ubox
9 46 0.997067652 ubox
9 60 0.072727695 ubox
10 37 0.003477135 ubox
10 45 0.996853408 ubox
10 59 0.052504948 ubox
11 36 0.003262087 ubox
11 44 0.996304419 ubox
11 59 0.051287012 ubox
12 43 0.996827009 ubox
12 58 0.071282337 ubox
13 42 0.997211263 ubox
14 40 0.023457784 ubox
14 41 0.995518836 ubox
14 56 0.073396504 ubox
15 39 0.029203759 ubox
15 40 0.974159703 ubox
15 41 0.025858817 ubox
15 55 0.073919376 ubox
16 23 0.008023770 ubox
16 39 0.838988645 ubox
16 40 0.032331550 ubox
16 54 0.073947558 ubox
17 22 0.009826637 ubox
17 24 0.015497439 ubox
17 35 0.121838093 ubox
17 53 0.073940039 ubox
18 23 0.015380615 ubox
18 33 0.081686268 ubox
18 34 0.118570248 ubox
18 40 0.151442005 ubox
18 41 0.003668048 ubox
18 52 0.073960111 ubox
19 32 0.091902140 ubox
19 33 0.102484966 ubox
19 39 0.308338434 ubox
19 40 0.005576992 ubox
19 51 0.073922995 ubox
20 31 0.097010888 ubox
20 35 0.562398822 ubox
20 38 0.332139076 ubox
20 50 0.073965991 ubox
21 33 0.721625216 ubox
21 34 0.535851632 ubox
21 40 0.012251906 ubox
21 48 0.020800595 ubox
21 49 0.070780620 ubox
22 32 0.762336129 ubox
22 33 0.497218546 ubox
22 39 0.024904467 ubox
22 43 0.023848276 ubox
22 47 0.029456130 ubox
22 48 0.062315832 ubox
23 31 0.786784898 ubox
23 35 0.333714024 ubox
23 38 0.026704503 ubox
23 42 0.027481557 ubox
23 44 0.017475263 ubox
23 46 0.036044318 ubox
24 33 0.049621875 ubox
24 34 0.336659841 ubox
24 41 0.027294911 ubox
24 43 0.018179555 ubox
25 32 0.049966358 ubox
25 33 0.334019029 ubox
25 34 0.032266419 ubox
25 40 0.026818967 ubox
26 32 0.309712026 ubox
26 33 0.032035151 ubox
26 39 0.023339737 ubox
26 41 0.034379218 ubox
27 40 0.035187548 ubox
28 34 0.005512817 ubox
28 39 0.033474951 ubox
28 41 0.016980258 ubox
29 33 0.005304553 ubox
29 40 0.017644819 ubox
29 41 0.006910040 ubox
30 39 0.017268355 ubox
30 40 0.005828518 ubox
30 41 0.046208577 ubox
31 40 0.047612229 ubox
48 90 0.008731965 ubox
48 93 0.020482534 ubox
49 89 0.010132810 ubox
49 92 0.024561043 ubox
50 91 0.025010566 ubox
50 94 0.006556331 ubox
51 60 0.151887308 ubox
51 87 0.053948070 ubox
51 88 0.023508384 ubox
51 90 0.020380963 ubox
51 93 0.006516158 ubox
51 99 0.008348614 ubox
51 100 0.023037581 ubox
52 59 0.151855837 ubox
52 86 0.061635302 ubox
52 87 0.016932622 ubox
52 89 0.017556401 ubox
52 92 0.006432259 ubox
52 98 0.007396351 ubox
52 99 0.019290390 ubox
53 58 0.150172968 ubox
53 61 0.042744276 ubox
53 85 0.065604918 ubox
53 91 0.005993462 ubox
54 60 0.055063452 ubox
54 84 0.066498930 ubox
54 88 0.014696220 ubox
54 98 0.029114217 ubox
54 99 0.854369550 ubox
54 100 0.140797847 ubox
55 59 0.047935228 ubox
55 83 0.066292550 ubox
55 86 0.003239400 ubox
55 87 0.014689319 ubox
55 90 0.004815875 ubox
55 97 0.023688947 ubox
55 98 0.923440509 ubox
55 99 0.154677068 ubox
55 100 0.098616986 ubox
56 82 0.065342817 ubox
56 83 0.004350292 ubox
56 86 0.014390372 ubox
56 89 0.005278834 ubox
56 97 0.939571318 ubox
56 98 0.153524560 ubox
56 99 0.115289723 ubox
56 100 0.023469140 ubox
57 82 0.005805624 ubox
57 83 0.003873905 ubox
57 84 0.013792141 ubox
57 88 0.005582600 ubox
57 96 0.942469365 ubox
57 97 0.145321862 ubox
57 98 0.120922695 ubox
57 99 0.030496308 ubox
57 100 0.016769560 ubox
58 82 0.004914171 ubox
58 83 0.013272268 ubox
58 87 0.005507204 ubox
58 97 0.120796323 ubox
58 98 0.030105716 ubox
58 99 0.018294746 ubox
59 67 0.003658872 ubox
59 79 0.013509027 ubox
59 80 0.063358105 ubox
59 81 0.004151062 ubox
59 95 0.953588186 ubox
60 66 0.004042023 ubox
60 78 0.014629713 ubox
60 79 0.064683762 ubox
60 91 0.004471745 ubox
60 94 0.965355587 ubox
61 90 0.004326162 ubox
61 93 0.964818977 ubox
61 98 0.050480574 ubox
61 99 0.015216354 ubox
61 100 0.007493871 ubox
62 89 0.003709905 ubox
62 92 0.964545447 ubox
62 97 0.056716744 ubox
62 98 0.014664584 ubox
62 99 0.008714645 ubox
63 79 0.003930503 ubox
63 91 0.962197571 ubox
63 95 0.228827891 ubox
64 75 0.224696317 ubox
64 78 0.003812820 ubox
64 91 0.044264574 ubox
64 94 0.230538527 ubox
65 74 0.225278066 ubox
65 87 0.019362633 ubox
65 89 0.922355268 ubox
65 90 0.047108671 ubox
65 93 0.201009639 ubox
65 97 0.014296997 ubox
66 72 0.019502999 ubox
66 73 0.224220470 ubox
66 83 0.004917512 ubox
66 84 0.025300652 ubox
66 86 0.017249622 ubox
66 87 0.019468616 ubox
66 88 0.938110693 ubox
66 89 0.020233174 ubox
66 90 0.014857252 ubox
66 92 0.142135652 ubox
66 93 0.130767555 ubox
66 96 0.016427570 ubox
66 98 0.003795086 ubox
66 99 0.005257459 ubox
66 100 0.006443502 ubox
67 71 0.022182714 ubox
67 82 0.009714261 ubox
67 83 0.026272366 ubox
67 86 0.061415991 ubox
67 87 0.923321284 ubox
67 89 0.016118120 ubox
67 92 0.196225332 ubox
67 97 0.003633209 ubox
67 98 0.005068772 ubox
67 99 0.006954314 ubox
68 75 0.024148002 ubox
68 91 0.242820873 ubox
68 94 0.025311549 ubox
69 74 0.022040796 ubox
69 83 0.737290581 ubox
69 87 0.044030393 ubox
69 90 0.241825394 ubox
69 93 0.025427534 ubox
69 98 0.023019578 ubox
69 99 0.012037423 ubox
69 100 0.004175003 ubox
70 82 0.748496058 ubox
70 86 0.101154042 ubox
70 89 0.226375478 ubox
70 92 0.025289889 ubox
70 97 0.025014473 ubox
70 98 0.013436010 ubox
70 99 0.004870591 ubox
71 79 0.011288594 ubox
71 80 0.719771282 ubox
71 81 0.533443103 ubox
71 85 0.058860389 ubox
71 91 0.024413682 ubox
71 95 0.004084350 ubox
72 78 0.014483789 ubox
72 79 0.899099289 ubox
72 94 0.005276593 ubox
72 95 0.048704174 ubox
73 78 0.896242662 ubox
73 79 0.096601869 ubox
73 94 0.049073959 ubox
73 95 0.013724759 ubox
74 78 0.087347149 ubox
74 85 0.331343781 ubox
74 94 0.013716179 ubox
75 83 0.006578338 ubox
75 84 0.345611927 ubox
75 88 0.031723094 ubox
75 93 0.013748239 ubox
75 99 0.004777819 ubox
75 100 0.007414337 ubox
76 82 0.007217030 ubox
76 83 0.344127166 ubox
76 86 0.004282646 ubox
76 87 0.032042736 ubox
76 90 0.128594296 ubox
76 92 0.012831871 ubox
76 98 0.006194504 ubox
76 99 0.010770403 ubox
77 82 0.327752242 ubox
77 83 0.005514717 ubox
77 86 0.032291145 ubox
77 89 0.134774470 ubox
77 90 0.161187793 ubox
77 97 0.006474857 ubox
77 98 0.011391423 ubox
78 82 0.005208811 ubox
78 84 0.015107274 ubox
78 86 0.003519985 ubox
78 88 0.135263814 ubox
78 89 0.175424144 ubox
78 96 0.006498188 ubox
78 97 0.011633206 ubox
79 83 0.009877231 ubox
79 87 0.133366621 ubox
79 88 0.177562295 ubox
79 90 0.003805744 ubox
79 96 0.011668028 ubox
79 99 0.004175617 ubox
80 86 0.127042402 ubox
80 87 0.174929010 ubox
80 89 0.003910894 ubox
80 93 0.003989654 ubox
80 98 0.004332259 ubox
81 86 0.137918022 ubox
81 92 0.004281844 ubox
81 97 0.004336959 ubox
82 91 0.004262465 ubox
83 95 0.006674943 ubox
84 91 0.012731267 ubox
84 94 0.007842779 ubox
85 90 0.012589177 ubox
85 93 0.007658034 ubox
87 95 0.006026187 ubox
88 94 0.012439066 ubox
88 95 0.010532233 ubox
89 94 0.010481761 ubox
1 53 0.9500000 lbox
2 52 0.9500000 lbox
4 50 0.9500000 lbox
5 49 0.9500000 lbox
7 48 0.9500000 lbox
8 47 0.9500000 lbox
9 46 0.9500000 lbox
10 45 0.9500000 lbox
11 44 0.9500000 lbox
12 43 0.9500000 lbox
13 42 0.9500000 lbox
14 41 0.9500000 lbox
15 40 0.9500000 lbox
16 39 0.9500000 lbox
21 33 0.9500000 lbox
22 32 0.9500000 lbox
23 31 0.9500000 lbox
54 99 0.9500000 lbox
55 98 0.9500000 lbox
56 97 0.9500000 lbox
57 96 0.9500000 lbox
59 95 0.9500000 lbox
60 94 0.9500000 lbox
61 93 0.9500000 lbox
62 92 0.9500000 lbox
63 91 0.9500000 lbox
65 89 0.9500000 lbox
66 88 0.9500000 lbox
67 87 0.9500000 lbox
69 83 0.9500000 lbox
70 82 0.9500000 lbox
71 81 0.9500000 lbox
72 79 0.9500000 lbox
73 78 0.9500000 lbox
showpage
end
%%EOF
