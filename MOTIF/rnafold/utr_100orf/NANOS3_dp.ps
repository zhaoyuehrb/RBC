%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 04:36:43 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (NANOS3)
} def

/sequence { (\
AUGGGGACCUUUGACCUGUGGACAGAUUACCUGGGUUUGGCACACCUGGUUAGGGCUCUGAGUGGGAAAGAGGGUCCUGAAACCAGGCUGAGCCCCCAGC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 19 0.380027430 ubox
1 27 0.004459338 ubox
2 13 0.004061239 ubox
2 18 0.394617940 ubox
2 20 0.015759056 ubox
2 24 0.020627383 ubox
2 26 0.004956560 ubox
2 29 0.008346760 ubox
2 33 0.009473602 ubox
2 98 0.732157138 ubox
3 9 0.098437725 ubox
3 10 0.031869010 ubox
3 11 0.016280825 ubox
3 12 0.008516615 ubox
3 16 0.067847330 ubox
3 17 0.435428501 ubox
3 19 0.015311110 ubox
3 23 0.022757798 ubox
3 28 0.009203334 ubox
3 31 0.074330039 ubox
3 32 0.107386670 ubox
3 95 0.004871542 ubox
3 96 0.062776735 ubox
3 97 0.812419080 ubox
4 8 0.097014402 ubox
4 9 0.035674323 ubox
4 10 0.020905218 ubox
4 11 0.009642223 ubox
4 12 0.004856447 ubox
4 15 0.068461590 ubox
4 16 0.440852890 ubox
4 17 0.126401421 ubox
4 27 0.009026061 ubox
4 28 0.006437974 ubox
4 30 0.078504552 ubox
4 31 0.134070247 ubox
4 32 0.083308668 ubox
4 94 0.004780667 ubox
4 95 0.063993881 ubox
4 96 0.812262170 ubox
4 97 0.160881320 ubox
5 9 0.021351303 ubox
5 10 0.008298733 ubox
5 11 0.006101285 ubox
5 12 0.006465513 ubox
5 15 0.440643208 ubox
5 16 0.133732443 ubox
5 17 0.012339138 ubox
5 27 0.007001260 ubox
5 28 0.009987783 ubox
5 30 0.137952200 ubox
5 31 0.106771944 ubox
5 32 0.004373742 ubox
5 38 0.052493315 ubox
5 93 0.004612152 ubox
5 94 0.063190977 ubox
5 95 0.809334936 ubox
5 96 0.162101820 ubox
5 97 0.012191473 ubox
6 10 0.009182358 ubox
6 11 0.017716706 ubox
6 12 0.035839157 ubox
6 15 0.134507312 ubox
6 16 0.012512897 ubox
6 27 0.011449398 ubox
6 28 0.050308274 ubox
6 30 0.109752468 ubox
6 31 0.005275848 ubox
6 36 0.008850514 ubox
6 37 0.403284214 ubox
6 38 0.029335987 ubox
6 93 0.062727161 ubox
6 94 0.579859965 ubox
6 95 0.162272320 ubox
6 96 0.012158061 ubox
7 11 0.033922594 ubox
7 19 0.013466011 ubox
7 27 0.064941162 ubox
7 36 0.461666355 ubox
7 37 0.023363686 ubox
8 18 0.013602832 ubox
8 21 0.072084503 ubox
8 34 0.053862257 ubox
8 35 0.468853367 ubox
8 40 0.249186989 ubox
8 55 0.003681527 ubox
9 20 0.072386393 ubox
9 21 0.016448516 ubox
9 25 0.023278088 ubox
9 33 0.054503741 ubox
9 34 0.468856005 ubox
9 35 0.005784337 ubox
9 39 0.277639258 ubox
9 40 0.068372855 ubox
9 54 0.003712900 ubox
9 92 0.058660382 ubox
10 20 0.016242736 ubox
10 21 0.004460467 ubox
10 22 0.006400758 ubox
10 24 0.020224833 ubox
10 25 0.006670055 ubox
10 26 0.230152576 ubox
10 33 0.461676635 ubox
10 34 0.005959456 ubox
10 39 0.085939643 ubox
10 40 0.031603218 ubox
10 91 0.057709894 ubox
10 92 0.014149660 ubox
11 20 0.005664749 ubox
11 21 0.007079631 ubox
11 22 0.014542082 ubox
11 24 0.005985378 ubox
11 25 0.245672130 ubox
11 26 0.011709618 ubox
11 33 0.014889151 ubox
11 39 0.136530610 ubox
11 40 0.012510671 ubox
11 53 0.003728996 ubox
11 90 0.049390657 ubox
11 91 0.014890290 ubox
12 18 0.008093840 ubox
12 20 0.007010941 ubox
12 21 0.014994536 ubox
12 24 0.249883565 ubox
12 25 0.010415788 ubox
12 29 0.433335906 ubox
12 39 0.040365131 ubox
12 42 0.011977339 ubox
12 44 0.003242211 ubox
12 52 0.004409356 ubox
12 90 0.014470142 ubox
13 17 0.004541193 ubox
13 19 0.005553888 ubox
13 23 0.250471490 ubox
13 28 0.459636841 ubox
13 32 0.004169790 ubox
13 37 0.624349136 ubox
13 38 0.056167229 ubox
13 41 0.013296227 ubox
13 43 0.003562987 ubox
13 51 0.005115345 ubox
13 89 0.009030626 ubox
14 27 0.455518976 ubox
14 36 0.668835574 ubox
14 37 0.041202470 ubox
14 50 0.005185280 ubox
15 21 0.251713809 ubox
15 34 0.026656733 ubox
15 35 0.674929551 ubox
15 40 0.012700177 ubox
15 49 0.005192596 ubox
16 20 0.250207472 ubox
16 25 0.494479429 ubox
16 33 0.027247753 ubox
16 34 0.674937874 ubox
16 35 0.009845579 ubox
16 39 0.012949067 ubox
16 48 0.005190331 ubox
16 99 0.005083489 ubox
17 24 0.495689287 ubox
17 29 0.004971856 ubox
17 33 0.667499087 ubox
17 34 0.010270967 ubox
17 42 0.007922135 ubox
17 44 0.059253303 ubox
17 98 0.005359887 ubox
18 23 0.493150979 ubox
18 27 0.038409643 ubox
18 28 0.006342775 ubox
18 30 0.147915424 ubox
18 32 0.503598496 ubox
18 38 0.003433544 ubox
18 41 0.008910147 ubox
18 43 0.067010924 ubox
18 45 0.006466388 ubox
18 97 0.005584661 ubox
18 100 0.003756547 ubox
19 26 0.040332341 ubox
19 29 0.148721824 ubox
19 33 0.007958159 ubox
19 40 0.008865486 ubox
19 42 0.067039184 ubox
19 44 0.007331012 ubox
19 98 0.010249929 ubox
20 28 0.145823316 ubox
20 31 0.667970378 ubox
20 32 0.032365487 ubox
20 38 0.003909863 ubox
20 41 0.066853253 ubox
20 43 0.007600328 ubox
20 96 0.006042949 ubox
20 97 0.013593765 ubox
21 27 0.107101009 ubox
21 28 0.037873174 ubox
21 30 0.668188449 ubox
21 31 0.034554528 ubox
21 37 0.004852416 ubox
21 38 0.007738155 ubox
21 95 0.006010439 ubox
21 96 0.013572349 ubox
22 27 0.040767898 ubox
22 36 0.005097421 ubox
22 37 0.007599567 ubox
23 33 0.068243368 ubox
23 35 0.004510374 ubox
23 39 0.085141153 ubox
24 32 0.070650649 ubox
24 38 0.085266438 ubox
25 31 0.070900892 ubox
25 37 0.085334636 ubox
26 36 0.085373003 ubox
27 34 0.004271563 ubox
27 35 0.084987329 ubox
28 33 0.004894153 ubox
28 34 0.079543126 ubox
29 36 0.005545329 ubox
30 35 0.006142085 ubox
30 40 0.009120682 ubox
31 39 0.010058377 ubox
31 99 0.509176535 ubox
32 98 0.532726844 ubox
33 95 0.080793307 ubox
33 96 0.008418259 ubox
33 97 0.549403991 ubox
34 94 0.088212357 ubox
34 95 0.008044756 ubox
34 96 0.549437595 ubox
34 97 0.023958608 ubox
35 41 0.003718047 ubox
35 93 0.100363861 ubox
35 94 0.005975174 ubox
35 95 0.548931207 ubox
35 96 0.024237096 ubox
35 100 0.003961267 ubox
36 40 0.003499740 ubox
36 92 0.100719068 ubox
36 99 0.003997583 ubox
37 91 0.101718242 ubox
37 98 0.003901828 ubox
38 44 0.009528540 ubox
38 90 0.101703468 ubox
39 43 0.010608245 ubox
39 89 0.102529948 ubox
39 94 0.805065437 ubox
39 95 0.005164721 ubox
40 88 0.102967765 ubox
40 93 0.951205619 ubox
40 94 0.004669190 ubox
41 87 0.075747644 ubox
41 90 0.080336291 ubox
41 92 0.955321392 ubox
42 89 0.078510804 ubox
43 90 0.965170925 ubox
44 89 0.962829433 ubox
45 87 0.996606313 ubox
46 86 0.999942420 ubox
46 87 0.005002812 ubox
47 85 0.999732429 ubox
48 84 0.999965101 ubox
49 83 0.999245687 ubox
50 80 0.427641819 ubox
50 81 0.108462607 ubox
50 82 0.875958259 ubox
51 79 0.755878695 ubox
51 80 0.106114938 ubox
51 81 0.576664833 ubox
52 78 0.979042779 ubox
53 77 0.998885875 ubox
53 78 0.045801924 ubox
54 76 0.998900315 ubox
54 77 0.045842113 ubox
55 75 0.998495072 ubox
55 76 0.045590747 ubox
56 72 0.029028587 ubox
56 73 0.006455917 ubox
56 74 0.999527283 ubox
57 67 0.010705644 ubox
57 71 0.042548533 ubox
57 72 0.003851937 ubox
57 73 0.998095995 ubox
58 64 0.003607538 ubox
58 65 0.005071535 ubox
58 66 0.013647394 ubox
58 70 0.049903004 ubox
58 72 0.998228978 ubox
58 73 0.020719702 ubox
59 64 0.005359185 ubox
59 65 0.014463962 ubox
59 69 0.051843253 ubox
59 71 0.992907826 ubox
59 72 0.020477207 ubox
73 89 0.004247327 ubox
74 88 0.004455823 ubox
76 87 0.004808882 ubox
77 86 0.004858459 ubox
78 85 0.004883687 ubox
79 84 0.004870624 ubox
87 93 0.013001128 ubox
88 92 0.015903993 ubox
1 19 0.9500000 lbox
2 18 0.9500000 lbox
3 17 0.9500000 lbox
4 16 0.9500000 lbox
5 15 0.9500000 lbox
31 99 0.9500000 lbox
32 98 0.9500000 lbox
33 97 0.9500000 lbox
34 96 0.9500000 lbox
35 95 0.9500000 lbox
39 94 0.9500000 lbox
40 93 0.9500000 lbox
41 92 0.9500000 lbox
43 90 0.9500000 lbox
44 89 0.9500000 lbox
45 87 0.9500000 lbox
46 86 0.9500000 lbox
47 85 0.9500000 lbox
48 84 0.9500000 lbox
49 83 0.9500000 lbox
50 82 0.9500000 lbox
51 79 0.9500000 lbox
52 78 0.9500000 lbox
53 77 0.9500000 lbox
54 76 0.9500000 lbox
55 75 0.9500000 lbox
56 74 0.9500000 lbox
57 73 0.9500000 lbox
58 72 0.9500000 lbox
59 71 0.9500000 lbox
showpage
end
%%EOF
