%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:06:30 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
GGGGUUGACGACCUAGCUGGGGGAGAAGCCCGAGGAAGAUUGACCAAUUUUGUAAUUCUAGAAACAUGGUCCAUGGAUCAGUGACAUUCAGGGAUGUGGCCAUUGACUUCUCUCAGGAGGAGUGGGAGUGCCUGCAGCCUGAUCAGAGGACCUUGUACAGGGAUG\
) } def
/len { sequence length } bind def

/coor [
[-1.79273856 174.26295471]
[-14.28446198 182.56697083]
[-26.77618599 190.87100220]
[-39.26791000 199.17501831]
[-51.75963211 207.47904968]
[-64.25135803 215.78308105]
[-76.74308014 224.08709717]
[-84.51573944 240.75791931]
[-102.03958893 241.22966003]
[-114.37193298 249.76860046]
[-126.70426941 258.30752563]
[-133.64561462 272.52471924]
[-148.51397705 273.40859985]
[-160.84631348 281.94754028]
[-163.79762268 297.24221802]
[-176.42601013 305.72622681]
[-190.98896790 302.81835938]
[-203.32130432 311.35729980]
[-210.26264954 325.57449341]
[-225.13101196 326.45837402]
[-237.46334839 334.99731445]
[-249.79568481 343.53622437]
[-252.37490845 359.12863159]
[-265.27264404 368.26229858]
[-280.83691406 365.51837158]
[-289.83370972 352.52478027]
[-286.92538452 336.99038696]
[-273.83740234 328.13150024]
[-258.33462524 331.20388794]
[-246.00227356 322.66494751]
[-233.66993713 314.12603760]
[-227.61068726 300.51959229]
[-211.86024475 299.02496338]
[-199.52789307 290.48602295]
[-197.12536621 275.83120728]
[-184.74026489 266.99584961]
[-169.38523865 269.61520386]
[-157.05290222 261.07626343]
[-150.99365234 247.46983337]
[-135.24320984 245.97518921]
[-122.91086578 237.43626404]
[-110.57852936 228.89732361]
[-108.09436798 217.03038025]
[-97.85170746 209.82080078]
[-85.04710388 211.59538269]
[-72.55538177 203.29135132]
[-60.06365967 194.98731995]
[-47.57193375 186.68330383]
[-35.08021164 178.37927246]
[-22.58848763 170.07525635]
[-10.09676456 161.77122498]
[-9.33787441 148.88272095]
[-1.16152513 138.64035034]
[11.61281013 134.93617249]
[24.36848831 139.34284973]
[37.01512146 131.27671814]
[49.66175461 123.21056366]
[62.30838776 115.14442444]
[74.95501709 107.07827759]
[74.71832275 93.82019806]
[81.04444885 82.16632080]
[92.29121399 75.14184570]
[105.53908539 74.57025909]
[117.34907532 80.59992981]
[130.14608765 72.77455902]
[142.94309998 64.94918060]
[150.68000793 51.14879608]
[165.57456970 51.11004257]
[178.37158203 43.28466797]
[191.16859436 35.45929718]
[203.96560669 27.63392448]
[216.76261902 19.80855179]
[218.11679077 4.46344090]
[228.12995911 -7.00782776]
[242.80422974 -10.34392262]
[256.46560669 -4.46981764]
[269.26260376 -12.29519081]
[282.05963135 -20.12056351]
[294.85662842 -27.94593620]
[307.65365601 -35.77130890]
[320.45065308 -43.59667969]
[318.60467529 -55.54668045]
[320.90859985 -67.38153839]
[327.06701660 -77.70674133]
[336.33175659 -85.31379700]
[347.59268188 -89.32163239]
[359.51077271 -89.27864838]
[370.67727661 -85.21341705]
[379.78021240 -77.62860870]
[393.00064087 -84.71520233]
[406.22109985 -91.80179596]
[419.44152832 -98.88838959]
[427.94909668 -112.22750854]
[442.82183838 -111.42099762]
[456.04229736 -118.50759125]
[457.20932007 -130.39147949]
[463.91674805 -140.12510681]
[474.39117432 -145.33990479]
[485.96078491 -144.83563232]
[495.73672485 -138.85461426]
[509.21588135 -145.43585205]
[511.55895996 -149.21044922]
[514.67987061 -151.76095581]
[518.08905029 -152.99302673]
[521.31762695 -152.98416138]
[523.97265625 -151.96142578]
[537.91094971 -157.50440979]
[551.84924316 -163.04739380]
[565.78747559 -168.59036255]
[579.72576904 -174.13334656]
[593.66400146 -179.67631531]
[607.60229492 -185.21929932]
[617.33905029 -198.41505432]
[633.60278320 -196.31204224]
[639.66278076 -181.07365417]
[629.28503418 -168.37583923]
[613.14526367 -171.28102112]
[599.20703125 -165.73805237]
[585.26873779 -160.19506836]
[571.33044434 -154.65209961]
[557.39221191 -149.10911560]
[543.45391846 -143.56613159]
[529.51562500 -138.02316284]
[515.79711914 -131.95671082]
[502.31796265 -125.37547302]
[497.45550537 -107.76006317]
[481.00045776 -99.10509491]
[463.12890625 -105.28714752]
[449.90844727 -98.20055389]
[442.34649658 -85.36831665]
[426.52813721 -85.66793823]
[413.30767822 -78.58134460]
[400.08724976 -71.49475098]
[386.86679077 -64.40815735]
[387.15463257 -46.33779526]
[378.22387695 -30.52864647]
[362.45181274 -21.36294556]
[344.12536621 -21.43098259]
[328.27603149 -30.79966736]
[315.47903442 -22.97429466]
[302.68200684 -15.14892292]
[289.88500977 -7.32355022]
[277.08798218 0.50182259]
[264.29098511 8.32719517]
[263.29461670 23.16448975]
[253.63830566 34.70655823]
[238.86444092 38.39254761]
[224.58799744 32.60556412]
[211.79098511 40.43093491]
[198.99397278 48.25630951]
[186.19696045 56.08168030]
[173.39994812 63.90705490]
[166.57835388 77.14772034]
[150.76847839 77.74620056]
[137.97146606 85.57157135]
[125.17444611 93.39694214]
[124.18875122 109.60507202]
[113.78704071 122.07420349]
[98.01841736 125.95046234]
[83.02116394 119.72491455]
[70.37452698 127.79105377]
[57.72789764 135.85719299]
[45.08126450 143.92333984]
[32.43463135 151.98948669]
[28.98706245 169.11828613]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[1 51]
[2 50]
[3 49]
[4 48]
[5 47]
[6 46]
[7 45]
[9 42]
[10 41]
[11 40]
[13 38]
[14 37]
[17 34]
[18 33]
[20 31]
[21 30]
[22 29]
[55 164]
[56 163]
[57 162]
[58 161]
[59 160]
[64 156]
[65 155]
[66 154]
[68 152]
[69 151]
[70 150]
[71 149]
[72 148]
[76 144]
[77 143]
[78 142]
[79 141]
[80 140]
[81 139]
[89 134]
[90 133]
[91 132]
[92 131]
[94 129]
[95 128]
[100 125]
[101 124]
[106 123]
[107 122]
[108 121]
[109 120]
[110 119]
[111 118]
[112 117]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
