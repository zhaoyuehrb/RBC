%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:16:21 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
AUUUCACUUGGAGGAAAGAGAGAAGGAAGGAAGCUGAGGACUUAGCAGGGUAUCACUGGACAGGCCAUGGCUCCACGGUCCCGGCGACGAAGGCACAAGAAACCUCCCUCAUCAGUGGCUCCCAUCAUCAUGGCCCCAACCACAAUUGUGACCCCUGUGCCUCUGA\
) } def
/len { sequence length } bind def

/coor [
[-102.96696472 423.74252319]
[-122.94000244 422.03189087]
[-129.73728943 435.40338135]
[-136.53457642 448.77487183]
[-143.33184814 462.14636230]
[-142.68814087 477.95446777]
[-155.35282898 485.79382324]
[-162.15010071 499.16531372]
[-168.94738770 512.53680420]
[-163.81178284 527.48339844]
[-170.82417297 541.64678955]
[-185.82424927 546.62408447]
[-199.91271973 539.46234131]
[-204.73114014 524.41052246]
[-197.42083740 510.39855957]
[-182.31889343 505.73953247]
[-175.52160645 492.36804199]
[-168.72431946 478.99652100]
[-169.85421753 464.14483643]
[-156.70335388 455.34909058]
[-149.90606689 441.97760010]
[-143.10877991 428.60610962]
[-136.31150818 415.23458862]
[-143.81970215 408.30328369]
[-149.58702087 399.85501099]
[-153.31529236 390.31796265]
[-154.80984497 380.17691040]
[-153.98970032 369.94839478]
[-150.89187622 360.15457153]
[-145.66979980 351.29644775]
[-138.58570862 343.82836914]
[-129.99745178 338.13452148]
[-120.34043884 334.50942993]
[-110.10558319 333.14245605]
[-99.81433105 334.10812378]
[-89.99206543 337.36199951]
[-81.49790955 324.99877930]
[-73.00375366 312.63552856]
[-64.50959778 300.27230835]
[-67.59863281 292.92340088]
[-67.50550079 284.85794067]
[-64.17061615 277.41018677]
[-58.07683945 271.84210205]
[-50.18096161 269.12954712]
[-41.76387024 269.79180908]
[-32.36432648 258.10214233]
[-22.96477890 246.41246033]
[-13.56523323 234.72277832]
[-4.16568708 223.03311157]
[5.23385859 211.34342957]
[4.24542332 199.26039124]
[12.01778603 189.43896484]
[24.79814529 187.50286865]
[34.41592026 175.99206543]
[44.03369522 164.48127747]
[53.65147018 152.97047424]
[62.71746063 141.02024841]
[71.21161652 128.65702820]
[79.70577240 116.29380798]
[73.99707794 101.09169769]
[78.41144562 85.46458435]
[91.23034668 75.49618530]
[107.46331787 75.06723785]
[115.72341156 62.54641724]
[123.98349762 50.02560043]
[132.24359131 37.50477982]
[140.50367737 24.98396111]
[148.76376343 12.46314144]
[157.02386475 -0.05767728]
[165.28395081 -12.57849598]
[157.56437683 -24.44417572]
[154.96615601 -38.31534576]
[157.85012817 -52.08562469]
[165.74725342 -63.67678452]
[177.43441772 -71.35240173]
[191.12384033 -73.97794342]
[204.73652649 -71.18839264]
[213.23068237 -83.55161285]
[210.55564880 -98.89703369]
[219.34605408 -111.31410217]
[233.99205017 -113.76976013]
[242.48620605 -126.13298035]
[250.98036194 -138.49620056]
[248.30534363 -153.84162903]
[257.09573364 -166.25869751]
[271.74176025 -168.71435547]
[280.23590088 -181.07757568]
[281.67343140 -196.83334351]
[295.25778198 -202.94189453]
[303.75195312 -215.30511475]
[305.18945312 -231.06088257]
[318.77383423 -237.16943359]
[327.26797485 -249.53265381]
[327.44985962 -253.96878052]
[328.90988159 -257.72299194]
[331.26898193 -260.47268677]
[334.08163452 -262.05468750]
[336.89471436 -262.47302246]
[346.29425049 -274.16268921]
[348.26770020 -290.44265747]
[363.45733643 -296.62384033]
[376.23739624 -286.34753418]
[373.46081543 -270.18515015]
[357.98394775 -264.76315308]
[348.58438110 -253.07347107]
[339.63119507 -241.03849792]
[331.13705444 -228.67527771]
[330.30709839 -213.80381775]
[316.11517334 -206.81095886]
[307.62100220 -194.44773865]
[306.79104614 -179.57627869]
[292.59912109 -172.58341980]
[284.10498047 -160.22019958]
[287.06564331 -145.66787720]
[278.62747192 -133.00880432]
[263.34359741 -130.00204468]
[254.84944153 -117.63882446]
[246.35528564 -105.27560425]
[249.31594849 -90.72328186]
[240.87779236 -78.06420898]
[225.59390259 -75.05745697]
[217.09974670 -62.69423294]
[225.29896545 -49.00140381]
[226.72137451 -33.04660797]
[221.03257751 -18.01061630]
[209.32099915 -6.91315651]
[193.88993835 -2.00648499]
[177.80476379 -4.31840611]
[169.54467773 8.20241261]
[161.28459167 20.72323227]
[153.02450562 33.24405289]
[144.76440430 45.76486969]
[136.50431824 58.28569031]
[128.24423218 70.80651093]
[119.98413849 83.32732391]
[125.60463715 95.33668518]
[124.57906342 108.55648041]
[117.17362976 119.55530548]
[105.31052399 125.47826385]
[92.06899261 124.78795624]
[83.57483673 137.15118408]
[75.08068085 149.51440430]
[90.08020782 149.63418579]
[99.48961639 161.31591797]
[96.41168976 175.99673462]
[83.10258484 182.91539001]
[69.31806946 177.00041199]
[65.16226196 162.58825684]
[55.54449081 174.09904480]
[45.92671585 185.60984802]
[36.30894089 197.12063599]
[33.59220505 215.31324768]
[16.92353439 220.74298096]
[7.52398920 232.43264771]
[-1.87555659 244.12232971]
[-11.27510262 255.81199646]
[-20.67464828 267.50167847]
[-30.07419395 279.19134521]
[-31.76978493 301.51419067]
[-52.14637756 308.76647949]
[-60.64052963 321.12969971]
[-69.13468933 333.49291992]
[-77.62884521 345.85614014]
[-66.58164978 362.85610962]
[-63.96412659 382.91455078]
[-70.25046539 402.09350586]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[2 23]
[3 22]
[4 21]
[5 20]
[7 18]
[8 17]
[9 16]
[36 163]
[37 162]
[38 161]
[39 160]
[45 158]
[46 157]
[47 156]
[48 155]
[49 154]
[50 153]
[53 151]
[54 150]
[55 149]
[56 148]
[57 142]
[58 141]
[59 140]
[63 135]
[64 134]
[65 133]
[66 132]
[67 131]
[68 130]
[69 129]
[70 128]
[77 122]
[78 121]
[81 118]
[82 117]
[83 116]
[86 113]
[87 112]
[89 110]
[90 109]
[92 107]
[93 106]
[98 105]
[99 104]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
