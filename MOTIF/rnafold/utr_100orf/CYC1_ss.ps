%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:13:13 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
GAGGUUUUGACUCUCGUGGCGCCCCAGGGGCCGACGGGAGUGGCGGCCGCGCGGAGGAGGCCAAGAUGGCGGCAGCUGCGGCUUCGCUUCGCGGGGUAGUGUUGGGCCCGCGGGGCGCGGGGCUCCCGGGCGCGCGUGCCCGGGGUCUGCUGUGCAGCGCGCGUC\
) } def
/len { sequence length } bind def

/coor [
[96.65380096 127.06438446]
[89.26007843 125.06655121]
[82.71348572 121.09156799]
[70.38114166 129.63050842]
[58.04880142 138.16943359]
[45.71646118 146.70837402]
[45.23523331 162.10559082]
[35.88914871 174.12658691]
[21.42782021 178.28999329]
[7.45514059 173.20057678]
[-4.87719917 181.73950195]
[-17.20953941 190.27844238]
[-29.54187965 198.81738281]
[-41.87422180 207.35630798]
[-54.20655823 215.89524841]
[-66.53890228 224.43417358]
[-78.87123871 232.97311401]
[-91.12223053 241.62835693]
[-103.29077148 250.39913940]
[-115.45931244 259.16992188]
[-122.13035583 273.51593018]
[-136.97932434 274.68103027]
[-149.14787292 283.45181274]
[-158.46173096 297.61825562]
[-174.65287781 292.59002686]
[-174.30332947 275.63970947]
[-157.91865540 271.28326416]
[-145.75010681 262.51248169]
[-139.94943237 248.79382324]
[-124.23009491 247.00138855]
[-112.06155396 238.23060608]
[-99.89301300 229.45982361]
[-96.28958893 222.96905518]
[-87.41017151 220.64077759]
[-75.07783508 212.10183716]
[-62.74549484 203.56289673]
[-50.41315460 195.02397156]
[-38.08081436 186.48503113]
[-25.74847221 177.94610596]
[-13.41613293 169.40716553]
[-1.08379269 160.86824036]
[-0.93099838 145.99830627]
[8.05481052 133.92689514]
[22.59570122 129.40849304]
[37.17752838 134.37603760]
[49.50986862 125.83709717]
[61.84220886 117.29816437]
[74.17455292 108.75923157]
[73.18458557 86.24153137]
[90.38167572 68.42483521]
[84.05670166 54.82355881]
[77.73171997 41.22228622]
[71.40674591 27.62101173]
[65.08177185 14.01973629]
[58.75679016 0.41846231]
[52.43181610 -13.18281174]
[45.97842026 -26.72362709]
[39.39718246 -40.20277023]
[32.81594467 -53.68191528]
[26.23470879 -67.16105652]
[19.65347290 -80.64020538]
[13.07223606 -94.11934662]
[-2.42582607 -104.02594757]
[-0.57871079 -121.45856476]
[-7.41384983 -134.81074524]
[-20.58958054 -143.56921387]
[-19.50176811 -158.42404175]
[-26.33690643 -171.77622986]
[-40.39360809 -180.22259521]
[-39.83668518 -196.61228943]
[-25.23905373 -204.08497620]
[-11.61750507 -194.95341492]
[-12.98472118 -178.61135864]
[-6.14958191 -165.25917053]
[6.53725481 -157.45574951]
[5.93833637 -141.64588928]
[12.77347565 -128.29370117]
[24.20831108 -124.26380157]
[30.00175858 -113.15859222]
[26.55138016 -100.70058441]
[33.13261795 -87.22144318]
[39.71385193 -73.74229431]
[46.29508972 -60.26315308]
[52.87632751 -46.78400803]
[59.45756149 -33.30486298]
[65.24360657 -28.65336418]
[66.03308868 -19.50778961]
[72.35806274 -5.90651464]
[78.68304443 7.69475985]
[85.00801849 21.29603386]
[91.33300018 34.89730835]
[97.65797424 48.49858475]
[103.98294830 62.09985733]
[118.30051422 66.57282257]
[131.24331665 58.99102783]
[144.18612671 51.40922928]
[150.04144287 44.33956146]
[157.44639587 43.80907822]
[170.53036499 36.47356796]
[183.61433411 29.13805962]
[191.86793518 15.64033127]
[206.75329590 16.16523743]
[219.83726501 8.82972717]
[232.92123413 1.49421704]
[241.17483521 -12.00351048]
[256.06018066 -11.47860527]
[269.14416504 -18.81411552]
[282.22811890 -26.14962387]
[295.31210327 -33.48513412]
[306.17114258 -46.50501633]
[321.68829346 -39.67460632]
[319.42037964 -22.87302971]
[302.64761353 -20.40116310]
[289.56362915 -13.06565380]
[276.47967529 -5.73014402]
[263.39569092 1.60536599]
[256.07794189 14.57840919]
[240.25674438 14.57818794]
[227.17277527 21.91369820]
[214.08880615 29.24920845]
[206.77105713 42.22225189]
[190.94984436 42.22203064]
[177.86587524 49.55754089]
[164.78190613 56.89305115]
[151.76792908 64.35203552]
[138.82511902 71.93383789]
[125.88230896 79.51563263]
[130.10398865 98.54668427]
[122.91443634 114.78535461]
[132.79573059 126.07074738]
[142.67701721 137.35614014]
[152.55830383 148.64152527]
[162.43960571 159.92692566]
[172.32089233 171.21231079]
[182.20217896 182.49771118]
[192.08346558 193.78309631]
[202.07110596 204.97448730]
[212.16419983 216.07086182]
[222.25727844 227.16723633]
[237.26676941 232.16981506]
[240.10687256 246.79113770]
[250.19996643 257.88751221]
[260.29306030 268.98388672]
[276.08950806 269.48092651]
[286.84680176 281.05920410]
[286.18280029 296.84951782]
[274.49145508 307.48379517]
[258.70901489 306.65289307]
[248.19894409 294.84976196]
[249.19667053 279.07699585]
[239.10359192 267.98062134]
[229.01049805 256.88421631]
[214.72293091 252.67533875]
[211.16090393 237.26033020]
[201.06782532 226.16395569]
[190.97473145 215.06758118]
[184.11747742 212.22280884]
[180.79808044 203.66439819]
[170.91679382 192.37899780]
[161.03549194 181.09361267]
[151.15420532 169.80821228]
[141.27291870 158.52282715]
[131.39161682 147.23742676]
[121.51033020 135.95204163]
[111.62904358 124.66664124]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[3 48]
[4 47]
[5 46]
[6 45]
[10 41]
[11 40]
[12 39]
[13 38]
[14 37]
[15 36]
[16 35]
[17 34]
[18 32]
[19 31]
[20 30]
[22 28]
[23 27]
[50 93]
[51 92]
[52 91]
[53 90]
[54 89]
[55 88]
[56 87]
[57 85]
[58 84]
[59 83]
[60 82]
[61 81]
[62 80]
[64 77]
[65 76]
[67 74]
[68 73]
[94 127]
[95 126]
[96 125]
[98 124]
[99 123]
[100 122]
[102 120]
[103 119]
[104 118]
[106 116]
[107 115]
[108 114]
[109 113]
[129 165]
[130 164]
[131 163]
[132 162]
[133 161]
[134 160]
[135 159]
[136 158]
[137 156]
[138 155]
[139 154]
[141 152]
[142 151]
[143 150]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
