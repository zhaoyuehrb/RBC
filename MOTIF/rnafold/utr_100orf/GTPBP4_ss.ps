%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:06:05 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
GGAAGUCCCACCUGCGCCCGACGGCGGAAGUUCCGGGAGUGCCAAGUACCCGCGUGCAUACGGCUGCCGGCAUGGCACAUUACAACUUCAAGAAAAUUACGGUGGUGCCGUCCGCCAAGGACUUCAUAGACCUCACGUUGUCGAAGACUCAACGAAAGACUCCAACCGUUA\
) } def
/len { sequence length } bind def

/coor [
[173.47071838 191.04428101]
[178.43051147 182.20014954]
[167.44361877 171.98799133]
[156.45671082 161.77584839]
[145.46981812 151.56369019]
[134.48291016 141.35154724]
[123.49601746 131.13938904]
[112.50911713 120.92723846]
[121.83215332 132.67802429]
[120.86875153 147.64704895]
[110.11631012 158.10578918]
[95.12634277 158.65435791]
[83.63820648 149.00953674]
[81.58324432 134.15095520]
[90.02412415 121.74898529]
[79.81197357 132.73588562]
[69.59982300 143.72279358]
[59.38767242 154.70968628]
[56.25402451 170.80665588]
[40.66090775 175.88471985]
[28.64918900 164.72001648]
[32.57549286 148.79782104]
[48.40077209 144.49752808]
[58.61292267 133.51063538]
[68.82507324 122.52373505]
[79.03722382 111.53683472]
[76.98882294 96.67736053]
[64.18492889 88.86325073]
[51.38103485 81.04914856]
[38.57713699 73.23504639]
[25.77324104 65.42093658]
[12.96934414 57.60683441]
[0.30777633 62.26456070]
[-12.53410149 58.81823349]
[-20.91311073 48.74646759]
[-21.93427277 35.88028717]
[-34.59331512 27.83363342]
[-50.39040375 26.96040916]
[-56.98078537 13.60315800]
[-69.63983154 5.55650473]
[-82.29887390 -2.49014783]
[-94.95791626 -10.53680038]
[-107.61695862 -18.58345413]
[-120.27600098 -26.63010597]
[-131.19700623 -21.82225990]
[-142.96101379 -22.88971519]
[-152.63938904 -29.45003700]
[-157.87919617 -39.76793671]
[-157.47485352 -51.21283722]
[-169.83157349 -59.71645737]
[-185.58622742 -61.16604233]
[-191.68437195 -74.75507355]
[-204.04109192 -83.25868988]
[-216.39781189 -91.76231384]
[-225.27688599 -94.06259155]
[-228.90061951 -100.53578949]
[-241.09997559 -109.26367950]
[-257.09835815 -108.06734467]
[-267.90243530 -119.92699432]
[-265.22424316 -135.74491882]
[-251.11827087 -143.38696289]
[-236.40539551 -136.99079895]
[-232.37208557 -121.46302032]
[-220.17274475 -112.73513794]
[-207.89419556 -104.11902618]
[-195.53747559 -95.61540985]
[-183.18075562 -87.11179352]
[-168.30993652 -86.27044678]
[-161.32795715 -72.07317352]
[-148.97123718 -63.56955719]
[-131.23431396 -67.98999786]
[-115.61108398 -57.90066528]
[-112.22934723 -39.28915024]
[-99.57030487 -31.24249649]
[-86.91126251 -23.19584465]
[-74.25222015 -15.14919090]
[-61.59317780 -7.10253859]
[-48.93413544 0.94411439]
[-34.04250336 1.24178898]
[-26.54666328 15.17459011]
[-13.88761902 23.22124290]
[2.33768797 18.86016083]
[16.99461174 27.74283218]
[20.78344917 44.80293655]
[33.58734512 52.61704254]
[46.39124298 60.43114471]
[59.19513702 68.24525452]
[71.99903107 76.05935669]
[84.80293274 83.87345886]
[77.31273651 70.87742615]
[66.54164124 60.43790817]
[62.16218567 46.09146500]
[65.26665497 31.41623878]
[75.08074951 20.07236481]
[89.15675354 14.88911533]
[103.98397827 17.15924072]
[115.86437225 26.31654930]
[121.83484650 40.07712173]
[120.40631866 55.00894547]
[111.93544006 67.38755035]
[107.18949127 81.61695862]
[118.17639160 71.40480804]
[129.16329956 61.19265747]
[140.15019226 50.98050690]
[151.13710022 40.76835632]
[151.46376038 24.96744347]
[162.92536926 14.08593655]
[178.72193909 14.57964134]
[189.48165894 26.15565109]
[188.82096863 41.94612503]
[177.13185120 52.58285141]
[161.34924316 51.75525665]
[150.36235046 61.96740723]
[139.37544250 72.17955780]
[128.38854980 82.39170837]
[117.40164185 92.60385895]
[120.69493866 97.28470612]
[122.60988617 103.20861816]
[122.72126770 109.94033813]
[133.70816040 120.15248871]
[144.69506836 130.36463928]
[155.68196106 140.57679749]
[166.66886902 150.78894043]
[177.65576172 161.00109863]
[188.64266968 171.21324158]
[206.81787109 161.61756897]
[227.23799133 159.55538940]
[246.90954590 165.30731201]
[262.95690918 178.00999451]
[273.04278564 195.78570557]
[275.70843506 216.01983643]
[270.58483887 235.74548340]
[283.09478760 244.02198792]
[298.39105225 241.07885742]
[310.96005249 249.65063477]
[313.67160034 264.25143433]
[326.18157959 272.52792358]
[338.69152832 280.80444336]
[351.20150757 289.08096313]
[363.71148682 297.35748291]
[377.78680420 291.04174805]
[393.03884888 293.36090088]
[404.60076904 303.57492065]
[408.78314209 318.42453003]
[404.25143433 333.17129517]
[392.45166016 343.10955811]
[377.14913940 345.06808472]
[363.22680664 338.42187500]
[355.12722778 325.29174805]
[355.43496704 309.86746216]
[342.92498779 301.59094238]
[330.41503906 293.31442261]
[317.90505981 285.03790283]
[305.39508057 276.76138306]
[290.89682007 279.97625732]
[278.09201050 271.76089478]
[274.81826782 256.53195190]
[262.30831909 248.25544739]
[254.98208618 255.13046265]
[246.48921204 260.50964355]
[237.13107300 264.19937134]
[227.24018860 266.06600952]
[217.16853333 266.04077148]
[207.27494812 264.12222290]
[197.91236877 260.37643433]
[189.41522217 254.93467712]
[182.08750916 247.98887634]
[176.19189453 239.78482056]
[171.94035339 230.61343384]
[169.48645020 220.80047607]
[168.91986084 210.69502258]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[2 125]
[3 124]
[4 123]
[5 122]
[6 121]
[7 120]
[8 119]
[15 26]
[16 25]
[17 24]
[18 23]
[27 89]
[28 88]
[29 87]
[30 86]
[31 85]
[32 84]
[36 81]
[37 80]
[39 78]
[40 77]
[41 76]
[42 75]
[43 74]
[44 73]
[49 70]
[50 69]
[52 67]
[53 66]
[54 65]
[56 64]
[57 63]
[101 116]
[102 115]
[103 114]
[104 113]
[105 112]
[132 158]
[133 157]
[136 154]
[137 153]
[138 152]
[139 151]
[140 150]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
