%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 04:37:41 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (KRTAP13-4)
} def

/sequence { (\
UGAACUCCCAUCUCUCAUCAGCAUGUCCUACAACUGCUGCUCUAGAAACUUCUCCUCCCGCUCCUUUGGGGGCUACCUGUACUACCCAGGCUCCUACCCCAGCAGCCUGGUCUACAGCACUG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 10 0.221715991 ubox
1 17 0.107517716 ubox
1 20 0.018266804 ubox
1 32 0.004333092 ubox
1 75 0.021488969 ubox
1 116 0.009034381 ubox
1 119 0.145769390 ubox
1 122 0.011676717 ubox
2 9 0.254388908 ubox
2 12 0.142387753 ubox
2 14 0.058200584 ubox
2 16 0.123588189 ubox
2 19 0.024212606 ubox
2 27 0.003712119 ubox
2 31 0.004791092 ubox
2 42 0.018050518 ubox
2 51 0.007601481 ubox
2 52 0.167086079 ubox
2 54 0.104313765 ubox
2 57 0.131761897 ubox
2 59 0.019839678 ubox
2 74 0.022982912 ubox
2 112 0.012915180 ubox
2 115 0.009892229 ubox
2 118 0.170356955 ubox
2 121 0.019136487 ubox
3 11 0.137701738 ubox
3 13 0.056342638 ubox
3 15 0.119261376 ubox
3 18 0.022969217 ubox
3 26 0.003423977 ubox
3 41 0.017615227 ubox
3 50 0.008163912 ubox
3 51 0.166800562 ubox
3 53 0.101984107 ubox
3 56 0.129257886 ubox
3 111 0.012059876 ubox
4 50 0.154412685 ubox
4 80 0.005494621 ubox
5 25 0.003457924 ubox
5 45 0.011995104 ubox
5 71 0.010767629 ubox
5 72 0.157091503 ubox
5 79 0.005682358 ubox
5 117 0.014787030 ubox
6 44 0.011556733 ubox
6 46 0.023522278 ubox
6 70 0.003939850 ubox
6 71 0.157998058 ubox
6 72 0.006652154 ubox
6 116 0.011727695 ubox
7 45 0.023693647 ubox
7 69 0.003824215 ubox
7 70 0.158881693 ubox
7 71 0.009172691 ubox
7 72 0.021714987 ubox
8 68 0.003709583 ubox
8 69 0.158882847 ubox
8 70 0.008640992 ubox
8 71 0.021915477 ubox
8 72 0.019113031 ubox
9 25 0.019013754 ubox
9 68 0.158856391 ubox
9 69 0.007920036 ubox
9 70 0.018443188 ubox
9 71 0.019199642 ubox
9 79 0.004050185 ubox
9 122 0.091468477 ubox
10 18 0.012726199 ubox
10 24 0.019099246 ubox
10 67 0.152193007 ubox
10 78 0.003709200 ubox
10 121 0.083752776 ubox
11 17 0.013387738 ubox
11 23 0.018921673 ubox
11 46 0.491581392 ubox
12 21 0.018504810 ubox
12 45 0.521409733 ubox
12 72 0.005882213 ubox
12 117 0.006937744 ubox
13 20 0.017561406 ubox
13 44 0.503189997 ubox
13 46 0.699017224 ubox
13 71 0.005764647 ubox
13 116 0.004508987 ubox
14 21 0.005417006 ubox
14 45 0.733141330 ubox
14 70 0.005696665 ubox
14 117 0.005481201 ubox
15 20 0.005169451 ubox
15 44 0.711258742 ubox
15 46 0.084891156 ubox
15 69 0.005662903 ubox
15 116 0.004368986 ubox
16 25 0.007555756 ubox
16 39 0.020286399 ubox
16 45 0.088951862 ubox
16 68 0.005713055 ubox
16 122 0.043312380 ubox
17 24 0.007438433 ubox
17 38 0.019280180 ubox
17 67 0.005191018 ubox
17 121 0.039909698 ubox
18 23 0.006713378 ubox
18 46 0.011558949 ubox
19 36 0.026307027 ubox
19 39 0.983067992 ubox
19 45 0.011312807 ubox
19 122 0.010464112 ubox
20 29 0.004004500 ubox
20 35 0.026553261 ubox
20 38 0.993916934 ubox
20 41 0.047385022 ubox
20 121 0.009795906 ubox
21 28 0.004173810 ubox
21 34 0.026515884 ubox
21 37 0.997670381 ubox
21 40 0.049570038 ubox
21 118 0.003396161 ubox
21 120 0.008787722 ubox
22 36 0.997655026 ubox
22 39 0.049583371 ubox
22 117 0.003376725 ubox
23 35 0.964831117 ubox
23 38 0.048161880 ubox
24 30 0.018745788 ubox
24 32 0.505637544 ubox
24 36 0.006989146 ubox
24 116 0.003269820 ubox
25 29 0.015848309 ubox
25 31 0.532584925 ubox
25 34 0.813772818 ubox
25 35 0.004266114 ubox
25 37 0.034990598 ubox
25 115 0.003292103 ubox
26 30 0.479867916 ubox
26 33 0.775218762 ubox
26 36 0.033744590 ubox
26 114 0.003195231 ubox
30 35 0.003261965 ubox
31 122 0.008742025 ubox
32 121 0.008572717 ubox
35 119 0.027395512 ubox
36 61 0.003316213 ubox
36 118 0.030636031 ubox
36 121 0.004404365 ubox
37 60 0.003312543 ubox
37 117 0.030641049 ubox
38 116 0.030591865 ubox
38 119 0.073579245 ubox
39 59 0.005685159 ubox
39 61 0.018295354 ubox
39 73 0.004939999 ubox
39 115 0.030477262 ubox
39 118 0.137824965 ubox
40 60 0.019447658 ubox
40 71 0.006442037 ubox
40 72 0.005129763 ubox
40 117 0.141644300 ubox
41 70 0.006486154 ubox
41 71 0.004520319 ubox
41 116 0.138204263 ubox
42 69 0.006726358 ubox
42 70 0.003230964 ubox
42 117 0.003359630 ubox
43 68 0.006768881 ubox
43 75 0.038007980 ubox
43 84 0.010396999 ubox
43 114 0.141546916 ubox
43 122 0.029825404 ubox
44 50 0.023551824 ubox
44 51 0.010729570 ubox
44 53 0.218446572 ubox
44 56 0.033423809 ubox
44 62 0.006615805 ubox
44 65 0.006840946 ubox
44 67 0.006910756 ubox
44 74 0.040583670 ubox
44 83 0.011141193 ubox
44 113 0.143544164 ubox
44 121 0.037764247 ubox
45 49 0.024971258 ubox
45 50 0.010711621 ubox
45 51 0.011078693 ubox
45 52 0.236178169 ubox
45 54 0.101111101 ubox
45 55 0.034205514 ubox
45 57 0.038109612 ubox
45 61 0.007117061 ubox
45 63 0.010339058 ubox
45 64 0.007267682 ubox
45 66 0.007028561 ubox
45 73 0.040612651 ubox
45 82 0.011180692 ubox
45 112 0.143570374 ubox
45 120 0.038097930 ubox
46 50 0.011836625 ubox
46 51 0.221078553 ubox
46 53 0.098085732 ubox
46 56 0.036968895 ubox
46 62 0.010101315 ubox
46 65 0.006751161 ubox
46 66 0.003251455 ubox
46 111 0.133922330 ubox
47 65 0.003642849 ubox
47 66 0.004936825 ubox
48 65 0.004650107 ubox
48 80 0.047584863 ubox
49 72 0.005501045 ubox
49 79 0.049258099 ubox
49 117 0.006556859 ubox
50 71 0.004380891 ubox
50 116 0.005161967 ubox
51 72 0.029693464 ubox
52 71 0.039793804 ubox
52 72 0.015951063 ubox
52 117 0.003958669 ubox
53 70 0.039602865 ubox
53 71 0.015071874 ubox
53 72 0.017317511 ubox
54 69 0.040310150 ubox
54 70 0.014048723 ubox
54 71 0.023341723 ubox
54 72 0.236112528 ubox
55 68 0.040344866 ubox
55 69 0.013867484 ubox
55 70 0.021789622 ubox
55 71 0.238460044 ubox
55 72 0.503022446 ubox
55 117 0.003995508 ubox
56 68 0.012580634 ubox
56 69 0.017347094 ubox
56 70 0.082236102 ubox
56 71 0.509569591 ubox
56 72 0.039990957 ubox
57 68 0.017313583 ubox
57 69 0.080604131 ubox
57 70 0.560550783 ubox
57 71 0.054803965 ubox
57 72 0.021210725 ubox
58 68 0.077964000 ubox
58 69 0.561281049 ubox
58 70 0.054781293 ubox
58 71 0.021473991 ubox
58 72 0.014054864 ubox
59 68 0.561615062 ubox
59 69 0.054647846 ubox
59 70 0.021382480 ubox
59 71 0.014169842 ubox
59 79 0.003237866 ubox
59 122 0.015830071 ubox
60 67 0.428181436 ubox
60 73 0.803309511 ubox
60 106 0.004809814 ubox
61 69 0.018705186 ubox
61 70 0.008870175 ubox
61 71 0.016732837 ubox
61 72 0.804235387 ubox
61 105 0.004823000 ubox
62 68 0.017367706 ubox
62 69 0.008694985 ubox
62 70 0.019125680 ubox
62 71 0.803138501 ubox
62 72 0.004899097 ubox
62 104 0.004748930 ubox
63 68 0.010047654 ubox
63 69 0.022540723 ubox
63 70 0.803577806 ubox
63 71 0.030129957 ubox
64 68 0.024270087 ubox
64 69 0.802939025 ubox
64 70 0.030207171 ubox
65 69 0.027313677 ubox
66 102 0.004270013 ubox
67 101 0.004723904 ubox
68 100 0.005007027 ubox
69 99 0.005007620 ubox
70 77 0.004516816 ubox
70 98 0.005005361 ubox
71 76 0.011497231 ubox
71 77 0.007905119 ubox
71 97 0.004980922 ubox
71 120 0.009464124 ubox
71 121 0.015064924 ubox
72 76 0.008520006 ubox
72 80 0.021127123 ubox
72 118 0.030798730 ubox
72 120 0.018203849 ubox
73 79 0.030011132 ubox
73 117 0.029865981 ubox
74 81 0.012082543 ubox
74 84 0.008753509 ubox
74 116 0.021195920 ubox
74 122 0.078272353 ubox
75 80 0.011626488 ubox
75 83 0.009027923 ubox
75 121 0.097283343 ubox
76 90 0.006661720 ubox
77 89 0.006734914 ubox
77 117 0.970798449 ubox
78 84 0.007332061 ubox
78 88 0.006741976 ubox
78 116 0.982339966 ubox
78 119 0.063950275 ubox
79 83 0.006778090 ubox
79 85 0.029109554 ubox
79 87 0.006722130 ubox
79 115 0.984807237 ubox
79 118 0.072095293 ubox
79 120 0.019878083 ubox
80 84 0.026349390 ubox
80 114 0.982240057 ubox
80 117 0.071243860 ubox
80 119 0.019528956 ubox
81 111 0.014480361 ubox
81 113 0.947377338 ubox
82 110 0.010317609 ubox
82 117 0.021086983 ubox
83 109 0.004793738 ubox
83 114 0.053576303 ubox
83 116 0.020476528 ubox
84 111 0.477347275 ubox
84 113 0.055769494 ubox
85 110 0.400915407 ubox
86 109 0.284328893 ubox
86 110 0.914658898 ubox
87 109 0.958642623 ubox
88 108 0.999243778 ubox
89 107 0.999962299 ubox
90 106 0.999968111 ubox
91 102 0.003264008 ubox
91 105 0.999934105 ubox
92 101 0.005174700 ubox
92 104 0.976851916 ubox
94 102 0.979670409 ubox
95 101 0.951612617 ubox
95 104 0.005377608 ubox
99 110 0.003331291 ubox
100 109 0.003350603 ubox
101 108 0.003348082 ubox
102 107 0.003295091 ubox
115 122 0.008165686 ubox
116 121 0.007545508 ubox
13 46 0.9500000 lbox
14 45 0.9500000 lbox
15 44 0.9500000 lbox
19 39 0.9500000 lbox
20 38 0.9500000 lbox
21 37 0.9500000 lbox
22 36 0.9500000 lbox
23 35 0.9500000 lbox
25 34 0.9500000 lbox
26 33 0.9500000 lbox
60 73 0.9500000 lbox
61 72 0.9500000 lbox
62 71 0.9500000 lbox
63 70 0.9500000 lbox
64 69 0.9500000 lbox
77 117 0.9500000 lbox
78 116 0.9500000 lbox
79 115 0.9500000 lbox
80 114 0.9500000 lbox
81 113 0.9500000 lbox
86 110 0.9500000 lbox
87 109 0.9500000 lbox
88 108 0.9500000 lbox
89 107 0.9500000 lbox
90 106 0.9500000 lbox
91 105 0.9500000 lbox
92 104 0.9500000 lbox
94 102 0.9500000 lbox
95 101 0.9500000 lbox
showpage
end
%%EOF
