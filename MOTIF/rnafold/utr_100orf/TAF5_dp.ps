%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:25:25 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (TAF5)
} def

/sequence { (\
AAUCACGCUUGACGGCGCGAGGUGGCUCAGCCGCAAGAUGGCGGCGCUGGCGGAGGAGCAGACGGAGGUGGCGGUCAAGCUAGAGCCUGAGGGACCGCCAACGCUGCUACCUCCGCAGGCGGGGGACGGCGCAGGCG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
3 12 0.003289971 ubox
3 20 0.004574940 ubox
3 41 0.003513623 ubox
4 11 0.003599019 ubox
4 19 0.004892341 ubox
4 24 0.004707927 ubox
4 40 0.011818451 ubox
4 43 0.004031422 ubox
5 23 0.004714900 ubox
5 39 0.011472428 ubox
6 14 0.003191416 ubox
6 17 0.005645939 ubox
6 22 0.004706351 ubox
6 40 0.027180559 ubox
6 43 0.011200235 ubox
6 121 0.003662110 ubox
6 137 0.951252458 ubox
7 13 0.003181624 ubox
7 16 0.006391095 ubox
7 39 0.027083386 ubox
7 42 0.011296823 ubox
7 120 0.003681084 ubox
7 136 0.999092346 ubox
8 15 0.006390936 ubox
8 21 0.004710672 ubox
8 37 0.035989181 ubox
8 41 0.010987117 ubox
8 119 0.003679910 ubox
8 135 0.999191553 ubox
9 14 0.005840709 ubox
9 20 0.004721609 ubox
9 36 0.036428019 ubox
9 40 0.009635223 ubox
9 118 0.003627643 ubox
9 133 0.003364655 ubox
9 134 0.998207363 ubox
10 19 0.004718672 ubox
10 35 0.037552115 ubox
10 117 0.003269638 ubox
10 133 0.997862827 ubox
10 134 0.005133609 ubox
11 18 0.004701800 ubox
11 34 0.037606370 ubox
11 132 0.994658719 ubox
11 136 0.004688365 ubox
13 33 0.038312211 ubox
13 43 0.004033747 ubox
13 46 0.007876657 ubox
13 49 0.022300630 ubox
13 128 0.009386327 ubox
13 131 0.992664703 ubox
14 27 0.009076275 ubox
14 28 0.005583135 ubox
14 32 0.038468913 ubox
14 42 0.004081102 ubox
14 45 0.008796625 ubox
14 48 0.022502241 ubox
14 127 0.009286431 ubox
14 130 0.992178819 ubox
15 23 0.003383444 ubox
15 26 0.015769704 ubox
15 27 0.004653667 ubox
15 31 0.038645892 ubox
15 42 0.004958766 ubox
15 47 0.022579978 ubox
15 130 0.043856319 ubox
15 132 0.091343587 ubox
16 22 0.003516362 ubox
16 24 0.005095686 ubox
16 25 0.015610969 ubox
16 30 0.038728123 ubox
16 40 0.004084611 ubox
16 41 0.004957167 ubox
16 43 0.014500906 ubox
16 46 0.022573321 ubox
16 121 0.003367021 ubox
16 128 0.990839455 ubox
16 129 0.056428205 ubox
16 131 0.102088702 ubox
17 23 0.006902033 ubox
17 26 0.113699822 ubox
17 31 0.021327998 ubox
17 39 0.003713993 ubox
17 42 0.018888909 ubox
17 45 0.018471765 ubox
17 120 0.006061961 ubox
17 127 0.961538267 ubox
17 130 0.102344669 ubox
17 132 0.007874588 ubox
18 22 0.008281068 ubox
18 24 0.019901136 ubox
18 25 0.117823429 ubox
18 30 0.073329927 ubox
18 40 0.007338493 ubox
18 41 0.019009517 ubox
18 43 0.008622601 ubox
18 44 0.017996278 ubox
18 119 0.006350898 ubox
18 121 0.049104969 ubox
18 128 0.031780054 ubox
18 129 0.102169506 ubox
18 131 0.008648732 ubox
19 23 0.012485830 ubox
19 28 0.985764870 ubox
19 39 0.006960254 ubox
19 42 0.009124000 ubox
19 127 0.018952575 ubox
19 130 0.008641499 ubox
20 27 0.986739513 ubox
21 26 0.985568217 ubox
21 27 0.011238286 ubox
21 28 0.025566634 ubox
21 32 0.004857889 ubox
22 26 0.014971222 ubox
22 27 0.018733091 ubox
22 31 0.005130935 ubox
22 34 0.035193171 ubox
22 127 0.034704255 ubox
23 29 0.010720927 ubox
23 30 0.005162387 ubox
23 33 0.035212293 ubox
23 49 0.003318008 ubox
23 121 0.015223477 ubox
23 126 0.036525014 ubox
23 128 0.007570571 ubox
24 28 0.011727731 ubox
24 32 0.035612286 ubox
24 48 0.005692240 ubox
24 120 0.014650183 ubox
24 127 0.008669928 ubox
25 31 0.035652140 ubox
25 45 0.004822547 ubox
25 47 0.005984609 ubox
25 120 0.012323381 ubox
26 30 0.035415585 ubox
26 44 0.005025515 ubox
26 46 0.005991933 ubox
26 118 0.014251349 ubox
26 119 0.012470435 ubox
26 122 0.006893043 ubox
26 123 0.051081038 ubox
26 124 0.044827697 ubox
26 125 0.024076735 ubox
27 43 0.004127130 ubox
27 117 0.013318042 ubox
27 118 0.009910227 ubox
27 121 0.006065356 ubox
27 122 0.051269418 ubox
27 123 0.044909315 ubox
27 124 0.024414818 ubox
27 125 0.004274730 ubox
27 126 0.009335793 ubox
28 43 0.004743685 ubox
28 49 0.008944361 ubox
28 121 0.051200823 ubox
28 122 0.044760266 ubox
28 123 0.024482445 ubox
28 124 0.005252120 ubox
28 125 0.009774084 ubox
29 48 0.008590573 ubox
30 42 0.061548593 ubox
30 45 0.946132997 ubox
30 47 0.005354055 ubox
31 41 0.061628483 ubox
31 44 0.995975263 ubox
31 46 0.003960562 ubox
32 40 0.061612836 ubox
32 43 0.996663219 ubox
33 39 0.048485678 ubox
33 42 0.996689861 ubox
34 40 0.066222262 ubox
34 41 0.993481281 ubox
35 39 0.075777823 ubox
39 131 0.003790692 ubox
40 127 0.004631502 ubox
40 130 0.005402770 ubox
41 130 0.004246858 ubox
41 132 0.007570624 ubox
41 136 0.032860207 ubox
42 128 0.005790806 ubox
42 129 0.004206655 ubox
42 131 0.007611918 ubox
42 135 0.032894893 ubox
43 127 0.005706409 ubox
43 130 0.007547365 ubox
44 120 0.008230622 ubox
44 132 0.033729143 ubox
45 119 0.008397397 ubox
45 121 0.317168777 ubox
45 128 0.006955230 ubox
45 131 0.033753993 ubox
46 120 0.995590412 ubox
46 127 0.004319816 ubox
46 130 0.033775299 ubox
47 118 0.067359703 ubox
47 119 0.995758030 ubox
47 122 0.031236094 ubox
47 123 0.004732631 ubox
47 129 0.033755482 ubox
48 117 0.077091896 ubox
48 118 0.921546813 ubox
48 121 0.031306742 ubox
48 122 0.004377564 ubox
48 128 0.033183411 ubox
49 116 0.056983716 ubox
49 120 0.031259848 ubox
49 127 0.032943625 ubox
50 116 0.993060531 ubox
50 120 0.003586933 ubox
51 115 0.999948143 ubox
51 119 0.003280497 ubox
52 114 0.999977529 ubox
53 113 0.999991864 ubox
54 112 0.999848354 ubox
55 111 0.999984443 ubox
56 110 0.998944381 ubox
57 108 0.996046806 ubox
58 107 0.999863705 ubox
59 106 0.999864062 ubox
60 105 0.999502326 ubox
60 108 0.015006250 ubox
61 104 0.999349233 ubox
61 107 0.015189699 ubox
62 69 0.030301637 ubox
63 68 0.034345960 ubox
63 103 0.981449108 ubox
63 106 0.015787505 ubox
64 102 0.967171799 ubox
64 105 0.021007756 ubox
65 104 0.025230012 ubox
66 105 0.004338998 ubox
67 96 0.003384642 ubox
67 99 0.635115002 ubox
67 104 0.006145248 ubox
68 95 0.003391460 ubox
68 98 0.634684842 ubox
68 102 0.076343398 ubox
69 94 0.003355519 ubox
69 97 0.633914435 ubox
69 100 0.652909953 ubox
69 101 0.066326139 ubox
70 96 0.633845722 ubox
70 99 0.771927332 ubox
71 80 0.004205788 ubox
71 95 0.632911627 ubox
71 98 0.772750819 ubox
72 79 0.004863522 ubox
72 89 0.022888268 ubox
72 97 0.773166609 ubox
73 81 0.005463800 ubox
73 87 0.022923406 ubox
73 88 0.016813340 ubox
73 96 0.773388832 ubox
74 80 0.005733146 ubox
74 86 0.023081936 ubox
74 87 0.016544317 ubox
74 95 0.773413455 ubox
75 79 0.005365671 ubox
75 84 0.021337736 ubox
75 85 0.015114931 ubox
75 90 0.638625514 ubox
75 92 0.017234578 ubox
75 93 0.027529282 ubox
75 94 0.765500350 ubox
76 83 0.024441742 ubox
76 89 0.647402708 ubox
76 91 0.019855887 ubox
76 92 0.047967595 ubox
76 93 0.757735888 ubox
77 88 0.650093446 ubox
78 88 0.098542314 ubox
79 86 0.747075339 ubox
79 87 0.090227252 ubox
80 85 0.748853363 ubox
80 91 0.397662419 ubox
80 92 0.085829382 ubox
80 93 0.005686176 ubox
81 89 0.444250447 ubox
81 90 0.372684123 ubox
81 91 0.081235079 ubox
81 92 0.008730260 ubox
82 88 0.499674005 ubox
83 87 0.493066956 ubox
86 92 0.082816459 ubox
86 93 0.016009989 ubox
87 91 0.083098502 ubox
87 92 0.029193521 ubox
87 93 0.003817307 ubox
88 92 0.005352393 ubox
119 130 0.021270707 ubox
119 132 0.009833234 ubox
120 128 0.025983911 ubox
120 129 0.020504019 ubox
120 131 0.011051044 ubox
121 127 0.120081470 ubox
121 130 0.012255878 ubox
127 137 0.003198135 ubox
129 136 0.015689451 ubox
130 135 0.015830350 ubox
6 137 0.9500000 lbox
7 136 0.9500000 lbox
8 135 0.9500000 lbox
9 134 0.9500000 lbox
10 133 0.9500000 lbox
11 132 0.9500000 lbox
13 131 0.9500000 lbox
14 130 0.9500000 lbox
16 128 0.9500000 lbox
17 127 0.9500000 lbox
19 28 0.9500000 lbox
20 27 0.9500000 lbox
21 26 0.9500000 lbox
30 45 0.9500000 lbox
31 44 0.9500000 lbox
32 43 0.9500000 lbox
33 42 0.9500000 lbox
34 41 0.9500000 lbox
46 120 0.9500000 lbox
47 119 0.9500000 lbox
48 118 0.9500000 lbox
50 116 0.9500000 lbox
51 115 0.9500000 lbox
52 114 0.9500000 lbox
53 113 0.9500000 lbox
54 112 0.9500000 lbox
55 111 0.9500000 lbox
56 110 0.9500000 lbox
57 108 0.9500000 lbox
58 107 0.9500000 lbox
59 106 0.9500000 lbox
60 105 0.9500000 lbox
61 104 0.9500000 lbox
63 103 0.9500000 lbox
64 102 0.9500000 lbox
67 99 0.9500000 lbox
68 98 0.9500000 lbox
69 97 0.9500000 lbox
70 96 0.9500000 lbox
71 95 0.9500000 lbox
75 90 0.9500000 lbox
76 89 0.9500000 lbox
77 88 0.9500000 lbox
79 86 0.9500000 lbox
80 85 0.9500000 lbox
showpage
end
%%EOF
