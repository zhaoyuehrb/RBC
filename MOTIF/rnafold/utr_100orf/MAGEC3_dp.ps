%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 04:18:35 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (MAGEC3)
} def

/sequence { (\
AUGCUGCUGCCCUGCCACUGGGUGUUGGAUGCCACCUUCAGUGAUGGCAGUCUAGGCCAGUGGGUGAAAAACACAUGUGCCACAUAUGCCUUAUCCCCAG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 61 0.043654182 ubox
1 65 0.007317214 ubox
1 85 0.008943192 ubox
1 94 0.004477740 ubox
2 54 0.021080530 ubox
2 59 0.160598366 ubox
2 60 0.047939045 ubox
2 62 0.026956154 ubox
2 64 0.006999602 ubox
2 66 0.005349555 ubox
2 84 0.009555630 ubox
2 93 0.005183423 ubox
2 99 0.012368385 ubox
3 10 0.030326807 ubox
3 15 0.008532520 ubox
3 51 0.014411894 ubox
3 53 0.023407838 ubox
3 57 0.667534849 ubox
3 58 0.129450869 ubox
3 61 0.526255721 ubox
3 65 0.011186086 ubox
3 83 0.009709648 ubox
3 89 0.018225501 ubox
3 92 0.004701578 ubox
3 98 0.012321160 ubox
4 9 0.030420650 ubox
4 14 0.008602463 ubox
4 50 0.015088275 ubox
4 55 0.121838154 ubox
4 56 0.678919808 ubox
4 60 0.605655248 ubox
4 63 0.046279027 ubox
4 64 0.009868499 ubox
4 88 0.018206926 ubox
4 100 0.021702039 ubox
5 49 0.014976732 ubox
5 54 0.126154729 ubox
5 55 0.670022006 ubox
5 59 0.605784328 ubox
5 62 0.050327460 ubox
5 63 0.007487503 ubox
5 99 0.021695953 ubox
6 15 0.019665880 ubox
6 48 0.014865645 ubox
6 51 0.711608361 ubox
6 53 0.050949254 ubox
6 57 0.237550388 ubox
6 58 0.555956155 ubox
6 61 0.276628607 ubox
6 98 0.017142663 ubox
7 14 0.019894105 ubox
7 47 0.014733558 ubox
7 50 0.722607750 ubox
7 55 0.096993280 ubox
7 56 0.325301557 ubox
7 60 0.317163961 ubox
7 100 0.005084019 ubox
8 24 0.004696180 ubox
8 46 0.014137024 ubox
8 49 0.722720746 ubox
8 54 0.106044483 ubox
8 55 0.320615416 ubox
8 59 0.316632190 ubox
8 99 0.005142056 ubox
9 15 0.008842369 ubox
9 23 0.010196659 ubox
9 45 0.007135737 ubox
9 48 0.722956126 ubox
9 51 0.012829139 ubox
9 53 0.102871298 ubox
9 57 0.552983285 ubox
9 58 0.224905996 ubox
9 65 0.004105887 ubox
9 98 0.004984725 ubox
10 14 0.008833807 ubox
10 22 0.010521505 ubox
10 47 0.719672689 ubox
10 50 0.010928977 ubox
10 56 0.598167824 ubox
10 64 0.004187274 ubox
11 21 0.010528219 ubox
11 46 0.715037294 ubox
11 47 0.068380901 ubox
11 55 0.597786210 ubox
11 56 0.028530616 ubox
11 63 0.003797925 ubox
12 20 0.010530134 ubox
12 41 0.011022859 ubox
12 46 0.096481414 ubox
12 47 0.010856360 ubox
12 50 0.687592912 ubox
12 55 0.026854764 ubox
12 62 0.003359088 ubox
12 100 0.009126646 ubox
13 40 0.011031052 ubox
13 43 0.021046869 ubox
13 46 0.019642969 ubox
13 49 0.689034375 ubox
13 54 0.019532708 ubox
13 66 0.003633507 ubox
13 99 0.009318765 ubox
14 23 0.004999460 ubox
14 39 0.010950586 ubox
14 42 0.028885301 ubox
14 45 0.237806935 ubox
14 48 0.689546422 ubox
14 53 0.005072397 ubox
14 65 0.005042283 ubox
14 98 0.009261236 ubox
15 22 0.005127717 ubox
15 41 0.029161670 ubox
15 47 0.689480832 ubox
15 50 0.003206624 ubox
15 63 0.021992425 ubox
15 64 0.004232662 ubox
16 21 0.005119663 ubox
16 43 0.765666999 ubox
16 46 0.638102496 ubox
16 62 0.024599609 ubox
17 42 0.894892724 ubox
17 45 0.436009559 ubox
17 61 0.026624406 ubox
18 41 0.992949996 ubox
18 60 0.027538669 ubox
18 100 0.007631808 ubox
19 40 0.985948153 ubox
19 43 0.046925947 ubox
19 59 0.027437115 ubox
19 99 0.007755140 ubox
20 33 0.003299067 ubox
20 36 0.014088662 ubox
20 37 0.368676514 ubox
20 38 0.043394872 ubox
20 39 0.918782073 ubox
20 42 0.020498660 ubox
20 58 0.026183385 ubox
20 98 0.007772362 ubox
21 32 0.003266234 ubox
21 33 0.057761331 ubox
21 35 0.015281155 ubox
21 36 0.849554687 ubox
21 37 0.137684727 ubox
21 38 0.491612250 ubox
21 39 0.012896999 ubox
21 57 0.024808926 ubox
21 58 0.008799203 ubox
21 97 0.007763262 ubox
22 32 0.058507062 ubox
22 35 0.861322139 ubox
22 36 0.192345988 ubox
22 37 0.440996081 ubox
22 38 0.016465889 ubox
22 42 0.005109670 ubox
22 57 0.012046928 ubox
22 96 0.007680517 ubox
23 31 0.058272372 ubox
23 34 0.860272442 ubox
23 40 0.045661143 ubox
23 56 0.014069862 ubox
24 30 0.053447840 ubox
24 32 0.222511613 ubox
24 33 0.829457668 ubox
24 35 0.472996125 ubox
24 39 0.046198355 ubox
25 29 0.051277712 ubox
25 31 0.310649687 ubox
25 34 0.339593444 ubox
25 55 0.022060180 ubox
26 34 0.361795937 ubox
26 54 0.028777640 ubox
27 33 0.493723456 ubox
27 36 0.066339828 ubox
27 37 0.004947564 ubox
27 52 0.004581470 ubox
27 53 0.029593184 ubox
28 32 0.486667331 ubox
28 35 0.066113355 ubox
28 36 0.005308376 ubox
28 51 0.003513236 ubox
28 52 0.029688911 ubox
29 51 0.028992906 ubox
30 49 0.024721688 ubox
30 50 0.016947299 ubox
31 48 0.030118400 ubox
32 47 0.030160659 ubox
33 43 0.004795544 ubox
33 46 0.030024534 ubox
34 42 0.007022829 ubox
34 45 0.027298614 ubox
35 41 0.008401859 ubox
37 44 0.006981671 ubox
38 43 0.006730892 ubox
38 44 0.014853545 ubox
39 43 0.015144179 ubox
41 94 0.004962725 ubox
42 93 0.005192709 ubox
43 92 0.005277182 ubox
44 91 0.005593232 ubox
45 59 0.011354553 ubox
46 58 0.012693873 ubox
46 90 0.020762240 ubox
46 98 0.003481465 ubox
47 57 0.012698371 ubox
47 89 0.020802626 ubox
47 97 0.003475684 ubox
48 56 0.012690267 ubox
48 88 0.020803311 ubox
49 87 0.020638069 ubox
51 93 0.005446430 ubox
52 60 0.015493661 ubox
52 100 0.010188773 ubox
53 59 0.015204276 ubox
53 93 0.034710180 ubox
53 99 0.010308450 ubox
54 91 0.145220691 ubox
54 92 0.026480833 ubox
55 81 0.057359806 ubox
55 90 0.158942848 ubox
55 91 0.007826236 ubox
55 98 0.008718846 ubox
56 65 0.004537418 ubox
56 80 0.057461634 ubox
56 89 0.159062899 ubox
56 90 0.007299433 ubox
56 97 0.008711629 ubox
57 64 0.004796135 ubox
57 79 0.057364940 ubox
57 88 0.157983274 ubox
58 63 0.004856080 ubox
58 77 0.048474195 ubox
58 79 0.003690825 ubox
58 88 0.019211402 ubox
59 76 0.047456904 ubox
59 78 0.004505118 ubox
59 87 0.025794152 ubox
60 74 0.045831599 ubox
60 76 0.031341094 ubox
60 80 0.003183148 ubox
60 83 0.079797605 ubox
60 85 0.135985458 ubox
60 87 0.008801754 ubox
61 73 0.045968436 ubox
61 75 0.033525101 ubox
61 79 0.003184556 ubox
61 82 0.080004455 ubox
61 84 0.137511686 ubox
61 86 0.009591263 ubox
61 99 0.703562198 ubox
62 72 0.045904961 ubox
62 74 0.033489460 ubox
62 78 0.003265806 ubox
62 81 0.079872513 ubox
62 83 0.137383738 ubox
62 85 0.008560810 ubox
62 90 0.004242929 ubox
62 91 0.007819461 ubox
62 96 0.088397698 ubox
62 97 0.093783968 ubox
62 98 0.973449782 ubox
63 80 0.079647234 ubox
63 81 0.137660036 ubox
63 89 0.004241401 ubox
63 90 0.008622671 ubox
63 95 0.088912067 ubox
63 96 0.094753974 ubox
63 97 0.974085512 ubox
63 98 0.047896619 ubox
64 72 0.041355454 ubox
64 74 0.061867051 ubox
64 76 0.031533034 ubox
64 80 0.137825708 ubox
64 83 0.012732059 ubox
64 89 0.008643938 ubox
64 94 0.089171737 ubox
64 95 0.095168225 ubox
64 96 0.973891795 ubox
64 97 0.048784647 ubox
65 71 0.042269767 ubox
65 73 0.063679367 ubox
65 75 0.033057125 ubox
65 77 0.003319676 ubox
65 79 0.135825578 ubox
65 82 0.012949334 ubox
65 84 0.003540298 ubox
65 88 0.005110297 ubox
65 93 0.097710184 ubox
65 99 0.003948105 ubox
66 72 0.064488871 ubox
66 74 0.035133565 ubox
66 76 0.004321216 ubox
66 78 0.081558777 ubox
66 81 0.012947362 ubox
66 83 0.003611028 ubox
66 92 0.096801796 ubox
66 95 0.964201246 ubox
66 98 0.004388274 ubox
67 91 0.091463539 ubox
67 92 0.067373209 ubox
67 94 0.947184042 ubox
68 91 0.065448146 ubox
68 92 0.178734095 ubox
69 91 0.175233241 ubox
69 92 0.517051342 ubox
70 91 0.495071981 ubox
70 92 0.405796917 ubox
71 78 0.064677034 ubox
71 91 0.432033274 ubox
72 77 0.066025910 ubox
72 79 0.005620610 ubox
72 88 0.194547844 ubox
73 78 0.005139991 ubox
73 87 0.192695683 ubox
74 88 0.960618687 ubox
75 85 0.190128999 ubox
75 87 0.963696218 ubox
76 82 0.003713543 ubox
76 84 0.198772389 ubox
76 86 0.964027399 ubox
76 93 0.003293693 ubox
77 81 0.003955588 ubox
77 83 0.199113229 ubox
77 85 0.964324843 ubox
77 92 0.003280986 ubox
78 82 0.179391244 ubox
78 84 0.963884471 ubox
79 83 0.948542884 ubox
79 89 0.006784117 ubox
80 88 0.006613035 ubox
84 94 0.010424278 ubox
85 93 0.011310803 ubox
86 92 0.011375333 ubox
87 93 0.003325551 ubox
87 99 0.003590523 ubox
88 98 0.003976376 ubox
90 100 0.004356056 ubox
91 99 0.004351600 ubox
92 99 0.004470326 ubox
3 57 0.9500000 lbox
4 56 0.9500000 lbox
5 55 0.9500000 lbox
6 51 0.9500000 lbox
7 50 0.9500000 lbox
8 49 0.9500000 lbox
9 48 0.9500000 lbox
10 47 0.9500000 lbox
11 46 0.9500000 lbox
16 43 0.9500000 lbox
17 42 0.9500000 lbox
18 41 0.9500000 lbox
19 40 0.9500000 lbox
20 39 0.9500000 lbox
21 36 0.9500000 lbox
22 35 0.9500000 lbox
23 34 0.9500000 lbox
24 33 0.9500000 lbox
61 99 0.9500000 lbox
62 98 0.9500000 lbox
63 97 0.9500000 lbox
64 96 0.9500000 lbox
66 95 0.9500000 lbox
67 94 0.9500000 lbox
74 88 0.9500000 lbox
75 87 0.9500000 lbox
76 86 0.9500000 lbox
77 85 0.9500000 lbox
78 84 0.9500000 lbox
79 83 0.9500000 lbox
showpage
end
%%EOF
