%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:26:02 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (HIST2H2AC)
} def

/sequence { (\
AUGUCUGGUCGUGGCAAACAAGGAGGCAAGGCCCGCGCCAAGGCCAAGUCGCGCUCGUCCCGCGCUGGCCUCCAGUUCCCGGUAGGGCGAGUGCACCGCU\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 9 0.010073082 ubox
1 12 0.015143142 ubox
1 49 0.031411243 ubox
2 8 0.011122015 ubox
2 11 0.015953193 ubox
2 16 0.139736914 ubox
2 20 0.044178647 ubox
2 28 0.168650927 ubox
2 37 0.003509142 ubox
2 46 0.100379083 ubox
2 48 0.034235684 ubox
2 51 0.021822148 ubox
2 89 0.006432581 ubox
2 95 0.005545751 ubox
2 98 0.021270076 ubox
3 10 0.032839741 ubox
3 15 0.155116608 ubox
3 19 0.049026724 ubox
3 27 0.187209868 ubox
3 32 0.005054182 ubox
3 36 0.005651392 ubox
3 44 0.423012524 ubox
3 45 0.079765007 ubox
3 49 0.040571784 ubox
3 50 0.465499191 ubox
3 88 0.010434292 ubox
3 94 0.003730878 ubox
3 96 0.025879083 ubox
3 97 0.028918512 ubox
3 99 0.066832778 ubox
4 14 0.154374936 ubox
4 18 0.048051022 ubox
4 23 0.015254008 ubox
4 24 0.022532391 ubox
4 26 0.186980282 ubox
4 31 0.005067446 ubox
4 35 0.005560607 ubox
4 43 0.431054438 ubox
4 48 0.082116542 ubox
4 87 0.010432304 ubox
4 93 0.003290605 ubox
4 95 0.024414239 ubox
4 98 0.063345230 ubox
5 13 0.154282968 ubox
5 14 0.016562897 ubox
5 22 0.019750437 ubox
5 23 0.024167386 ubox
5 25 0.186977881 ubox
5 26 0.008692890 ubox
5 30 0.005139297 ubox
5 42 0.433775185 ubox
5 43 0.013605509 ubox
5 48 0.479963471 ubox
5 86 0.010487166 ubox
5 91 0.003341039 ubox
6 13 0.016395822 ubox
6 16 0.047411179 ubox
6 20 0.008715253 ubox
6 21 0.018162637 ubox
6 22 0.023722546 ubox
6 24 0.182868580 ubox
6 25 0.008674347 ubox
6 28 0.004047650 ubox
6 29 0.004910801 ubox
6 40 0.329619015 ubox
6 41 0.306641961 ubox
6 42 0.009321117 ubox
6 46 0.709751355 ubox
6 47 0.339846907 ubox
6 85 0.010443197 ubox
6 90 0.003336448 ubox
6 98 0.068167260 ubox
7 12 0.018787670 ubox
7 15 0.048047422 ubox
7 19 0.011163623 ubox
7 27 0.004342088 ubox
7 33 0.008347407 ubox
7 39 0.453353282 ubox
7 45 0.827286278 ubox
7 97 0.095951721 ubox
7 100 0.012604268 ubox
8 15 0.012411874 ubox
8 19 0.024441769 ubox
8 27 0.008316578 ubox
8 32 0.008420694 ubox
8 38 0.453675478 ubox
8 44 0.827612196 ubox
8 88 0.003351000 ubox
8 96 0.095908257 ubox
8 99 0.013980513 ubox
9 14 0.012682494 ubox
9 18 0.024323657 ubox
9 23 0.085793624 ubox
9 24 0.032905427 ubox
9 26 0.008349963 ubox
9 31 0.008470992 ubox
9 37 0.221624821 ubox
9 43 0.827157481 ubox
9 82 0.010076457 ubox
9 87 0.003337456 ubox
9 95 0.085406072 ubox
9 98 0.011415388 ubox
10 22 0.105298585 ubox
10 23 0.043542319 ubox
10 25 0.008329605 ubox
10 30 0.008442912 ubox
10 35 0.203513471 ubox
10 37 0.395764849 ubox
10 42 0.820757464 ubox
10 81 0.010667261 ubox
10 86 0.003310733 ubox
10 98 0.007766239 ubox
11 19 0.132197851 ubox
11 27 0.003677774 ubox
11 34 0.204085162 ubox
11 36 0.404934551 ubox
11 38 0.005927836 ubox
11 80 0.010667666 ubox
11 96 0.007492795 ubox
11 97 0.007563996 ubox
11 99 0.184620411 ubox
12 18 0.132004947 ubox
12 20 0.152887505 ubox
12 26 0.003635867 ubox
12 28 0.004918851 ubox
12 35 0.403748274 ubox
12 37 0.005877110 ubox
12 40 0.793588856 ubox
12 46 0.014196457 ubox
12 95 0.007084119 ubox
12 98 0.184752561 ubox
13 19 0.157939662 ubox
13 27 0.004817083 ubox
13 33 0.293703962 ubox
13 34 0.346667620 ubox
13 36 0.004767457 ubox
13 39 0.827160976 ubox
13 45 0.015836071 ubox
13 50 0.003791754 ubox
13 79 0.010691232 ubox
13 94 0.003544234 ubox
13 97 0.185109778 ubox
13 100 0.019987151 ubox
14 27 0.018870924 ubox
14 32 0.359320512 ubox
14 33 0.263400609 ubox
14 36 0.009272520 ubox
14 38 0.827224890 ubox
14 44 0.015840150 ubox
14 49 0.003800360 ubox
14 78 0.010667570 ubox
14 96 0.184153414 ubox
14 99 0.022591467 ubox
15 26 0.022108827 ubox
15 31 0.414215995 ubox
15 35 0.010636251 ubox
15 37 0.826057408 ubox
15 43 0.015833995 ubox
15 48 0.003820557 ubox
15 98 0.022581210 ubox
16 77 0.004296015 ubox
17 76 0.003884856 ubox
17 77 0.008728642 ubox
18 49 0.006297795 ubox
18 76 0.010314185 ubox
19 48 0.006653678 ubox
19 75 0.010480953 ubox
21 100 0.010685601 ubox
22 33 0.302719903 ubox
22 34 0.474441891 ubox
22 39 0.010813725 ubox
22 45 0.003890938 ubox
22 50 0.020808036 ubox
22 73 0.011848456 ubox
22 97 0.069335608 ubox
22 99 0.011701701 ubox
22 100 0.015345228 ubox
23 32 0.304147744 ubox
23 33 0.380985943 ubox
23 38 0.010827231 ubox
23 44 0.003846731 ubox
23 49 0.020018880 ubox
23 50 0.032328499 ubox
23 72 0.011867896 ubox
23 96 0.069078313 ubox
23 99 0.017017462 ubox
24 49 0.031643342 ubox
24 71 0.011860713 ubox
25 33 0.611510862 ubox
25 34 0.169157397 ubox
25 39 0.009694043 ubox
25 45 0.104117971 ubox
25 50 0.241849610 ubox
25 70 0.011855159 ubox
25 97 0.016780900 ubox
25 100 0.023998753 ubox
26 32 0.682126285 ubox
26 33 0.157226142 ubox
26 36 0.145605701 ubox
26 38 0.009713816 ubox
26 44 0.104230839 ubox
26 49 0.243345109 ubox
26 69 0.011848818 ubox
26 94 0.003193602 ubox
26 96 0.016601555 ubox
26 99 0.026704408 ubox
27 31 0.680359913 ubox
27 35 0.145605451 ubox
27 37 0.009712930 ubox
27 43 0.104154388 ubox
27 48 0.243456990 ubox
27 68 0.011757774 ubox
27 93 0.003191899 ubox
27 98 0.026719316 ubox
30 39 0.113797262 ubox
30 45 0.308227152 ubox
30 50 0.006370045 ubox
31 38 0.114128692 ubox
31 44 0.308473829 ubox
31 49 0.006399945 ubox
31 88 0.003204315 ubox
32 37 0.113814664 ubox
32 43 0.307304090 ubox
32 48 0.006392475 ubox
32 87 0.003209681 ubox
33 42 0.305988700 ubox
33 43 0.026913396 ubox
33 86 0.003209488 ubox
34 42 0.038012692 ubox
34 85 0.003208519 ubox
35 44 0.008321621 ubox
35 99 0.004322241 ubox
36 43 0.008341765 ubox
36 98 0.004326135 ubox
37 44 0.007757492 ubox
37 97 0.003507890 ubox
38 43 0.007799999 ubox
41 71 0.003941137 ubox
41 100 0.009030280 ubox
42 50 0.025163120 ubox
42 70 0.004142297 ubox
42 97 0.004893218 ubox
42 99 0.007998157 ubox
42 100 0.118745371 ubox
43 49 0.025304875 ubox
43 69 0.004149709 ubox
43 96 0.004728834 ubox
43 99 0.137978290 ubox
44 48 0.025182411 ubox
44 68 0.004153005 ubox
44 98 0.138161445 ubox
45 67 0.004167475 ubox
46 66 0.003328407 ubox
47 66 0.005714468 ubox
47 100 0.431682964 ubox
48 65 0.006372390 ubox
48 94 0.003493380 ubox
48 96 0.488250731 ubox
48 99 0.479110799 ubox
49 95 0.487451459 ubox
49 98 0.474424303 ubox
50 64 0.006451970 ubox
50 67 0.003394648 ubox
50 98 0.045667692 ubox
51 63 0.006604125 ubox
51 65 0.010568713 ubox
51 94 0.998675244 ubox
51 97 0.019282589 ubox
51 99 0.009515995 ubox
52 62 0.006604146 ubox
52 64 0.010605838 ubox
52 93 0.999795028 ubox
52 98 0.009401632 ubox
53 61 0.006479476 ubox
53 63 0.010606743 ubox
53 92 0.999482021 ubox
53 97 0.007728675 ubox
54 62 0.010596529 ubox
54 91 0.999895686 ubox
55 90 0.999759854 ubox
56 89 0.999880009 ubox
57 88 0.999824926 ubox
58 86 0.026353756 ubox
58 87 0.938240998 ubox
59 82 0.007052282 ubox
59 85 0.036235909 ubox
59 86 0.936447920 ubox
59 87 0.343470297 ubox
60 81 0.006916551 ubox
60 82 0.403296777 ubox
60 85 0.845501495 ubox
60 86 0.345532607 ubox
60 87 0.009868613 ubox
61 81 0.567877286 ubox
61 85 0.347451707 ubox
61 86 0.010919096 ubox
62 69 0.005785041 ubox
62 80 0.567861411 ubox
62 83 0.662863490 ubox
62 94 0.003681165 ubox
63 68 0.005805426 ubox
63 81 0.140387421 ubox
63 82 0.667382881 ubox
63 93 0.003685161 ubox
64 76 0.877247954 ubox
64 80 0.129064939 ubox
64 83 0.446798639 ubox
64 92 0.003686475 ubox
65 75 0.890349931 ubox
65 82 0.452055030 ubox
65 91 0.003688971 ubox
66 74 0.890243683 ubox
66 81 0.452054766 ubox
66 90 0.003666888 ubox
67 73 0.890422396 ubox
67 77 0.032755888 ubox
67 78 0.017610605 ubox
67 79 0.026655096 ubox
67 80 0.451979571 ubox
68 72 0.876040011 ubox
68 76 0.045989092 ubox
68 77 0.015692313 ubox
68 78 0.032683847 ubox
68 79 0.447983578 ubox
68 83 0.003504419 ubox
68 88 0.003646539 ubox
69 75 0.093279153 ubox
69 82 0.003871299 ubox
69 87 0.003583371 ubox
70 81 0.003900481 ubox
70 86 0.003517488 ubox
71 85 0.003195593 ubox
72 82 0.006599341 ubox
73 81 0.006641824 ubox
77 81 0.006444805 ubox
78 87 0.007824046 ubox
79 86 0.008839791 ubox
80 85 0.009028267 ubox
90 100 0.008230244 ubox
91 99 0.009012934 ubox
92 98 0.008996741 ubox
93 97 0.008579049 ubox
93 99 0.004538414 ubox
94 98 0.004662104 ubox
6 46 0.9500000 lbox
7 45 0.9500000 lbox
8 44 0.9500000 lbox
9 43 0.9500000 lbox
10 42 0.9500000 lbox
12 40 0.9500000 lbox
13 39 0.9500000 lbox
14 38 0.9500000 lbox
15 37 0.9500000 lbox
25 33 0.9500000 lbox
26 32 0.9500000 lbox
27 31 0.9500000 lbox
51 94 0.9500000 lbox
52 93 0.9500000 lbox
53 92 0.9500000 lbox
54 91 0.9500000 lbox
55 90 0.9500000 lbox
56 89 0.9500000 lbox
57 88 0.9500000 lbox
58 87 0.9500000 lbox
59 86 0.9500000 lbox
60 85 0.9500000 lbox
62 83 0.9500000 lbox
63 82 0.9500000 lbox
64 76 0.9500000 lbox
65 75 0.9500000 lbox
66 74 0.9500000 lbox
67 73 0.9500000 lbox
68 72 0.9500000 lbox
showpage
end
%%EOF
