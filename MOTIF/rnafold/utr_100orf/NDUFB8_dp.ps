%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 05:08:52 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (NDUFB8)
} def

/sequence { (\
ACGUUUGGCCCGGCUCAGCCGCCGUGACAGGCCUUUGCGCAUGUGCAGAAGGGAAACGUGAAGAAGGUGAAGAUGGCGGUGGCCAGGGCCGGGGUCUUGGGAGUCCAGUGGCUGCAAAGGGCAUCCCGGAACGUGAUGCCGCUGGGCGCACGGACAGCCUCCCACAUGACCA\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 95 0.008695038 ubox
2 91 0.024058480 ubox
2 94 0.010279752 ubox
3 9 0.004261798 ubox
3 90 0.010534990 ubox
3 170 0.003277637 ubox
4 8 0.003996777 ubox
4 92 0.044237024 ubox
4 93 0.050398325 ubox
4 169 0.003239801 ubox
5 91 0.038160111 ubox
5 92 0.771058286 ubox
6 91 0.924282551 ubox
6 92 0.023621946 ubox
7 90 0.999244196 ubox
7 96 0.005626568 ubox
7 171 0.003305718 ubox
8 89 0.999477608 ubox
8 95 0.005598994 ubox
9 87 0.006528451 ubox
9 88 0.999456616 ubox
9 93 0.018059473 ubox
9 94 0.004870013 ubox
10 86 0.009218725 ubox
10 87 0.999432582 ubox
10 92 0.031823301 ubox
10 93 0.003980048 ubox
11 86 0.998892170 ubox
11 91 0.032015261 ubox
12 84 0.995566075 ubox
12 90 0.032157910 ubox
13 83 0.999379263 ubox
13 89 0.032159414 ubox
14 82 0.997520831 ubox
14 88 0.032153067 ubox
15 81 0.812592281 ubox
15 82 0.058220183 ubox
15 87 0.032081973 ubox
16 81 0.512090999 ubox
16 86 0.031818080 ubox
17 80 0.418752097 ubox
18 80 0.884128130 ubox
18 83 0.032081536 ubox
19 79 0.999197250 ubox
19 82 0.032125274 ubox
20 78 0.999460104 ubox
20 81 0.032129104 ubox
21 77 0.999465472 ubox
21 80 0.032115728 ubox
22 76 0.999479427 ubox
22 79 0.032128351 ubox
23 75 0.999440633 ubox
23 78 0.032127794 ubox
24 74 0.997040123 ubox
24 77 0.032124486 ubox
25 73 0.990497471 ubox
25 76 0.031955272 ubox
26 74 0.003485058 ubox
28 69 0.074645641 ubox
29 68 0.043310139 ubox
31 68 0.995040936 ubox
32 52 0.008482336 ubox
32 53 0.004744117 ubox
32 67 0.999888980 ubox
33 51 0.008504118 ubox
33 52 0.004739713 ubox
33 63 0.003303576 ubox
33 66 0.999886357 ubox
33 67 0.008109293 ubox
34 49 0.007771074 ubox
34 50 0.007356751 ubox
34 51 0.004584975 ubox
34 62 0.004804038 ubox
34 64 0.022275627 ubox
34 65 0.997731795 ubox
34 66 0.009526984 ubox
35 48 0.012192770 ubox
35 49 0.005947316 ubox
35 50 0.004325421 ubox
35 61 0.007842117 ubox
35 62 0.005990045 ubox
35 63 0.031277118 ubox
35 64 0.992207354 ubox
35 65 0.045398490 ubox
36 47 0.016788817 ubox
36 48 0.004388097 ubox
36 49 0.004110202 ubox
36 60 0.008886832 ubox
36 61 0.008171302 ubox
36 62 0.032288425 ubox
36 63 0.962955651 ubox
36 64 0.063030776 ubox
36 65 0.003306329 ubox
37 46 0.019040419 ubox
37 59 0.018431339 ubox
38 45 0.019035068 ubox
38 58 0.018523422 ubox
38 60 0.086865111 ubox
39 44 0.012330567 ubox
39 46 0.008625596 ubox
39 57 0.017875903 ubox
39 59 0.085983153 ubox
40 45 0.008746098 ubox
40 58 0.085127995 ubox
40 60 0.991856437 ubox
41 59 0.995327404 ubox
42 58 0.995104759 ubox
43 57 0.997409774 ubox
44 56 0.992249524 ubox
45 57 0.005159506 ubox
56 68 0.004199186 ubox
57 67 0.004357701 ubox
91 163 0.009630874 ubox
91 171 0.019640043 ubox
92 162 0.009657750 ubox
92 163 0.006355180 ubox
92 170 0.019454428 ubox
92 171 0.045702447 ubox
93 161 0.009650631 ubox
93 162 0.006377158 ubox
93 170 0.035500667 ubox
93 171 0.995938637 ubox
94 160 0.009090503 ubox
94 161 0.006352898 ubox
94 167 0.004573402 ubox
94 170 0.998932656 ubox
95 166 0.004680528 ubox
95 169 0.999226748 ubox
96 168 0.998588340 ubox
97 129 0.004588000 ubox
98 128 0.005717522 ubox
98 164 0.965653331 ubox
98 166 0.087185786 ubox
99 127 0.007142695 ubox
99 159 0.019565442 ubox
99 160 0.006979489 ubox
99 161 0.003794114 ubox
99 162 0.004532861 ubox
99 163 0.998427914 ubox
99 165 0.048612756 ubox
100 126 0.007176879 ubox
100 158 0.019815924 ubox
100 159 0.011442543 ubox
100 160 0.004164253 ubox
100 161 0.004734910 ubox
100 162 0.999402106 ubox
100 163 0.023193132 ubox
101 125 0.007177823 ubox
101 158 0.011774859 ubox
101 159 0.006246452 ubox
101 161 0.999468066 ubox
101 162 0.019464974 ubox
102 124 0.007151375 ubox
102 160 0.995785325 ubox
103 122 0.008073694 ubox
103 147 0.093406286 ubox
103 155 0.726973141 ubox
103 158 0.066916386 ubox
103 159 0.675925311 ubox
104 121 0.008101601 ubox
104 130 0.027692574 ubox
104 146 0.096947083 ubox
104 153 0.006083416 ubox
104 154 0.987057286 ubox
104 157 0.072367236 ubox
105 120 0.008143480 ubox
105 129 0.029753559 ubox
105 145 0.101252367 ubox
105 152 0.006204515 ubox
105 153 0.992068667 ubox
106 119 0.008181697 ubox
106 128 0.029743210 ubox
106 144 0.101314917 ubox
106 152 0.988339358 ubox
107 143 0.101294361 ubox
108 124 0.013121752 ubox
108 142 0.101317261 ubox
108 149 0.075718429 ubox
108 151 0.977071553 ubox
108 155 0.009711690 ubox
109 116 0.008219676 ubox
109 123 0.013272268 ubox
109 141 0.101260047 ubox
109 148 0.075642679 ubox
109 150 0.969110145 ubox
109 152 0.046074618 ubox
109 154 0.008578334 ubox
109 156 0.003201383 ubox
110 115 0.008549004 ubox
110 122 0.013112090 ubox
110 126 0.026210384 ubox
110 127 0.003894690 ubox
110 140 0.100975338 ubox
110 147 0.074513934 ubox
110 149 0.840313447 ubox
110 151 0.071364151 ubox
110 155 0.003248772 ubox
110 159 0.015478315 ubox
111 122 0.005825576 ubox
111 125 0.026202173 ubox
111 126 0.003818261 ubox
111 139 0.100936561 ubox
111 147 0.451276214 ubox
111 149 0.520270002 ubox
111 158 0.017779872 ubox
112 119 0.007154104 ubox
112 120 0.012928480 ubox
112 121 0.006296416 ubox
112 138 0.100724810 ubox
112 145 0.075304896 ubox
112 146 0.451377161 ubox
112 148 0.691231247 ubox
112 157 0.017783295 ubox
113 118 0.007373981 ubox
113 119 0.012752766 ubox
113 120 0.006226733 ubox
113 123 0.027603570 ubox
113 133 0.025095471 ubox
113 135 0.035007728 ubox
113 144 0.073441815 ubox
113 145 0.423805658 ubox
113 148 0.449364614 ubox
113 156 0.017721798 ubox
114 122 0.028716533 ubox
114 132 0.025600767 ubox
114 134 0.066403750 ubox
114 137 0.009722134 ubox
114 142 0.139946054 ubox
114 143 0.022448597 ubox
114 147 0.881350125 ubox
114 155 0.017507650 ubox
115 121 0.028698672 ubox
115 133 0.067100552 ubox
115 135 0.062701396 ubox
115 141 0.140381735 ubox
115 144 0.283992811 ubox
115 146 0.881781288 ubox
115 148 0.003168620 ubox
116 134 0.062385605 ubox
116 143 0.255338007 ubox
118 143 0.890249340 ubox
119 126 0.005624075 ubox
119 127 0.100390267 ubox
119 140 0.070311901 ubox
119 142 0.898766897 ubox
119 143 0.005268120 ubox
120 125 0.005686340 ubox
120 126 0.100418428 ubox
120 127 0.014938154 ubox
120 139 0.049766800 ubox
120 140 0.990938076 ubox
121 125 0.098796920 ubox
121 126 0.014768460 ubox
121 139 0.992993816 ubox
122 138 0.994234512 ubox
123 137 0.993865179 ubox
124 136 0.993943890 ubox
125 135 0.991355938 ubox
127 133 0.975846112 ubox
127 135 0.015125617 ubox
128 132 0.914443499 ubox
128 134 0.031411180 ubox
128 159 0.004739861 ubox
129 158 0.004765476 ubox
132 152 0.035083465 ubox
133 151 0.035839837 ubox
134 150 0.035835819 ubox
135 149 0.035829893 ubox
137 148 0.035484858 ubox
138 147 0.035855849 ubox
139 146 0.035856560 ubox
140 145 0.035844208 ubox
146 158 0.022570239 ubox
147 157 0.022679472 ubox
148 158 0.058582335 ubox
149 157 0.058667968 ubox
152 159 0.073269343 ubox
152 160 0.003315786 ubox
152 162 0.003401699 ubox
153 158 0.073191174 ubox
153 159 0.005220437 ubox
153 161 0.003791594 ubox
154 160 0.003625359 ubox
5 92 0.9500000 lbox
6 91 0.9500000 lbox
7 90 0.9500000 lbox
8 89 0.9500000 lbox
9 88 0.9500000 lbox
10 87 0.9500000 lbox
11 86 0.9500000 lbox
12 84 0.9500000 lbox
13 83 0.9500000 lbox
14 82 0.9500000 lbox
15 81 0.9500000 lbox
18 80 0.9500000 lbox
19 79 0.9500000 lbox
20 78 0.9500000 lbox
21 77 0.9500000 lbox
22 76 0.9500000 lbox
23 75 0.9500000 lbox
24 74 0.9500000 lbox
25 73 0.9500000 lbox
31 68 0.9500000 lbox
32 67 0.9500000 lbox
33 66 0.9500000 lbox
34 65 0.9500000 lbox
35 64 0.9500000 lbox
36 63 0.9500000 lbox
40 60 0.9500000 lbox
41 59 0.9500000 lbox
42 58 0.9500000 lbox
43 57 0.9500000 lbox
44 56 0.9500000 lbox
93 171 0.9500000 lbox
94 170 0.9500000 lbox
95 169 0.9500000 lbox
96 168 0.9500000 lbox
98 164 0.9500000 lbox
99 163 0.9500000 lbox
100 162 0.9500000 lbox
101 161 0.9500000 lbox
102 160 0.9500000 lbox
103 155 0.9500000 lbox
104 154 0.9500000 lbox
105 153 0.9500000 lbox
106 152 0.9500000 lbox
108 151 0.9500000 lbox
109 150 0.9500000 lbox
111 149 0.9500000 lbox
112 148 0.9500000 lbox
114 147 0.9500000 lbox
115 146 0.9500000 lbox
118 143 0.9500000 lbox
119 142 0.9500000 lbox
120 140 0.9500000 lbox
121 139 0.9500000 lbox
122 138 0.9500000 lbox
123 137 0.9500000 lbox
124 136 0.9500000 lbox
125 135 0.9500000 lbox
127 133 0.9500000 lbox
128 132 0.9500000 lbox
showpage
end
%%EOF
