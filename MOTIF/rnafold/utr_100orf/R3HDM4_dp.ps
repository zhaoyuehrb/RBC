%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:26:10 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (R3HDM4)
} def

/sequence { (\
CCCGUCACUUCCUGCCCGGCCCGGUGAAGGCCCUGCCGGGCGGCGGCGGCGGCGACAGCGUGCGAGCCAUGGUCGCGCUGGAGAACCCCGAGUGCGGCCCGGAGGCGGCGGAGGGCACCCCGGGCGGGCGGCGGCUGCUGCCCCUUCCCAGCUGCCUGCCUGCCCUAG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 111 0.046733795 ubox
1 114 0.014135197 ubox
1 115 0.008782775 ubox
2 52 0.006240152 ubox
2 108 0.004918282 ubox
2 110 0.033210866 ubox
2 111 0.996350962 ubox
2 113 0.010156227 ubox
2 114 0.008194894 ubox
3 51 0.006926411 ubox
3 107 0.004998502 ubox
3 110 0.999285651 ubox
3 113 0.007415115 ubox
4 50 0.006962928 ubox
4 106 0.005003806 ubox
4 109 0.999932436 ubox
5 49 0.006960743 ubox
5 105 0.004768839 ubox
5 108 0.999605697 ubox
6 48 0.006971744 ubox
6 104 0.004312545 ubox
6 107 0.998870211 ubox
8 46 0.007430754 ubox
8 104 0.053836565 ubox
8 105 0.998335645 ubox
9 45 0.007355334 ubox
9 103 0.053807175 ubox
9 104 0.997493434 ubox
10 102 0.053215580 ubox
10 103 0.997863603 ubox
11 43 0.005540888 ubox
11 45 0.004526181 ubox
11 101 0.053522821 ubox
11 102 0.998295016 ubox
12 42 0.008815539 ubox
12 43 0.191959273 ubox
12 101 0.979974964 ubox
12 102 0.006315353 ubox
13 42 0.600404169 ubox
13 45 0.008670359 ubox
13 101 0.008251527 ubox
14 41 0.996700536 ubox
14 44 0.070026508 ubox
14 47 0.010894675 ubox
14 100 0.007163495 ubox
15 40 0.997400362 ubox
15 43 0.068783284 ubox
15 46 0.010786223 ubox
16 39 0.997408907 ubox
16 42 0.067095798 ubox
16 43 0.016690422 ubox
16 45 0.010403415 ubox
17 38 0.997394834 ubox
17 42 0.021502470 ubox
18 37 0.997393370 ubox
18 41 0.017915012 ubox
19 36 0.997407503 ubox
19 41 0.069233742 ubox
20 35 0.996513069 ubox
20 40 0.071786056 ubox
21 30 0.073087564 ubox
21 39 0.071789692 ubox
22 29 0.073118245 ubox
22 35 0.004165654 ubox
22 38 0.071790292 ubox
23 32 0.991979863 ubox
23 33 0.056103889 ubox
23 34 0.011934142 ubox
23 37 0.071783974 ubox
24 31 0.993211953 ubox
24 32 0.050784977 ubox
24 33 0.012732956 ubox
24 36 0.071778463 ubox
25 30 0.981819742 ubox
25 35 0.070966612 ubox
26 34 0.053723473 ubox
28 34 0.019685333 ubox
29 33 0.020715437 ubox
42 47 0.013036946 ubox
42 53 0.004968519 ubox
42 68 0.680508808 ubox
42 70 0.033125641 ubox
42 99 0.012565140 ubox
42 100 0.012531002 ubox
43 50 0.032748481 ubox
43 63 0.006690240 ubox
43 67 0.682578941 ubox
43 98 0.012647733 ubox
43 99 0.006613675 ubox
44 49 0.032781139 ubox
44 51 0.006111751 ubox
44 62 0.006691996 ubox
44 64 0.006487125 ubox
44 66 0.682314935 ubox
44 71 0.006213359 ubox
44 97 0.012656939 ubox
44 101 0.005393661 ubox
45 50 0.006505572 ubox
45 61 0.005150921 ubox
45 63 0.010189411 ubox
45 68 0.726856500 ubox
45 70 0.005105147 ubox
45 100 0.003537534 ubox
46 53 0.004259867 ubox
46 59 0.003712284 ubox
46 61 0.007297469 ubox
46 63 0.473322423 ubox
46 67 0.727638351 ubox
46 95 0.008719095 ubox
47 52 0.004376302 ubox
47 58 0.003720393 ubox
47 60 0.008653469 ubox
47 62 0.473205185 ubox
47 64 0.296172780 ubox
47 66 0.727205177 ubox
47 94 0.008637722 ubox
48 59 0.007097411 ubox
48 61 0.370159580 ubox
48 63 0.267140581 ubox
48 68 0.054647576 ubox
48 89 0.003182770 ubox
48 93 0.007987450 ubox
49 59 0.274566296 ubox
49 61 0.307839946 ubox
49 63 0.814953401 ubox
49 67 0.054708124 ubox
49 88 0.003206664 ubox
50 58 0.274894931 ubox
50 60 0.401664494 ubox
50 62 0.825665222 ubox
50 64 0.092744356 ubox
50 66 0.054652695 ubox
50 90 0.007940099 ubox
51 59 0.323928485 ubox
51 61 0.717300903 ubox
51 63 0.090636853 ubox
51 68 0.031479388 ubox
51 87 0.003362562 ubox
51 89 0.007937973 ubox
52 59 0.848075939 ubox
52 61 0.226933160 ubox
52 63 0.068631014 ubox
52 67 0.031513155 ubox
52 86 0.003363693 ubox
52 88 0.007878977 ubox
53 58 0.881444124 ubox
53 60 0.299997634 ubox
53 62 0.070329542 ubox
53 64 0.019550865 ubox
53 66 0.031398500 ubox
54 59 0.294834591 ubox
54 61 0.053761413 ubox
54 63 0.020433324 ubox
55 61 0.022241959 ubox
56 60 0.026331010 ubox
56 62 0.021397941 ubox
56 80 0.008755282 ubox
57 61 0.017385574 ubox
57 79 0.008768444 ubox
58 67 0.007915625 ubox
58 78 0.008768406 ubox
59 66 0.007934607 ubox
59 77 0.008765356 ubox
60 67 0.004693940 ubox
60 70 0.004385396 ubox
60 76 0.008650142 ubox
61 66 0.004626258 ubox
61 69 0.004538863 ubox
61 75 0.008616627 ubox
61 110 0.003627892 ubox
62 68 0.004578965 ubox
62 74 0.008536448 ubox
62 109 0.005512807 ubox
63 72 0.008428959 ubox
63 108 0.005510814 ubox
66 106 0.007870399 ubox
67 102 0.003512294 ubox
67 105 0.007878840 ubox
68 101 0.004431042 ubox
68 104 0.007867498 ubox
70 101 0.026749794 ubox
71 99 0.989888027 ubox
71 100 0.115752856 ubox
72 98 0.996493839 ubox
72 99 0.082267263 ubox
73 97 0.999509423 ubox
74 96 0.999828682 ubox
75 95 0.999941079 ubox
76 94 0.999929068 ubox
77 93 0.999541744 ubox
78 92 0.999832914 ubox
79 90 0.476502618 ubox
79 91 0.870726606 ubox
80 87 0.103896524 ubox
80 88 0.194954984 ubox
80 89 0.969982102 ubox
81 86 0.103646834 ubox
81 87 0.198269433 ubox
81 88 0.968667396 ubox
110 121 0.008064694 ubox
111 120 0.008376749 ubox
112 166 0.240313036 ubox
113 119 0.047574291 ubox
113 120 0.132936294 ubox
113 121 0.943634309 ubox
113 165 0.247545065 ubox
114 118 0.046962730 ubox
114 119 0.133048549 ubox
114 120 0.944703245 ubox
114 121 0.114028460 ubox
114 164 0.247580112 ubox
115 119 0.929451536 ubox
115 120 0.112823346 ubox
115 163 0.247577012 ubox
116 162 0.242372949 ubox
117 161 0.171692735 ubox
121 158 0.018945915 ubox
121 162 0.050463826 ubox
122 149 0.004074171 ubox
122 157 0.019189325 ubox
122 160 0.015423585 ubox
122 161 0.177262308 ubox
122 164 0.003392135 ubox
122 165 0.967570479 ubox
122 166 0.011890091 ubox
123 148 0.004079631 ubox
123 156 0.019219356 ubox
123 159 0.010936386 ubox
123 160 0.246266403 ubox
123 164 0.968785685 ubox
123 165 0.010197370 ubox
124 147 0.004076172 ubox
124 155 0.019217661 ubox
124 159 0.246543171 ubox
124 163 0.968822015 ubox
124 164 0.007216135 ubox
125 154 0.019205652 ubox
125 158 0.246777599 ubox
125 162 0.968826137 ubox
126 143 0.016573359 ubox
126 149 0.008174811 ubox
126 153 0.005517407 ubox
126 157 0.246598634 ubox
126 160 0.005806885 ubox
126 161 0.968103839 ubox
127 142 0.016756834 ubox
127 148 0.008259411 ubox
127 152 0.004431824 ubox
127 156 0.246776210 ubox
127 159 0.005828462 ubox
127 160 0.968829398 ubox
128 141 0.016826706 ubox
128 147 0.008273370 ubox
128 155 0.246775870 ubox
128 159 0.968835858 ubox
129 140 0.016846387 ubox
129 154 0.246767235 ubox
129 158 0.968412556 ubox
130 139 0.016834678 ubox
130 142 0.003352928 ubox
130 144 0.010907435 ubox
130 145 0.006079539 ubox
130 149 0.003442406 ubox
130 153 0.246401549 ubox
130 156 0.938287214 ubox
130 157 0.234794829 ubox
130 160 0.004539813 ubox
131 138 0.016847244 ubox
131 141 0.003383110 ubox
131 143 0.010984202 ubox
131 144 0.006314575 ubox
131 148 0.003412441 ubox
131 152 0.246565745 ubox
131 155 0.951903170 ubox
131 156 0.161880533 ubox
131 159 0.004585327 ubox
132 137 0.016823207 ubox
132 140 0.003394453 ubox
132 151 0.246416100 ubox
132 154 0.964830406 ubox
132 158 0.004619144 ubox
133 139 0.003434567 ubox
133 142 0.243611816 ubox
133 143 0.017543856 ubox
133 144 0.007531659 ubox
133 148 0.008688361 ubox
133 149 0.028524455 ubox
133 153 0.964125269 ubox
133 156 0.079563107 ubox
134 138 0.003363580 ubox
134 141 0.244171316 ubox
134 142 0.012732192 ubox
134 143 0.007164444 ubox
134 147 0.008459932 ubox
134 148 0.027805584 ubox
134 152 0.964619166 ubox
134 155 0.087738480 ubox
135 140 0.244419328 ubox
135 151 0.964554376 ubox
135 154 0.087605897 ubox
136 150 0.963572448 ubox
137 149 0.957602070 ubox
137 152 0.090412223 ubox
138 151 0.091293471 ubox
139 150 0.093704396 ubox
140 149 0.095991241 ubox
144 151 0.004839186 ubox
145 150 0.008231999 ubox
146 150 0.005069260 ubox
151 159 0.003999670 ubox
152 158 0.004021022 ubox
2 111 0.9500000 lbox
3 110 0.9500000 lbox
4 109 0.9500000 lbox
5 108 0.9500000 lbox
6 107 0.9500000 lbox
8 105 0.9500000 lbox
9 104 0.9500000 lbox
10 103 0.9500000 lbox
11 102 0.9500000 lbox
12 101 0.9500000 lbox
13 42 0.9500000 lbox
14 41 0.9500000 lbox
15 40 0.9500000 lbox
16 39 0.9500000 lbox
17 38 0.9500000 lbox
18 37 0.9500000 lbox
19 36 0.9500000 lbox
20 35 0.9500000 lbox
23 32 0.9500000 lbox
24 31 0.9500000 lbox
25 30 0.9500000 lbox
45 68 0.9500000 lbox
46 67 0.9500000 lbox
47 66 0.9500000 lbox
49 63 0.9500000 lbox
50 62 0.9500000 lbox
51 61 0.9500000 lbox
52 59 0.9500000 lbox
53 58 0.9500000 lbox
71 99 0.9500000 lbox
72 98 0.9500000 lbox
73 97 0.9500000 lbox
74 96 0.9500000 lbox
75 95 0.9500000 lbox
76 94 0.9500000 lbox
77 93 0.9500000 lbox
78 92 0.9500000 lbox
79 91 0.9500000 lbox
80 89 0.9500000 lbox
81 88 0.9500000 lbox
113 121 0.9500000 lbox
114 120 0.9500000 lbox
115 119 0.9500000 lbox
122 165 0.9500000 lbox
123 164 0.9500000 lbox
124 163 0.9500000 lbox
125 162 0.9500000 lbox
126 161 0.9500000 lbox
127 160 0.9500000 lbox
128 159 0.9500000 lbox
129 158 0.9500000 lbox
130 156 0.9500000 lbox
131 155 0.9500000 lbox
132 154 0.9500000 lbox
133 153 0.9500000 lbox
134 152 0.9500000 lbox
135 151 0.9500000 lbox
136 150 0.9500000 lbox
137 149 0.9500000 lbox
showpage
end
%%EOF
