%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:06:05 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
UAUAUCCAAGGUGCAGCAGCUGAGCAUUCCAAAUUCGGGAACCACCAGAAAGGCUGGCCUCUCUUCAACAUGGGAUCUUCUGGACUUUUGAGCCUCCUGGUGCUAUUCGUCCUCUUAGCGAAUGUCCAGGGACCUGGUCUGACUGAUUGGUUAUUUCCCAGGAGAUGUC\
) } def
/len { sequence length } bind def

/coor [
[-20.94001579 201.31587219]
[-29.66573334 213.51676941]
[-42.50843811 221.26692200]
[-57.36999512 223.30018616]
[-71.82244110 219.28436279]
[-83.50465393 209.87553406]
[-90.50807953 196.61083984]
[-91.68856049 181.65736389]
[-86.85383606 167.45909119]
[-101.20289612 171.82994080]
[-115.55196381 176.20079041]
[-129.90103149 180.57162476]
[-137.23297119 186.08670044]
[-144.55577087 184.88803101]
[-158.98315430 188.99296570]
[-173.41053772 193.09791565]
[-187.83792114 197.20286560]
[-196.38168335 214.07766724]
[-214.22969055 219.29902649]
[-229.97279358 210.01298523]
[-244.23864746 214.64823914]
[-258.50448608 219.28349304]
[-261.78494263 234.22290039]
[-272.03500366 245.44041443]
[-286.42800903 249.99098206]
[-301.06832886 246.74797058]
[-312.04574585 236.68009949]
[-326.31158447 241.31535339]
[-340.57745361 245.95060730]
[-354.84329224 250.58586121]
[-360.53308105 265.15158081]
[-374.27911377 272.60684204]
[-389.59091187 269.43148804]
[-399.23870850 257.12484741]
[-398.66714478 241.49771118]
[-388.14605713 229.92875671]
[-372.64318848 227.88047791]
[-359.47854614 236.32000732]
[-345.21270752 231.68475342]
[-330.94683838 227.04949951]
[-316.68099976 222.41424561]
[-313.71783447 207.81680298]
[-303.77975464 196.58779907]
[-289.46081543 191.80928040]
[-274.57482910 194.85960388]
[-263.13973999 205.01763916]
[-248.87390137 200.38238525]
[-234.60804749 195.74713135]
[-231.73741150 184.65788269]
[-223.77488708 176.25691223]
[-212.62626648 172.72395325]
[-201.04293823 175.05284119]
[-191.94287109 182.77546692]
[-177.51548767 178.67053223]
[-163.08810425 174.56558228]
[-148.66072083 170.46063232]
[-134.27188110 166.22256470]
[-119.92281342 161.85171509]
[-105.57374573 157.48086548]
[-91.22467804 153.11003113]
[-86.58942413 138.84417725]
[-95.62894440 126.87391663]
[-104.66846466 114.90366364]
[-120.17981720 115.32502747]
[-132.95736694 106.52083588]
[-138.08789062 91.87647247]
[-133.59858704 77.02299500]
[-121.21569061 67.67186737]
[-105.70068359 67.41879272]
[-93.01939392 76.36107635]
[-88.04803467 91.06023407]
[-92.69820404 105.86414337]
[-83.65868378 117.83439636]
[-74.61916351 129.80465698]
[-60.44140625 134.70274353]
[-45.94063187 130.86509705]
[-31.43985558 127.02745819]
[-16.93907928 123.18981171]
[-2.43830347 119.35217285]
[12.06247234 115.51452637]
[26.56324768 111.67688751]
[41.06402588 107.83924866]
[55.56480026 104.00160217]
[55.39165115 94.39649963]
[57.28655243 84.90342712]
[61.19301605 75.96584320]
[66.95986938 68.00802612]
[74.34690094 61.41495132]
[83.03479004 56.51372528]
[92.63880157 53.55744934]
[102.72584534 52.71228790]
[112.83398438 54.04846573]
[122.49356842 57.53557587]
[131.24909973 63.04257584]
[138.68064880 70.34243774]
[144.42399597 79.12142181]
[157.32099915 71.46195221]
[170.21798706 63.80248260]
[183.11499023 56.14301300]
[196.01199341 48.48354721]
[201.82113647 41.38234329]
[209.21884155 40.80423737]
[222.25517273 33.38439941]
[228.19454956 26.39175224]
[235.60166931 25.95044708]
[248.77288818 18.77277184]
[261.94412231 11.59509945]
[275.11532593 4.41742563]
[288.28656006 -2.76024795]
[301.45776367 -9.93792152]
[304.37423706 -25.30113220]
[316.51629639 -35.15527725]
[332.15084839 -34.84753036]
[343.89575195 -24.52320290]
[346.20538330 -9.05712414]
[337.98922729 4.24809599]
[323.12670898 9.11013889]
[308.63543701 3.23329735]
[295.46423340 10.41097069]
[282.29299927 17.58864403]
[269.12179565 24.76631737]
[255.95056152 31.94399071]
[242.77934265 39.12166595]
[229.67501831 46.42073059]
[216.63867188 53.84056854]
[203.67146301 61.38054276]
[190.77445984 69.04000854]
[177.87745667 76.69947815]
[164.98046875 84.35894775]
[152.08346558 92.01841736]
[152.22206116 107.01777649]
[165.25839233 114.43761444]
[178.29473877 121.85745239]
[191.33106995 129.27728271]
[200.37617493 130.81330872]
[204.53791809 136.95660400]
[217.43492126 144.61607361]
[230.33190918 152.27552795]
[243.22891235 159.93499756]
[259.06771851 157.38328552]
[270.84069824 168.28176880]
[269.51657104 184.27008057]
[256.11114502 193.08335876]
[240.90788269 187.96080017]
[235.56944275 172.83200073]
[222.67243958 165.17253113]
[209.77545166 157.51306152]
[196.87844849 149.85359192]
[183.91122437 142.31362915]
[170.87489319 134.89378357]
[157.83856201 127.47394562]
[144.80223083 120.05410767]
[133.57325745 134.78001404]
[117.89971161 144.10136414]
[100.15830994 146.85009766]
[82.94984436 142.83673096]
[68.71799469 132.84779358]
[59.40244293 118.50238037]
[44.90166473 122.34001923]
[30.40089035 126.17766571]
[15.90011406 130.01530457]
[1.39933813 133.85295105]
[-13.10143757 137.69058228]
[-27.60221481 141.52822876]
[-42.10298920 145.36587524]
[-56.60376740 149.20350647]
[-41.78743362 151.54367065]
[-29.10774612 159.55775452]
[-20.63620377 171.93647766]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[9 60]
[10 59]
[11 58]
[12 57]
[14 56]
[15 55]
[16 54]
[17 53]
[20 48]
[21 47]
[22 46]
[27 41]
[28 40]
[29 39]
[30 38]
[61 74]
[62 73]
[63 72]
[75 166]
[76 165]
[77 164]
[78 163]
[79 162]
[80 161]
[81 160]
[82 159]
[83 158]
[96 130]
[97 129]
[98 128]
[99 127]
[100 126]
[102 125]
[103 124]
[105 123]
[106 122]
[107 121]
[108 120]
[109 119]
[110 118]
[131 152]
[132 151]
[133 150]
[134 149]
[136 148]
[137 147]
[138 146]
[139 145]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
