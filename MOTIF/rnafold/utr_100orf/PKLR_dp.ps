%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 01:42:32 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (PKLR)
} def

/sequence { (\
CAUUCCAUGGUCCCGCAGCCCCAGGCCCACACUGAAAGCAUGUCGAUCCAGGAGAACAUAUCAUCCCUGCAGCUUCGGUCAUGGGUCUCUAAGUCCCAAAGAGACUUAGCAAAGUCCAUCCUGAUUGGGGCUCCAGGAG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 9 0.078967004 ubox
2 8 0.077576650 ubox
2 11 0.009079506 ubox
2 59 0.006616034 ubox
3 7 0.068809678 ubox
3 10 0.010218409 ubox
3 53 0.005415690 ubox
3 54 0.100384798 ubox
3 55 0.010729786 ubox
3 56 0.008077566 ubox
3 58 0.005772278 ubox
3 138 0.031766497 ubox
3 139 0.633187148 ubox
4 9 0.008226803 ubox
4 10 0.010169234 ubox
4 52 0.003181600 ubox
4 53 0.154178979 ubox
4 54 0.006513440 ubox
4 55 0.008608862 ubox
4 137 0.018414816 ubox
4 138 0.933548068 ubox
5 9 0.013356489 ubox
5 51 0.003226176 ubox
5 52 0.158905044 ubox
5 54 0.008504746 ubox
5 136 0.018454106 ubox
5 137 0.959805822 ubox
6 51 0.158696406 ubox
6 136 0.958303144 ubox
8 15 0.005913433 ubox
8 17 0.009048785 ubox
8 50 0.144056843 ubox
8 135 0.953263288 ubox
9 14 0.008296831 ubox
9 16 0.015188745 ubox
9 20 0.008460386 ubox
9 48 0.066806192 ubox
9 49 0.144468797 ubox
9 132 0.030267619 ubox
9 133 0.025210132 ubox
9 134 0.959247002 ubox
10 16 0.017402576 ubox
10 19 0.008549713 ubox
10 47 0.068131373 ubox
10 48 0.143889329 ubox
10 131 0.038286617 ubox
10 132 0.009009190 ubox
10 133 0.958706662 ubox
11 15 0.016899534 ubox
11 18 0.008314869 ubox
11 46 0.120448853 ubox
11 130 0.040880724 ubox
11 137 0.003556078 ubox
11 138 0.188022125 ubox
12 45 0.120849979 ubox
12 129 0.041998215 ubox
12 130 0.021028242 ubox
12 136 0.004486561 ubox
12 137 0.200574506 ubox
13 128 0.042009339 ubox
13 129 0.021015701 ubox
13 130 0.029576342 ubox
13 136 0.199866588 ubox
13 137 0.107529993 ubox
14 42 0.006497070 ubox
14 45 0.061064099 ubox
14 127 0.041981080 ubox
14 128 0.020892257 ubox
14 129 0.029553624 ubox
14 136 0.108628146 ubox
15 41 0.005898461 ubox
15 43 0.143067962 ubox
15 44 0.061928513 ubox
15 126 0.028776910 ubox
15 131 0.003491749 ubox
16 42 0.158094039 ubox
16 123 0.030573216 ubox
16 127 0.032332346 ubox
17 41 0.157133709 ubox
17 122 0.030679589 ubox
17 126 0.028842164 ubox
17 132 0.975693339 ubox
18 26 0.006771597 ubox
18 39 0.157581645 ubox
18 121 0.030315016 ubox
18 125 0.021235887 ubox
18 131 0.985444744 ubox
19 25 0.006834628 ubox
19 38 0.157542498 ubox
19 130 0.985512183 ubox
20 24 0.006792831 ubox
20 129 0.985507979 ubox
21 127 0.003466815 ubox
21 128 0.985442264 ubox
21 129 0.004201641 ubox
22 34 0.156493718 ubox
22 123 0.015301603 ubox
22 127 0.984387625 ubox
22 128 0.005040800 ubox
23 33 0.157138652 ubox
23 88 0.833177198 ubox
23 122 0.016273841 ubox
23 126 0.421405478 ubox
24 32 0.157123828 ubox
24 33 0.024410469 ubox
24 87 0.980574006 ubox
24 88 0.042106812 ubox
24 89 0.004101476 ubox
24 121 0.017261177 ubox
24 125 0.058961450 ubox
25 32 0.024751825 ubox
25 86 0.985281451 ubox
25 87 0.045367913 ubox
25 120 0.015261756 ubox
26 85 0.987122048 ubox
27 84 0.987132253 ubox
28 83 0.987007889 ubox
28 123 0.003629597 ubox
29 79 0.003402587 ubox
29 82 0.956577801 ubox
29 122 0.003231010 ubox
30 78 0.003784999 ubox
31 79 0.960576121 ubox
32 78 0.986690583 ubox
33 40 0.003513931 ubox
33 77 0.986162712 ubox
33 81 0.015016108 ubox
34 39 0.003695920 ubox
34 76 0.986466834 ubox
34 80 0.015176008 ubox
35 74 0.003500870 ubox
35 75 0.805097901 ubox
35 79 0.015056381 ubox
36 74 0.566251063 ubox
36 75 0.565756721 ubox
37 74 0.802478722 ubox
38 70 0.021913333 ubox
38 73 0.986118952 ubox
39 69 0.021355956 ubox
39 72 0.984790654 ubox
40 47 0.055870316 ubox
40 59 0.011774821 ubox
40 68 0.018056119 ubox
40 82 0.004086440 ubox
41 46 0.059677040 ubox
41 50 0.014670817 ubox
41 58 0.012759984 ubox
41 69 0.003696334 ubox
41 71 0.954505577 ubox
41 81 0.005608188 ubox
42 49 0.017801115 ubox
42 57 0.012803015 ubox
42 70 0.959626397 ubox
42 73 0.014446337 ubox
42 80 0.005652484 ubox
43 52 0.003475942 ubox
43 53 0.005238816 ubox
43 55 0.007717167 ubox
43 56 0.010212234 ubox
43 69 0.515717845 ubox
43 72 0.014260791 ubox
43 78 0.006534408 ubox
44 51 0.009416637 ubox
44 52 0.006801720 ubox
44 54 0.010793736 ubox
44 69 0.149008400 ubox
44 77 0.006835076 ubox
45 62 0.006594656 ubox
45 65 0.073503369 ubox
45 68 0.106017342 ubox
45 76 0.006845955 ubox
46 61 0.006556783 ubox
46 64 0.073224170 ubox
46 75 0.006788641 ubox
47 53 0.007506143 ubox
47 55 0.007915446 ubox
47 60 0.005991478 ubox
47 63 0.070729914 ubox
48 52 0.007728919 ubox
48 54 0.008651839 ubox
49 69 0.825980811 ubox
50 68 0.965005066 ubox
51 62 0.022358962 ubox
51 65 0.017600791 ubox
51 66 0.198734986 ubox
51 67 0.961833226 ubox
51 68 0.032929747 ubox
52 61 0.019635383 ubox
52 62 0.070435460 ubox
52 64 0.017656976 ubox
52 65 0.228966033 ubox
52 66 0.954934513 ubox
52 67 0.033488113 ubox
53 61 0.070657094 ubox
53 64 0.253932922 ubox
53 68 0.005329492 ubox
54 62 0.290321649 ubox
54 65 0.913750718 ubox
54 67 0.005374606 ubox
55 61 0.278895176 ubox
55 64 0.901245506 ubox
58 64 0.011736515 ubox
59 63 0.020095600 ubox
62 69 0.003419048 ubox
64 138 0.032286779 ubox
65 137 0.028244892 ubox
66 136 0.020107100 ubox
66 137 0.156398482 ubox
67 136 0.158028565 ubox
68 135 0.159232043 ubox
69 134 0.159092177 ubox
71 132 0.155814577 ubox
72 131 0.159345792 ubox
73 130 0.159348048 ubox
74 129 0.159162462 ubox
75 128 0.158882935 ubox
76 127 0.159308972 ubox
77 126 0.158814456 ubox
78 125 0.159168337 ubox
79 124 0.159329356 ubox
80 123 0.159332611 ubox
81 119 0.069472980 ubox
81 122 0.141121227 ubox
82 98 0.015743541 ubox
82 108 0.008232708 ubox
82 118 0.125349822 ubox
83 97 0.017469723 ubox
83 107 0.008456785 ubox
83 117 0.126108160 ubox
83 120 0.029132032 ubox
83 121 0.069377155 ubox
84 96 0.017477811 ubox
84 106 0.008851976 ubox
84 116 0.125894261 ubox
84 117 0.067444662 ubox
84 119 0.007613858 ubox
84 120 0.068026190 ubox
85 95 0.017467078 ubox
85 105 0.010747231 ubox
85 115 0.121192196 ubox
85 116 0.069383256 ubox
85 119 0.065960524 ubox
86 104 0.011186475 ubox
86 114 0.018485869 ubox
86 118 0.064792728 ubox
87 93 0.016996372 ubox
87 103 0.013334937 ubox
87 114 0.149864987 ubox
88 92 0.015363499 ubox
88 102 0.029304882 ubox
88 113 0.149352703 ubox
88 124 0.003801887 ubox
89 101 0.031584680 ubox
89 109 0.979257664 ubox
89 114 0.004786240 ubox
89 123 0.003679401 ubox
90 100 0.030783939 ubox
90 108 0.994789736 ubox
90 113 0.003832605 ubox
91 107 0.995795591 ubox
92 106 0.996203517 ubox
92 126 0.043038507 ubox
92 132 0.014890532 ubox
93 105 0.996783657 ubox
93 125 0.049954080 ubox
93 131 0.015755661 ubox
94 102 0.020891174 ubox
94 104 0.996435369 ubox
94 124 0.050562426 ubox
94 130 0.015753810 ubox
95 101 0.025358910 ubox
95 103 0.995040696 ubox
95 123 0.050474965 ubox
95 129 0.015778113 ubox
96 128 0.015795361 ubox
97 123 0.018994985 ubox
97 127 0.015804308 ubox
98 122 0.018695303 ubox
98 126 0.015688181 ubox
99 125 0.014489581 ubox
100 122 0.014770149 ubox
101 120 0.029542050 ubox
101 121 0.013892471 ubox
102 119 0.028839768 ubox
102 122 0.007797264 ubox
103 116 0.078105268 ubox
103 121 0.005066844 ubox
104 115 0.078712812 ubox
105 114 0.078810134 ubox
106 113 0.078081250 ubox
107 112 0.071389135 ubox
107 123 0.004294096 ubox
108 122 0.004964578 ubox
109 115 0.016844882 ubox
109 121 0.005540285 ubox
109 125 0.003880630 ubox
110 114 0.030471234 ubox
110 123 0.097473264 ubox
110 127 0.017789086 ubox
111 122 0.089854126 ubox
111 126 0.030646072 ubox
112 125 0.023405026 ubox
112 126 0.056091830 ubox
113 122 0.183328315 ubox
113 125 0.047558297 ubox
113 126 0.749288022 ubox
113 132 0.003256986 ubox
114 121 0.189338856 ubox
114 125 0.870319245 ubox
114 131 0.003448718 ubox
115 124 0.881688609 ubox
115 130 0.003305689 ubox
116 123 0.875970541 ubox
116 128 0.012538010 ubox
116 129 0.003172477 ubox
117 123 0.168057163 ubox
117 127 0.016055374 ubox
118 122 0.156436719 ubox
118 125 0.026122990 ubox
118 126 0.021153945 ubox
119 124 0.025876360 ubox
120 128 0.006010661 ubox
121 127 0.007678723 ubox
4 138 0.9500000 lbox
5 137 0.9500000 lbox
6 136 0.9500000 lbox
8 135 0.9500000 lbox
9 134 0.9500000 lbox
10 133 0.9500000 lbox
17 132 0.9500000 lbox
18 131 0.9500000 lbox
19 130 0.9500000 lbox
20 129 0.9500000 lbox
21 128 0.9500000 lbox
22 127 0.9500000 lbox
23 88 0.9500000 lbox
24 87 0.9500000 lbox
25 86 0.9500000 lbox
26 85 0.9500000 lbox
27 84 0.9500000 lbox
28 83 0.9500000 lbox
29 82 0.9500000 lbox
31 79 0.9500000 lbox
32 78 0.9500000 lbox
33 77 0.9500000 lbox
34 76 0.9500000 lbox
35 75 0.9500000 lbox
36 74 0.9500000 lbox
38 73 0.9500000 lbox
39 72 0.9500000 lbox
41 71 0.9500000 lbox
42 70 0.9500000 lbox
49 69 0.9500000 lbox
50 68 0.9500000 lbox
51 67 0.9500000 lbox
52 66 0.9500000 lbox
54 65 0.9500000 lbox
55 64 0.9500000 lbox
89 109 0.9500000 lbox
90 108 0.9500000 lbox
91 107 0.9500000 lbox
92 106 0.9500000 lbox
93 105 0.9500000 lbox
94 104 0.9500000 lbox
95 103 0.9500000 lbox
113 126 0.9500000 lbox
114 125 0.9500000 lbox
115 124 0.9500000 lbox
116 123 0.9500000 lbox
showpage
end
%%EOF
