%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 02:01:11 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
CCAAGGGACCACACAGCCCAUUCUGCUCCGUAUACCAGCUUUCUGUCUCUAGAAAAAAACACAUUUGAAGCAUGAAUUCUCAGCAGCAGAAGCAGCCUUGCACCCCACCCCCUCAGCCUCAGCAGCAGCAGGUGAAACAACCUUGCCAGCCUCCACCCCAGGAACCAUGCA\
) } def
/len { sequence length } bind def

/coor [
[392.25442505 306.73120117]
[374.65728760 296.28048706]
[362.25762939 279.96173096]
[356.88903809 260.15231323]
[359.35879517 239.74850464]
[345.89562988 233.13465881]
[332.43243408 226.52081299]
[321.23675537 233.83126831]
[307.78231812 234.65231323]
[295.58621216 228.66191101]
[287.88983154 217.33268738]
[286.79736328 203.57141113]
[273.45724487 196.71276855]
[259.39755249 201.49403381]
[245.77104187 194.72843933]
[240.85133362 179.94891357]
[227.51119995 173.09028625]
[214.32110596 179.95755005]
[199.44047546 177.71459961]
[188.60725403 167.01438904]
[186.12318420 151.81123352]
[172.78306580 144.95260620]
[159.44293213 138.09396362]
[146.10279846 131.23533630]
[132.76266479 124.37670135]
[119.42253113 117.51806641]
[106.08239746 110.65943146]
[114.50125885 123.07405090]
[122.69803619 135.63641357]
[125.40805054 150.38957214]
[122.21091461 165.04489136]
[113.60258484 177.32888794]
[100.91847229 185.33596802]
[86.12625122 187.82398987]
[71.52063751 184.40699768]
[59.36737442 175.61505127]
[51.55179977 162.81204224]
[49.28633881 147.98411560]
[52.92256546 133.43119812]
[67.08568573 128.49095154]
[52.28790283 126.03625488]
[37.49011612 123.58156586]
[22.69232941 121.12686920]
[7.89454365 118.67217255]
[-6.90324211 116.21747589]
[-22.05712318 122.48580933]
[-34.89600372 112.28310394]
[-32.21234131 96.10503387]
[-16.76686287 90.59420776]
[-4.44854784 101.41969299]
[10.34923840 103.87438965]
[25.14702415 106.32907867]
[39.94480896 108.78377533]
[54.74259567 111.23847198]
[69.54038239 113.69316864]
[74.39038086 107.97236633]
[62.58094025 98.72373199]
[50.77150726 89.47509766]
[38.96207047 80.22646332]
[27.15263367 70.97782898]
[12.81073475 66.58352661]
[8.59133720 52.18920135]
[18.29125404 40.74753952]
[33.18204498 42.55429077]
[39.86426926 55.98384857]
[50.92079544 66.12058258]
[61.97731781 76.25730896]
[73.03384399 86.39403534]
[84.09037018 96.53076935]
[88.94036102 90.80996704]
[84.09715271 76.61337280]
[78.34384155 69.46994019]
[79.29771423 62.11304092]
[74.71459961 47.83035278]
[70.13149261 33.54766846]
[57.62780380 22.93683052]
[60.83102417 6.85356426]
[76.44594574 1.84295714]
[88.40927887 13.05949116]
[84.41417694 28.96455765]
[88.99728394 43.24724197]
[93.58039856 57.52993011]
[98.29375458 71.77016449]
[103.13695526 85.96675873]
[112.94103241 97.31929779]
[126.28116608 104.17793274]
[139.62129211 111.03656769]
[152.96142578 117.89520264]
[166.30155945 124.75383759]
[179.64169312 131.61247253]
[192.98182678 138.47111511]
[206.79176331 131.64529419]
[221.79754639 134.22981262]
[232.28013611 145.02700806]
[234.36984253 159.75015259]
[247.70997620 166.60879517]
[262.59259033 162.01034546]
[276.02368164 169.15600586]
[280.31585693 183.37263489]
[293.65600586 190.23127747]
[308.63055420 182.40414429]
[325.15789795 185.00544739]
[336.77139282 196.81732178]
[339.04629517 213.05764771]
[352.50946045 219.67149353]
[365.97265625 226.28533936]
[372.46139526 218.49340820]
[380.29397583 212.06352234]
[389.18981934 207.22299194]
[398.83087158 204.14219666]
[408.87292480 202.92869568]
[418.95794678 203.62341309]
[428.72677612 206.19924927]
[437.83193970 210.56221008]
[445.95007324 216.55471802]
[452.79330444 223.96141052]
[458.11953735 232.51681519]
[461.74102783 241.91488647]
[463.53088379 251.81994629]
[463.42764282 261.87869263]
[461.43731689 271.73275757]
[457.63308716 281.03155518]
[469.83242798 289.75942993]
[482.03179932 298.48733521]
[495.43399048 305.22384644]
[509.71667480 309.80694580]
[527.59881592 305.48468018]
[538.89483643 318.89425659]
[553.25885010 323.21575928]
[567.62280273 327.53723145]
[582.02569580 331.72738647]
[596.46624756 335.78579712]
[610.90679932 339.84420776]
[624.56451416 331.89172363]
[639.82373047 336.00665283]
[647.63134766 349.74768066]
[643.35534668 364.96252441]
[629.53253174 372.62445068]
[614.36370850 368.18780518]
[606.84838867 354.28475952]
[592.40783691 350.22631836]
[577.96728516 346.16790771]
[570.65014648 347.38983154]
[563.30133057 341.90124512]
[548.93731689 337.57977295]
[534.57330322 333.25827026]
[523.74975586 338.71139526]
[511.73098755 335.20086670]
[505.13357544 324.08963013]
[490.85089111 319.50653076]
[486.15942383 325.35803223]
[472.08505249 342.91259766]
[479.66400146 355.85705566]
[487.24295044 368.80154419]
[502.59481812 372.55599976]
[510.72390747 386.10934448]
[506.80734253 401.42065430]
[493.16879272 409.40600586]
[477.89974976 405.32778931]
[470.05908203 391.60556030]
[474.29849243 376.38049316]
[466.71954346 363.43600464]
[459.14059448 350.49154663]
[457.08673096 339.44903564]
[458.04302979 329.31533813]
[461.51620483 320.81033325]
[466.85586548 314.48440552]
[473.30389404 310.68667603]
[461.10455322 301.95880127]
[448.90521240 293.23089600]
[432.31146240 305.06304932]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[5 106]
[6 105]
[7 104]
[12 100]
[13 99]
[16 96]
[17 95]
[21 91]
[22 90]
[23 89]
[24 88]
[25 87]
[26 86]
[27 85]
[40 55]
[41 54]
[42 53]
[43 52]
[44 51]
[45 50]
[70 84]
[71 83]
[73 82]
[74 81]
[75 80]
[122 170]
[123 169]
[124 168]
[125 150]
[126 149]
[128 146]
[129 145]
[130 144]
[131 142]
[132 141]
[133 140]
[152 163]
[153 162]
[154 161]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
