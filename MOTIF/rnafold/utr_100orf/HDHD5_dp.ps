%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:25:59 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (HDHD5)
} def

/sequence { (\
CCGUGCACGUGCGCACGGCGACGGCCGGAUGGCUGCGUGGGGCUGUGUGGCUGCGCUCGGCGCGGCGCGUGGGCUUUGCUGGCGGGCGGCGCGCGCGGCUGCGGGGCUCCAGGGCCGCCCCGCCCGCA\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 18 0.735861269 ubox
1 24 0.004080513 ubox
1 28 0.009672891 ubox
2 17 0.992885044 ubox
2 23 0.004882263 ubox
2 27 0.009717991 ubox
2 93 0.031420963 ubox
3 14 0.059935661 ubox
3 16 0.997408280 ubox
3 22 0.006108794 ubox
3 26 0.009705837 ubox
3 74 0.003348665 ubox
3 92 0.032581092 ubox
3 94 0.005355094 ubox
4 13 0.060229100 ubox
4 15 0.997232004 ubox
4 20 0.005994933 ubox
4 21 0.004986670 ubox
4 73 0.003346605 ubox
4 91 0.032571030 ubox
4 93 0.005356687 ubox
4 128 0.007786872 ubox
5 12 0.061375504 ubox
5 14 0.997376248 ubox
5 19 0.008823346 ubox
5 25 0.009778632 ubox
5 36 0.004052464 ubox
5 90 0.032585195 ubox
5 92 0.005359561 ubox
5 127 0.009894082 ubox
6 11 0.061544591 ubox
6 13 0.996481338 ubox
6 18 0.008826876 ubox
6 24 0.009773080 ubox
6 35 0.004055184 ubox
6 71 0.003360609 ubox
6 89 0.032561659 ubox
6 91 0.005352754 ubox
6 126 0.009880688 ubox
7 34 0.004010431 ubox
7 38 0.007670072 ubox
7 70 0.003360546 ubox
8 17 0.009982236 ubox
8 23 0.009802629 ubox
8 37 0.009418002 ubox
8 69 0.003360586 ubox
8 88 0.032883457 ubox
9 16 0.010009377 ubox
9 22 0.010016367 ubox
9 33 0.003412076 ubox
9 36 0.009477848 ubox
9 68 0.003359451 ubox
9 87 0.032997795 ubox
10 15 0.009364086 ubox
10 20 0.003830068 ubox
10 21 0.009349410 ubox
10 32 0.003283621 ubox
10 35 0.009158148 ubox
10 67 0.003313515 ubox
10 86 0.032942123 ubox
11 19 0.006323372 ubox
11 33 0.009418449 ubox
12 18 0.006329714 ubox
12 20 0.008090508 ubox
12 31 0.003627250 ubox
12 32 0.009357273 ubox
12 84 0.032992713 ubox
13 19 0.008134378 ubox
13 30 0.003929797 ubox
13 83 0.032997663 ubox
14 18 0.008075509 ubox
14 31 0.004252558 ubox
14 82 0.032973355 ubox
15 30 0.003972827 ubox
16 27 0.011711519 ubox
16 59 0.004195556 ubox
16 81 0.032820249 ubox
16 126 0.004848543 ubox
17 22 0.003428900 ubox
17 26 0.012809157 ubox
17 58 0.004184446 ubox
17 80 0.032969231 ubox
17 124 0.009787738 ubox
17 125 0.004784336 ubox
18 25 0.013214609 ubox
18 36 0.006009070 ubox
18 38 0.115634398 ubox
18 56 0.005889017 ubox
18 79 0.032998139 ubox
18 123 0.010561110 ubox
18 124 0.004327650 ubox
18 127 0.654045467 ubox
19 24 0.013279875 ubox
19 35 0.006005022 ubox
19 37 0.415433790 ubox
19 55 0.006087994 ubox
19 78 0.032996896 ubox
19 122 0.010774138 ubox
19 126 0.682043377 ubox
20 36 0.423295526 ubox
20 54 0.006099972 ubox
20 77 0.032794324 ubox
20 121 0.010282383 ubox
20 125 0.667210489 ubox
21 38 0.007782726 ubox
21 76 0.031956048 ubox
22 35 0.431256637 ubox
22 37 0.008579777 ubox
22 53 0.006194595 ubox
22 117 0.004004451 ubox
22 122 0.057862121 ubox
22 126 0.517452153 ubox
23 34 0.431689316 ubox
23 36 0.007513931 ubox
23 52 0.006198212 ubox
23 75 0.032220885 ubox
23 116 0.004016801 ubox
23 119 0.006288210 ubox
23 121 0.058277451 ubox
23 124 0.728940783 ubox
23 125 0.520884365 ubox
24 33 0.432175301 ubox
24 51 0.006207121 ubox
24 74 0.032975034 ubox
24 115 0.004014634 ubox
24 118 0.006302617 ubox
24 120 0.057897480 ubox
24 123 0.737236818 ubox
24 124 0.513396418 ubox
24 127 0.021386175 ubox
25 32 0.432176594 ubox
25 50 0.006207232 ubox
25 73 0.032957427 ubox
25 114 0.004009951 ubox
25 117 0.006224616 ubox
25 122 0.708578198 ubox
25 126 0.020790920 ubox
26 31 0.431551946 ubox
26 49 0.006207141 ubox
26 72 0.032915659 ubox
26 113 0.003983656 ubox
26 122 0.551195273 ubox
26 126 0.007121348 ubox
27 48 0.006179647 ubox
27 119 0.149579574 ubox
27 120 0.660622517 ubox
27 121 0.592693443 ubox
27 124 0.017027635 ubox
27 125 0.009017258 ubox
28 118 0.152394769 ubox
28 119 0.660899810 ubox
28 120 0.588600212 ubox
28 123 0.017041794 ubox
28 124 0.008988436 ubox
29 38 0.003238513 ubox
29 46 0.006201636 ubox
29 70 0.029142185 ubox
30 37 0.003547625 ubox
30 45 0.006180565 ubox
30 69 0.029599702 ubox
30 117 0.683021306 ubox
30 122 0.005809222 ubox
31 36 0.003822411 ubox
31 44 0.006184093 ubox
31 68 0.029675700 ubox
31 116 0.710422497 ubox
31 119 0.550812362 ubox
31 120 0.005770349 ubox
31 121 0.004123283 ubox
32 43 0.006208827 ubox
32 66 0.032965054 ubox
32 115 0.710496997 ubox
32 118 0.554109245 ubox
32 119 0.004460424 ubox
32 120 0.003857321 ubox
33 42 0.006204775 ubox
33 65 0.032990536 ubox
33 113 0.019871992 ubox
33 114 0.710125512 ubox
33 117 0.553757950 ubox
34 41 0.006127888 ubox
34 64 0.032965984 ubox
34 112 0.027792059 ubox
34 113 0.673919893 ubox
34 117 0.004223884 ubox
34 128 0.005842061 ubox
35 63 0.032990137 ubox
35 115 0.552898666 ubox
35 116 0.015299218 ubox
35 118 0.004298547 ubox
35 127 0.014131514 ubox
36 62 0.032990554 ubox
36 114 0.553046876 ubox
36 117 0.004321882 ubox
36 126 0.014496631 ubox
37 61 0.032988325 ubox
37 115 0.005553363 ubox
37 116 0.004338962 ubox
37 123 0.006309898 ubox
37 125 0.004426213 ubox
37 127 0.008987801 ubox
38 60 0.032910396 ubox
38 111 0.944673369 ubox
38 114 0.004501431 ubox
38 122 0.006474485 ubox
38 126 0.007939257 ubox
39 110 0.999064694 ubox
39 121 0.006634194 ubox
40 58 0.032913383 ubox
40 109 0.999197936 ubox
40 110 0.018349523 ubox
40 120 0.006634526 ubox
40 125 0.003762521 ubox
41 57 0.032889087 ubox
41 108 0.998585416 ubox
41 109 0.018362720 ubox
41 119 0.006634431 ubox
41 124 0.003820259 ubox
42 56 0.032892427 ubox
42 107 0.999390148 ubox
42 118 0.006634177 ubox
42 123 0.003873185 ubox
43 55 0.032252193 ubox
43 106 0.999390565 ubox
43 117 0.006621728 ubox
43 122 0.003920373 ubox
44 53 0.003373288 ubox
44 55 0.006334739 ubox
44 104 0.003742321 ubox
44 105 0.998150128 ubox
45 51 0.006937085 ubox
45 54 0.030249626 ubox
46 50 0.006494771 ubox
46 53 0.029700475 ubox
46 103 0.996621445 ubox
47 52 0.016516450 ubox
47 54 0.005107405 ubox
47 102 0.999366739 ubox
48 53 0.004905752 ubox
48 101 0.997335221 ubox
49 100 0.995533206 ubox
50 99 0.999421817 ubox
51 98 0.999426111 ubox
52 97 0.998672886 ubox
53 96 0.999400734 ubox
54 95 0.999411261 ubox
55 94 0.999297909 ubox
56 93 0.997753093 ubox
58 91 0.019061750 ubox
58 93 0.040698207 ubox
59 90 0.016253800 ubox
59 92 0.069795419 ubox
59 94 0.005213882 ubox
60 90 0.005222052 ubox
60 92 0.996045609 ubox
61 88 0.014662920 ubox
61 89 0.006723036 ubox
61 91 0.999208674 ubox
62 87 0.012072595 ubox
62 90 0.999277092 ubox
62 92 0.003340620 ubox
63 86 0.011462793 ubox
63 88 0.009073910 ubox
63 89 0.998885129 ubox
63 91 0.003340655 ubox
64 87 0.008013878 ubox
64 90 0.003316834 ubox
65 87 0.998940562 ubox
66 84 0.009428147 ubox
66 86 0.999267011 ubox
67 83 0.009430172 ubox
68 82 0.009402635 ubox
68 84 0.999153524 ubox
69 83 0.999371838 ubox
70 81 0.009216222 ubox
70 82 0.998316122 ubox
71 80 0.013243479 ubox
72 79 0.015604893 ubox
72 80 0.997298795 ubox
73 79 0.999238708 ubox
74 78 0.991977279 ubox
95 127 0.033309479 ubox
96 126 0.033356952 ubox
97 125 0.033357659 ubox
98 124 0.033183218 ubox
101 123 0.033237436 ubox
102 122 0.033388715 ubox
103 121 0.033631827 ubox
104 120 0.033633531 ubox
105 116 0.006473048 ubox
105 119 0.033625608 ubox
106 115 0.006542397 ubox
106 118 0.033617547 ubox
107 114 0.006577857 ubox
107 117 0.033577294 ubox
108 113 0.006160928 ubox
108 114 0.005735622 ubox
109 113 0.006684427 ubox
112 119 0.003844760 ubox
112 120 0.010906735 ubox
112 121 0.018288193 ubox
112 125 0.431086551 ubox
113 118 0.003853827 ubox
113 119 0.010946358 ubox
113 120 0.018313076 ubox
113 124 0.431701897 ubox
113 125 0.005240268 ubox
114 118 0.010783917 ubox
114 119 0.018090084 ubox
114 123 0.431706350 ubox
114 124 0.004991918 ubox
115 122 0.426868293 ubox
116 122 0.059702088 ubox
117 121 0.078887072 ubox
2 17 0.9500000 lbox
3 16 0.9500000 lbox
4 15 0.9500000 lbox
5 14 0.9500000 lbox
6 13 0.9500000 lbox
18 127 0.9500000 lbox
19 126 0.9500000 lbox
20 125 0.9500000 lbox
23 124 0.9500000 lbox
24 123 0.9500000 lbox
25 122 0.9500000 lbox
27 120 0.9500000 lbox
28 119 0.9500000 lbox
30 117 0.9500000 lbox
31 116 0.9500000 lbox
32 115 0.9500000 lbox
33 114 0.9500000 lbox
34 113 0.9500000 lbox
38 111 0.9500000 lbox
39 110 0.9500000 lbox
40 109 0.9500000 lbox
41 108 0.9500000 lbox
42 107 0.9500000 lbox
43 106 0.9500000 lbox
44 105 0.9500000 lbox
46 103 0.9500000 lbox
47 102 0.9500000 lbox
48 101 0.9500000 lbox
49 100 0.9500000 lbox
50 99 0.9500000 lbox
51 98 0.9500000 lbox
52 97 0.9500000 lbox
53 96 0.9500000 lbox
54 95 0.9500000 lbox
55 94 0.9500000 lbox
56 93 0.9500000 lbox
60 92 0.9500000 lbox
61 91 0.9500000 lbox
62 90 0.9500000 lbox
63 89 0.9500000 lbox
65 87 0.9500000 lbox
66 86 0.9500000 lbox
68 84 0.9500000 lbox
69 83 0.9500000 lbox
70 82 0.9500000 lbox
72 80 0.9500000 lbox
73 79 0.9500000 lbox
74 78 0.9500000 lbox
showpage
end
%%EOF
