%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:45:28 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (CSF2)
} def

/sequence { (\
ACACAGAGAGAAAGGCUAAAGUUCUCUGGAGGAUGUGGCUGCAGAGCCUGCUGCUCUUGGGCACUGUGGCCUGCAGCAUCUCUGCACCCGCCCGCUCGCCCAGCCCCAGCACGCAGCCCUGGGAGCAUGUGA\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 130 0.246986609 ubox
2 28 0.018785155 ubox
2 35 0.003403004 ubox
2 129 0.261366322 ubox
2 131 0.533771952 ubox
3 27 0.013377705 ubox
3 34 0.003480325 ubox
3 128 0.227263517 ubox
3 130 0.532757024 ubox
4 28 0.839457046 ubox
4 84 0.005278538 ubox
4 129 0.523289190 ubox
4 131 0.020424711 ubox
5 25 0.005914920 ubox
5 27 0.847234560 ubox
5 57 0.003339487 ubox
5 83 0.005400329 ubox
5 128 0.462337356 ubox
5 130 0.018024666 ubox
6 24 0.006761296 ubox
6 26 0.854612575 ubox
6 56 0.004321252 ubox
6 82 0.005508317 ubox
7 17 0.003824600 ubox
7 23 0.006676940 ubox
7 25 0.854432999 ubox
7 27 0.490400081 ubox
7 55 0.004325184 ubox
7 57 0.004081843 ubox
7 81 0.005507897 ubox
8 16 0.003983114 ubox
8 22 0.005757225 ubox
8 23 0.004342677 ubox
8 24 0.854337737 ubox
8 26 0.517906977 ubox
8 54 0.004318616 ubox
8 56 0.004218690 ubox
8 80 0.005508488 ubox
9 17 0.029562551 ubox
9 22 0.034312552 ubox
9 23 0.839251962 ubox
9 25 0.518159130 ubox
9 27 0.014325501 ubox
9 55 0.004217030 ubox
9 79 0.005483333 ubox
10 16 0.047372999 ubox
10 22 0.686448073 ubox
10 23 0.031695454 ubox
10 24 0.518480486 ubox
10 26 0.015116124 ubox
10 54 0.004206373 ubox
11 22 0.053493658 ubox
11 23 0.506012264 ubox
11 25 0.014625117 ubox
12 22 0.424257000 ubox
12 23 0.083173032 ubox
13 22 0.129765637 ubox
13 23 0.017896037 ubox
13 25 0.006316968 ubox
13 49 0.005674423 ubox
13 72 0.005495395 ubox
13 120 0.009598675 ubox
14 22 0.047097520 ubox
14 23 0.090592211 ubox
14 24 0.007556276 ubox
14 48 0.005710594 ubox
14 71 0.005541546 ubox
14 100 0.017474448 ubox
14 118 0.010575808 ubox
14 119 0.008006527 ubox
15 22 0.294671881 ubox
15 23 0.006546306 ubox
15 47 0.005710256 ubox
15 70 0.005541811 ubox
15 99 0.017552945 ubox
15 117 0.011908342 ubox
15 118 0.005870241 ubox
16 21 0.311966906 ubox
16 46 0.005307365 ubox
16 69 0.005541796 ubox
16 98 0.017571848 ubox
16 116 0.013092187 ubox
17 45 0.003427834 ubox
17 68 0.005521120 ubox
17 115 0.012654684 ubox
18 67 0.004930473 ubox
20 27 0.013254496 ubox
20 65 0.005376886 ubox
20 96 0.004304211 ubox
21 26 0.013666769 ubox
21 34 0.003835232 ubox
21 64 0.005534582 ubox
21 95 0.004353134 ubox
21 110 0.004477926 ubox
21 112 0.011819606 ubox
21 114 0.003378960 ubox
22 33 0.004049550 ubox
22 63 0.005430881 ubox
22 94 0.004204663 ubox
22 109 0.004458430 ubox
22 111 0.011636694 ubox
22 113 0.003328398 ubox
23 32 0.004131449 ubox
23 108 0.004024765 ubox
24 31 0.004174228 ubox
24 46 0.003241983 ubox
24 61 0.005512398 ubox
24 109 0.009542899 ubox
25 30 0.003865094 ubox
25 45 0.005198765 ubox
25 60 0.005509498 ubox
25 108 0.009454198 ubox
26 44 0.006100439 ubox
26 59 0.005504565 ubox
26 103 0.014046181 ubox
26 109 0.007743883 ubox
27 43 0.006104809 ubox
27 94 0.005215139 ubox
27 98 0.014054192 ubox
27 102 0.145532190 ubox
27 108 0.007768539 ubox
28 42 0.006133308 ubox
28 57 0.009292226 ubox
28 93 0.024393037 ubox
28 96 0.074357615 ubox
28 97 0.047366791 ubox
28 100 0.083628783 ubox
28 101 0.267479231 ubox
28 107 0.007785959 ubox
29 56 0.010333046 ubox
29 92 0.024687390 ubox
29 95 0.190259848 ubox
29 96 0.032349435 ubox
29 97 0.900640623 ubox
29 99 0.081375086 ubox
29 100 0.265679396 ubox
29 106 0.007739763 ubox
30 40 0.006107653 ubox
30 55 0.010335422 ubox
30 96 0.906112167 ubox
31 39 0.006121078 ubox
31 54 0.010315230 ubox
31 92 0.038823243 ubox
31 93 0.301072710 ubox
31 95 0.905993656 ubox
31 96 0.040622976 ubox
31 97 0.066845354 ubox
31 100 0.017917573 ubox
31 101 0.015319177 ubox
31 105 0.006690231 ubox
32 91 0.038338713 ubox
32 92 0.300919996 ubox
32 95 0.052279840 ubox
32 96 0.058142828 ubox
32 97 0.260230702 ubox
32 99 0.017976826 ubox
32 100 0.015238501 ubox
32 104 0.006596733 ubox
33 96 0.256645045 ubox
34 90 0.077280532 ubox
34 94 0.136238570 ubox
34 98 0.007481110 ubox
34 102 0.005418107 ubox
35 51 0.005629738 ubox
35 89 0.079728234 ubox
35 91 0.964822746 ubox
35 93 0.131673904 ubox
35 95 0.193677977 ubox
35 97 0.004620459 ubox
35 101 0.005710490 ubox
36 50 0.005447035 ubox
36 90 0.966792929 ubox
36 94 0.193025928 ubox
37 48 0.010386707 ubox
37 88 0.087886328 ubox
37 89 0.967240973 ubox
37 92 0.175698542 ubox
37 93 0.159739685 ubox
37 100 0.005670424 ubox
38 47 0.010409872 ubox
38 87 0.093504809 ubox
38 88 0.965574474 ubox
38 91 0.206024177 ubox
38 92 0.118079612 ubox
38 99 0.005672158 ubox
39 46 0.010422302 ubox
39 90 0.232227517 ubox
39 98 0.005669530 ubox
40 45 0.010317911 ubox
40 86 0.989635339 ubox
40 90 0.007626662 ubox
41 85 0.999886953 ubox
42 84 0.999908801 ubox
43 83 0.999673701 ubox
44 82 0.999900276 ubox
45 81 0.999592281 ubox
46 80 0.996415599 ubox
48 76 0.009171483 ubox
49 75 0.009189398 ubox
49 78 0.969435757 ubox
50 74 0.009190377 ubox
50 77 0.999758870 ubox
51 73 0.009174565 ubox
51 76 0.999859919 ubox
52 75 0.999625553 ubox
52 78 0.003438794 ubox
53 74 0.999854286 ubox
53 77 0.003550367 ubox
54 73 0.998182045 ubox
54 76 0.003551238 ubox
55 69 0.004103299 ubox
55 75 0.003430018 ubox
56 68 0.004506010 ubox
56 69 0.006407413 ubox
57 68 0.006287622 ubox
58 66 0.003731892 ubox
58 73 0.048951078 ubox
58 102 0.009857242 ubox
59 65 0.005586890 ubox
59 71 0.136494507 ubox
59 72 0.980322291 ubox
59 101 0.011083517 ubox
60 64 0.005526280 ubox
60 70 0.136803594 ubox
60 71 0.990243133 ubox
60 72 0.003278519 ubox
60 100 0.011086345 ubox
61 67 0.008722412 ubox
61 70 0.990378255 ubox
61 99 0.011086283 ubox
62 66 0.008857763 ubox
62 68 0.150875764 ubox
62 69 0.987233236 ubox
62 98 0.011060274 ubox
63 67 0.133342205 ubox
65 94 0.004301969 ubox
66 93 0.004844305 ubox
66 95 0.009004794 ubox
67 94 0.008986382 ubox
68 92 0.008079289 ubox
68 93 0.007428123 ubox
69 91 0.009540376 ubox
69 92 0.005434101 ubox
70 90 0.010795625 ubox
72 86 0.010953397 ubox
73 85 0.011106919 ubox
74 84 0.011107291 ubox
75 83 0.011094295 ubox
76 82 0.010985113 ubox
89 131 0.004827305 ubox
90 99 0.005032373 ubox
90 130 0.004959449 ubox
91 98 0.005043302 ubox
91 129 0.004967302 ubox
93 131 0.016363416 ubox
94 104 0.023024206 ubox
94 117 0.003944288 ubox
94 126 0.063764243 ubox
94 130 0.017059195 ubox
95 103 0.023090737 ubox
95 116 0.003954878 ubox
95 125 0.063821873 ubox
95 129 0.017034609 ubox
96 102 0.022233760 ubox
96 115 0.003930454 ubox
96 124 0.060952646 ubox
96 132 0.236936503 ubox
97 123 0.038884725 ubox
97 131 0.295691427 ubox
98 104 0.055233516 ubox
98 114 0.004187524 ubox
98 126 0.037288332 ubox
98 128 0.006362308 ubox
98 130 0.346743285 ubox
99 103 0.054969313 ubox
99 113 0.004182126 ubox
99 122 0.017422141 ubox
99 123 0.092317147 ubox
99 125 0.035922694 ubox
99 129 0.347306987 ubox
100 121 0.014368152 ubox
100 122 0.098951406 ubox
100 123 0.007146421 ubox
101 121 0.099553859 ubox
101 122 0.005974774 ubox
101 129 0.483179571 ubox
101 131 0.142011024 ubox
102 120 0.099880896 ubox
102 128 0.485951212 ubox
102 130 0.140097510 ubox
103 110 0.009234140 ubox
103 114 0.013699852 ubox
103 117 0.016437234 ubox
103 119 0.097725286 ubox
103 126 0.987413048 ubox
103 130 0.004777938 ubox
104 109 0.009675200 ubox
104 113 0.015215204 ubox
104 116 0.017729469 ubox
104 122 0.004400131 ubox
104 123 0.017533360 ubox
104 125 0.988515623 ubox
104 129 0.005726883 ubox
105 121 0.004525973 ubox
105 122 0.017232288 ubox
105 123 0.994370230 ubox
106 121 0.016648281 ubox
106 122 0.994566970 ubox
106 123 0.007912479 ubox
107 121 0.994553905 ubox
107 122 0.007004554 ubox
108 120 0.971175940 ubox
109 117 0.563194350 ubox
109 119 0.816698962 ubox
110 116 0.625088805 ubox
112 131 0.007732526 ubox
113 126 0.003235875 ubox
113 130 0.007841340 ubox
114 125 0.003241567 ubox
114 129 0.007852296 ubox
115 128 0.007796561 ubox
116 126 0.007882440 ubox
117 123 0.003427074 ubox
117 125 0.007863735 ubox
118 122 0.003460911 ubox
4 28 0.9500000 lbox
5 27 0.9500000 lbox
6 26 0.9500000 lbox
7 25 0.9500000 lbox
8 24 0.9500000 lbox
9 23 0.9500000 lbox
10 22 0.9500000 lbox
29 97 0.9500000 lbox
30 96 0.9500000 lbox
31 95 0.9500000 lbox
35 91 0.9500000 lbox
36 90 0.9500000 lbox
37 89 0.9500000 lbox
38 88 0.9500000 lbox
40 86 0.9500000 lbox
41 85 0.9500000 lbox
42 84 0.9500000 lbox
43 83 0.9500000 lbox
44 82 0.9500000 lbox
45 81 0.9500000 lbox
46 80 0.9500000 lbox
49 78 0.9500000 lbox
50 77 0.9500000 lbox
51 76 0.9500000 lbox
52 75 0.9500000 lbox
53 74 0.9500000 lbox
54 73 0.9500000 lbox
59 72 0.9500000 lbox
60 71 0.9500000 lbox
61 70 0.9500000 lbox
62 69 0.9500000 lbox
103 126 0.9500000 lbox
104 125 0.9500000 lbox
105 123 0.9500000 lbox
106 122 0.9500000 lbox
107 121 0.9500000 lbox
108 120 0.9500000 lbox
109 119 0.9500000 lbox
showpage
end
%%EOF
