%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:09:50 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (OR5P3)
} def

/sequence { (\
AUGGGGACUGGAAAUGACACCACUGUGGUAGAGUUUACUCUUUUGGGGUUAUCUGAGGAUACUACAGUUUGUGCUAUUUUAUUUCUUGUGUUUCUAGGAA\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 89 0.052355627 ubox
1 91 0.007774891 ubox
2 88 0.054271079 ubox
2 90 0.008495750 ubox
2 96 0.894968750 ubox
3 86 0.013389061 ubox
3 87 0.058051310 ubox
3 89 0.005970075 ubox
3 92 0.004459680 ubox
3 93 0.073136482 ubox
3 94 0.069218963 ubox
3 95 0.978799014 ubox
4 85 0.014655015 ubox
4 86 0.060380700 ubox
4 87 0.026772774 ubox
4 91 0.004616795 ubox
4 92 0.095141759 ubox
4 93 0.065444027 ubox
4 94 0.987346011 ubox
4 95 0.038590576 ubox
5 84 0.014632129 ubox
5 85 0.060601971 ubox
5 86 0.031791010 ubox
5 91 0.111501584 ubox
5 92 0.062119106 ubox
5 93 0.983372071 ubox
5 94 0.039816409 ubox
5 95 0.011240664 ubox
6 83 0.014782691 ubox
6 84 0.059972686 ubox
6 85 0.032690582 ubox
6 91 0.054701720 ubox
6 92 0.983544620 ubox
6 93 0.036113997 ubox
6 94 0.011564576 ubox
7 82 0.014365443 ubox
7 83 0.056901270 ubox
7 84 0.032213792 ubox
7 89 0.164015792 ubox
7 91 0.981698469 ubox
7 92 0.025956776 ubox
7 93 0.009394120 ubox
8 88 0.175086285 ubox
8 90 0.978083075 ubox
8 97 0.025139213 ubox
9 81 0.037206573 ubox
9 88 0.143658574 ubox
9 90 0.010080740 ubox
9 96 0.025207783 ubox
10 80 0.033141459 ubox
10 84 0.003426251 ubox
10 85 0.016835647 ubox
10 86 0.953775965 ubox
10 87 0.127978891 ubox
10 89 0.015452802 ubox
10 95 0.025183090 ubox
11 79 0.027120574 ubox
11 80 0.103777953 ubox
11 84 0.014785131 ubox
11 85 0.992973557 ubox
11 86 0.016620798 ubox
11 87 0.013725379 ubox
11 94 0.025173467 ubox
12 78 0.023216263 ubox
12 79 0.109202679 ubox
12 80 0.004167138 ubox
12 83 0.013765609 ubox
12 84 0.992650472 ubox
12 86 0.011314085 ubox
12 87 0.003626084 ubox
12 93 0.025023085 ubox
13 77 0.017961901 ubox
13 78 0.118983012 ubox
13 79 0.006366953 ubox
13 80 0.003619747 ubox
13 82 0.010271683 ubox
13 83 0.990765702 ubox
13 92 0.023897212 ubox
14 77 0.127788655 ubox
14 78 0.006758288 ubox
14 79 0.004090171 ubox
14 82 0.990123073 ubox
14 91 0.022861893 ubox
15 76 0.133637726 ubox
15 81 0.989071315 ubox
15 90 0.021649691 ubox
16 75 0.135290175 ubox
16 78 0.042918833 ubox
16 79 0.066663919 ubox
16 80 0.984752068 ubox
16 85 0.007926718 ubox
16 87 0.004031000 ubox
16 89 0.011664878 ubox
16 92 0.004861142 ubox
17 72 0.084002936 ubox
17 77 0.053754769 ubox
17 78 0.090654452 ubox
17 79 0.972393445 ubox
17 84 0.007870057 ubox
17 86 0.004256755 ubox
17 89 0.008565460 ubox
17 91 0.006038124 ubox
18 27 0.004901418 ubox
18 71 0.102837179 ubox
18 73 0.992630987 ubox
18 88 0.009022962 ubox
18 90 0.006326673 ubox
19 26 0.004910673 ubox
19 29 0.009233471 ubox
19 70 0.099711646 ubox
19 72 0.992871537 ubox
19 87 0.007952006 ubox
19 89 0.006350329 ubox
20 25 0.004883217 ubox
20 28 0.010132312 ubox
20 71 0.989110094 ubox
20 88 0.006279062 ubox
21 27 0.010140149 ubox
21 71 0.051240236 ubox
21 73 0.027287971 ubox
22 26 0.008217966 ubox
22 68 0.972352191 ubox
22 70 0.046568334 ubox
22 72 0.022117687 ubox
23 67 0.999498957 ubox
23 71 0.016458799 ubox
24 66 0.999653339 ubox
25 65 0.999893689 ubox
26 64 0.999496423 ubox
27 44 0.003442512 ubox
27 63 0.999359164 ubox
28 38 0.004606690 ubox
28 43 0.003697756 ubox
28 60 0.007231413 ubox
28 62 0.999697759 ubox
28 65 0.003406590 ubox
29 37 0.005697418 ubox
29 55 0.189902000 ubox
29 59 0.017641172 ubox
29 61 0.976458399 ubox
29 64 0.003592478 ubox
30 36 0.006969891 ubox
30 39 0.011332454 ubox
30 41 0.174206012 ubox
30 42 0.005088334 ubox
30 43 0.014701939 ubox
30 54 0.386011826 ubox
30 60 0.867299150 ubox
30 63 0.003843990 ubox
31 35 0.006260057 ubox
31 38 0.026894958 ubox
31 40 0.391903483 ubox
31 42 0.048650081 ubox
31 43 0.003303250 ubox
31 44 0.003422328 ubox
31 50 0.014555876 ubox
31 53 0.468162391 ubox
31 62 0.003912112 ubox
32 39 0.392932144 ubox
32 41 0.055344970 ubox
32 42 0.003172631 ubox
32 43 0.003690250 ubox
32 49 0.014355440 ubox
32 50 0.003306775 ubox
32 52 0.464844856 ubox
32 54 0.352616870 ubox
32 63 0.005079272 ubox
33 38 0.390185700 ubox
33 40 0.057523089 ubox
33 42 0.003987943 ubox
33 52 0.076760891 ubox
33 53 0.391003101 ubox
33 60 0.051859688 ubox
33 62 0.005961799 ubox
34 47 0.014479902 ubox
34 48 0.003220496 ubox
34 51 0.106995243 ubox
34 56 0.244439674 ubox
34 57 0.340157244 ubox
34 58 0.036412233 ubox
34 59 0.069399338 ubox
34 61 0.006490122 ubox
35 46 0.014596892 ubox
35 48 0.008614046 ubox
35 55 0.232808617 ubox
35 56 0.353222741 ubox
35 57 0.040677066 ubox
35 58 0.065779845 ubox
35 59 0.052773263 ubox
36 45 0.014644498 ubox
36 51 0.169125516 ubox
36 55 0.352401115 ubox
36 56 0.040303466 ubox
36 57 0.047595270 ubox
36 58 0.048189505 ubox
36 61 0.011770859 ubox
37 44 0.013437680 ubox
37 49 0.721399896 ubox
37 50 0.125904336 ubox
37 54 0.210549209 ubox
37 60 0.019861571 ubox
38 46 0.023938148 ubox
38 47 0.309517179 ubox
38 48 0.756089484 ubox
38 57 0.162400094 ubox
38 58 0.012994177 ubox
39 45 0.018813314 ubox
39 46 0.311924058 ubox
39 47 0.753548453 ubox
39 48 0.035307961 ubox
39 56 0.162791689 ubox
39 57 0.007069636 ubox
39 58 0.028289087 ubox
39 59 0.353621620 ubox
40 45 0.314218706 ubox
40 46 0.751988953 ubox
40 47 0.054871539 ubox
40 48 0.039647761 ubox
40 55 0.162572429 ubox
40 57 0.041851465 ubox
40 58 0.355803364 ubox
41 45 0.677497559 ubox
41 46 0.050938087 ubox
41 47 0.039045071 ubox
41 48 0.005871482 ubox
41 56 0.042195605 ubox
41 57 0.336558843 ubox
41 58 0.213656099 ubox
41 59 0.214440071 ubox
42 46 0.028879590 ubox
42 47 0.005685658 ubox
42 48 0.008949874 ubox
42 55 0.039795546 ubox
42 56 0.313198751 ubox
42 57 0.305903368 ubox
42 58 0.237849274 ubox
42 59 0.035077162 ubox
43 47 0.007113784 ubox
43 55 0.269419910 ubox
43 56 0.348808287 ubox
43 57 0.247751556 ubox
43 58 0.036268968 ubox
43 59 0.009727102 ubox
44 51 0.062062579 ubox
44 55 0.368593648 ubox
44 56 0.252789757 ubox
44 57 0.033955176 ubox
44 58 0.009915311 ubox
44 76 0.005371705 ubox
45 50 0.058030848 ubox
45 53 0.225504832 ubox
45 54 0.406580076 ubox
45 75 0.005874515 ubox
46 52 0.213278295 ubox
46 53 0.419591534 ubox
46 54 0.265543168 ubox
46 74 0.005923390 ubox
47 52 0.372124215 ubox
47 53 0.267084627 ubox
47 54 0.066390607 ubox
47 63 0.004307763 ubox
47 75 0.003464262 ubox
48 52 0.173152602 ubox
48 53 0.070291533 ubox
48 60 0.010468806 ubox
48 62 0.005270239 ubox
48 72 0.004609028 ubox
48 74 0.003623761 ubox
49 56 0.007084372 ubox
49 57 0.004190644 ubox
49 58 0.004950771 ubox
49 59 0.011571131 ubox
49 61 0.003978229 ubox
49 73 0.003536752 ubox
50 55 0.007752059 ubox
50 56 0.005654660 ubox
50 57 0.006748099 ubox
50 58 0.011803403 ubox
50 61 0.031512397 ubox
51 60 0.049762488 ubox
52 58 0.006789848 ubox
52 59 0.059675308 ubox
53 57 0.010523215 ubox
53 58 0.061373562 ubox
53 67 0.007861141 ubox
54 66 0.007897924 ubox
55 60 0.003388710 ubox
55 65 0.007944391 ubox
56 63 0.009852574 ubox
57 62 0.010666340 ubox
57 79 0.004178665 ubox
58 78 0.006353360 ubox
59 77 0.006624050 ubox
60 76 0.006665765 ubox
61 75 0.006609671 ubox
63 73 0.006647555 ubox
64 72 0.006932042 ubox
65 71 0.006946789 ubox
66 70 0.005630340 ubox
66 75 0.004208973 ubox
67 74 0.004756195 ubox
68 73 0.004752230 ubox
71 82 0.003306490 ubox
72 81 0.003519984 ubox
73 80 0.003394114 ubox
73 89 0.003873799 ubox
74 88 0.004771356 ubox
80 88 0.003752550 ubox
81 87 0.005073299 ubox
81 89 0.008403666 ubox
82 88 0.008636382 ubox
82 100 0.005387242 ubox
83 99 0.006963724 ubox
83 100 0.018529828 ubox
84 98 0.007033739 ubox
84 99 0.025318825 ubox
85 97 0.007122960 ubox
85 98 0.025987089 ubox
86 96 0.006950898 ubox
86 97 0.025970333 ubox
87 96 0.025899421 ubox
87 98 0.003806292 ubox
88 95 0.024041641 ubox
89 96 0.004314172 ubox
90 95 0.004091114 ubox
91 99 0.004824420 ubox
91 100 0.004923488 ubox
92 98 0.005214081 ubox
92 99 0.006948923 ubox
92 100 0.012302875 ubox
93 97 0.004055640 ubox
93 98 0.006687744 ubox
93 99 0.018446172 ubox
94 98 0.019094394 ubox
2 96 0.9500000 lbox
3 95 0.9500000 lbox
4 94 0.9500000 lbox
5 93 0.9500000 lbox
6 92 0.9500000 lbox
7 91 0.9500000 lbox
8 90 0.9500000 lbox
10 86 0.9500000 lbox
11 85 0.9500000 lbox
12 84 0.9500000 lbox
13 83 0.9500000 lbox
14 82 0.9500000 lbox
15 81 0.9500000 lbox
16 80 0.9500000 lbox
17 79 0.9500000 lbox
18 73 0.9500000 lbox
19 72 0.9500000 lbox
20 71 0.9500000 lbox
22 68 0.9500000 lbox
23 67 0.9500000 lbox
24 66 0.9500000 lbox
25 65 0.9500000 lbox
26 64 0.9500000 lbox
27 63 0.9500000 lbox
28 62 0.9500000 lbox
29 61 0.9500000 lbox
30 60 0.9500000 lbox
32 54 0.9500000 lbox
33 53 0.9500000 lbox
37 49 0.9500000 lbox
38 48 0.9500000 lbox
39 47 0.9500000 lbox
40 46 0.9500000 lbox
41 45 0.9500000 lbox
showpage
end
%%EOF
