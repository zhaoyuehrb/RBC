%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 03:09:16 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (PPM1J)
} def

/sequence { (\
CGGCCGAGGGCGGGGCAGGGAGGCAGCAUGCUAAACCGGGUGCGCUCGGCCGUGGCGCACCUGGUGAGCUCCGGGGGCGCUCCGCCUCCGCGCCCCAAAUCCCCGGACCUGCCCAACGCCGCCUCGG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 121 0.108002903 ubox
1 126 0.010521987 ubox
2 109 0.005185655 ubox
2 120 0.114382444 ubox
2 123 0.056280535 ubox
2 125 0.008985314 ubox
3 108 0.005193053 ubox
3 119 0.114399260 ubox
3 122 0.056412348 ubox
3 124 0.007295162 ubox
4 106 0.005244925 ubox
4 118 0.111797477 ubox
4 121 0.056223600 ubox
4 127 0.972599104 ubox
5 105 0.005253887 ubox
5 118 0.028733659 ubox
5 121 0.004342228 ubox
5 126 0.991345867 ubox
6 104 0.005251811 ubox
6 117 0.037056633 ubox
6 120 0.003302022 ubox
6 125 0.991690624 ubox
7 110 0.003212046 ubox
7 124 0.988232397 ubox
8 103 0.004630954 ubox
8 109 0.003442281 ubox
8 114 0.115614921 ubox
8 120 0.007337517 ubox
8 123 0.970534281 ubox
8 124 0.075578420 ubox
9 102 0.004630647 ubox
9 108 0.003441211 ubox
9 113 0.115799211 ubox
9 119 0.006239051 ubox
9 120 0.674870290 ubox
9 122 0.686830064 ubox
9 123 0.173871303 ubox
10 101 0.004620605 ubox
10 112 0.115814458 ubox
10 119 0.949400174 ubox
10 122 0.233605967 ubox
11 105 0.005300642 ubox
11 111 0.115776263 ubox
11 118 0.951430613 ubox
11 121 0.280884625 ubox
12 96 0.006328791 ubox
12 104 0.009356869 ubox
12 110 0.115412909 ubox
12 114 0.007853453 ubox
12 117 0.930596748 ubox
12 120 0.280816260 ubox
13 95 0.006387108 ubox
13 103 0.009485121 ubox
13 109 0.115480733 ubox
13 113 0.007107561 ubox
13 114 0.967610242 ubox
13 119 0.201532605 ubox
14 94 0.006461042 ubox
14 102 0.009516632 ubox
14 108 0.115431871 ubox
14 112 0.005052526 ubox
14 113 0.991803403 ubox
14 114 0.024061650 ubox
14 120 0.005283788 ubox
15 24 0.005786380 ubox
15 93 0.006533293 ubox
15 101 0.009518854 ubox
15 112 0.992003176 ubox
15 113 0.017052348 ubox
15 119 0.005879973 ubox
16 23 0.005787555 ubox
16 92 0.006531135 ubox
16 111 0.992154999 ubox
16 118 0.006367420 ubox
17 110 0.991750726 ubox
18 96 0.003292552 ubox
18 103 0.105507826 ubox
18 104 0.061835480 ubox
18 109 0.990671968 ubox
18 110 0.016620784 ubox
18 113 0.015582348 ubox
18 114 0.042269983 ubox
19 72 0.015905728 ubox
19 89 0.007221219 ubox
19 95 0.003622793 ubox
19 96 0.052732761 ubox
19 102 0.109538918 ubox
19 103 0.059348893 ubox
19 104 0.012557746 ubox
19 108 0.986595525 ubox
19 109 0.033690423 ubox
19 112 0.015663399 ubox
19 113 0.042224604 ubox
19 114 0.006209105 ubox
20 69 0.008774642 ubox
20 71 0.021986795 ubox
20 88 0.007516496 ubox
20 94 0.007355449 ubox
20 95 0.073071032 ubox
20 101 0.113308796 ubox
20 102 0.056599388 ubox
20 103 0.017246118 ubox
20 108 0.044344102 ubox
20 112 0.042080660 ubox
20 113 0.004444027 ubox
21 32 0.065114433 ubox
21 70 0.022177281 ubox
21 87 0.007520458 ubox
21 100 0.113715351 ubox
21 110 0.044294028 ubox
22 31 0.059809177 ubox
22 32 0.596451936 ubox
22 69 0.019324786 ubox
22 70 0.013067798 ubox
22 71 0.004483868 ubox
22 72 0.053995913 ubox
22 86 0.007523789 ubox
22 94 0.342389829 ubox
22 95 0.022190823 ubox
22 96 0.024566922 ubox
22 101 0.022006353 ubox
22 102 0.030830546 ubox
22 103 0.055594149 ubox
22 104 0.260806187 ubox
22 109 0.044547924 ubox
22 113 0.008420141 ubox
23 31 0.619665218 ubox
23 69 0.017547126 ubox
23 70 0.004732196 ubox
23 71 0.054119343 ubox
23 85 0.007522829 ubox
23 91 0.008882720 ubox
23 93 0.343293765 ubox
23 94 0.020893436 ubox
23 95 0.024457779 ubox
23 100 0.015738744 ubox
23 101 0.030585318 ubox
23 102 0.056334827 ubox
23 103 0.258078178 ubox
23 108 0.044364503 ubox
23 112 0.009911865 ubox
24 30 0.620534441 ubox
24 68 0.017813350 ubox
24 84 0.007475288 ubox
24 90 0.008780355 ubox
24 92 0.342566751 ubox
24 111 0.010268452 ubox
25 29 0.503158784 ubox
25 32 0.019174067 ubox
25 70 0.058823687 ubox
25 110 0.010246809 ubox
26 31 0.019980547 ubox
26 69 0.060313990 ubox
26 91 0.277195528 ubox
26 93 0.036265083 ubox
26 109 0.010129063 ubox
27 66 0.005794700 ubox
27 68 0.059853850 ubox
27 90 0.273234537 ubox
27 92 0.036304241 ubox
28 65 0.004006418 ubox
28 100 0.025756066 ubox
29 66 0.033089255 ubox
29 73 0.005864514 ubox
29 97 0.015506356 ubox
29 99 0.026099063 ubox
30 65 0.009895436 ubox
30 69 0.776506059 ubox
30 72 0.004437236 ubox
30 96 0.007090959 ubox
31 64 0.007247271 ubox
31 68 0.777902680 ubox
32 63 0.004909525 ubox
32 66 0.018118854 ubox
32 67 0.754748531 ubox
33 65 0.013975810 ubox
35 65 0.981904092 ubox
36 64 0.999783373 ubox
36 106 0.004218132 ubox
37 63 0.999919441 ubox
37 105 0.004237069 ubox
38 62 0.999208435 ubox
38 95 0.005072865 ubox
38 104 0.004045727 ubox
39 61 0.999961346 ubox
39 94 0.005199514 ubox
39 103 0.003868942 ubox
40 60 0.999964415 ubox
40 93 0.005233860 ubox
40 102 0.003671668 ubox
41 59 0.999767098 ubox
41 92 0.005281100 ubox
42 58 0.999965160 ubox
42 91 0.005285769 ubox
42 93 0.004485352 ubox
43 57 0.999956637 ubox
43 90 0.005284863 ubox
43 92 0.004495387 ubox
44 56 0.999945937 ubox
44 89 0.005213327 ubox
44 91 0.004493879 ubox
45 55 0.995776047 ubox
45 90 0.004479281 ubox
46 54 0.562799268 ubox
46 55 0.090111396 ubox
47 54 0.809193228 ubox
48 53 0.721005260 ubox
48 86 0.006643905 ubox
49 85 0.006658264 ubox
50 84 0.005036195 ubox
51 84 0.004750950 ubox
52 83 0.006437113 ubox
54 81 0.006611092 ubox
55 80 0.006941391 ubox
56 79 0.006948233 ubox
57 78 0.006948359 ubox
58 77 0.006837822 ubox
60 75 0.006902721 ubox
61 74 0.006950493 ubox
62 73 0.007003357 ubox
63 72 0.007090533 ubox
64 71 0.007089385 ubox
65 73 0.003630065 ubox
65 97 0.007050833 ubox
66 72 0.013980026 ubox
66 82 0.005314407 ubox
66 91 0.004336129 ubox
66 96 0.015490691 ubox
66 101 0.018061396 ubox
66 104 0.008452937 ubox
67 81 0.005350129 ubox
67 100 0.018051716 ubox
67 110 0.006246011 ubox
68 80 0.005352774 ubox
68 91 0.015545196 ubox
68 93 0.194364728 ubox
68 109 0.006723506 ubox
69 79 0.005350155 ubox
69 90 0.014220092 ubox
69 92 0.194728675 ubox
69 106 0.003943627 ubox
70 105 0.003447032 ubox
70 106 0.004690160 ubox
70 107 0.803848904 ubox
71 77 0.005332645 ubox
71 105 0.005422860 ubox
71 106 0.868933286 ubox
72 76 0.005296963 ubox
72 90 0.297627662 ubox
72 105 0.869215956 ubox
73 83 0.004630404 ubox
73 89 0.409239280 ubox
73 95 0.003412562 ubox
73 96 0.028740284 ubox
73 101 0.015390126 ubox
73 102 0.018535730 ubox
73 103 0.040230195 ubox
73 104 0.867535736 ubox
74 82 0.004633878 ubox
74 88 0.409435620 ubox
74 89 0.011599113 ubox
74 94 0.003452233 ubox
74 95 0.025306952 ubox
74 96 0.505935899 ubox
74 100 0.003239968 ubox
74 101 0.014255303 ubox
74 102 0.046425941 ubox
74 103 0.756613304 ubox
74 104 0.003207799 ubox
75 81 0.004533345 ubox
75 87 0.409197204 ubox
75 88 0.011599133 ubox
75 93 0.003476324 ubox
75 94 0.021216856 ubox
75 95 0.660814104 ubox
75 96 0.040591479 ubox
75 101 0.040400019 ubox
75 102 0.625463957 ubox
75 103 0.004158024 ubox
76 80 0.004440078 ubox
76 86 0.409758766 ubox
76 93 0.016019877 ubox
76 94 0.786158856 ubox
76 95 0.047372571 ubox
76 96 0.013592023 ubox
76 100 0.007697926 ubox
76 101 0.459009129 ubox
76 102 0.004607836 ubox
77 85 0.409906329 ubox
77 91 0.015781799 ubox
77 93 0.893555254 ubox
77 94 0.042222010 ubox
77 95 0.017713503 ubox
77 100 0.161709816 ubox
77 101 0.004698950 ubox
78 84 0.409874265 ubox
78 90 0.015907458 ubox
78 92 0.896695480 ubox
79 83 0.383438027 ubox
79 85 0.004737073 ubox
79 89 0.015329326 ubox
79 91 0.896645392 ubox
79 93 0.025699600 ubox
80 84 0.004970939 ubox
80 90 0.895224190 ubox
80 92 0.024607787 ubox
83 90 0.037533600 ubox
83 92 0.148752719 ubox
84 89 0.080584599 ubox
84 91 0.150975360 ubox
84 93 0.065874583 ubox
85 90 0.150602248 ubox
85 92 0.065860002 ubox
91 105 0.006233876 ubox
92 104 0.006153472 ubox
93 106 0.018267874 ubox
94 105 0.018680596 ubox
94 106 0.066057474 ubox
95 105 0.065964075 ubox
95 106 0.357643080 ubox
96 105 0.358800553 ubox
100 106 0.011282673 ubox
100 107 0.055366307 ubox
101 105 0.016861002 ubox
101 106 0.060336897 ubox
105 114 0.004173039 ubox
106 113 0.004178935 ubox
119 127 0.004651159 ubox
120 126 0.004799176 ubox
121 125 0.004771115 ubox
4 127 0.9500000 lbox
5 126 0.9500000 lbox
6 125 0.9500000 lbox
7 124 0.9500000 lbox
8 123 0.9500000 lbox
9 122 0.9500000 lbox
10 119 0.9500000 lbox
11 118 0.9500000 lbox
12 117 0.9500000 lbox
13 114 0.9500000 lbox
14 113 0.9500000 lbox
15 112 0.9500000 lbox
16 111 0.9500000 lbox
17 110 0.9500000 lbox
18 109 0.9500000 lbox
19 108 0.9500000 lbox
30 69 0.9500000 lbox
31 68 0.9500000 lbox
32 67 0.9500000 lbox
35 65 0.9500000 lbox
36 64 0.9500000 lbox
37 63 0.9500000 lbox
38 62 0.9500000 lbox
39 61 0.9500000 lbox
40 60 0.9500000 lbox
41 59 0.9500000 lbox
42 58 0.9500000 lbox
43 57 0.9500000 lbox
44 56 0.9500000 lbox
45 55 0.9500000 lbox
47 54 0.9500000 lbox
48 53 0.9500000 lbox
70 107 0.9500000 lbox
71 106 0.9500000 lbox
72 105 0.9500000 lbox
73 104 0.9500000 lbox
74 103 0.9500000 lbox
75 102 0.9500000 lbox
76 101 0.9500000 lbox
77 93 0.9500000 lbox
78 92 0.9500000 lbox
79 91 0.9500000 lbox
80 90 0.9500000 lbox
showpage
end
%%EOF
