%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:11:43 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (HIST1H4B)
} def

/sequence { (\
AUGUCUGGUCGCGGCAAAGGCGGUAAAGGUUUGGGUAAGGGAGGUGCCAAGCGUCACCGAAAAGUGCUGCGGGAUAACAUCCAAGGCAUCACCAAACCGG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 9 0.003585683 ubox
1 24 0.005323534 ubox
1 80 0.044303807 ubox
1 89 0.577788023 ubox
2 8 0.004092087 ubox
2 16 0.015370980 ubox
2 22 0.023910076 ubox
2 23 0.003920466 ubox
2 25 0.005126562 ubox
2 76 0.038004156 ubox
2 79 0.051992695 ubox
2 88 0.678674886 ubox
2 91 0.006119659 ubox
2 94 0.006362952 ubox
2 99 0.025103049 ubox
3 10 0.005001387 ubox
3 15 0.017061098 ubox
3 21 0.033846347 ubox
3 24 0.005443126 ubox
3 30 0.005870537 ubox
3 75 0.041575582 ubox
3 78 0.054231855 ubox
3 87 0.708278546 ubox
3 90 0.005985292 ubox
3 92 0.005413966 ubox
3 93 0.006803409 ubox
3 97 0.167528012 ubox
3 98 0.029581572 ubox
4 14 0.012275200 ubox
4 20 0.033849466 ubox
4 29 0.017984748 ubox
4 74 0.041916786 ubox
4 77 0.052602920 ubox
4 86 0.708017578 ubox
4 91 0.005242255 ubox
4 96 0.166188537 ubox
4 100 0.030637236 ubox
5 13 0.012148176 ubox
5 14 0.012426811 ubox
5 19 0.033798004 ubox
5 23 0.009005894 ubox
5 28 0.024303908 ubox
5 29 0.005728721 ubox
5 73 0.042016423 ubox
5 85 0.707690569 ubox
5 86 0.009607225 ubox
5 99 0.048619327 ubox
5 100 0.634146098 ubox
6 13 0.012625634 ubox
6 16 0.004080308 ubox
6 18 0.033202306 ubox
6 22 0.008489810 ubox
6 25 0.008931153 ubox
6 27 0.024966328 ubox
6 28 0.005736501 ubox
6 72 0.035485689 ubox
6 76 0.014636177 ubox
6 79 0.004849209 ubox
6 83 0.394941721 ubox
6 84 0.576862297 ubox
6 85 0.008513181 ubox
6 88 0.004846075 ubox
6 91 0.013428460 ubox
6 94 0.195249099 ubox
6 99 0.653463830 ubox
7 12 0.015031711 ubox
7 15 0.005861121 ubox
7 21 0.006287232 ubox
7 24 0.008710438 ubox
7 75 0.017238077 ubox
7 78 0.006531211 ubox
7 81 0.033308109 ubox
7 82 0.559290551 ubox
7 87 0.005032577 ubox
7 90 0.014954130 ubox
7 93 0.201790488 ubox
7 98 0.665658536 ubox
8 15 0.026687964 ubox
8 21 0.014497529 ubox
8 24 0.023794758 ubox
8 75 0.008607567 ubox
8 78 0.012404242 ubox
8 80 0.034251261 ubox
8 81 0.558766852 ubox
8 87 0.009849496 ubox
8 89 0.014297010 ubox
8 92 0.201684567 ubox
8 97 0.665368983 ubox
9 14 0.025458596 ubox
9 20 0.015605299 ubox
9 23 0.050171068 ubox
9 72 0.554929251 ubox
9 73 0.038735242 ubox
9 74 0.027238556 ubox
9 77 0.017748320 ubox
9 79 0.054950243 ubox
9 86 0.009940847 ubox
9 88 0.013705191 ubox
9 91 0.188535938 ubox
9 96 0.627985238 ubox
10 19 0.015771155 ubox
10 22 0.063881248 ubox
10 71 0.987837862 ubox
10 72 0.028627810 ubox
10 73 0.022707240 ubox
10 85 0.008353911 ubox
11 21 0.064148109 ubox
11 24 0.030417173 ubox
11 70 0.996512591 ubox
12 20 0.064143572 ubox
12 23 0.031349369 ubox
12 69 0.996522908 ubox
12 71 0.004001302 ubox
13 68 0.995800738 ubox
13 70 0.003487976 ubox
14 21 0.031677878 ubox
14 67 0.996554489 ubox
15 20 0.031663607 ubox
15 66 0.996525809 ubox
16 65 0.986539459 ubox
18 32 0.005714486 ubox
19 31 0.006182567 ubox
19 58 0.005998170 ubox
20 30 0.006453833 ubox
20 57 0.005994522 ubox
21 29 0.006490871 ubox
21 59 0.994508596 ubox
22 55 0.005719271 ubox
22 58 0.996487110 ubox
23 54 0.004578674 ubox
23 57 0.996419337 ubox
24 53 0.003601557 ubox
24 56 0.970619367 ubox
28 55 0.037025556 ubox
28 98 0.076555299 ubox
29 52 0.995957249 ubox
29 54 0.010296705 ubox
29 97 0.076756690 ubox
30 50 0.006277066 ubox
30 51 0.995712686 ubox
30 96 0.076721109 ubox
31 49 0.005445053 ubox
31 50 0.993708998 ubox
31 51 0.011863502 ubox
31 95 0.076659421 ubox
31 100 0.007078844 ubox
32 49 0.989131968 ubox
32 50 0.013340023 ubox
32 56 0.003410585 ubox
32 94 0.076505465 ubox
32 99 0.011304236 ubox
33 48 0.952252974 ubox
33 55 0.005063045 ubox
33 93 0.075119717 ubox
33 98 0.012897484 ubox
34 47 0.912868274 ubox
34 48 0.293537376 ubox
34 54 0.004601301 ubox
34 92 0.073583539 ubox
34 93 0.014930754 ubox
34 97 0.012702459 ubox
34 98 0.026690007 ubox
35 45 0.038486086 ubox
35 47 0.398502438 ubox
35 52 0.007774621 ubox
35 57 0.003290025 ubox
35 87 0.014262510 ubox
35 92 0.020273026 ubox
35 97 0.026805956 ubox
36 44 0.091990034 ubox
36 46 0.479923932 ubox
36 51 0.007746647 ubox
36 56 0.003265833 ubox
36 86 0.014209074 ubox
36 91 0.024082959 ubox
36 96 0.026304607 ubox
37 45 0.462326591 ubox
39 48 0.012185865 ubox
39 58 0.059422550 ubox
39 93 0.026507866 ubox
40 47 0.013099852 ubox
40 48 0.003503078 ubox
40 57 0.059442855 ubox
40 58 0.012135529 ubox
40 82 0.015086483 ubox
40 92 0.026610656 ubox
40 93 0.015760415 ubox
41 47 0.003830470 ubox
41 55 0.058845444 ubox
41 57 0.012108844 ubox
41 81 0.015092241 ubox
41 92 0.015890926 ubox
42 54 0.058770190 ubox
42 80 0.014427609 ubox
43 55 0.016088853 ubox
43 58 0.020920443 ubox
43 90 0.047621243 ubox
44 52 0.058799339 ubox
44 54 0.015431930 ubox
44 57 0.020946413 ubox
44 78 0.012879712 ubox
44 89 0.048693125 ubox
45 51 0.058375690 ubox
45 53 0.016025653 ubox
45 56 0.020921685 ubox
45 76 0.005647177 ubox
45 77 0.011916097 ubox
45 88 0.048852867 ubox
46 52 0.017118653 ubox
46 55 0.020644239 ubox
46 75 0.007175371 ubox
46 87 0.048877122 ubox
47 51 0.017021166 ubox
47 53 0.014885910 ubox
47 73 0.014176991 ubox
47 86 0.048877198 ubox
48 72 0.014181249 ubox
48 85 0.048825364 ubox
50 68 0.003183802 ubox
51 67 0.003283967 ubox
51 70 0.050151292 ubox
52 66 0.003234478 ubox
52 69 0.050205129 ubox
52 71 0.009065702 ubox
53 67 0.009844112 ubox
53 68 0.047778470 ubox
53 70 0.009183916 ubox
54 69 0.008716610 ubox
55 66 0.050981003 ubox
56 65 0.051066528 ubox
57 64 0.050943967 ubox
59 90 0.011285724 ubox
60 89 0.009395789 ubox
64 89 0.060637132 ubox
64 92 0.003759175 ubox
65 88 0.063892844 ubox
65 91 0.005204199 ubox
66 87 0.064725337 ubox
66 90 0.005589152 ubox
67 86 0.064715135 ubox
68 85 0.064083546 ubox
68 88 0.006226190 ubox
69 87 0.006499967 ubox
70 86 0.006495040 ubox
71 82 0.055050860 ubox
71 93 0.016780592 ubox
72 80 0.007258033 ubox
72 81 0.056326416 ubox
72 82 0.812451288 ubox
72 92 0.017608514 ubox
72 93 0.012499608 ubox
73 80 0.038510892 ubox
73 81 0.814368228 ubox
73 90 0.022459773 ubox
73 92 0.012420234 ubox
74 80 0.803990479 ubox
74 89 0.022393350 ubox
75 79 0.712768335 ubox
75 88 0.021487930 ubox
80 86 0.004853672 ubox
81 85 0.005741023 ubox
81 99 0.003863763 ubox
81 100 0.015681169 ubox
82 99 0.015985590 ubox
85 93 0.617808066 ubox
85 98 0.028411130 ubox
86 92 0.616745102 ubox
86 97 0.028375906 ubox
89 100 0.037042686 ubox
90 99 0.083572949 ubox
92 100 0.412060305 ubox
93 99 0.416697324 ubox
5 100 0.9500000 lbox
6 99 0.9500000 lbox
7 98 0.9500000 lbox
8 97 0.9500000 lbox
9 96 0.9500000 lbox
10 71 0.9500000 lbox
11 70 0.9500000 lbox
12 69 0.9500000 lbox
13 68 0.9500000 lbox
14 67 0.9500000 lbox
15 66 0.9500000 lbox
16 65 0.9500000 lbox
21 59 0.9500000 lbox
22 58 0.9500000 lbox
23 57 0.9500000 lbox
24 56 0.9500000 lbox
29 52 0.9500000 lbox
30 51 0.9500000 lbox
31 50 0.9500000 lbox
32 49 0.9500000 lbox
33 48 0.9500000 lbox
34 47 0.9500000 lbox
72 82 0.9500000 lbox
73 81 0.9500000 lbox
74 80 0.9500000 lbox
75 79 0.9500000 lbox
85 93 0.9500000 lbox
86 92 0.9500000 lbox
showpage
end
%%EOF
