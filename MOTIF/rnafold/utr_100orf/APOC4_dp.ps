%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 04:16:36 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (APOC4)
} def

/sequence { (\
GAGUUGAGCACAGAGGGACAGAGGCACGGAACCCCCAGAAAUGUCCCUCCUCAGAAACAGGCUCCAGGCCCUGCCUGCCCUGUGCCUCUGCGUGCUGGUCCUGGCCUGCAUUGGGGCAUGCCAGCCAGAGGCCCAGGAAG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 52 0.082416154 ubox
1 64 0.608068043 ubox
2 51 0.082466261 ubox
2 63 0.610300364 ubox
2 72 0.004351226 ubox
2 76 0.011578662 ubox
3 9 0.014703302 ubox
3 11 0.014342371 ubox
3 50 0.082247636 ubox
3 58 0.083132496 ubox
3 62 0.610492464 ubox
3 71 0.004430126 ubox
3 74 0.003900285 ubox
3 75 0.011775903 ubox
3 78 0.021056369 ubox
4 8 0.013794266 ubox
4 10 0.013814978 ubox
4 54 0.623003632 ubox
4 55 0.047555078 ubox
4 56 0.023156834 ubox
4 57 0.079897905 ubox
4 60 0.074507222 ubox
4 61 0.581313542 ubox
4 77 0.007485175 ubox
4 136 0.005750321 ubox
4 138 0.007701879 ubox
4 139 0.013417798 ubox
4 140 0.006738806 ubox
5 12 0.027555553 ubox
5 53 0.917171830 ubox
5 54 0.035355047 ubox
5 55 0.017246590 ubox
5 56 0.048532360 ubox
5 59 0.098127273 ubox
5 60 0.265481531 ubox
5 135 0.006803059 ubox
5 138 0.012888250 ubox
5 139 0.007691043 ubox
6 11 0.030207005 ubox
6 52 0.961368247 ubox
6 58 0.103532511 ubox
6 64 0.152331951 ubox
6 134 0.006850246 ubox
7 51 0.961385824 ubox
7 63 0.152910219 ubox
7 96 0.012427425 ubox
8 50 0.960146602 ubox
8 62 0.153002933 ubox
8 74 0.004897105 ubox
8 78 0.011994315 ubox
8 95 0.012781950 ubox
9 61 0.152896124 ubox
9 73 0.004962987 ubox
9 77 0.011913346 ubox
9 94 0.012790575 ubox
10 72 0.004360298 ubox
10 76 0.010003754 ubox
10 93 0.012717016 ubox
11 90 0.003986487 ubox
11 92 0.012294789 ubox
12 48 0.003309270 ubox
12 51 0.081529308 ubox
12 89 0.005283555 ubox
13 49 0.996999023 ubox
13 50 0.060230030 ubox
13 52 0.011712319 ubox
13 88 0.005471913 ubox
14 48 0.999687981 ubox
14 51 0.010081108 ubox
14 87 0.005470213 ubox
15 47 0.999947368 ubox
15 50 0.006633790 ubox
15 86 0.005470427 ubox
16 46 0.999965101 ubox
16 49 0.005001044 ubox
16 85 0.005469213 ubox
17 45 0.999972343 ubox
18 44 0.999848593 ubox
18 83 0.005442538 ubox
19 43 0.999897326 ubox
19 82 0.005456759 ubox
20 42 0.991560490 ubox
20 81 0.005452103 ubox
21 80 0.005446570 ubox
23 33 0.070379646 ubox
23 34 0.082795146 ubox
23 35 0.071300891 ubox
23 36 0.229538032 ubox
23 79 0.005371848 ubox
24 32 0.070439039 ubox
24 33 0.083014056 ubox
24 34 0.070760077 ubox
24 35 0.227662499 ubox
24 78 0.005372372 ubox
25 77 0.005356885 ubox
26 76 0.004754623 ubox
28 34 0.435752888 ubox
28 35 0.742013891 ubox
28 36 0.454871086 ubox
28 75 0.003959190 ubox
29 33 0.429671322 ubox
29 34 0.741803281 ubox
29 35 0.454429803 ubox
29 74 0.003951370 ubox
37 42 0.005292351 ubox
42 59 0.003427994 ubox
43 58 0.003563930 ubox
44 57 0.003525090 ubox
47 54 0.003440919 ubox
49 54 0.003478647 ubox
50 60 0.047369325 ubox
50 61 0.003875576 ubox
51 59 0.045854017 ubox
51 60 0.007074779 ubox
52 60 0.026451882 ubox
52 73 0.003970585 ubox
52 77 0.025260655 ubox
52 90 0.011048943 ubox
53 63 0.008023663 ubox
53 72 0.004233852 ubox
53 76 0.028362130 ubox
53 89 0.011177379 ubox
54 62 0.010662319 ubox
54 64 0.026344425 ubox
54 71 0.004361530 ubox
54 75 0.029938208 ubox
54 88 0.011190169 ubox
55 63 0.025843803 ubox
55 87 0.010797950 ubox
57 83 0.175998437 ubox
58 73 0.119388732 ubox
58 77 0.697493209 ubox
58 82 0.181488188 ubox
59 72 0.119716141 ubox
59 76 0.700826363 ubox
59 81 0.181562448 ubox
60 70 0.080802577 ubox
60 71 0.100059721 ubox
60 75 0.701327846 ubox
60 79 0.049922784 ubox
60 80 0.181444462 ubox
61 69 0.104363273 ubox
61 70 0.075284802 ubox
61 74 0.701322810 ubox
61 78 0.070428319 ubox
61 79 0.181164785 ubox
62 68 0.123421326 ubox
62 73 0.699662137 ubox
62 77 0.063166824 ubox
62 140 0.009094990 ubox
63 67 0.111323842 ubox
63 138 0.004064452 ubox
63 139 0.008788926 ubox
64 137 0.003768725 ubox
65 73 0.045528340 ubox
65 77 0.692019971 ubox
65 136 0.003192528 ubox
66 72 0.097413285 ubox
66 76 0.700225425 ubox
67 71 0.096306741 ubox
67 75 0.701043184 ubox
67 133 0.003191258 ubox
68 74 0.701024351 ubox
68 78 0.003238928 ubox
68 132 0.003226480 ubox
69 73 0.695924447 ubox
69 77 0.003240646 ubox
69 131 0.003256742 ubox
70 130 0.003256323 ubox
71 128 0.003255441 ubox
72 127 0.003255113 ubox
73 126 0.003223031 ubox
75 124 0.003193360 ubox
75 140 0.050534866 ubox
76 123 0.003204927 ubox
76 139 0.051444158 ubox
78 137 0.054548295 ubox
79 136 0.038968783 ubox
79 137 0.978236237 ubox
80 136 0.982502868 ubox
80 137 0.006052417 ubox
81 135 0.983008268 ubox
81 136 0.004680683 ubox
82 119 0.003194165 ubox
82 134 0.981852038 ubox
83 118 0.003235068 ubox
84 117 0.003248428 ubox
84 132 0.998779446 ubox
85 116 0.003248178 ubox
85 131 0.999898309 ubox
86 115 0.003247772 ubox
86 130 0.999893153 ubox
87 114 0.003210435 ubox
87 129 0.999753832 ubox
88 113 0.003188295 ubox
88 128 0.999884480 ubox
89 127 0.999458613 ubox
90 125 0.026060282 ubox
90 126 0.997358828 ubox
91 124 0.036608821 ubox
92 111 0.004515012 ubox
92 125 0.075440845 ubox
93 110 0.004810948 ubox
93 123 0.025158032 ubox
93 124 0.045703550 ubox
93 127 0.005651452 ubox
94 109 0.004965124 ubox
94 121 0.047804586 ubox
94 122 0.018236379 ubox
94 125 0.995241736 ubox
94 126 0.005677531 ubox
95 108 0.004953821 ubox
95 120 0.051067424 ubox
95 124 0.997700372 ubox
95 128 0.003989912 ubox
96 118 0.006446713 ubox
96 123 0.998164997 ubox
96 127 0.005005631 ubox
97 106 0.004988666 ubox
97 117 0.006202818 ubox
97 122 0.998473880 ubox
97 126 0.005859813 ubox
97 133 0.007197755 ubox
98 105 0.005000952 ubox
98 117 0.051231320 ubox
98 121 0.998404900 ubox
98 125 0.006084389 ubox
98 132 0.007312928 ubox
99 104 0.004761756 ubox
99 115 0.005936009 ubox
99 116 0.051772577 ubox
99 118 0.003673565 ubox
99 120 0.982023306 ubox
99 124 0.003292077 ubox
99 131 0.007400697 ubox
99 138 0.009993380 ubox
100 114 0.006961860 ubox
100 115 0.054381701 ubox
100 116 0.018986204 ubox
100 130 0.007399063 ubox
100 137 0.010691611 ubox
101 113 0.006986809 ubox
101 114 0.054365100 ubox
101 115 0.018941982 ubox
101 116 0.009474725 ubox
101 124 0.011884367 ubox
101 128 0.007392288 ubox
101 136 0.010697431 ubox
102 110 0.008519287 ubox
102 113 0.053524374 ubox
102 114 0.012582153 ubox
102 115 0.008611907 ubox
102 118 0.555701256 ubox
102 120 0.018839963 ubox
102 123 0.013636894 ubox
102 127 0.007395132 ubox
102 135 0.010673604 ubox
103 109 0.011413290 ubox
103 112 0.050429229 ubox
103 117 0.558339681 ubox
103 119 0.083854939 ubox
103 122 0.013900179 ubox
103 126 0.007399882 ubox
103 133 0.006187279 ubox
103 134 0.008726264 ubox
104 111 0.039105282 ubox
104 117 0.825116071 ubox
104 121 0.013962764 ubox
104 125 0.007399847 ubox
104 132 0.008724316 ubox
104 133 0.006188598 ubox
105 114 0.055164587 ubox
105 115 0.543627305 ubox
105 116 0.835297634 ubox
105 120 0.014002131 ubox
105 124 0.007205688 ubox
105 131 0.010673715 ubox
106 113 0.059396275 ubox
106 114 0.543517021 ubox
106 115 0.835101663 ubox
106 130 0.010665284 ubox
107 113 0.530346832 ubox
107 114 0.825107511 ubox
107 118 0.014457822 ubox
107 129 0.010544414 ubox
108 112 0.246728993 ubox
108 117 0.014595736 ubox
108 121 0.007189391 ubox
108 125 0.003583746 ubox
109 116 0.014581424 ubox
109 120 0.007383411 ubox
109 124 0.003577037 ubox
110 119 0.007342744 ubox
111 118 0.006735822 ubox
111 124 0.008035018 ubox
112 123 0.010106340 ubox
113 122 0.010344489 ubox
114 121 0.010331800 ubox
115 126 0.003284449 ubox
116 125 0.003318306 ubox
117 124 0.003332808 ubox
4 54 0.9500000 lbox
5 53 0.9500000 lbox
6 52 0.9500000 lbox
7 51 0.9500000 lbox
8 50 0.9500000 lbox
13 49 0.9500000 lbox
14 48 0.9500000 lbox
15 47 0.9500000 lbox
16 46 0.9500000 lbox
17 45 0.9500000 lbox
18 44 0.9500000 lbox
19 43 0.9500000 lbox
20 42 0.9500000 lbox
28 35 0.9500000 lbox
29 34 0.9500000 lbox
58 77 0.9500000 lbox
59 76 0.9500000 lbox
60 75 0.9500000 lbox
61 74 0.9500000 lbox
62 73 0.9500000 lbox
79 137 0.9500000 lbox
80 136 0.9500000 lbox
81 135 0.9500000 lbox
82 134 0.9500000 lbox
84 132 0.9500000 lbox
85 131 0.9500000 lbox
86 130 0.9500000 lbox
87 129 0.9500000 lbox
88 128 0.9500000 lbox
89 127 0.9500000 lbox
90 126 0.9500000 lbox
94 125 0.9500000 lbox
95 124 0.9500000 lbox
96 123 0.9500000 lbox
97 122 0.9500000 lbox
98 121 0.9500000 lbox
99 120 0.9500000 lbox
104 117 0.9500000 lbox
105 116 0.9500000 lbox
106 115 0.9500000 lbox
107 114 0.9500000 lbox
showpage
end
%%EOF
