%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Wed Mar 18 00:40:28 2020
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 0 0 700 700
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: --noLP 

% To switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

/RNAplot 100 dict def

RNAplot begin

%%BeginProlog

/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/arccoords { % i j arccoords
  % puts optimal x1 y1 x2 y2 coordinates used in bezier curves from i to j
  % onto the stack
  dup 3 -1 roll dup 4 -1 roll lt dup dup 5 2 roll {exch} if
  dup 3 -1 roll dup 3 -1 roll exch sub 1 sub dup
  4 -2 roll 5 -1 roll {exch} if 4 2 roll
  sequence length dup 2 div exch 3 1 roll lt 
  {exch 5 -1 roll pop 4 -2 roll exch 4 2 roll}
  { 4 2 roll 5 -1 roll dup 6 1 roll {exch} if
    4 -2 roll exch pop dup 3 -1 roll dup 4 1 roll
    exch add 4 -1 roll dup 5 1 roll sub 1 sub
    5 -1 roll not {4 -2 roll exch 4 2 roll} if
  }ifelse
   % compute the scalingfactor and prepare (1-sf) and sf*r
  2 mul exch cpr 3 1 roll div dup
  3 -1 roll mul exch 1 exch sub exch
   % compute the coordinates
  3 -1 roll 1 sub coor exch get aload pop % get coord for i
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate y1
  4 -1 roll dup 5 1 roll mul 3 -1 roll dup 4 1 roll add exch % calculate x1
  5 -1 roll 1 sub coor exch get aload pop % get coord for j
  % duplicate j coord
  dup 3 -1 roll dup 4 1 roll exch 8 2 roll
  6 -1 roll dup 7 1 roll mul 5 -1 roll dup 6 1 roll add exch % calculate y2
  6 -1 roll mul 5 -1 roll add exch % calculate x2
  6 -2 roll % reorder
} bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall        % draw outline of 2nd sequence
     } {
        /i 0 def
        coor {
            /p coor i get def
            /a arcs i get def
            /l a length def
            l 0 eq {
                %% standard point... draw simple line
                p 0 2 getinterval aload pop lineto
            } {
                %% point in loop... draw arc around loop center
                /clockwise a 5 get def
                clockwise 0.0000000 gt {
                    a 0 5 getinterval aload pop arcn
                } {
                    a 0 5 getinterval aload pop arc
                } ifelse
            } ifelse
            /i i 1 add def
        } forall
    }
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
      currentdict (cpr) known
      { exch dup
        coor  exch 1 sub get aload pop moveto
        exch arccoords curveto
      }
      { coor exch 1 sub get aload pop moveto
        coor exch 1 sub get aload pop lineto
      }ifelse
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def
/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  /width {xmax xmin sub} bind def
  /height {ymax ymin sub} bind def
  10 10 translate
  680 size 10 add div dup scale
  size width sub width xmin sub xmax sub add 2 div 5 add
  size height sub height ymin sub ymax sub add 2 div 5 add
  translate
} bind def

%%EndProlog

% data start here
/sequence { (\
CGAACCCACCUGCAGGAACCAACUCCGGACACAACACCAGCAUUAAAACAAUUUUUUUUUGUCUGUUCAGACAUGACAACUUUUAUACCCAUCAUUUUUUCCAGUGUGGUAGUGGUUCUAUUUGUUAUUGGAAAUUUUGCUAAUGGCUUCAUAGCAUUGGUAAAUUCCAUUG\
) } def
/len { sequence length } bind def

/coor [
[324.40060425 436.21023560]
[313.21957397 434.75967407]
[302.41741943 431.51754761]
[292.27935791 426.56826782]
[283.07321167 420.04135132]
[275.04241943 412.10800171]
[268.39953613 402.97662354]
[263.32064819 392.88739014]
[259.94067383 382.10583496]
[258.34982300 370.91595459]
[258.59118652 359.61267090]
[260.65945435 348.49407959]
[264.50125122 337.85363770]
[270.01629639 327.97225952]
[277.06011963 319.11111450]
[267.30288696 307.71829224]
[257.54562378 296.32550049]
[247.78837585 284.93267822]
[238.03112793 273.53985596]
[228.27389526 262.14706421]
[218.51664734 250.75424194]
[211.75321960 247.70840454]
[208.68794250 239.06481934]
[199.13917542 227.49671936]
[189.48577881 216.01577759]
[179.72853088 204.62297058]
[169.97128296 193.23016357]
[155.81576538 188.59651184]
[152.71563721 173.08201599]
[142.95838928 161.68920898]
[122.99925995 171.56825256]
[101.02158356 175.16606140]
[78.95424652 172.16687012]
[58.73400879 162.83389282]
[42.13550949 147.98626709]
[30.61552811 128.92707825]
[25.18512535 107.32909393]
[26.32090378 85.08786011]
[11.98922539 80.66033173]
[-2.34245396 76.23281097]
[-16.71374321 71.93559265]
[-31.12345505 67.76904297]
[-44.84464645 75.14241791]
[-59.39879227 70.71166992]
[-66.34362030 57.58517075]
[-80.75333405 53.41861725]
[-95.16304779 49.25206375]
[-109.57276154 45.08551025]
[-124.25931549 51.54186630]
[-138.39646912 43.95764542]
[-141.13940430 28.15081596]
[-130.38397217 16.24702263]
[-114.38082886 17.37784004]
[-105.40620422 30.67579842]
[-90.99649048 34.84235001]
[-76.58677673 39.00890350]
[-62.17706680 43.17545700]
[-49.29858398 35.78084564]
[-34.62572861 39.80105209]
[-26.95690346 53.35932922]
[-12.54718971 57.52588272]
[-5.22193670 56.35900497]
[2.08507085 61.90113068]
[16.41674995 66.32865906]
[30.74842834 70.75617981]
[40.74419022 53.74278259]
[54.82286835 39.91666031]
[47.04935837 27.08807755]
[39.27584457 14.25949478]
[24.65052032 6.84114456]
[24.03264236 -9.54635906]
[38.05783081 -18.04495621]
[52.29817200 -9.91201973]
[52.10442734 6.48598337]
[59.87793732 19.31456566]
[67.65145111 32.14314651]
[74.53257751 29.27241325]
[81.66424561 27.09745407]
[88.97628784 25.63966942]
[96.39676666 24.91339874]
[103.85269928 24.92578506]
[111.27072906 25.67670822]
[118.57788849 27.15878105]
[125.70228577 29.35742378]
[132.57383728 32.25100708]
[139.12495422 35.81106567]
[145.29116821 40.00257492]
[151.01184082 44.78430939]
[156.23069763 50.10921860]
[160.89637756 55.92492676]
[164.96299744 62.17422104]
[168.39054871 68.79562378]
[171.14532471 75.72399139]
[173.20019531 82.89117432]
[174.53497314 90.22666931]
[175.13652039 97.65830231]
[174.99891663 105.11297607]
[174.12351990 112.51734924]
[172.51893616 119.79858398]
[170.20095825 126.88505554]
[167.19238281 133.70704651]
[163.52281189 140.19743347]
[159.22833252 146.29240417]
[154.35119629 151.93196106]
[164.10844421 163.32476807]
[178.96186829 168.77330017]
[181.36408997 183.47291565]
[191.12133789 194.86572266]
[200.87858582 206.25852966]
[208.86767578 210.76208496]
[210.70729065 217.94795227]
[220.25605774 229.51606750]
[229.90945435 240.99699402]
[239.66670227 252.38981628]
[249.42395020 263.78262329]
[259.18118286 275.17544556]
[268.93844604 286.56823730]
[278.69567871 297.96105957]
[288.45294189 309.35385132]
[305.64501953 300.83074951]
[324.49884033 297.32095337]
[343.58407593 299.08456421]
[361.45468140 305.98184204]
[376.75817871 317.48428345]
[388.33825684 332.71514893]
[395.32192993 350.51626587]
[397.18548584 369.53607178]
[393.79373169 388.33221436]
[385.40975952 405.48107910]
[396.89068604 415.13449097]
[408.37161255 424.78787231]
[419.85253906 434.44128418]
[431.33349609 444.09469604]
[437.82208252 445.63653564]
[441.91995239 449.63879395]
[443.04776001 454.31307983]
[454.17059326 464.37698364]
[465.29342651 474.44091797]
[476.41625977 484.50482178]
[487.53909302 494.56875610]
[498.66192627 504.63265991]
[509.78475952 514.69659424]
[520.90759277 524.76049805]
[532.03045654 534.82440186]
[543.15325928 544.88836670]
[551.64886475 548.34271240]
[554.38458252 555.23742676]
[565.32287598 565.50164795]
[581.40478516 568.71173096]
[586.40869141 584.32879639]
[575.18707275 596.28735352]
[559.28369141 592.28546143]
[555.05865479 576.43994141]
[544.12036133 566.17565918]
[533.08935547 556.01116943]
[521.96655273 545.94726562]
[510.84368896 535.88336182]
[499.72085571 525.81939697]
[488.59802246 515.75549316]
[477.47518921 505.69158936]
[466.35235596 495.62765503]
[455.22949219 485.56375122]
[444.10665894 475.49981689]
[432.98382568 465.43591309]
[421.68008423 455.57562256]
[410.19915771 445.92221069]
[398.71820068 436.26879883]
[387.23727417 426.61541748]
[375.75634766 416.96200562]
[367.03009033 424.07415771]
[357.26477051 429.68185425]
[346.71734619 433.63629150]
] def
/arcs [
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
[]
] def
/pairs [
[15 119]
[16 118]
[17 117]
[18 116]
[19 115]
[20 114]
[21 113]
[23 112]
[24 111]
[25 109]
[26 108]
[27 107]
[29 105]
[30 104]
[38 65]
[39 64]
[40 63]
[41 61]
[42 60]
[45 57]
[46 56]
[47 55]
[48 54]
[67 76]
[68 75]
[69 74]
[129 169]
[130 168]
[131 167]
[132 166]
[133 165]
[136 164]
[137 163]
[138 162]
[139 161]
[140 160]
[141 159]
[142 158]
[143 157]
[144 156]
[145 155]
[147 154]
[148 153]
] def

init

% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
showpage
end
%%EOF
