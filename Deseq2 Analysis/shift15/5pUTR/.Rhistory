iinstall.packages(ggplot2)
install.packages(ggplot2)
"ggplot2"
ggplot2
install.packages('ggplot2')
for (i in 1:21) {
file.name = strsplit(files[i],'/')
file.label = tail(file.name[[1]],1)
file.label = strsplit(file.label,'.csv')
deseq_out <- read.table(files[i], sep = ',',header = T)
deseq_out$GeneName <- mapIds(org.Hs.eg.db,
keys = as.character(deseq_out$X),
column = 'SYMBOL',
keytype ='ACCNUM',
multiVals = 'first')
genes_table <- read.table('Gene Groups/tpUTR_with_IREs.csv',sep=',',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$Gene
nidxs <-!idxs
dat <- data.frame(matrix(ncol = 2, nrow = 5522))
x <- c("Groups","logFC")
colnames(dat) <- x
dat$Groups[idxs] <- "fpUTR_with_IREs"
dat$Groups[!idxs] <- "Others"
dat$logFC <- deseq_out$log2FoldChange
two.group.unpaired <-
dat %>%
dabest(Groups,logFC,
idx=c("Others","fpUTR_with_IREs"),
paired=FALSE,reps =10000)
#two.group.unpaired
outname = paste("estimation stats/tpUTR_with_IREs/",file.label,"_dabest.jpg")
jpeg(outname)
print(plot(two.group.unpaired,rawplot.ylim = c(-1.5,3)))
dev.off()
print(1+1)
}
library(dabestr)
library(ggplot2)
library(org.Hs.eg.db)
library(AnnotationDbi)
files <- list.files(path="csv_raw/", pattern="*.csv", full.names=TRUE, recursive=FALSE)
for (i in 3:21) {
file.name = strsplit(files[i],'/')
file.label = tail(file.name[[1]],1)
file.label = strsplit(file.label,'.csv')
deseq_out <- read.table(files[i], sep = ',',header = T)
deseq_out$GeneName <- mapIds(org.Hs.eg.db,
keys = as.character(deseq_out$X),
column = 'SYMBOL',
keytype ='ACCNUM',
multiVals = 'first')
genes_table <- read.table('Gene Groups/fpUTR_with_IREs.csv',sep=',',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$Gene
nidxs <-!idxs
dat <- data.frame(matrix(ncol = 2, nrow = 5522))
x <- c("Groups","logFC")
colnames(dat) <- x
dat$Groups[idxs] <- "fpUTR_with_IREs"
dat$Groups[!idxs] <- "Others"
dat$logFC <- deseq_out$log2FoldChange
two.group.unpaired <-
dat %>%
dabest(Groups,logFC,
idx=c("Others","fpUTR_with_IREs"),
paired=FALSE,reps =10000)
#two.group.unpaired
outname = paste("estimation stats/fpUTR_with_IREs/",file.label,"_dabest.jpg")
jpeg(outname)
print(plot(two.group.unpaired,rawplot.ylim = c(-1.5,3)))
dev.off()
print(1+1)
}
for (i in 1:21) {
file.name = strsplit(files[i],'/')
file.label = tail(file.name[[1]],1)
file.label = strsplit(file.label,'.csv')
deseq_out <- read.table(files[i], sep = ',',header = T)
deseq_out$GeneName <- mapIds(org.Hs.eg.db,
keys = as.character(deseq_out$X),
column = 'SYMBOL',
keytype ='ACCNUM',
multiVals = 'first')
genes_table <- read.table('Gene Groups/tpUTR_with_IREs.csv',sep=',',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$Gene
nidxs <-!idxs
dat <- data.frame(matrix(ncol = 2, nrow = 5522))
x <- c("Groups","logFC")
colnames(dat) <- x
dat$Groups[idxs] <- "fpUTR_with_IREs"
dat$Groups[!idxs] <- "Others"
dat$logFC <- deseq_out$log2FoldChange
two.group.unpaired <-
dat %>%
dabest(Groups,logFC,
idx=c("Others","fpUTR_with_IREs"),
paired=FALSE,reps =10000)
#two.group.unpaired
outname = paste("estimation stats/tpUTR_with_IREs/",file.label,"_dabest.jpg")
jpeg(outname)
print(plot(two.group.unpaired,rawplot.ylim = c(-1.5,3)))
dev.off()
print(1+1)
}
setwd("Documents/HGLab/deseq_yue/withRefSeq/shift15/5pUTR/")
library(dabestr)
library(ggplot2)
library(org.Hs.eg.db)
library(AnnotationDbi)
files <- list.files(path="csv_raw/", pattern="*.csv", full.names=TRUE, recursive=FALSE)
for (i in 3:21) {
file.name = strsplit(files[i],'/')
file.label = tail(file.name[[1]],1)
file.label = strsplit(file.label,'.csv')
deseq_out <- read.table(files[i], sep = ',',header = T)
deseq_out$GeneName <- mapIds(org.Hs.eg.db,
keys = as.character(deseq_out$X),
column = 'SYMBOL',
keytype ='ACCNUM',
multiVals = 'first')
genes_table <- read.table('Gene Groups/fpUTR_with_IREs.csv',sep=',',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$Gene
nidxs <-!idxs
dat <- data.frame(matrix(ncol = 2, nrow = 5522))
x <- c("Groups","logFC")
colnames(dat) <- x
dat$Groups[idxs] <- "fpUTR_with_IREs"
dat$Groups[!idxs] <- "Others"
dat$logFC <- deseq_out$log2FoldChange
two.group.unpaired <-
dat %>%
dabest(Groups,logFC,
idx=c("Others","fpUTR_with_IREs"),
paired=FALSE,reps =10000)
#two.group.unpaired
outname = paste("estimation stats/fpUTR_with_IREs/",file.label,"_dabest.jpg")
jpeg(outname)
print(plot(two.group.unpaired,rawplot.ylim = c(-1.5,3)))
dev.off()
print(1+1)
}
for (i in 1:21) {
file.name = strsplit(files[i],'/')
file.label = tail(file.name[[1]],1)
file.label = strsplit(file.label,'.csv')
deseq_out <- read.table(files[i], sep = ',',header = T)
deseq_out$GeneName <- mapIds(org.Hs.eg.db,
keys = as.character(deseq_out$X),
column = 'SYMBOL',
keytype ='ACCNUM',
multiVals = 'first')
genes_table <- read.table('Gene Groups/tpUTR_with_IREs.csv',sep=',',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$Gene
nidxs <-!idxs
dat <- data.frame(matrix(ncol = 2, nrow = 5522))
x <- c("Groups","logFC")
colnames(dat) <- x
dat$Groups[idxs] <- "fpUTR_with_IREs"
dat$Groups[!idxs] <- "Others"
dat$logFC <- deseq_out$log2FoldChange
two.group.unpaired <-
dat %>%
dabest(Groups,logFC,
idx=c("Others","fpUTR_with_IREs"),
paired=FALSE,reps =10000)
#two.group.unpaired
outname = paste("estimation stats/tpUTR_with_IREs/",file.label,"_dabest.jpg")
jpeg(outname)
print(plot(two.group.unpaired,rawplot.ylim = c(-1.5,3)))
dev.off()
print(1+1)
}
getwd()
library(dabestr)
library(ggplot2)
library(org.Hs.eg.db)
library(AnnotationDbi)
files <- list.files(path="csv_raw/", pattern="*.csv", full.names=TRUE, recursive=FALSE)
i
file.name = strsplit(files[i],'/')
file.label = tail(file.name[[1]],1)
file.label = strsplit(file.label,'.csv')
file.name
genes_table <- read.table('/Users/zhaoy/Documents/HGLab/Gene Groups/Erythroid_29102019.csv',sep=',',header=T)
genes_table <- read.table('/Users/zhaoy/Documents/HGLab/Gene Groups/Erythroid_29102019.csv',sep=',',header=T)
genes_table <- read.table('/Users/zhaoy/Documents/HGLab/Gene Groups/Erythroid_29102019.csv',sep=',',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$Gene
View(genes_table)
idxs <-   deseq_out$GeneName %in% genes_table$GeneSymbol
sum(idxs)
nidxs <-!idxs
sum(nidxs)
genes_table <- read.table('/Users/zhaoy/Documents/HGLab/Gene Groups/lysosome.txt',sep=',',header=T)
View(genes_table)
idxs <-   deseq_out$GeneName %in% genes_table$lysosome
sum(idxs)
View(genes_table)
idxs <-   deseq_out$GeneName %in% genes_table$lysosome
sum(idxs)
deseq_out <- read.table(files[i], sep = ',',header = T)
deseq_out$GeneName <- mapIds(org.Hs.eg.db,
keys = as.character(deseq_out$X),
column = 'SYMBOL',
keytype ='ACCNUM',
multiVals = 'first')
genes_table <- read.table('/Users/zhaoy/Documents/HGLab/Gene Groups/lysosome.txt',sep=',',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$lysosome
sum(idxs)
genes_table <- read.table('/Users/zhaoy/Documents/HGLab/Gene Groups/Erythroid_29102019.csv',sep=',',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$GeneSymbol
sum(idxs)
View(genes_table)
genes_table <- read.table('/Users/zhaoy/Documents/HGLab/Gene Groups/lysosome.txt',sep=',',header=T)
deseq_out$GeneName
getwd()
idxs
View(genes_table)
genes_table <- read.table('/Users/zhaoy/Documents/HGLab/Gene Groups/lysosome.txt',sep='\t',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$lysosome
sum(idxs)
dir.create(file.path(getwd(), "estimation stats/lysosome"), showWarnings = FALSE)
dir.create(file.path(getwd(), "estimation stats/lysosome"), showWarnings = FALSE)
two.group.unpaired <-
dat %>%
dabest(Groups,logFC,
idx=c("Others","fpUTR_with_IREs"),
paired=FALSE,reps =10000)
library(dabestr)
library(ggplot2)
library(org.Hs.eg.db)
library(AnnotationDbi)
files <- list.files(path="csv_raw/", pattern="*.csv", full.names=TRUE, recursive=FALSE)
for (i in 1:21) {
file.name = strsplit(files[i],'/')
file.label = tail(file.name[[1]],1)
file.label = strsplit(file.label,'.csv')
deseq_out <- read.table(files[i], sep = ',',header = T)
deseq_out$GeneName <- mapIds(org.Hs.eg.db,
keys = as.character(deseq_out$X),
column = 'SYMBOL',
keytype ='ACCNUM',
multiVals = 'first')
genes_table <- read.table('/Users/zhaoy/Documents/HGLab/Gene Groups/Erythroid_29102019.csv',sep=',',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$GeneSymbol
nidxs <-!idxs
dat <- data.frame(matrix(ncol = 2, nrow = 5522))
x <- c("Groups","logFC")
colnames(dat) <- x
dat$Groups[idxs] <- "fpUTR_with_IREs"
dat$Groups[!idxs] <- "Others"
dat$logFC <- deseq_out$log2FoldChange
two.group.unpaired <-
dat %>%
dabest(Groups,logFC,
idx=c("Others","fpUTR_with_IREs"),
paired=FALSE,reps =10000)
#two.group.unpaired
dir.create(file.path(getwd(), "estimation stats/Erythroid_29102019"), showWarnings = FALSE)
outname = paste("estimation stats/Erythroid_29102019/",file.label,"dabest.jpg")
jpeg(outname)
print(plot(two.group.unpaired,rawplot.ylim = c(-1.5,3)))
dev.off()
print(1+1)
}
for (i in 1:21) {
file.name = strsplit(files[i],'/')
file.label = tail(file.name[[1]],1)
file.label = strsplit(file.label,'.csv')
deseq_out <- read.table(files[i], sep = ',',header = T)
deseq_out$GeneName <- mapIds(org.Hs.eg.db,
keys = as.character(deseq_out$X),
column = 'SYMBOL',
keytype ='ACCNUM',
multiVals = 'first')
genes_table <- read.table('/Users/zhaoy/Documents/HGLab/Gene Groups/lysosome.txt',sep='\t',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$lysosome
nidxs <-!idxs
dat <- data.frame(matrix(ncol = 2, nrow = 5522))
x <- c("Groups","logFC")
colnames(dat) <- x
dat$Groups[idxs] <- "fpUTR_with_IREs"
dat$Groups[!idxs] <- "Others"
dat$logFC <- deseq_out$log2FoldChange
two.group.unpaired <-
dat %>%
dabest(Groups,logFC,
idx=c("Others","fpUTR_with_IREs"),
paired=FALSE,reps =10000)
#two.group.unpaired
dir.create(file.path(getwd(), "estimation stats/lysosome"), showWarnings = FALSE)
outname = paste("estimation stats/lysosome/",file.label,"dabest.jpg")
jpeg(outname)
print(plot(two.group.unpaired,rawplot.ylim = c(-1.5,3)))
dev.off()
print(1+1)
}
dat
View(dat)
two.group.unpaired
getwd()
file.name = strsplit(files[i],'/')
file.label = tail(file.name[[1]],1)
file.label = strsplit(file.label,'.csv')
deseq_out <- read.table(files[i], sep = ',',header = T)
deseq_out$GeneName <- mapIds(org.Hs.eg.db,
keys = as.character(deseq_out$X),
column = 'SYMBOL',
keytype ='ACCNUM',
multiVals = 'first')
genes_table <- read.table('/Users/zhaoy/Documents/HGLab/Gene Groups/fpUTR_with_IREs_medium.csv',sep=',',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$GeneSymbol
nidxs <-!idxs
dat <- data.frame(matrix(ncol = 2, nrow = 5522))
x <- c("Groups","logFC")
colnames(dat) <- x
dat$Groups[idxs] <- "fpUTR_with_IREs_medium"
dat$Groups[!idxs] <- "Others"
dat$logFC <- deseq_out$log2FoldChange
two.group.unpaired <-
dat %>%
dabest(Groups,logFC,
idx=c("Others","fpUTR_with_IREs_medium"),
paired=FALSE,reps =10000)
dat$Groups[idxs] <- "fpUTR_with_IREs_medium"
dat$Groups[!idxs] <- "Others"
dat$logFC <- deseq_out$log2FoldChange
two.group.unpaired <-
dat %>%
dabest(Groups,logFC,
idx=c("Others","fpUTR_with_IREs_medium"),
paired=FALSE,reps =10000)
sum(idxs)
deseq_out <- read.table(files[i], sep = ',',header = T)
deseq_out$GeneName <- mapIds(org.Hs.eg.db,
keys = as.character(deseq_out$X),
column = 'SYMBOL',
keytype ='ACCNUM',
multiVals = 'first')
genes_table <- read.table('/Users/zhaoy/Documents/HGLab/Gene Groups/fpUTR_with_IREs_medium.csv',sep=',',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$GeneSymbol
sum(idxs)
idxs <-   deseq_out$GeneName %in% genes_table$Gene
nidxs <-!idxs
dat <- data.frame(matrix(ncol = 2, nrow = 5522))
x <- c("Groups","logFC")
colnames(dat) <- x
dat$Groups[idxs] <- "fpUTR_with_IREs_medium"
dat$Groups[!idxs] <- "Others"
dat$logFC <- deseq_out$log2FoldChange
two.group.unpaired <-
dat %>%
dabest(Groups,logFC,
idx=c("Others","fpUTR_with_IREs_medium"),
paired=FALSE,reps =10000)
print(plot(two.group.unpaired,rawplot.ylim = c(-1.5,3)))
library(dabestr)
library(ggplot2)
library(org.Hs.eg.db)
library(AnnotationDbi)
files <- list.files(path="csv_raw/", pattern="*.csv", full.names=TRUE, recursive=FALSE)
for (i in 1:21) {
file.name = strsplit(files[i],'/')
file.label = tail(file.name[[1]],1)
file.label = strsplit(file.label,'.csv')
deseq_out <- read.table(files[i], sep = ',',header = T)
deseq_out$GeneName <- mapIds(org.Hs.eg.db,
keys = as.character(deseq_out$X),
column = 'SYMBOL',
keytype ='ACCNUM',
multiVals = 'first')
genes_table <- read.table('/Users/zhaoy/Documents/HGLab/Gene Groups/fpUTR_with_IREs_medium.csv',sep=',',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$Gene
nidxs <-!idxs
dat <- data.frame(matrix(ncol = 2, nrow = 5522))
x <- c("Groups","logFC")
colnames(dat) <- x
dat$Groups[idxs] <- "fpUTR_with_IREs_medium"
dat$Groups[!idxs] <- "Others"
dat$logFC <- deseq_out$log2FoldChange
two.group.unpaired <-
dat %>%
dabest(Groups,logFC,
idx=c("Others","fpUTR_with_IREs_medium"),
paired=FALSE,reps =10000)
#two.group.unpaired
dir.create(file.path(getwd(), "estimation stats/fpUTR_with_IREs_medium"), showWarnings = FALSE)
outname = paste("estimation stats/fpUTR_with_IREs_medium/",file.label,"dabest.jpg")
jpeg(outname)
print(plot(two.group.unpaired,rawplot.ylim = c(-1.5,3)))
dev.off()
print(1+1)
}
for (i in 1:21) {
file.name = strsplit(files[i],'/')
file.label = tail(file.name[[1]],1)
file.label = strsplit(file.label,'.csv')
deseq_out <- read.table(files[i], sep = ',',header = T)
deseq_out$GeneName <- mapIds(org.Hs.eg.db,
keys = as.character(deseq_out$X),
column = 'SYMBOL',
keytype ='ACCNUM',
multiVals = 'first')
genes_table <- read.table('/Users/zhaoy/Documents/HGLab/Gene Groups/tpUTR_with_IREs_medium.csv',sep=',',header=T)
idxs <-   deseq_out$GeneName %in% genes_table$Gene
nidxs <-!idxs
dat <- data.frame(matrix(ncol = 2, nrow = 5522))
x <- c("Groups","logFC")
colnames(dat) <- x
dat$Groups[idxs] <- "tpUTR_with_IREs_medium"
dat$Groups[!idxs] <- "Others"
dat$logFC <- deseq_out$log2FoldChange
two.group.unpaired <-
dat %>%
dabest(Groups,logFC,
idx=c("Others","tpUTR_with_IREs_medium"),
paired=FALSE,reps =10000)
#two.group.unpaired
dir.create(file.path(getwd(), "estimation stats/tpUTR_with_IREs_medium"), showWarnings = FALSE)
outname = paste("estimation stats/tpUTR_with_IREs_medium/",file.label,"dabest.jpg")
jpeg(outname)
print(plot(two.group.unpaired,rawplot.ylim = c(-1.5,3)))
dev.off()
print(1+1)
}
