iinstall.packages(ggplot2)
install.packages(ggplot2)
"ggplot2"
ggplot2
install.packages('ggplot2')
getwd()
setwd('/Users/zhaoy/Documents/My Projects/RBC/Deseq2 Analysis/shift15/coding/')
library(DESeq2)
library(IHW)
#load read count table
#df_te <- read.table('/dir', sep = '\t',header = T) # dir = path where df_te is stored
df_te <- read.table('cdReadsFiltered.csv', sep = ',',header = T)
rownames(df_te) <- df_te[,1]
df_te[,1]<-NULL
###call design matrix
colData = read.table('combined_design.txt',sep='\t',header=TRUE) # dir = path where de_te_design is stored
###deseq analysis
###use a design formula that models the assay different at t0, the diff over time,
###and any assay-specific differences over time (the interaction term assay:time)
design = ~ combined
#colData$assay <- factor(colData$assay, levels = c("RPF0")) #"RNA"))
dds <- DESeqDataSetFromMatrix(countData = df_te, colData = colData,design = design)
#run DESeq
dds <- DESeq(dds)
View(dds)
dds
counts(dds, normalized=TRUE)
dds <- estimateSizeFactors(dds)
counts(dds, normalized=TRUE)
write.csv(counts(dds, normalized=TRUE),'csv_raw/deseq_normed_count.csv')
