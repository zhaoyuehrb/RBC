geom_text_repel(data = subset(res_tableDE, ((log2FoldChange > 1 | log2FoldChange < -1) & -log10(padj) > 17)),
#data = subset(res_tableDE, SYMBOL %in% c('Htra2','Tomm7','Sqstm1')), #for rna autophagy
aes(label = SYMBOL), size = 3,
box.padding = unit(0.4, 'lines'),
point.padding = unit(0.4, 'lines'),
segment.size = 0.2, segment.colour = 'grey50')+
theme_bw() +
ggtitle(paste(type,day,sep = '')) +
xlab(bquote(~log[2]~ "FC")) +
ylab(bquote(~-log[10]~italic(p-adj)))+
theme(legend.position = c(0.15,0.9),
#legend.position = 'none',
legend.title = element_blank(),
legend.background = element_rect(color = 'black',size = 0.5,linetype= 'solid'),
legend.text = element_text(size = 12),
plot.title = element_text(size = rel(1.5),hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
axis.text.y = element_text(size = 12),
axis.text.x = element_text(size=14))
save_dir <- '/Users/Yue/Documents/HGLab/deseq_yue/combined_design/volc_plots/'
#filepath <- paste(save_dir,folder_label,'/',type,toString(day),'.png',sep = '')
filepath <- paste(save_dir,'/',type,'.png',sep = '')
ggsave(filepath,width = 9, height = 7)
}
plot_volcano(res_0_L24,'L24_0',10000,c(),'','',xlims=c(-5,5), ylims=c(0,10))
###function to compare different combinations of factors
filter_sig_res <- function(dds, factors) {
res_df <- results(dds, contrast = (factors),test = "Wald",alpha = alpha,cooksCutoff = FALSE,independentFiltering = FALSE)
summary(res_df)
res_df <- na.omit(res_df)
# #
# res_df$SYMBOL <- mapIds(org.Mm.eg.db,
#                         keys = as.character(rownames(res_df)),
#                         column = 'SYMBOL',
#                         keytype = 'ACCNUM',
#                         multiVals = 'first')
# ###remove statistically insignificant genes
# res_df <- res_df[res_df$padj<alpha,]
# res_df <- data.frame(ACCNUM=row.names(data.frame(res_df)), res_df,row.names = NULL)
# # #
# ###select columns Accnum and Log2FC
# res_df <- res_df[,c("ACCNUM","log2FoldChange")]
# res_df <- data.frame(res_df, row.names=NULL)
# #
# # ###select AccNum, log2FC and padj
# # res_df <- data.frame(ACCNUM = row.names(data.frame(res_df)), res_df, row.names = NULL)
# # res_df <- res_df[,c("ACCNUM","log2FoldChange","padj")]
###add symbol and select padj
# res_df <- data.frame(res_df)
# rownames(res_df) <- NULL
# res_df <- res_df[,c("SYMBOL","log2FoldChange")]
}
res_1_L24 <- filter_sig_res(dds,c("combined","L241","RPF1"))
library(DESeq2)
library(IHW)
#load read count table
#df_te <- read.table('/dir', sep = '\t',header = T) # dir = path where df_te is stored
df_te <- read.table('/Users/Yue/Documents/HGLab/deseq_yue/combined_design/Fil10_BioRep_ReadCounts.txt', sep = '\t',header = T)
rownames(df_te) <- df_te[,1]
df_te[,1]<-NULL
###call design matrix
colData = read.table('/Users/Yue/Documents/HGLab/deseq_yue/combined_design/combined_design.txt',sep='\t',header=TRUE) # dir = path where de_te_design is stored
###deseq analysis
###use a design formula that models the assay different at t0, the diff over time,
###and any assay-specific differences over time (the interaction term assay:time)
design = ~ combined
#colData$assay <- factor(colData$assay, levels = c("RPF0")) #"RNA"))
dds <- DESeqDataSetFromMatrix(countData = df_te, colData = colData,design = design)
#run DESeq
dds <- DESeq(dds)
alpha <- 0.05
res <- results(dds,alpha = alpha)
#res <- results(dds,alpha = alpha, filterFun = IHW)
resultsNames(dds)
test_design <- model.matrix(design, colData)
###function to compare different combinations of factors
filter_sig_res <- function(dds, factors) {
res_df <- results(dds, contrast = (factors),test = "Wald",alpha = alpha,cooksCutoff = FALSE,independentFiltering = FALSE)
summary(res_df)
res_df <- na.omit(res_df)
# #
# res_df$SYMBOL <- mapIds(org.Mm.eg.db,
#                         keys = as.character(rownames(res_df)),
#                         column = 'SYMBOL',
#                         keytype = 'ACCNUM',
#                         multiVals = 'first')
# ###remove statistically insignificant genes
# res_df <- res_df[res_df$padj<alpha,]
# res_df <- data.frame(ACCNUM=row.names(data.frame(res_df)), res_df,row.names = NULL)
# # #
# ###select columns Accnum and Log2FC
# res_df <- res_df[,c("ACCNUM","log2FoldChange")]
# res_df <- data.frame(res_df, row.names=NULL)
# #
# # ###select AccNum, log2FC and padj
# # res_df <- data.frame(ACCNUM = row.names(data.frame(res_df)), res_df, row.names = NULL)
# # res_df <- res_df[,c("ACCNUM","log2FoldChange","padj")]
###add symbol and select padj
# res_df <- data.frame(res_df)
# rownames(res_df) <- NULL
# res_df <- res_df[,c("SYMBOL","log2FoldChange")]
}
res_0_L24 <- filter_sig_res(dds,c("combined","L240","RPF0"))
View(res_0_L24)
res_0_S15 <- filter_sig_res(dds,c("combined","S150","RPF0"))
res_1_S15 <- filter_sig_res(dds,c("combined","S151","RPF1"))
res_2_S15 <- filter_sig_res(dds,c("combined","S152","RPF2"))
?results
View(test_design)
resultsNames(dds)
dds <- makeExampleDESeqDataSet(m=4)
dds <- DESeq(dds)
resultsNames(dds)
View(dds)
dds <- makeExampleDESeqDataSet(n=100,m=12)
dds$genotype <- factor(rep(rep(c("I","II"),each=3),2))
design(dds) <- ~ genotype + condition + genotype:condition
dds <- DESeq(dds)
resultsNames(dds)
View(dds.design)
names(dds.design)
names(dds)
levels(dds)
View(dds)
View(dds$condition)
View(dds$design)
View(dds$genotype)
test_design <- model.matrix(design)
test_design <- model.matrix(design)
test_design <- model.matrix(dds$design)
View(dds)
View(test_design)
log10(0,05)
log10(0.05)
log10(0.04)
log10(0.1)
assay
assay(dds)
assay(res)
res
library(ggplot2)
library(ggrepel)
library(org.Hs.eg.db)
L24 <- read.table('csv_raw/ER_L24_t1.csv', sep = ',',header = T)
S15 <- read.table('csv_raw/ER_S15_t1.csv', sep = ',',header = T)
TEfc <- read.table('csv_raw/TE_t2_t1.csv',sep = ',', header = T)
getwd()
setwd("/Users/Yue/Documents/HGLab new/RBC/Deseq2 Analysis/shift15/coding/")
L24 <- read.table('csv_raw/ER_L24_t1.csv', sep = ',',header = T)
S15 <- read.table('csv_raw/ER_S15_t1.csv', sep = ',',header = T)
TEfc <- read.table('csv_raw/TE_t2_t1.csv',sep = ',', header = T)
RNAfc <- read.table('csv_raw/RNA_T2_against_T1.csv',sep = ',', header = T)
L24 <- L24[order(L24$log2FoldChange),]
L24 <- L24[L24$padj<0.05,]
L24up <- L24[L24$log2FoldChange>1,]
L24down <- head(L24,nrow(L24up))
list_of_genes <- mapIds(org.Hs.eg.db,
keys = as.character(TEfc$X),
column = 'SYMBOL',
keytype ='ACCNUM',
multiVals = 'first')
L24_up_id = is.element(TEfc$X,L24up$X)
L24_down_id = is.element(TEfc$X,L24down$X)
S15 <- S15[order(S15$log2FoldChange),]
S15 <- S15[S15$padj<0.05,]
S15up <- S15[S15$log2FoldChange>1,]
S15down <- head(S15,nrow(S15up))
S15_up_id = is.element(TEfc$X,S15up$X)
S15_down_id = is.element(TEfc$X,S15down$X)
#L24 up and S15 up
#anchor
group = rep('Others',7990)
both_up <- L24_up_id & S15_up_id
group[both_up] <- "L24 up S15 up"
both_down <- L24_down_id & S15_down_id
group[both_down] <- "L24 down S15 down"
df = data.frame(TEfc = TEfc$log2FoldChange,
RNAfc = RNAfc$log2FoldChange,
Symbol = list_of_genes,
X = TEfc$X,
Group = group)
df$Group <- factor(df$Group, levels = c("L24 up S15 up","L24 down S15 down","Others"))
ggplot(df, aes(x=RNAfc, y=TEfc)) +
geom_point(data = df[df$Group == "Others",], alpha = 0.5, colour = "grey") +
geom_point(data = df[df$Group != "Others",], aes(colour = Group)) +
geom_abline(slope=1, linetype = 'dashed', color = 'brown', size = 0.7) +
#scale_fill_discrete(values = c("#d8b365", "#f5f5f5", "#5ab4ac")) +
scale_color_manual(values=c('red','green','orange')) +
ylim(-1.5,2) +
xlim(-4,8) +
theme_bw() +
geom_text_repel(
data = subset(df, (X %in% L24up$X | X %in% S15up$X) & (RNAfc > 2.3 | RNAfc < -1.7 | abs(TEfc > 1.6))),
aes(label = Symbol), size = 3,
box.padding = unit(0.4, 'lines'),
point.padding = unit(0.4, 'lines'),
force = 3,
segment.size = 0.2, segment.colour = 'grey50'
) +
ggtitle("TE fold change against RNA fold change") +
theme(legend.position = c(0.8,0.9),
#legend.position = 'none',
legend.title = element_blank(),
legend.background = element_rect(color = 'black',size = 0.5,linetype= 'solid'),
legend.text = element_text(size = 12),
plot.title = element_text(size = rel(1.5),hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
axis.text.y = element_text(size = 12),
axis.text.x = element_text(size=14))
ggplot(df, aes(x=RNAfc, y=TEfc)) +
geom_point(data = df[df$Group == "Others",], alpha = 0.5, colour = "grey") +
geom_point(data = df[df$Group != "Others",], aes(colour = Group)) +
geom_abline(slope=1, linetype = 'dashed', color = 'brown', size = 0.7) +
#scale_fill_discrete(values = c("#d8b365", "#f5f5f5", "#5ab4ac")) +
scale_color_manual(values=c('red','green','orange')) +
ylim(-1.5,2) +
xlim(-4,8) +
theme_bw() +
geom_text_repel(
data = subset(df, (X %in% L24up$X | X %in% S15up$X) & (RNAfc > -2.3 | RNAfc < -1.7 | abs(TEfc > 1.6))),
aes(label = Symbol), size = 3,
box.padding = unit(0.4, 'lines'),
point.padding = unit(0.4, 'lines'),
force = 3,
segment.size = 0.2, segment.colour = 'grey50'
) +
ggtitle("TE fold change against RNA fold change") +
theme(legend.position = c(0.8,0.9),
#legend.position = 'none',
legend.title = element_blank(),
legend.background = element_rect(color = 'black',size = 0.5,linetype= 'solid'),
legend.text = element_text(size = 12),
plot.title = element_text(size = rel(1.5),hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
axis.text.y = element_text(size = 12),
axis.text.x = element_text(size=14))
ggplot(df, aes(x=RNAfc, y=TEfc)) +
geom_point(data = df[df$Group == "Others",], alpha = 0.5, colour = "grey") +
geom_point(data = df[df$Group != "Others",], aes(colour = Group)) +
geom_abline(slope=1, linetype = 'dashed', color = 'brown', size = 0.7) +
#scale_fill_discrete(values = c("#d8b365", "#f5f5f5", "#5ab4ac")) +
scale_color_manual(values=c('red','green','orange')) +
ylim(-1.5,2) +
xlim(-4,8) +
theme_bw() +
geom_text_repel(
data = subset(df, (X %in% both_up$X | X %in% both_down$X) & (RNAfc > -2.3 | RNAfc < -1.7 | abs(TEfc > 1.6))),
aes(label = Symbol), size = 3,
box.padding = unit(0.4, 'lines'),
point.padding = unit(0.4, 'lines'),
force = 3,
segment.size = 0.2, segment.colour = 'grey50'
) +
ggtitle("TE fold change against RNA fold change") +
theme(legend.position = c(0.8,0.9),
#legend.position = 'none',
legend.title = element_blank(),
legend.background = element_rect(color = 'black',size = 0.5,linetype= 'solid'),
legend.text = element_text(size = 12),
plot.title = element_text(size = rel(1.5),hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
axis.text.y = element_text(size = 12),
axis.text.x = element_text(size=14))
S15up
ggplot(df, aes(x=RNAfc, y=TEfc)) +
geom_point(data = df[df$Group == "Others",], alpha = 0.5, colour = "grey") +
geom_point(data = df[df$Group != "Others",], aes(colour = Group)) +
geom_abline(slope=1, linetype = 'dashed', color = 'brown', size = 0.7) +
#scale_fill_discrete(values = c("#d8b365", "#f5f5f5", "#5ab4ac")) +
scale_color_manual(values=c('red','green','orange')) +
ylim(-1.5,2) +
xlim(-4,8) +
theme_bw() +
geom_text_repel(
data = subset(df, (Group != 'Others') & (RNAfc > -2.3 | RNAfc < -1.7 | abs(TEfc > 1.6))),
aes(label = Symbol), size = 3,
box.padding = unit(0.4, 'lines'),
point.padding = unit(0.4, 'lines'),
force = 3,
segment.size = 0.2, segment.colour = 'grey50'
) +
ggtitle("TE fold change against RNA fold change") +
theme(legend.position = c(0.8,0.9),
#legend.position = 'none',
legend.title = element_blank(),
legend.background = element_rect(color = 'black',size = 0.5,linetype= 'solid'),
legend.text = element_text(size = 12),
plot.title = element_text(size = rel(1.5),hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
axis.text.y = element_text(size = 12),
axis.text.x = element_text(size=14))
ggsave('scatter_L24_S15_feb/Both up down in TE and RNA t2_t1.png',width = 9, height = 7)
L24S15 <- read.table('csv_raw/L24_against_S15_t1.csv', sep = ',',header = T)
L24S15 <- L24S15[order(L24S15$log2FoldChange),]
L24S15 <- L24S15[L24S15$padj<0.05,]
L24S15down <- L24S15[L24S15$log2FoldChange<-1,]
View(L24S15down)
View(L24S15)
L24S15 <- read.table('csv_raw/L24_against_S15_t1.csv', sep = ',',header = T)
View(L24S15)
L24S15 <- L24S15[order(L24S15$log2FoldChange),]
L24S15 <- L24S15[L24S15$padj<0.05,]
L24S15down <- L24S15[L24S15$log2FoldChange<-1,]
L24S15 <- read.table('csv_raw/L24_against_S15_t1.csv', sep = ',',header = T)
L24S15 <- L24S15[order(L24S15$log2FoldChange),]
L24S15 <- L24S15[L24S15$padj<0.05,]
View(L24S15)
L24S15$log2FoldChange<-1
L24S15 <- read.table('csv_raw/L24_against_S15_t1.csv', sep = ',',header = T)
L24S15 <- L24S15[order(L24S15$log2FoldChange),]
L24S15 <- L24S15[L24S15$padj<0.05,]
L24S15down <- L24S15[L24S15$log2FoldChange< -1,]
L24down <- head(L24,nrow(L24up))
View(L24S15down)
L24S15up <- tail(L24S15,nrow(L24S15down))
View(L24S15down)
View(L24S15up)
L24_more_S15 = is.element(TEfc$X,L24S15up$X)
L24_less_S15 = is.element(TEfc$X,L24S15down$X)
sum(L24_more_S15)
sum(both_up)
sum(both_up & L24_more_S15)
sum(both_down & L24_less_S15)
sum(both_down & L24_more_S15)
sum(both_up & L24_less_S15)
group[L24_more_S15] <- "L24 > S15"
group[L24_less_S15] <- "L24 < S15"
df = data.frame(TEfc = TEfc$log2FoldChange,
RNAfc = RNAfc$log2FoldChange,
Symbol = list_of_genes,
X = TEfc$X,
Group = group)
df$Group <- factor(df$Group, levels = c("L24 up S15 up","L24 down S15 down","L24 > S15","L24 < S15","Others"))
ggplot(df, aes(x=RNAfc, y=TEfc)) +
geom_point(data = df[df$Group == "Others",], alpha = 0.5, colour = "grey") +
geom_point(data = df[df$Group != "Others",], aes(colour = Group)) +
geom_abline(slope=1, linetype = 'dashed', color = 'brown', size = 0.7) +
#scale_fill_discrete(values = c("#d8b365", "#f5f5f5", "#5ab4ac")) +
scale_color_manual(values=c('red','green','orange')) +
ylim(-1.5,2) +
xlim(-4,8) +
theme_bw() +
geom_text_repel(
data = subset(df, (Group != 'Others') & (RNAfc > -2.3 | RNAfc < -1.7 | abs(TEfc > 1.6))),
aes(label = Symbol), size = 3,
box.padding = unit(0.4, 'lines'),
point.padding = unit(0.4, 'lines'),
force = 3,
segment.size = 0.2, segment.colour = 'grey50'
) +
ggtitle("TE fold change against RNA fold change") +
theme(legend.position = c(0.8,0.9),
#legend.position = 'none',
legend.title = element_blank(),
legend.background = element_rect(color = 'black',size = 0.5,linetype= 'solid'),
legend.text = element_text(size = 12),
plot.title = element_text(size = rel(1.5),hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
axis.text.y = element_text(size = 12),
axis.text.x = element_text(size=14))
ggplot(df, aes(x=RNAfc, y=TEfc)) +
geom_point(data = df[df$Group == "Others",], alpha = 0.5, colour = "grey") +
geom_point(data = df[df$Group != "Others",], aes(colour = Group)) +
geom_abline(slope=1, linetype = 'dashed', color = 'brown', size = 0.7) +
#scale_fill_discrete(values = c("#d8b365", "#f5f5f5", "#5ab4ac")) +
scale_color_manual(values=c('red','green','orange','blue')) +
ylim(-1.5,2) +
xlim(-4,8) +
theme_bw() +
geom_text_repel(
data = subset(df, (Group != 'Others') & (RNAfc > -2.3 | RNAfc < -1.7 | abs(TEfc > 1.6))),
aes(label = Symbol), size = 3,
box.padding = unit(0.4, 'lines'),
point.padding = unit(0.4, 'lines'),
force = 3,
segment.size = 0.2, segment.colour = 'grey50'
) +
ggtitle("TE fold change against RNA fold change") +
theme(legend.position = c(0.8,0.9),
#legend.position = 'none',
legend.title = element_blank(),
legend.background = element_rect(color = 'black',size = 0.5,linetype= 'solid'),
legend.text = element_text(size = 12),
plot.title = element_text(size = rel(1.5),hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
axis.text.y = element_text(size = 12),
axis.text.x = element_text(size=14))
ggplot(df, aes(x=RNAfc, y=TEfc)) +
geom_point(data = df[df$Group == "Others",], alpha = 0.5, colour = "grey") +
geom_point(data = df[df$Group != "Others",], aes(colour = Group)) +
geom_abline(slope=1, linetype = 'dashed', color = 'brown', size = 0.7) +
#scale_fill_discrete(values = c("#d8b365", "#f5f5f5", "#5ab4ac")) +
scale_color_manual(values=c('red','green','orange','blue')) +
ylim(-1.5,2) +
xlim(-4,8) +
theme_bw() +
geom_text_repel(
data = subset(df, (Group != 'Others') & (RNAfc > 1 | RNAfc < -1.7 | abs(TEfc > 1.6))),
aes(label = Symbol), size = 3,
box.padding = unit(0.4, 'lines'),
point.padding = unit(0.4, 'lines'),
force = 3,
segment.size = 0.2, segment.colour = 'grey50'
) +
ggtitle("TE fold change against RNA fold change") +
theme(legend.position = c(0.8,0.9),
#legend.position = 'none',
legend.title = element_blank(),
legend.background = element_rect(color = 'black',size = 0.5,linetype= 'solid'),
legend.text = element_text(size = 12),
plot.title = element_text(size = rel(1.5),hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
axis.text.y = element_text(size = 12),
axis.text.x = element_text(size=14))
ggplot(df, aes(x=RNAfc, y=TEfc)) +
geom_point(data = df[df$Group == "Others",], alpha = 0.5, colour = "grey") +
geom_point(data = df[df$Group != "Others",], aes(colour = Group)) +
geom_abline(slope=1, linetype = 'dashed', color = 'brown', size = 0.7) +
#scale_fill_discrete(values = c("#d8b365", "#f5f5f5", "#5ab4ac")) +
scale_color_manual(values=c('red','green','orange','blue')) +
ylim(-1.5,2) +
xlim(-4,8) +
theme_bw() +
geom_text_repel(
data = subset(df, (Group != 'Others') & (RNAfc > 2 | RNAfc < -0.3 | TEfc > 1 | TEfc < -0.6)),
aes(label = Symbol), size = 3,
box.padding = unit(0.4, 'lines'),
point.padding = unit(0.4, 'lines'),
force = 3,
segment.size = 0.2, segment.colour = 'grey50'
) +
ggtitle("TE fold change against RNA fold change") +
theme(legend.position = c(0.8,0.9),
#legend.position = 'none',
legend.title = element_blank(),
legend.background = element_rect(color = 'black',size = 0.5,linetype= 'solid'),
legend.text = element_text(size = 12),
plot.title = element_text(size = rel(1.5),hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
axis.text.y = element_text(size = 12),
axis.text.x = element_text(size=14))
ggplot(df, aes(x=RNAfc, y=TEfc)) +
geom_point(data = df[df$Group == "Others",], alpha = 0.5, colour = "grey") +
geom_point(data = df[df$Group != "Others",], aes(colour = Group)) +
geom_abline(slope=1, linetype = 'dashed', color = 'brown', size = 0.7) +
#scale_fill_discrete(values = c("#d8b365", "#f5f5f5", "#5ab4ac")) +
scale_color_manual(values=c('red','green','orange','blue')) +
ylim(-1.5,2) +
xlim(-4,8) +
theme_bw() +
geom_text_repel(
data = subset(df, (Group != 'Others') & (RNAfc > 3 | RNAfc < -0.5 | TEfc > 1.1 | TEfc < -0.7)),
aes(label = Symbol), size = 3,
box.padding = unit(0.4, 'lines'),
point.padding = unit(0.4, 'lines'),
force = 3,
segment.size = 0.2, segment.colour = 'grey50'
) +
ggtitle("TE fold change against RNA fold change") +
theme(legend.position = c(0.8,0.9),
#legend.position = 'none',
legend.title = element_blank(),
legend.background = element_rect(color = 'black',size = 0.5,linetype= 'solid'),
legend.text = element_text(size = 12),
plot.title = element_text(size = rel(1.5),hjust = 0.5),
axis.title = element_text(size = rel(1.25)),
axis.text.y = element_text(size = 12),
axis.text.x = element_text(size=14))
ggsave('scatter_L24_S15_feb/TE and RNA t2_t1.png',width = 9, height = 7)
## anchor
L24_col = rep('noChange',7990)
L24_col[L24_down_id] <- "down"
L24_col[L24_up_id] <- "up"
S15_col = rep('noChange',7990)
S15_col[S15_down_id] <- "down"
S15_col[S15_up_id] <- "up"
df = data.frame(Gene = list_of_genes,
TEfc = TEfc$log2FoldChange,
RNAfc = RNAfc$log2FoldChange,
L24 = L24_col,
S15 = S15_col,
L24overS15= L24S15_col)
L24S15_col = rep('noChange',7990)
L24S15_col[L24_more_S15] <- "up"
L24S15_col[L24_less_S15] <- "down"
df = data.frame(Gene = list_of_genes,
TEfc = TEfc$log2FoldChange,
RNAfc = RNAfc$log2FoldChange,
L24 = L24_col,
S15 = S15_col,
L24overS15= L24S15_col)
## anchor
L24_col = rep('noChange',7990)
L24_col[L24_down_id] <- "down"
L24_col[L24_up_id] <- "up"
S15_col = rep('noChange',7990)
S15_col[S15_down_id] <- "down"
S15_col[S15_up_id] <- "up"
L24S15_col = rep('noChange',7990)
L24S15_col[L24_more_S15] <- "up"
L24S15_col[L24_less_S15] <- "down"
df = data.frame(Gene = list_of_genes,
TEfc = TEfc$log2FoldChange,
RNAfc = RNAfc$log2FoldChange,
L24 = L24_col,
S15 = S15_col,
L24overS15= L24S15_col)
write.csv(df,"scatter_L24_S15_feb/tefc_rnafc_t2t1_full.csv", row.names = FALSE)
redundent = df$L24 == 'noChange' & df$S15 == 'noChange' & df$L24overS15 == 'noChange'
df_short = df[c(!redundent),]
write.csv(df,"scatter_L24_S15_feb/tefc_rnafc_t2t1_short.csv", row.names = FALSE)
write.csv(df_short,"scatter_L24_S15_feb/tefc_rnafc_t2t1_short.csv", row.names = FALSE)
